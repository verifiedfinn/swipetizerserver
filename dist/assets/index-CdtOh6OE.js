var LM=(i,s)=>()=>(s||i((s={exports:{}}).exports,s),s.exports);var A4=LM((H4,Hm)=>{function DM(i,s){for(var c=0;c<s.length;c++){const p=s[c];if(typeof p!="string"&&!Array.isArray(p)){for(const _ in p)if(_!=="default"&&!(_ in i)){const T=Object.getOwnPropertyDescriptor(p,_);T&&Object.defineProperty(i,_,T.get?T:{enumerable:!0,get:()=>p[_]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))p(_);new MutationObserver(_=>{for(const T of _)if(T.type==="childList")for(const S of T.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&p(S)}).observe(document,{childList:!0,subtree:!0});function c(_){const T={};return _.integrity&&(T.integrity=_.integrity),_.referrerPolicy&&(T.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?T.credentials="include":_.crossOrigin==="anonymous"?T.credentials="omit":T.credentials="same-origin",T}function p(_){if(_.ep)return;_.ep=!0;const T=c(_);fetch(_.href,T)}})();var uh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ay(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function zM(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var s=i.default;if(typeof s=="function"){var c=function p(){return this instanceof p?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};c.prototype=s.prototype}else c={};return Object.defineProperty(c,"__esModule",{value:!0}),Object.keys(i).forEach(function(p){var _=Object.getOwnPropertyDescriptor(i,p);Object.defineProperty(c,p,_.get?_:{enumerable:!0,get:function(){return i[p]}})}),c}var j_={exports:{}},tm={},V_={exports:{}},ar={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iw;function OM(){if(iw)return ar;iw=1;var i=Symbol.for("react.element"),s=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),S=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),o=Symbol.for("react.suspense"),I=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),V=Symbol.iterator;function q(te){return te===null||typeof te!="object"?null:(te=V&&te[V]||te["@@iterator"],typeof te=="function"?te:null)}var ee={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H=Object.assign,j={};function Z(te,Ue,Pt){this.props=te,this.context=Ue,this.refs=j,this.updater=Pt||ee}Z.prototype.isReactComponent={},Z.prototype.setState=function(te,Ue){if(typeof te!="object"&&typeof te!="function"&&te!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,te,Ue,"setState")},Z.prototype.forceUpdate=function(te){this.updater.enqueueForceUpdate(this,te,"forceUpdate")};function ne(){}ne.prototype=Z.prototype;function xe(te,Ue,Pt){this.props=te,this.context=Ue,this.refs=j,this.updater=Pt||ee}var ce=xe.prototype=new ne;ce.constructor=xe,H(ce,Z.prototype),ce.isPureReactComponent=!0;var me=Array.isArray,de=Object.prototype.hasOwnProperty,_e={current:null},Se={key:!0,ref:!0,__self:!0,__source:!0};function $e(te,Ue,Pt){var kt,qt={},Wt=null,St=null;if(Ue!=null)for(kt in Ue.ref!==void 0&&(St=Ue.ref),Ue.key!==void 0&&(Wt=""+Ue.key),Ue)de.call(Ue,kt)&&!Se.hasOwnProperty(kt)&&(qt[kt]=Ue[kt]);var Ft=arguments.length-2;if(Ft===1)qt.children=Pt;else if(1<Ft){for(var en=Array(Ft),yn=0;yn<Ft;yn++)en[yn]=arguments[yn+2];qt.children=en}if(te&&te.defaultProps)for(kt in Ft=te.defaultProps,Ft)qt[kt]===void 0&&(qt[kt]=Ft[kt]);return{$$typeof:i,type:te,key:Wt,ref:St,props:qt,_owner:_e.current}}function dt(te,Ue){return{$$typeof:i,type:te.type,key:Ue,ref:te.ref,props:te.props,_owner:te._owner}}function Y(te){return typeof te=="object"&&te!==null&&te.$$typeof===i}function pt(te){var Ue={"=":"=0",":":"=2"};return"$"+te.replace(/[=:]/g,function(Pt){return Ue[Pt]})}var Lt=/\/+/g;function lt(te,Ue){return typeof te=="object"&&te!==null&&te.key!=null?pt(""+te.key):Ue.toString(36)}function zt(te,Ue,Pt,kt,qt){var Wt=typeof te;(Wt==="undefined"||Wt==="boolean")&&(te=null);var St=!1;if(te===null)St=!0;else switch(Wt){case"string":case"number":St=!0;break;case"object":switch(te.$$typeof){case i:case s:St=!0}}if(St)return St=te,qt=qt(St),te=kt===""?"."+lt(St,0):kt,me(qt)?(Pt="",te!=null&&(Pt=te.replace(Lt,"$&/")+"/"),zt(qt,Ue,Pt,"",function(yn){return yn})):qt!=null&&(Y(qt)&&(qt=dt(qt,Pt+(!qt.key||St&&St.key===qt.key?"":(""+qt.key).replace(Lt,"$&/")+"/")+te)),Ue.push(qt)),1;if(St=0,kt=kt===""?".":kt+":",me(te))for(var Ft=0;Ft<te.length;Ft++){Wt=te[Ft];var en=kt+lt(Wt,Ft);St+=zt(Wt,Ue,Pt,en,qt)}else if(en=q(te),typeof en=="function")for(te=en.call(te),Ft=0;!(Wt=te.next()).done;)Wt=Wt.value,en=kt+lt(Wt,Ft++),St+=zt(Wt,Ue,Pt,en,qt);else if(Wt==="object")throw Ue=String(te),Error("Objects are not valid as a React child (found: "+(Ue==="[object Object]"?"object with keys {"+Object.keys(te).join(", ")+"}":Ue)+"). If you meant to render a collection of children, use an array instead.");return St}function $n(te,Ue,Pt){if(te==null)return te;var kt=[],qt=0;return zt(te,kt,"","",function(Wt){return Ue.call(Pt,Wt,qt++)}),kt}function ln(te){if(te._status===-1){var Ue=te._result;Ue=Ue(),Ue.then(function(Pt){(te._status===0||te._status===-1)&&(te._status=1,te._result=Pt)},function(Pt){(te._status===0||te._status===-1)&&(te._status=2,te._result=Pt)}),te._status===-1&&(te._status=0,te._result=Ue)}if(te._status===1)return te._result.default;throw te._result}var fn={current:null},gt={transition:null},Et={ReactCurrentDispatcher:fn,ReactCurrentBatchConfig:gt,ReactCurrentOwner:_e};function Le(){throw Error("act(...) is not supported in production builds of React.")}return ar.Children={map:$n,forEach:function(te,Ue,Pt){$n(te,function(){Ue.apply(this,arguments)},Pt)},count:function(te){var Ue=0;return $n(te,function(){Ue++}),Ue},toArray:function(te){return $n(te,function(Ue){return Ue})||[]},only:function(te){if(!Y(te))throw Error("React.Children.only expected to receive a single React element child.");return te}},ar.Component=Z,ar.Fragment=c,ar.Profiler=_,ar.PureComponent=xe,ar.StrictMode=p,ar.Suspense=o,ar.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Et,ar.act=Le,ar.cloneElement=function(te,Ue,Pt){if(te==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+te+".");var kt=H({},te.props),qt=te.key,Wt=te.ref,St=te._owner;if(Ue!=null){if(Ue.ref!==void 0&&(Wt=Ue.ref,St=_e.current),Ue.key!==void 0&&(qt=""+Ue.key),te.type&&te.type.defaultProps)var Ft=te.type.defaultProps;for(en in Ue)de.call(Ue,en)&&!Se.hasOwnProperty(en)&&(kt[en]=Ue[en]===void 0&&Ft!==void 0?Ft[en]:Ue[en])}var en=arguments.length-2;if(en===1)kt.children=Pt;else if(1<en){Ft=Array(en);for(var yn=0;yn<en;yn++)Ft[yn]=arguments[yn+2];kt.children=Ft}return{$$typeof:i,type:te.type,key:qt,ref:Wt,props:kt,_owner:St}},ar.createContext=function(te){return te={$$typeof:S,_currentValue:te,_currentValue2:te,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},te.Provider={$$typeof:T,_context:te},te.Consumer=te},ar.createElement=$e,ar.createFactory=function(te){var Ue=$e.bind(null,te);return Ue.type=te,Ue},ar.createRef=function(){return{current:null}},ar.forwardRef=function(te){return{$$typeof:k,render:te}},ar.isValidElement=Y,ar.lazy=function(te){return{$$typeof:O,_payload:{_status:-1,_result:te},_init:ln}},ar.memo=function(te,Ue){return{$$typeof:I,type:te,compare:Ue===void 0?null:Ue}},ar.startTransition=function(te){var Ue=gt.transition;gt.transition={};try{te()}finally{gt.transition=Ue}},ar.unstable_act=Le,ar.useCallback=function(te,Ue){return fn.current.useCallback(te,Ue)},ar.useContext=function(te){return fn.current.useContext(te)},ar.useDebugValue=function(){},ar.useDeferredValue=function(te){return fn.current.useDeferredValue(te)},ar.useEffect=function(te,Ue){return fn.current.useEffect(te,Ue)},ar.useId=function(){return fn.current.useId()},ar.useImperativeHandle=function(te,Ue,Pt){return fn.current.useImperativeHandle(te,Ue,Pt)},ar.useInsertionEffect=function(te,Ue){return fn.current.useInsertionEffect(te,Ue)},ar.useLayoutEffect=function(te,Ue){return fn.current.useLayoutEffect(te,Ue)},ar.useMemo=function(te,Ue){return fn.current.useMemo(te,Ue)},ar.useReducer=function(te,Ue,Pt){return fn.current.useReducer(te,Ue,Pt)},ar.useRef=function(te){return fn.current.useRef(te)},ar.useState=function(te){return fn.current.useState(te)},ar.useSyncExternalStore=function(te,Ue,Pt){return fn.current.useSyncExternalStore(te,Ue,Pt)},ar.useTransition=function(){return fn.current.useTransition()},ar.version="18.3.1",ar}var ow;function I0(){return ow||(ow=1,V_.exports=OM()),V_.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sw;function BM(){if(sw)return tm;sw=1;var i=I0(),s=Symbol.for("react.element"),c=Symbol.for("react.fragment"),p=Object.prototype.hasOwnProperty,_=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,T={key:!0,ref:!0,__self:!0,__source:!0};function S(k,o,I){var O,V={},q=null,ee=null;I!==void 0&&(q=""+I),o.key!==void 0&&(q=""+o.key),o.ref!==void 0&&(ee=o.ref);for(O in o)p.call(o,O)&&!T.hasOwnProperty(O)&&(V[O]=o[O]);if(k&&k.defaultProps)for(O in o=k.defaultProps,o)V[O]===void 0&&(V[O]=o[O]);return{$$typeof:s,type:k,key:q,ref:ee,props:V,_owner:_.current}}return tm.Fragment=c,tm.jsx=S,tm.jsxs=S,tm}var aw;function FM(){return aw||(aw=1,j_.exports=BM()),j_.exports}var Be=FM(),Ee=I0();const lc=Ay(Ee),lw=DM({__proto__:null,default:lc},[Ee]);var Bg={},U_={exports:{}},Ds={},$_={exports:{}},G_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uw;function NM(){return uw||(uw=1,function(i){function s(gt,Et){var Le=gt.length;gt.push(Et);e:for(;0<Le;){var te=Le-1>>>1,Ue=gt[te];if(0<_(Ue,Et))gt[te]=Et,gt[Le]=Ue,Le=te;else break e}}function c(gt){return gt.length===0?null:gt[0]}function p(gt){if(gt.length===0)return null;var Et=gt[0],Le=gt.pop();if(Le!==Et){gt[0]=Le;e:for(var te=0,Ue=gt.length,Pt=Ue>>>1;te<Pt;){var kt=2*(te+1)-1,qt=gt[kt],Wt=kt+1,St=gt[Wt];if(0>_(qt,Le))Wt<Ue&&0>_(St,qt)?(gt[te]=St,gt[Wt]=Le,te=Wt):(gt[te]=qt,gt[kt]=Le,te=kt);else if(Wt<Ue&&0>_(St,Le))gt[te]=St,gt[Wt]=Le,te=Wt;else break e}}return Et}function _(gt,Et){var Le=gt.sortIndex-Et.sortIndex;return Le!==0?Le:gt.id-Et.id}if(typeof performance=="object"&&typeof performance.now=="function"){var T=performance;i.unstable_now=function(){return T.now()}}else{var S=Date,k=S.now();i.unstable_now=function(){return S.now()-k}}var o=[],I=[],O=1,V=null,q=3,ee=!1,H=!1,j=!1,Z=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,xe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ce(gt){for(var Et=c(I);Et!==null;){if(Et.callback===null)p(I);else if(Et.startTime<=gt)p(I),Et.sortIndex=Et.expirationTime,s(o,Et);else break;Et=c(I)}}function me(gt){if(j=!1,ce(gt),!H)if(c(o)!==null)H=!0,ln(de);else{var Et=c(I);Et!==null&&fn(me,Et.startTime-gt)}}function de(gt,Et){H=!1,j&&(j=!1,ne($e),$e=-1),ee=!0;var Le=q;try{for(ce(Et),V=c(o);V!==null&&(!(V.expirationTime>Et)||gt&&!pt());){var te=V.callback;if(typeof te=="function"){V.callback=null,q=V.priorityLevel;var Ue=te(V.expirationTime<=Et);Et=i.unstable_now(),typeof Ue=="function"?V.callback=Ue:V===c(o)&&p(o),ce(Et)}else p(o);V=c(o)}if(V!==null)var Pt=!0;else{var kt=c(I);kt!==null&&fn(me,kt.startTime-Et),Pt=!1}return Pt}finally{V=null,q=Le,ee=!1}}var _e=!1,Se=null,$e=-1,dt=5,Y=-1;function pt(){return!(i.unstable_now()-Y<dt)}function Lt(){if(Se!==null){var gt=i.unstable_now();Y=gt;var Et=!0;try{Et=Se(!0,gt)}finally{Et?lt():(_e=!1,Se=null)}}else _e=!1}var lt;if(typeof xe=="function")lt=function(){xe(Lt)};else if(typeof MessageChannel<"u"){var zt=new MessageChannel,$n=zt.port2;zt.port1.onmessage=Lt,lt=function(){$n.postMessage(null)}}else lt=function(){Z(Lt,0)};function ln(gt){Se=gt,_e||(_e=!0,lt())}function fn(gt,Et){$e=Z(function(){gt(i.unstable_now())},Et)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(gt){gt.callback=null},i.unstable_continueExecution=function(){H||ee||(H=!0,ln(de))},i.unstable_forceFrameRate=function(gt){0>gt||125<gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):dt=0<gt?Math.floor(1e3/gt):5},i.unstable_getCurrentPriorityLevel=function(){return q},i.unstable_getFirstCallbackNode=function(){return c(o)},i.unstable_next=function(gt){switch(q){case 1:case 2:case 3:var Et=3;break;default:Et=q}var Le=q;q=Et;try{return gt()}finally{q=Le}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(gt,Et){switch(gt){case 1:case 2:case 3:case 4:case 5:break;default:gt=3}var Le=q;q=gt;try{return Et()}finally{q=Le}},i.unstable_scheduleCallback=function(gt,Et,Le){var te=i.unstable_now();switch(typeof Le=="object"&&Le!==null?(Le=Le.delay,Le=typeof Le=="number"&&0<Le?te+Le:te):Le=te,gt){case 1:var Ue=-1;break;case 2:Ue=250;break;case 5:Ue=1073741823;break;case 4:Ue=1e4;break;default:Ue=5e3}return Ue=Le+Ue,gt={id:O++,callback:Et,priorityLevel:gt,startTime:Le,expirationTime:Ue,sortIndex:-1},Le>te?(gt.sortIndex=Le,s(I,gt),c(o)===null&&gt===c(I)&&(j?(ne($e),$e=-1):j=!0,fn(me,Le-te))):(gt.sortIndex=Ue,s(o,gt),H||ee||(H=!0,ln(de))),gt},i.unstable_shouldYield=pt,i.unstable_wrapCallback=function(gt){var Et=q;return function(){var Le=q;q=Et;try{return gt.apply(this,arguments)}finally{q=Le}}}}(G_)),G_}var cw;function jM(){return cw||(cw=1,$_.exports=NM()),$_.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hw;function VM(){if(hw)return Ds;hw=1;var i=I0(),s=jM();function c(l){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+l,x=1;x<arguments.length;x++)d+="&args[]="+encodeURIComponent(arguments[x]);return"Minified React error #"+l+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p=new Set,_={};function T(l,d){S(l,d),S(l+"Capture",d)}function S(l,d){for(_[l]=d,l=0;l<d.length;l++)p.add(d[l])}var k=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),o=Object.prototype.hasOwnProperty,I=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,O={},V={};function q(l){return o.call(V,l)?!0:o.call(O,l)?!1:I.test(l)?V[l]=!0:(O[l]=!0,!1)}function ee(l,d,x,A){if(x!==null&&x.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return A?!1:x!==null?!x.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function H(l,d,x,A){if(d===null||typeof d>"u"||ee(l,d,x,A))return!0;if(A)return!1;if(x!==null)switch(x.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function j(l,d,x,A,D,U,re){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=A,this.attributeNamespace=D,this.mustUseProperty=x,this.propertyName=l,this.type=d,this.sanitizeURL=U,this.removeEmptyString=re}var Z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){Z[l]=new j(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var d=l[0];Z[d]=new j(d,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){Z[l]=new j(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){Z[l]=new j(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){Z[l]=new j(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){Z[l]=new j(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){Z[l]=new j(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){Z[l]=new j(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){Z[l]=new j(l,5,!1,l.toLowerCase(),null,!1,!1)});var ne=/[\-:]([a-z])/g;function xe(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var d=l.replace(ne,xe);Z[d]=new j(d,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var d=l.replace(ne,xe);Z[d]=new j(d,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var d=l.replace(ne,xe);Z[d]=new j(d,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){Z[l]=new j(l,1,!1,l.toLowerCase(),null,!1,!1)}),Z.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){Z[l]=new j(l,1,!1,l.toLowerCase(),null,!0,!0)});function ce(l,d,x,A){var D=Z.hasOwnProperty(d)?Z[d]:null;(D!==null?D.type!==0:A||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(H(d,x,D,A)&&(x=null),A||D===null?q(d)&&(x===null?l.removeAttribute(d):l.setAttribute(d,""+x)):D.mustUseProperty?l[D.propertyName]=x===null?D.type===3?!1:"":x:(d=D.attributeName,A=D.attributeNamespace,x===null?l.removeAttribute(d):(D=D.type,x=D===3||D===4&&x===!0?"":""+x,A?l.setAttributeNS(A,d,x):l.setAttribute(d,x))))}var me=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,de=Symbol.for("react.element"),_e=Symbol.for("react.portal"),Se=Symbol.for("react.fragment"),$e=Symbol.for("react.strict_mode"),dt=Symbol.for("react.profiler"),Y=Symbol.for("react.provider"),pt=Symbol.for("react.context"),Lt=Symbol.for("react.forward_ref"),lt=Symbol.for("react.suspense"),zt=Symbol.for("react.suspense_list"),$n=Symbol.for("react.memo"),ln=Symbol.for("react.lazy"),fn=Symbol.for("react.offscreen"),gt=Symbol.iterator;function Et(l){return l===null||typeof l!="object"?null:(l=gt&&l[gt]||l["@@iterator"],typeof l=="function"?l:null)}var Le=Object.assign,te;function Ue(l){if(te===void 0)try{throw Error()}catch(x){var d=x.stack.trim().match(/\n( *(at )?)/);te=d&&d[1]||""}return`
`+te+l}var Pt=!1;function kt(l,d){if(!l||Pt)return"";Pt=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(tt){var A=tt}Reflect.construct(l,[],d)}else{try{d.call()}catch(tt){A=tt}l.call(d.prototype)}else{try{throw Error()}catch(tt){A=tt}l()}}catch(tt){if(tt&&A&&typeof tt.stack=="string"){for(var D=tt.stack.split(`
`),U=A.stack.split(`
`),re=D.length-1,Ce=U.length-1;1<=re&&0<=Ce&&D[re]!==U[Ce];)Ce--;for(;1<=re&&0<=Ce;re--,Ce--)if(D[re]!==U[Ce]){if(re!==1||Ce!==1)do if(re--,Ce--,0>Ce||D[re]!==U[Ce]){var Oe=`
`+D[re].replace(" at new "," at ");return l.displayName&&Oe.includes("<anonymous>")&&(Oe=Oe.replace("<anonymous>",l.displayName)),Oe}while(1<=re&&0<=Ce);break}}}finally{Pt=!1,Error.prepareStackTrace=x}return(l=l?l.displayName||l.name:"")?Ue(l):""}function qt(l){switch(l.tag){case 5:return Ue(l.type);case 16:return Ue("Lazy");case 13:return Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 2:case 15:return l=kt(l.type,!1),l;case 11:return l=kt(l.type.render,!1),l;case 1:return l=kt(l.type,!0),l;default:return""}}function Wt(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case Se:return"Fragment";case _e:return"Portal";case dt:return"Profiler";case $e:return"StrictMode";case lt:return"Suspense";case zt:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case pt:return(l.displayName||"Context")+".Consumer";case Y:return(l._context.displayName||"Context")+".Provider";case Lt:var d=l.render;return l=l.displayName,l||(l=d.displayName||d.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case $n:return d=l.displayName||null,d!==null?d:Wt(l.type)||"Memo";case ln:d=l._payload,l=l._init;try{return Wt(l(d))}catch{}}return null}function St(l){var d=l.type;switch(l.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=d.render,l=l.displayName||l.name||"",d.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wt(d);case 8:return d===$e?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Ft(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function en(l){var d=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function yn(l){var d=en(l)?"checked":"value",x=Object.getOwnPropertyDescriptor(l.constructor.prototype,d),A=""+l[d];if(!l.hasOwnProperty(d)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var D=x.get,U=x.set;return Object.defineProperty(l,d,{configurable:!0,get:function(){return D.call(this)},set:function(re){A=""+re,U.call(this,re)}}),Object.defineProperty(l,d,{enumerable:x.enumerable}),{getValue:function(){return A},setValue:function(re){A=""+re},stopTracking:function(){l._valueTracker=null,delete l[d]}}}}function Bn(l){l._valueTracker||(l._valueTracker=yn(l))}function Xt(l){if(!l)return!1;var d=l._valueTracker;if(!d)return!0;var x=d.getValue(),A="";return l&&(A=en(l)?l.checked?"true":"false":l.value),l=A,l!==x?(d.setValue(l),!0):!1}function Fn(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function pn(l,d){var x=d.checked;return Le({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:x??l._wrapperState.initialChecked})}function Pr(l,d){var x=d.defaultValue==null?"":d.defaultValue,A=d.checked!=null?d.checked:d.defaultChecked;x=Ft(d.value!=null?d.value:x),l._wrapperState={initialChecked:A,initialValue:x,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Nn(l,d){d=d.checked,d!=null&&ce(l,"checked",d,!1)}function jn(l,d){Nn(l,d);var x=Ft(d.value),A=d.type;if(x!=null)A==="number"?(x===0&&l.value===""||l.value!=x)&&(l.value=""+x):l.value!==""+x&&(l.value=""+x);else if(A==="submit"||A==="reset"){l.removeAttribute("value");return}d.hasOwnProperty("value")?Dr(l,d.type,x):d.hasOwnProperty("defaultValue")&&Dr(l,d.type,Ft(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(l.defaultChecked=!!d.defaultChecked)}function Kr(l,d,x){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var A=d.type;if(!(A!=="submit"&&A!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+l._wrapperState.initialValue,x||d===l.value||(l.value=d),l.defaultValue=d}x=l.name,x!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,x!==""&&(l.name=x)}function Dr(l,d,x){(d!=="number"||Fn(l.ownerDocument)!==l)&&(x==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+x&&(l.defaultValue=""+x))}var lr=Array.isArray;function Ii(l,d,x,A){if(l=l.options,d){d={};for(var D=0;D<x.length;D++)d["$"+x[D]]=!0;for(x=0;x<l.length;x++)D=d.hasOwnProperty("$"+l[x].value),l[x].selected!==D&&(l[x].selected=D),D&&A&&(l[x].defaultSelected=!0)}else{for(x=""+Ft(x),d=null,D=0;D<l.length;D++){if(l[D].value===x){l[D].selected=!0,A&&(l[D].defaultSelected=!0);return}d!==null||l[D].disabled||(d=l[D])}d!==null&&(d.selected=!0)}}function Zi(l,d){if(d.dangerouslySetInnerHTML!=null)throw Error(c(91));return Le({},d,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Hi(l,d){var x=d.value;if(x==null){if(x=d.children,d=d.defaultValue,x!=null){if(d!=null)throw Error(c(92));if(lr(x)){if(1<x.length)throw Error(c(93));x=x[0]}d=x}d==null&&(d=""),x=d}l._wrapperState={initialValue:Ft(x)}}function Ri(l,d){var x=Ft(d.value),A=Ft(d.defaultValue);x!=null&&(x=""+x,x!==l.value&&(l.value=x),d.defaultValue==null&&l.defaultValue!==x&&(l.defaultValue=x)),A!=null&&(l.defaultValue=""+A)}function It(l){var d=l.textContent;d===l._wrapperState.initialValue&&d!==""&&d!==null&&(l.value=d)}function Ht(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mn(l,d){return l==null||l==="http://www.w3.org/1999/xhtml"?Ht(d):l==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var xn,Wn=function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,x,A,D){MSApp.execUnsafeLocalFunction(function(){return l(d,x,A,D)})}:l}(function(l,d){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=d;else{for(xn=xn||document.createElement("div"),xn.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=xn.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;d.firstChild;)l.appendChild(d.firstChild)}});function un(l,d){if(d){var x=l.firstChild;if(x&&x===l.lastChild&&x.nodeType===3){x.nodeValue=d;return}}l.textContent=d}var tr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zr=["Webkit","ms","Moz","O"];Object.keys(tr).forEach(function(l){zr.forEach(function(d){d=d+l.charAt(0).toUpperCase()+l.substring(1),tr[d]=tr[l]})});function pr(l,d,x){return d==null||typeof d=="boolean"||d===""?"":x||typeof d!="number"||d===0||tr.hasOwnProperty(l)&&tr[l]?(""+d).trim():d+"px"}function Yr(l,d){l=l.style;for(var x in d)if(d.hasOwnProperty(x)){var A=x.indexOf("--")===0,D=pr(x,d[x],A);x==="float"&&(x="cssFloat"),A?l.setProperty(x,D):l[x]=D}}var io=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ts(l,d){if(d){if(io[l]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(c(137,l));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(c(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(c(61))}if(d.style!=null&&typeof d.style!="object")throw Error(c(62))}}function yo(l,d){if(l.indexOf("-")===-1)return typeof d.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gs=null;function ys(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var we=null,J=null,Q=null;function ye(l){if(l=Ul(l)){if(typeof we!="function")throw Error(c(280));var d=l.stateNode;d&&(d=zc(d),we(l.stateNode,l.type,d))}}function Ae(l){J?Q?Q.push(l):Q=[l]:J=l}function De(){if(J){var l=J,d=Q;if(Q=J=null,ye(l),d)for(l=0;l<d.length;l++)ye(d[l])}}function Ve(l,d){return l(d)}function Ge(){}var ze=!1;function Je(l,d,x){if(ze)return l(d,x);ze=!0;try{return Ve(l,d,x)}finally{ze=!1,(J!==null||Q!==null)&&(Ge(),De())}}function Tt(l,d){var x=l.stateNode;if(x===null)return null;var A=zc(x);if(A===null)return null;x=A[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(l=l.type,A=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!A;break e;default:l=!1}if(l)return null;if(x&&typeof x!="function")throw Error(c(231,d,typeof x));return x}var Dt=!1;if(k)try{var xt={};Object.defineProperty(xt,"passive",{get:function(){Dt=!0}}),window.addEventListener("test",xt,xt),window.removeEventListener("test",xt,xt)}catch{Dt=!1}function bn(l,d,x,A,D,U,re,Ce,Oe){var tt=Array.prototype.slice.call(arguments,3);try{d.apply(x,tt)}catch(Rt){this.onError(Rt)}}var Tn=!1,wn=null,Sn=!1,Vn=null,Ir={onError:function(l){Tn=!0,wn=l}};function Jr(l,d,x,A,D,U,re,Ce,Oe){Tn=!1,wn=null,bn.apply(Ir,arguments)}function Fi(l,d,x,A,D,U,re,Ce,Oe){if(Jr.apply(this,arguments),Tn){if(Tn){var tt=wn;Tn=!1,wn=null}else throw Error(c(198));Sn||(Sn=!0,Vn=tt)}}function Cr(l){var d=l,x=l;if(l.alternate)for(;d.return;)d=d.return;else{l=d;do d=l,(d.flags&4098)!==0&&(x=d.return),l=d.return;while(l)}return d.tag===3?x:null}function ns(l){if(l.tag===13){var d=l.memoizedState;if(d===null&&(l=l.alternate,l!==null&&(d=l.memoizedState)),d!==null)return d.dehydrated}return null}function ui(l){if(Cr(l)!==l)throw Error(c(188))}function Xi(l){var d=l.alternate;if(!d){if(d=Cr(l),d===null)throw Error(c(188));return d!==l?null:l}for(var x=l,A=d;;){var D=x.return;if(D===null)break;var U=D.alternate;if(U===null){if(A=D.return,A!==null){x=A;continue}break}if(D.child===U.child){for(U=D.child;U;){if(U===x)return ui(D),l;if(U===A)return ui(D),d;U=U.sibling}throw Error(c(188))}if(x.return!==A.return)x=D,A=U;else{for(var re=!1,Ce=D.child;Ce;){if(Ce===x){re=!0,x=D,A=U;break}if(Ce===A){re=!0,A=D,x=U;break}Ce=Ce.sibling}if(!re){for(Ce=U.child;Ce;){if(Ce===x){re=!0,x=U,A=D;break}if(Ce===A){re=!0,A=U,x=D;break}Ce=Ce.sibling}if(!re)throw Error(c(189))}}if(x.alternate!==A)throw Error(c(190))}if(x.tag!==3)throw Error(c(188));return x.stateNode.current===x?l:d}function ja(l){return l=Xi(l),l!==null?Id(l):null}function Id(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var d=Id(l);if(d!==null)return d;l=l.sibling}return null}var mh=s.unstable_scheduleCallback,Qn=s.unstable_cancelCallback,gh=s.unstable_shouldYield,vu=s.unstable_requestPaint,Nr=s.unstable_now,gc=s.unstable_getCurrentPriorityLevel,Lo=s.unstable_ImmediatePriority,_s=s.unstable_UserBlockingPriority,yl=s.unstable_NormalPriority,yh=s.unstable_LowPriority,la=s.unstable_IdlePriority,Do=null,oo=null;function ot(l){if(oo&&typeof oo.onCommitFiberRoot=="function")try{oo.onCommitFiberRoot(Do,l,void 0,(l.current.flags&128)===128)}catch{}}var ci=Math.clz32?Math.clz32:Rd,Qr=Math.log,_i=Math.LN2;function Rd(l){return l>>>=0,l===0?32:31-(Qr(l)/_i|0)|0}var _o=64,_l=4194304;function vl(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Ns(l,d){var x=l.pendingLanes;if(x===0)return 0;var A=0,D=l.suspendedLanes,U=l.pingedLanes,re=x&268435455;if(re!==0){var Ce=re&~D;Ce!==0?A=vl(Ce):(U&=re,U!==0&&(A=vl(U)))}else re=x&~D,re!==0?A=vl(re):U!==0&&(A=vl(U));if(A===0)return 0;if(d!==0&&d!==A&&(d&D)===0&&(D=A&-A,U=d&-d,D>=U||D===16&&(U&4194240)!==0))return d;if((A&4)!==0&&(A|=x&16),d=l.entangledLanes,d!==0)for(l=l.entanglements,d&=A;0<d;)x=31-ci(d),D=1<<x,A|=l[x],d&=~D;return A}function $t(l,d){switch(l){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gn(l,d){for(var x=l.suspendedLanes,A=l.pingedLanes,D=l.expirationTimes,U=l.pendingLanes;0<U;){var re=31-ci(U),Ce=1<<re,Oe=D[re];Oe===-1?((Ce&x)===0||(Ce&A)!==0)&&(D[re]=$t(Ce,d)):Oe<=d&&(l.expiredLanes|=Ce),U&=~Ce}}function Ln(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function so(){var l=_o;return _o<<=1,(_o&4194240)===0&&(_o=64),l}function vo(l){for(var d=[],x=0;31>x;x++)d.push(l);return d}function Cn(l,d,x){l.pendingLanes|=d,d!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,d=31-ci(d),l[d]=x}function xo(l,d){var x=l.pendingLanes&~d;l.pendingLanes=d,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=d,l.mutableReadLanes&=d,l.entangledLanes&=d,d=l.entanglements;var A=l.eventTimes;for(l=l.expirationTimes;0<x;){var D=31-ci(x),U=1<<D;d[D]=0,A[D]=-1,l[D]=-1,x&=~U}}function Va(l,d){var x=l.entangledLanes|=d;for(l=l.entanglements;x;){var A=31-ci(x),D=1<<A;D&d|l[A]&d&&(l[A]|=d),x&=~D}}var er=0;function wo(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var _r,yc,vs,xl,wl,xu=!1,wu=[],zo=null,Oo=null,rs=null,xs=new Map,vi=new Map,dr=[],_h="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _c(l,d){switch(l){case"focusin":case"focusout":zo=null;break;case"dragenter":case"dragleave":Oo=null;break;case"mouseover":case"mouseout":rs=null;break;case"pointerover":case"pointerout":xs.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":vi.delete(d.pointerId)}}function xi(l,d,x,A,D,U){return l===null||l.nativeEvent!==U?(l={blockedOn:d,domEventName:x,eventSystemFlags:A,nativeEvent:U,targetContainers:[D]},d!==null&&(d=Ul(d),d!==null&&yc(d)),l):(l.eventSystemFlags|=A,d=l.targetContainers,D!==null&&d.indexOf(D)===-1&&d.push(D),l)}function Bo(l,d,x,A,D){switch(d){case"focusin":return zo=xi(zo,l,d,x,A,D),!0;case"dragenter":return Oo=xi(Oo,l,d,x,A,D),!0;case"mouseover":return rs=xi(rs,l,d,x,A,D),!0;case"pointerover":var U=D.pointerId;return xs.set(U,xi(xs.get(U)||null,l,d,x,A,D)),!0;case"gotpointercapture":return U=D.pointerId,vi.set(U,xi(vi.get(U)||null,l,d,x,A,D)),!0}return!1}function vh(l){var d=ho(l.target);if(d!==null){var x=Cr(d);if(x!==null){if(d=x.tag,d===13){if(d=ns(x),d!==null){l.blockedOn=d,wl(l.priority,function(){vs(x)});return}}else if(d===3&&x.stateNode.current.memoizedState.isDehydrated){l.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}l.blockedOn=null}function ua(l){if(l.blockedOn!==null)return!1;for(var d=l.targetContainers;0<d.length;){var x=wh(l.domEventName,l.eventSystemFlags,d[0],l.nativeEvent);if(x===null){x=l.nativeEvent;var A=new x.constructor(x.type,x);gs=A,x.target.dispatchEvent(A),gs=null}else return d=Ul(x),d!==null&&yc(d),l.blockedOn=x,!1;d.shift()}return!0}function Or(l,d,x){ua(l)&&x.delete(d)}function bu(){xu=!1,zo!==null&&ua(zo)&&(zo=null),Oo!==null&&ua(Oo)&&(Oo=null),rs!==null&&ua(rs)&&(rs=null),xs.forEach(Or),vi.forEach(Or)}function Ua(l,d){l.blockedOn===d&&(l.blockedOn=null,xu||(xu=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,bu)))}function is(l){function d(D){return Ua(D,l)}if(0<wu.length){Ua(wu[0],l);for(var x=1;x<wu.length;x++){var A=wu[x];A.blockedOn===l&&(A.blockedOn=null)}}for(zo!==null&&Ua(zo,l),Oo!==null&&Ua(Oo,l),rs!==null&&Ua(rs,l),xs.forEach(d),vi.forEach(d),x=0;x<dr.length;x++)A=dr[x],A.blockedOn===l&&(A.blockedOn=null);for(;0<dr.length&&(x=dr[0],x.blockedOn===null);)vh(x),x.blockedOn===null&&dr.shift()}var Wr=me.ReactCurrentBatchConfig,bl=!0;function xh(l,d,x,A){var D=er,U=Wr.transition;Wr.transition=null;try{er=1,ws(l,d,x,A)}finally{er=D,Wr.transition=U}}function js(l,d,x,A){var D=er,U=Wr.transition;Wr.transition=null;try{er=4,ws(l,d,x,A)}finally{er=D,Wr.transition=U}}function ws(l,d,x,A){if(bl){var D=wh(l,d,x,A);if(D===null)zl(l,d,A,$a,x),_c(l,A);else if(Bo(D,l,d,x,A))A.stopPropagation();else if(_c(l,A),d&4&&-1<_h.indexOf(l)){for(;D!==null;){var U=Ul(D);if(U!==null&&_r(U),U=wh(l,d,x,A),U===null&&zl(l,d,A,$a,x),U===D)break;D=U}D!==null&&A.stopPropagation()}else zl(l,d,A,null,x)}}var $a=null;function wh(l,d,x,A){if($a=null,l=ys(A),l=ho(l),l!==null)if(d=Cr(l),d===null)l=null;else if(x=d.tag,x===13){if(l=ns(d),l!==null)return l;l=null}else if(x===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;l=null}else d!==l&&(l=null);return $a=l,null}function vc(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gc()){case Lo:return 1;case _s:return 4;case yl:case yh:return 16;case la:return 536870912;default:return 16}default:return 16}}var bo=null,Fo=null,Tl=null;function ca(){if(Tl)return Tl;var l,d=Fo,x=d.length,A,D="value"in bo?bo.value:bo.textContent,U=D.length;for(l=0;l<x&&d[l]===D[l];l++);var re=x-l;for(A=1;A<=re&&d[x-A]===D[U-A];A++);return Tl=D.slice(l,1<A?1-A:void 0)}function No(l){var d=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&d===13&&(l=13)):l=d,l===10&&(l=13),32<=l||l===13?l:0}function ha(){return!0}function bs(){return!1}function Ni(l){function d(x,A,D,U,re){this._reactName=x,this._targetInst=D,this.type=A,this.nativeEvent=U,this.target=re,this.currentTarget=null;for(var Ce in l)l.hasOwnProperty(Ce)&&(x=l[Ce],this[Ce]=x?x(U):U[Ce]);return this.isDefaultPrevented=(U.defaultPrevented!=null?U.defaultPrevented:U.returnValue===!1)?ha:bs,this.isPropagationStopped=bs,this}return Le(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=ha)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=ha)},persist:function(){},isPersistent:ha}),d}var os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ga=Ni(os),El=Le({},os,{view:0,detail:0}),xc=Ni(El),Tu,Eu,Ts,Xn=Le({},El,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cu,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Ts&&(Ts&&l.type==="mousemove"?(Tu=l.screenX-Ts.screenX,Eu=l.screenY-Ts.screenY):Eu=Tu=0,Ts=l),Tu)},movementY:function(l){return"movementY"in l?l.movementY:Eu}}),Ld=Ni(Xn),bh=Le({},Xn,{dataTransfer:0}),Dd=Ni(bh),Th=Le({},El,{relatedTarget:0}),wc=Ni(Th),Eh=Le({},os,{animationName:0,elapsedTime:0,pseudoElement:0}),Sl=Ni(Eh),bc=Le({},os,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),Cl=Ni(bc),Vs=Le({},os,{data:0}),da=Ni(Vs),Tc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Su={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sh(l){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(l):(l=Su[l])?!!d[l]:!1}function Cu(){return Sh}var Ec=Le({},El,{key:function(l){if(l.key){var d=Tc[l.key]||l.key;if(d!=="Unidentified")return d}return l.type==="keypress"?(l=No(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?zd[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cu,charCode:function(l){return l.type==="keypress"?No(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?No(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Sc=Ni(Ec),Ch=Le({},Xn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zn=Ni(Ch),Au=Le({},El,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cu}),Od=Ni(Au),Ah=Le({},os,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bd=Ni(Ah),qa=Le({},Xn,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Mh=Ni(qa),op=[9,13,27,32],kh=k&&"CompositionEvent"in window,Mu=null;k&&"documentMode"in document&&(Mu=document.documentMode);var Ph=k&&"TextEvent"in window&&!Mu,Cc=k&&(!kh||Mu&&8<Mu&&11>=Mu),Ac=" ",ku=!1;function Ih(l,d){switch(l){case"keyup":return op.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rh(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Al=!1;function Pu(l,d){switch(l){case"compositionend":return Rh(d);case"keypress":return d.which!==32?null:(ku=!0,Ac);case"textInput":return l=d.data,l===Ac&&ku?null:l;default:return null}}function Ml(l,d){if(Al)return l==="compositionend"||!kh&&Ih(l,d)?(l=ca(),Tl=Fo=bo=null,Al=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return Cc&&d.locale!=="ko"?null:d.data;default:return null}}var Lh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kl(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d==="input"?!!Lh[l.type]:d==="textarea"}function Mc(l,d,x,A){Ae(A),d=uo(d,"onChange"),0<d.length&&(x=new Ga("onChange","change",null,x,A),l.push({event:x,listeners:d}))}var ao=null,fa=null;function Dh(l){Ka(l,0)}function Wa(l){var d=Qa(l);if(Xt(d))return l}function Fd(l,d){if(l==="change")return d}var kc=!1;if(k){var zh;if(k){var Iu="oninput"in document;if(!Iu){var Ru=document.createElement("div");Ru.setAttribute("oninput","return;"),Iu=typeof Ru.oninput=="function"}zh=Iu}else zh=!1;kc=zh&&(!document.documentMode||9<document.documentMode)}function Pl(){ao&&(ao.detachEvent("onpropertychange",Oh),fa=ao=null)}function Oh(l){if(l.propertyName==="value"&&Wa(fa)){var d=[];Mc(d,fa,l,ys(l)),Je(Dh,d)}}function Bh(l,d,x){l==="focusin"?(Pl(),ao=d,fa=x,ao.attachEvent("onpropertychange",Oh)):l==="focusout"&&Pl()}function sp(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Wa(fa)}function Fh(l,d){if(l==="click")return Wa(d)}function Nd(l,d){if(l==="input"||l==="change")return Wa(d)}function Lu(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var jo=typeof Object.is=="function"?Object.is:Lu;function pa(l,d){if(jo(l,d))return!0;if(typeof l!="object"||l===null||typeof d!="object"||d===null)return!1;var x=Object.keys(l),A=Object.keys(d);if(x.length!==A.length)return!1;for(A=0;A<x.length;A++){var D=x[A];if(!o.call(d,D)||!jo(l[D],d[D]))return!1}return!0}function Nh(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function Za(l,d){var x=Nh(l);l=0;for(var A;x;){if(x.nodeType===3){if(A=l+x.textContent.length,l<=d&&A>=d)return{node:x,offset:d-l};l=A}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=Nh(x)}}function jd(l,d){return l&&d?l===d?!0:l&&l.nodeType===3?!1:d&&d.nodeType===3?jd(l,d.parentNode):"contains"in l?l.contains(d):l.compareDocumentPosition?!!(l.compareDocumentPosition(d)&16):!1:!1}function Vd(){for(var l=window,d=Fn();d instanceof l.HTMLIFrameElement;){try{var x=typeof d.contentWindow.location.href=="string"}catch{x=!1}if(x)l=d.contentWindow;else break;d=Fn(l.document)}return d}function jh(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d&&(d==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||d==="textarea"||l.contentEditable==="true")}function ap(l){var d=Vd(),x=l.focusedElem,A=l.selectionRange;if(d!==x&&x&&x.ownerDocument&&jd(x.ownerDocument.documentElement,x)){if(A!==null&&jh(x)){if(d=A.start,l=A.end,l===void 0&&(l=d),"selectionStart"in x)x.selectionStart=d,x.selectionEnd=Math.min(l,x.value.length);else if(l=(d=x.ownerDocument||document)&&d.defaultView||window,l.getSelection){l=l.getSelection();var D=x.textContent.length,U=Math.min(A.start,D);A=A.end===void 0?U:Math.min(A.end,D),!l.extend&&U>A&&(D=A,A=U,U=D),D=Za(x,U);var re=Za(x,A);D&&re&&(l.rangeCount!==1||l.anchorNode!==D.node||l.anchorOffset!==D.offset||l.focusNode!==re.node||l.focusOffset!==re.offset)&&(d=d.createRange(),d.setStart(D.node,D.offset),l.removeAllRanges(),U>A?(l.addRange(d),l.extend(re.node,re.offset)):(d.setEnd(re.node,re.offset),l.addRange(d)))}}for(d=[],l=x;l=l.parentNode;)l.nodeType===1&&d.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<d.length;x++)l=d[x],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var lp=k&&"documentMode"in document&&11>=document.documentMode,Ha=null,Il=null,Es=null,Pc=!1;function Vh(l,d,x){var A=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;Pc||Ha==null||Ha!==Fn(A)||(A=Ha,"selectionStart"in A&&jh(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),Es&&pa(Es,A)||(Es=A,A=uo(Il,"onSelect"),0<A.length&&(d=new Ga("onSelect","select",null,d,x),l.push({event:d,listeners:A}),d.target=Ha)))}function Vo(l,d){var x={};return x[l.toLowerCase()]=d.toLowerCase(),x["Webkit"+l]="webkit"+d,x["Moz"+l]="moz"+d,x}var Us={animationend:Vo("Animation","AnimationEnd"),animationiteration:Vo("Animation","AnimationIteration"),animationstart:Vo("Animation","AnimationStart"),transitionend:Vo("Transition","TransitionEnd")},lo={},Rl={};k&&(Rl=document.createElement("div").style,"AnimationEvent"in window||(delete Us.animationend.animation,delete Us.animationiteration.animation,delete Us.animationstart.animation),"TransitionEvent"in window||delete Us.transitionend.transition);function Du(l){if(lo[l])return lo[l];if(!Us[l])return l;var d=Us[l],x;for(x in d)if(d.hasOwnProperty(x)&&x in Rl)return lo[l]=d[x];return l}var ma=Du("animationend"),Xa=Du("animationiteration"),zu=Du("animationstart"),Ou=Du("transitionend"),Kn=new Map,Ll="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $s(l,d){Kn.set(l,d),T(d,[l])}for(var Dl=0;Dl<Ll.length;Dl++){var ga=Ll[Dl],Ud=ga.toLowerCase(),Ic=ga[0].toUpperCase()+ga.slice(1);$s(Ud,"on"+Ic)}$s(ma,"onAnimationEnd"),$s(Xa,"onAnimationIteration"),$s(zu,"onAnimationStart"),$s("dblclick","onDoubleClick"),$s("focusin","onFocus"),$s("focusout","onBlur"),$s(Ou,"onTransitionEnd"),S("onMouseEnter",["mouseout","mouseover"]),S("onMouseLeave",["mouseout","mouseover"]),S("onPointerEnter",["pointerout","pointerover"]),S("onPointerLeave",["pointerout","pointerover"]),T("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),T("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),T("onBeforeInput",["compositionend","keypress","textInput","paste"]),T("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),T("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),T("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var To="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$d=new Set("cancel close invalid load scroll toggle".split(" ").concat(To));function Bu(l,d,x){var A=l.type||"unknown-event";l.currentTarget=x,Fi(A,d,void 0,l),l.currentTarget=null}function Ka(l,d){d=(d&4)!==0;for(var x=0;x<l.length;x++){var A=l[x],D=A.event;A=A.listeners;e:{var U=void 0;if(d)for(var re=A.length-1;0<=re;re--){var Ce=A[re],Oe=Ce.instance,tt=Ce.currentTarget;if(Ce=Ce.listener,Oe!==U&&D.isPropagationStopped())break e;Bu(D,Ce,tt),U=Oe}else for(re=0;re<A.length;re++){if(Ce=A[re],Oe=Ce.instance,tt=Ce.currentTarget,Ce=Ce.listener,Oe!==U&&D.isPropagationStopped())break e;Bu(D,Ce,tt),U=Oe}}}if(Sn)throw l=Vn,Sn=!1,Vn=null,l}function hr(l,d){var x=d[Dc];x===void 0&&(x=d[Dc]=new Set);var A=l+"__bubble";x.has(A)||(Nu(d,l,2,!1),x.add(A))}function Fu(l,d,x){var A=0;d&&(A|=4),Nu(x,l,A,d)}var ya="_reactListening"+Math.random().toString(36).slice(2);function Gs(l){if(!l[ya]){l[ya]=!0,p.forEach(function(x){x!=="selectionchange"&&($d.has(x)||Fu(x,!1,l),Fu(x,!0,l))});var d=l.nodeType===9?l:l.ownerDocument;d===null||d[ya]||(d[ya]=!0,Fu("selectionchange",!1,d))}}function Nu(l,d,x,A){switch(vc(d)){case 1:var D=xh;break;case 4:D=js;break;default:D=ws}x=D.bind(null,d,x,l),D=void 0,!Dt||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(D=!0),A?D!==void 0?l.addEventListener(d,x,{capture:!0,passive:D}):l.addEventListener(d,x,!0):D!==void 0?l.addEventListener(d,x,{passive:D}):l.addEventListener(d,x,!1)}function zl(l,d,x,A,D){var U=A;if((d&1)===0&&(d&2)===0&&A!==null)e:for(;;){if(A===null)return;var re=A.tag;if(re===3||re===4){var Ce=A.stateNode.containerInfo;if(Ce===D||Ce.nodeType===8&&Ce.parentNode===D)break;if(re===4)for(re=A.return;re!==null;){var Oe=re.tag;if((Oe===3||Oe===4)&&(Oe=re.stateNode.containerInfo,Oe===D||Oe.nodeType===8&&Oe.parentNode===D))return;re=re.return}for(;Ce!==null;){if(re=ho(Ce),re===null)return;if(Oe=re.tag,Oe===5||Oe===6){A=U=re;continue e}Ce=Ce.parentNode}}A=A.return}Je(function(){var tt=U,Rt=ys(x),Ot=[];e:{var Ct=Kn.get(l);if(Ct!==void 0){var tn=Ga,an=l;switch(l){case"keypress":if(No(x)===0)break e;case"keydown":case"keyup":tn=Sc;break;case"focusin":an="focus",tn=wc;break;case"focusout":an="blur",tn=wc;break;case"beforeblur":case"afterblur":tn=wc;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tn=Ld;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tn=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tn=Od;break;case ma:case Xa:case zu:tn=Sl;break;case Ou:tn=Bd;break;case"scroll":tn=xc;break;case"wheel":tn=Mh;break;case"copy":case"cut":case"paste":tn=Cl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tn=Zn}var cn=(d&4)!==0,ai=!cn&&l==="scroll",Ye=cn?Ct!==null?Ct+"Capture":null:Ct;cn=[];for(var je=tt,et;je!==null;){et=je;var Ut=et.stateNode;if(et.tag===5&&Ut!==null&&(et=Ut,Ye!==null&&(Ut=Tt(je,Ye),Ut!=null&&cn.push(Nt(je,Ut,et)))),ai)break;je=je.return}0<cn.length&&(Ct=new tn(Ct,an,null,x,Rt),Ot.push({event:Ct,listeners:cn}))}}if((d&7)===0){e:{if(Ct=l==="mouseover"||l==="pointerover",tn=l==="mouseout"||l==="pointerout",Ct&&x!==gs&&(an=x.relatedTarget||x.fromElement)&&(ho(an)||an[ss]))break e;if((tn||Ct)&&(Ct=Rt.window===Rt?Rt:(Ct=Rt.ownerDocument)?Ct.defaultView||Ct.parentWindow:window,tn?(an=x.relatedTarget||x.toElement,tn=tt,an=an?ho(an):null,an!==null&&(ai=Cr(an),an!==ai||an.tag!==5&&an.tag!==6)&&(an=null)):(tn=null,an=tt),tn!==an)){if(cn=Ld,Ut="onMouseLeave",Ye="onMouseEnter",je="mouse",(l==="pointerout"||l==="pointerover")&&(cn=Zn,Ut="onPointerLeave",Ye="onPointerEnter",je="pointer"),ai=tn==null?Ct:Qa(tn),et=an==null?Ct:Qa(an),Ct=new cn(Ut,je+"leave",tn,x,Rt),Ct.target=ai,Ct.relatedTarget=et,Ut=null,ho(Rt)===tt&&(cn=new cn(Ye,je+"enter",an,x,Rt),cn.target=et,cn.relatedTarget=ai,Ut=cn),ai=Ut,tn&&an)t:{for(cn=tn,Ye=an,je=0,et=cn;et;et=Ya(et))je++;for(et=0,Ut=Ye;Ut;Ut=Ya(Ut))et++;for(;0<je-et;)cn=Ya(cn),je--;for(;0<et-je;)Ye=Ya(Ye),et--;for(;je--;){if(cn===Ye||Ye!==null&&cn===Ye.alternate)break t;cn=Ya(cn),Ye=Ya(Ye)}cn=null}else cn=null;tn!==null&&Ol(Ot,Ct,tn,cn,!1),an!==null&&ai!==null&&Ol(Ot,ai,an,cn,!0)}}e:{if(Ct=tt?Qa(tt):window,tn=Ct.nodeName&&Ct.nodeName.toLowerCase(),tn==="select"||tn==="input"&&Ct.type==="file")var hn=Fd;else if(kl(Ct))if(kc)hn=Nd;else{hn=sp;var _n=Bh}else(tn=Ct.nodeName)&&tn.toLowerCase()==="input"&&(Ct.type==="checkbox"||Ct.type==="radio")&&(hn=Fh);if(hn&&(hn=hn(l,tt))){Mc(Ot,hn,x,Rt);break e}_n&&_n(l,Ct,tt),l==="focusout"&&(_n=Ct._wrapperState)&&_n.controlled&&Ct.type==="number"&&Dr(Ct,"number",Ct.value)}switch(_n=tt?Qa(tt):window,l){case"focusin":(kl(_n)||_n.contentEditable==="true")&&(Ha=_n,Il=tt,Es=null);break;case"focusout":Es=Il=Ha=null;break;case"mousedown":Pc=!0;break;case"contextmenu":case"mouseup":case"dragend":Pc=!1,Vh(Ot,x,Rt);break;case"selectionchange":if(lp)break;case"keydown":case"keyup":Vh(Ot,x,Rt)}var vn;if(kh)e:{switch(l){case"compositionstart":var zn="onCompositionStart";break e;case"compositionend":zn="onCompositionEnd";break e;case"compositionupdate":zn="onCompositionUpdate";break e}zn=void 0}else Al?Ih(l,x)&&(zn="onCompositionEnd"):l==="keydown"&&x.keyCode===229&&(zn="onCompositionStart");zn&&(Cc&&x.locale!=="ko"&&(Al||zn!=="onCompositionStart"?zn==="onCompositionEnd"&&Al&&(vn=ca()):(bo=Rt,Fo="value"in bo?bo.value:bo.textContent,Al=!0)),_n=uo(tt,zn),0<_n.length&&(zn=new da(zn,l,null,x,Rt),Ot.push({event:zn,listeners:_n}),vn?zn.data=vn:(vn=Rh(x),vn!==null&&(zn.data=vn)))),(vn=Ph?Pu(l,x):Ml(l,x))&&(tt=uo(tt,"onBeforeInput"),0<tt.length&&(Rt=new da("onBeforeInput","beforeinput",null,x,Rt),Ot.push({event:Rt,listeners:tt}),Rt.data=vn))}Ka(Ot,d)})}function Nt(l,d,x){return{instance:l,listener:d,currentTarget:x}}function uo(l,d){for(var x=d+"Capture",A=[];l!==null;){var D=l,U=D.stateNode;D.tag===5&&U!==null&&(D=U,U=Tt(l,x),U!=null&&A.unshift(Nt(l,U,D)),U=Tt(l,d),U!=null&&A.push(Nt(l,U,D))),l=l.return}return A}function Ya(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function Ol(l,d,x,A,D){for(var U=d._reactName,re=[];x!==null&&x!==A;){var Ce=x,Oe=Ce.alternate,tt=Ce.stateNode;if(Oe!==null&&Oe===A)break;Ce.tag===5&&tt!==null&&(Ce=tt,D?(Oe=Tt(x,U),Oe!=null&&re.unshift(Nt(x,Oe,Ce))):D||(Oe=Tt(x,U),Oe!=null&&re.push(Nt(x,Oe,Ce)))),x=x.return}re.length!==0&&l.push({event:d,listeners:re})}var ju=/\r\n?/g,wi=/\u0000|\uFFFD/g;function Bl(l){return(typeof l=="string"?l:""+l).replace(ju,`
`).replace(wi,"")}function Ja(l,d,x){if(d=Bl(d),Bl(l)!==d&&x)throw Error(c(425))}function Fl(){}var Nl=null,Rc=null;function jl(l,d){return l==="textarea"||l==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var _a=typeof setTimeout=="function"?setTimeout:void 0,Uh=typeof clearTimeout=="function"?clearTimeout:void 0,Gd=typeof Promise=="function"?Promise:void 0,qd=typeof queueMicrotask=="function"?queueMicrotask:typeof Gd<"u"?function(l){return Gd.resolve(null).then(l).catch(Vl)}:_a;function Vl(l){setTimeout(function(){throw l})}function Vu(l,d){var x=d,A=0;do{var D=x.nextSibling;if(l.removeChild(x),D&&D.nodeType===8)if(x=D.data,x==="/$"){if(A===0){l.removeChild(D),is(d);return}A--}else x!=="$"&&x!=="$?"&&x!=="$!"||A++;x=D}while(x);is(d)}function Ss(l){for(;l!=null;l=l.nextSibling){var d=l.nodeType;if(d===1||d===3)break;if(d===8){if(d=l.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return l}function Lc(l){l=l.previousSibling;for(var d=0;l;){if(l.nodeType===8){var x=l.data;if(x==="$"||x==="$!"||x==="$?"){if(d===0)return l;d--}else x==="/$"&&d++}l=l.previousSibling}return null}var qs=Math.random().toString(36).slice(2),co="__reactFiber$"+qs,Ws="__reactProps$"+qs,ss="__reactContainer$"+qs,Dc="__reactEvents$"+qs,$h="__reactListeners$"+qs,Wd="__reactHandles$"+qs;function ho(l){var d=l[co];if(d)return d;for(var x=l.parentNode;x;){if(d=x[ss]||x[co]){if(x=d.alternate,d.child!==null||x!==null&&x.child!==null)for(l=Lc(l);l!==null;){if(x=l[co])return x;l=Lc(l)}return d}l=x,x=l.parentNode}return null}function Ul(l){return l=l[co]||l[ss],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Qa(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(c(33))}function zc(l){return l[Ws]||null}var Oc=[],va=-1;function Zs(l){return{current:l}}function Ar(l){0>va||(l.current=Oc[va],Oc[va]=null,va--)}function qn(l,d){va++,Oc[va]=l.current,l.current=d}var xa={},Li=Zs(xa),fo=Zs(!1),el=xa;function Di(l,d){var x=l.type.contextTypes;if(!x)return xa;var A=l.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===d)return A.__reactInternalMemoizedMaskedChildContext;var D={},U;for(U in x)D[U]=d[U];return A&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=d,l.__reactInternalMemoizedMaskedChildContext=D),D}function Ki(l){return l=l.childContextTypes,l!=null}function Bc(){Ar(fo),Ar(Li)}function Uo(l,d,x){if(Li.current!==xa)throw Error(c(168));qn(Li,d),qn(fo,x)}function as(l,d,x){var A=l.stateNode;if(d=d.childContextTypes,typeof A.getChildContext!="function")return x;A=A.getChildContext();for(var D in A)if(!(D in d))throw Error(c(108,St(l)||"Unknown",D));return Le({},x,A)}function Cs(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||xa,el=Li.current,qn(Li,l),qn(fo,fo.current),!0}function Uu(l,d,x){var A=l.stateNode;if(!A)throw Error(c(169));x?(l=as(l,d,el),A.__reactInternalMemoizedMergedChildContext=l,Ar(fo),Ar(Li),qn(Li,l)):Ar(fo),qn(fo,x)}var Vt=null,$l=!1,$u=!1;function tl(l){Vt===null?Vt=[l]:Vt.push(l)}function nl(l){$l=!0,tl(l)}function Bt(){if(!$u&&Vt!==null){$u=!0;var l=0,d=er;try{var x=Vt;for(er=1;l<x.length;l++){var A=x[l];do A=A(!0);while(A!==null)}Vt=null,$l=!1}catch(D){throw Vt!==null&&(Vt=Vt.slice(l+1)),mh(Lo,Bt),D}finally{er=d,$u=!1}}return null}var wa=[],Gl=0,Gu=null,ql=0,Eo=[],So=0,rl=null,Hs=1,ls="";function Xs(l,d){wa[Gl++]=ql,wa[Gl++]=Gu,Gu=l,ql=d}function Fc(l,d,x){Eo[So++]=Hs,Eo[So++]=ls,Eo[So++]=rl,rl=l;var A=Hs;l=ls;var D=32-ci(A)-1;A&=~(1<<D),x+=1;var U=32-ci(d)+D;if(30<U){var re=D-D%5;U=(A&(1<<re)-1).toString(32),A>>=re,D-=re,Hs=1<<32-ci(d)+D|x<<D|A,ls=U+l}else Hs=1<<U|x<<D|A,ls=l}function ba(l){l.return!==null&&(Xs(l,1),Fc(l,1,0))}function f(l){for(;l===Gu;)Gu=wa[--Gl],wa[Gl]=null,ql=wa[--Gl],wa[Gl]=null;for(;l===rl;)rl=Eo[--So],Eo[So]=null,ls=Eo[--So],Eo[So]=null,Hs=Eo[--So],Eo[So]=null}var r=null,u=null,g=!1,v=null;function b(l,d){var x=Ui(5,null,null,0);x.elementType="DELETED",x.stateNode=d,x.return=l,d=l.deletions,d===null?(l.deletions=[x],l.flags|=16):d.push(x)}function M(l,d){switch(l.tag){case 5:var x=l.type;return d=d.nodeType!==1||x.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(l.stateNode=d,r=l,u=Ss(d.firstChild),!0):!1;case 6:return d=l.pendingProps===""||d.nodeType!==3?null:d,d!==null?(l.stateNode=d,r=l,u=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(x=rl!==null?{id:Hs,overflow:ls}:null,l.memoizedState={dehydrated:d,treeContext:x,retryLane:1073741824},x=Ui(18,null,null,0),x.stateNode=d,x.return=l,l.child=x,r=l,u=null,!0):!1;default:return!1}}function P(l){return(l.mode&1)!==0&&(l.flags&128)===0}function L(l){if(g){var d=u;if(d){var x=d;if(!M(l,d)){if(P(l))throw Error(c(418));d=Ss(x.nextSibling);var A=r;d&&M(l,d)?b(A,x):(l.flags=l.flags&-4097|2,g=!1,r=l)}}else{if(P(l))throw Error(c(418));l.flags=l.flags&-4097|2,g=!1,r=l}}}function N(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;r=l}function F(l){if(l!==r)return!1;if(!g)return N(l),g=!0,!1;var d;if((d=l.tag!==3)&&!(d=l.tag!==5)&&(d=l.type,d=d!=="head"&&d!=="body"&&!jl(l.type,l.memoizedProps)),d&&(d=u)){if(P(l))throw W(),Error(c(418));for(;d;)b(l,d),d=Ss(d.nextSibling)}if(N(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(c(317));e:{for(l=l.nextSibling,d=0;l;){if(l.nodeType===8){var x=l.data;if(x==="/$"){if(d===0){u=Ss(l.nextSibling);break e}d--}else x!=="$"&&x!=="$!"&&x!=="$?"||d++}l=l.nextSibling}u=null}}else u=r?Ss(l.stateNode.nextSibling):null;return!0}function W(){for(var l=u;l;)l=Ss(l.nextSibling)}function ie(){u=r=null,g=!1}function ae(l){v===null?v=[l]:v.push(l)}var ue=me.ReactCurrentBatchConfig;function le(l,d,x){if(l=x.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(x._owner){if(x=x._owner,x){if(x.tag!==1)throw Error(c(309));var A=x.stateNode}if(!A)throw Error(c(147,l));var D=A,U=""+l;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===U?d.ref:(d=function(re){var Ce=D.refs;re===null?delete Ce[U]:Ce[U]=re},d._stringRef=U,d)}if(typeof l!="string")throw Error(c(284));if(!x._owner)throw Error(c(290,l))}return l}function he(l,d){throw l=Object.prototype.toString.call(d),Error(c(31,l==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":l))}function X(l){var d=l._init;return d(l._payload)}function se(l){function d(Ye,je){if(l){var et=Ye.deletions;et===null?(Ye.deletions=[je],Ye.flags|=16):et.push(je)}}function x(Ye,je){if(!l)return null;for(;je!==null;)d(Ye,je),je=je.sibling;return null}function A(Ye,je){for(Ye=new Map;je!==null;)je.key!==null?Ye.set(je.key,je):Ye.set(je.index,je),je=je.sibling;return Ye}function D(Ye,je){return Ye=nu(Ye,je),Ye.index=0,Ye.sibling=null,Ye}function U(Ye,je,et){return Ye.index=et,l?(et=Ye.alternate,et!==null?(et=et.index,et<je?(Ye.flags|=2,je):et):(Ye.flags|=2,je)):(Ye.flags|=1048576,je)}function re(Ye){return l&&Ye.alternate===null&&(Ye.flags|=2),Ye}function Ce(Ye,je,et,Ut){return je===null||je.tag!==6?(je=Rp(et,Ye.mode,Ut),je.return=Ye,je):(je=D(je,et),je.return=Ye,je)}function Oe(Ye,je,et,Ut){var hn=et.type;return hn===Se?Rt(Ye,je,et.props.children,Ut,et.key):je!==null&&(je.elementType===hn||typeof hn=="object"&&hn!==null&&hn.$$typeof===ln&&X(hn)===je.type)?(Ut=D(je,et.props),Ut.ref=le(Ye,je,et),Ut.return=Ye,Ut):(Ut=mf(et.type,et.key,et.props,null,Ye.mode,Ut),Ut.ref=le(Ye,je,et),Ut.return=Ye,Ut)}function tt(Ye,je,et,Ut){return je===null||je.tag!==4||je.stateNode.containerInfo!==et.containerInfo||je.stateNode.implementation!==et.implementation?(je=Lp(et,Ye.mode,Ut),je.return=Ye,je):(je=D(je,et.children||[]),je.return=Ye,je)}function Rt(Ye,je,et,Ut,hn){return je===null||je.tag!==7?(je=rc(et,Ye.mode,Ut,hn),je.return=Ye,je):(je=D(je,et),je.return=Ye,je)}function Ot(Ye,je,et){if(typeof je=="string"&&je!==""||typeof je=="number")return je=Rp(""+je,Ye.mode,et),je.return=Ye,je;if(typeof je=="object"&&je!==null){switch(je.$$typeof){case de:return et=mf(je.type,je.key,je.props,null,Ye.mode,et),et.ref=le(Ye,null,je),et.return=Ye,et;case _e:return je=Lp(je,Ye.mode,et),je.return=Ye,je;case ln:var Ut=je._init;return Ot(Ye,Ut(je._payload),et)}if(lr(je)||Et(je))return je=rc(je,Ye.mode,et,null),je.return=Ye,je;he(Ye,je)}return null}function Ct(Ye,je,et,Ut){var hn=je!==null?je.key:null;if(typeof et=="string"&&et!==""||typeof et=="number")return hn!==null?null:Ce(Ye,je,""+et,Ut);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case de:return et.key===hn?Oe(Ye,je,et,Ut):null;case _e:return et.key===hn?tt(Ye,je,et,Ut):null;case ln:return hn=et._init,Ct(Ye,je,hn(et._payload),Ut)}if(lr(et)||Et(et))return hn!==null?null:Rt(Ye,je,et,Ut,null);he(Ye,et)}return null}function tn(Ye,je,et,Ut,hn){if(typeof Ut=="string"&&Ut!==""||typeof Ut=="number")return Ye=Ye.get(et)||null,Ce(je,Ye,""+Ut,hn);if(typeof Ut=="object"&&Ut!==null){switch(Ut.$$typeof){case de:return Ye=Ye.get(Ut.key===null?et:Ut.key)||null,Oe(je,Ye,Ut,hn);case _e:return Ye=Ye.get(Ut.key===null?et:Ut.key)||null,tt(je,Ye,Ut,hn);case ln:var _n=Ut._init;return tn(Ye,je,et,_n(Ut._payload),hn)}if(lr(Ut)||Et(Ut))return Ye=Ye.get(et)||null,Rt(je,Ye,Ut,hn,null);he(je,Ut)}return null}function an(Ye,je,et,Ut){for(var hn=null,_n=null,vn=je,zn=je=0,$i=null;vn!==null&&zn<et.length;zn++){vn.index>zn?($i=vn,vn=null):$i=vn.sibling;var or=Ct(Ye,vn,et[zn],Ut);if(or===null){vn===null&&(vn=$i);break}l&&vn&&or.alternate===null&&d(Ye,vn),je=U(or,je,zn),_n===null?hn=or:_n.sibling=or,_n=or,vn=$i}if(zn===et.length)return x(Ye,vn),g&&Xs(Ye,zn),hn;if(vn===null){for(;zn<et.length;zn++)vn=Ot(Ye,et[zn],Ut),vn!==null&&(je=U(vn,je,zn),_n===null?hn=vn:_n.sibling=vn,_n=vn);return g&&Xs(Ye,zn),hn}for(vn=A(Ye,vn);zn<et.length;zn++)$i=tn(vn,Ye,zn,et[zn],Ut),$i!==null&&(l&&$i.alternate!==null&&vn.delete($i.key===null?zn:$i.key),je=U($i,je,zn),_n===null?hn=$i:_n.sibling=$i,_n=$i);return l&&vn.forEach(function(Is){return d(Ye,Is)}),g&&Xs(Ye,zn),hn}function cn(Ye,je,et,Ut){var hn=Et(et);if(typeof hn!="function")throw Error(c(150));if(et=hn.call(et),et==null)throw Error(c(151));for(var _n=hn=null,vn=je,zn=je=0,$i=null,or=et.next();vn!==null&&!or.done;zn++,or=et.next()){vn.index>zn?($i=vn,vn=null):$i=vn.sibling;var Is=Ct(Ye,vn,or.value,Ut);if(Is===null){vn===null&&(vn=$i);break}l&&vn&&Is.alternate===null&&d(Ye,vn),je=U(Is,je,zn),_n===null?hn=Is:_n.sibling=Is,_n=Is,vn=$i}if(or.done)return x(Ye,vn),g&&Xs(Ye,zn),hn;if(vn===null){for(;!or.done;zn++,or=et.next())or=Ot(Ye,or.value,Ut),or!==null&&(je=U(or,je,zn),_n===null?hn=or:_n.sibling=or,_n=or);return g&&Xs(Ye,zn),hn}for(vn=A(Ye,vn);!or.done;zn++,or=et.next())or=tn(vn,Ye,zn,or.value,Ut),or!==null&&(l&&or.alternate!==null&&vn.delete(or.key===null?zn:or.key),je=U(or,je,zn),_n===null?hn=or:_n.sibling=or,_n=or);return l&&vn.forEach(function(gg){return d(Ye,gg)}),g&&Xs(Ye,zn),hn}function ai(Ye,je,et,Ut){if(typeof et=="object"&&et!==null&&et.type===Se&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case de:e:{for(var hn=et.key,_n=je;_n!==null;){if(_n.key===hn){if(hn=et.type,hn===Se){if(_n.tag===7){x(Ye,_n.sibling),je=D(_n,et.props.children),je.return=Ye,Ye=je;break e}}else if(_n.elementType===hn||typeof hn=="object"&&hn!==null&&hn.$$typeof===ln&&X(hn)===_n.type){x(Ye,_n.sibling),je=D(_n,et.props),je.ref=le(Ye,_n,et),je.return=Ye,Ye=je;break e}x(Ye,_n);break}else d(Ye,_n);_n=_n.sibling}et.type===Se?(je=rc(et.props.children,Ye.mode,Ut,et.key),je.return=Ye,Ye=je):(Ut=mf(et.type,et.key,et.props,null,Ye.mode,Ut),Ut.ref=le(Ye,je,et),Ut.return=Ye,Ye=Ut)}return re(Ye);case _e:e:{for(_n=et.key;je!==null;){if(je.key===_n)if(je.tag===4&&je.stateNode.containerInfo===et.containerInfo&&je.stateNode.implementation===et.implementation){x(Ye,je.sibling),je=D(je,et.children||[]),je.return=Ye,Ye=je;break e}else{x(Ye,je);break}else d(Ye,je);je=je.sibling}je=Lp(et,Ye.mode,Ut),je.return=Ye,Ye=je}return re(Ye);case ln:return _n=et._init,ai(Ye,je,_n(et._payload),Ut)}if(lr(et))return an(Ye,je,et,Ut);if(Et(et))return cn(Ye,je,et,Ut);he(Ye,et)}return typeof et=="string"&&et!==""||typeof et=="number"?(et=""+et,je!==null&&je.tag===6?(x(Ye,je.sibling),je=D(je,et),je.return=Ye,Ye=je):(x(Ye,je),je=Rp(et,Ye.mode,Ut),je.return=Ye,Ye=je),re(Ye)):x(Ye,je)}return ai}var ge=se(!0),ve=se(!1),Pe=Zs(null),Re=null,Ie=null,Ne=null;function Fe(){Ne=Ie=Re=null}function He(l){var d=Pe.current;Ar(Pe),l._currentValue=d}function vt(l,d,x){for(;l!==null;){var A=l.alternate;if((l.childLanes&d)!==d?(l.childLanes|=d,A!==null&&(A.childLanes|=d)):A!==null&&(A.childLanes&d)!==d&&(A.childLanes|=d),l===x)break;l=l.return}}function qe(l,d){Re=l,Ne=Ie=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&d)!==0&&(ji=!0),l.firstContext=null)}function nt(l){var d=l._currentValue;if(Ne!==l)if(l={context:l,memoizedValue:d,next:null},Ie===null){if(Re===null)throw Error(c(308));Ie=l,Re.dependencies={lanes:0,firstContext:l}}else Ie=Ie.next=l;return d}var Xe=null;function yt(l){Xe===null?Xe=[l]:Xe.push(l)}function Ze(l,d,x,A){var D=d.interleaved;return D===null?(x.next=x,yt(d)):(x.next=D.next,D.next=x),d.interleaved=x,rt(l,A)}function rt(l,d){l.lanes|=d;var x=l.alternate;for(x!==null&&(x.lanes|=d),x=l,l=l.return;l!==null;)l.childLanes|=d,x=l.alternate,x!==null&&(x.childLanes|=d),x=l,l=l.return;return x.tag===3?x.stateNode:null}var mt=!1;function ht(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wt(l,d){l=l.updateQueue,d.updateQueue===l&&(d.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Jt(l,d){return{eventTime:l,lane:d,tag:0,payload:null,callback:null,next:null}}function dn(l,d,x){var A=l.updateQueue;if(A===null)return null;if(A=A.shared,(sn&2)!==0){var D=A.pending;return D===null?d.next=d:(d.next=D.next,D.next=d),A.pending=d,rt(l,x)}return D=A.interleaved,D===null?(d.next=d,yt(A)):(d.next=D.next,D.next=d),A.interleaved=d,rt(l,x)}function Zt(l,d,x){if(d=d.updateQueue,d!==null&&(d=d.shared,(x&4194240)!==0)){var A=d.lanes;A&=l.pendingLanes,x|=A,d.lanes=x,Va(l,x)}}function on(l,d){var x=l.updateQueue,A=l.alternate;if(A!==null&&(A=A.updateQueue,x===A)){var D=null,U=null;if(x=x.firstBaseUpdate,x!==null){do{var re={eventTime:x.eventTime,lane:x.lane,tag:x.tag,payload:x.payload,callback:x.callback,next:null};U===null?D=U=re:U=U.next=re,x=x.next}while(x!==null);U===null?D=U=d:U=U.next=d}else D=U=d;x={baseState:A.baseState,firstBaseUpdate:D,lastBaseUpdate:U,shared:A.shared,effects:A.effects},l.updateQueue=x;return}l=x.lastBaseUpdate,l===null?x.firstBaseUpdate=d:l.next=d,x.lastBaseUpdate=d}function Pn(l,d,x,A){var D=l.updateQueue;mt=!1;var U=D.firstBaseUpdate,re=D.lastBaseUpdate,Ce=D.shared.pending;if(Ce!==null){D.shared.pending=null;var Oe=Ce,tt=Oe.next;Oe.next=null,re===null?U=tt:re.next=tt,re=Oe;var Rt=l.alternate;Rt!==null&&(Rt=Rt.updateQueue,Ce=Rt.lastBaseUpdate,Ce!==re&&(Ce===null?Rt.firstBaseUpdate=tt:Ce.next=tt,Rt.lastBaseUpdate=Oe))}if(U!==null){var Ot=D.baseState;re=0,Rt=tt=Oe=null,Ce=U;do{var Ct=Ce.lane,tn=Ce.eventTime;if((A&Ct)===Ct){Rt!==null&&(Rt=Rt.next={eventTime:tn,lane:0,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null});e:{var an=l,cn=Ce;switch(Ct=d,tn=x,cn.tag){case 1:if(an=cn.payload,typeof an=="function"){Ot=an.call(tn,Ot,Ct);break e}Ot=an;break e;case 3:an.flags=an.flags&-65537|128;case 0:if(an=cn.payload,Ct=typeof an=="function"?an.call(tn,Ot,Ct):an,Ct==null)break e;Ot=Le({},Ot,Ct);break e;case 2:mt=!0}}Ce.callback!==null&&Ce.lane!==0&&(l.flags|=64,Ct=D.effects,Ct===null?D.effects=[Ce]:Ct.push(Ce))}else tn={eventTime:tn,lane:Ct,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null},Rt===null?(tt=Rt=tn,Oe=Ot):Rt=Rt.next=tn,re|=Ct;if(Ce=Ce.next,Ce===null){if(Ce=D.shared.pending,Ce===null)break;Ct=Ce,Ce=Ct.next,Ct.next=null,D.lastBaseUpdate=Ct,D.shared.pending=null}}while(!0);if(Rt===null&&(Oe=Ot),D.baseState=Oe,D.firstBaseUpdate=tt,D.lastBaseUpdate=Rt,d=D.shared.interleaved,d!==null){D=d;do re|=D.lane,D=D.next;while(D!==d)}else U===null&&(D.shared.lanes=0);to|=re,l.lanes=re,l.memoizedState=Ot}}function Dn(l,d,x){if(l=d.effects,d.effects=null,l!==null)for(d=0;d<l.length;d++){var A=l[d],D=A.callback;if(D!==null){if(A.callback=null,A=x,typeof D!="function")throw Error(c(191,D));D.call(A)}}}var Qt={},Un=Zs(Qt),nr=Zs(Qt),rr=Zs(Qt);function Jn(l){if(l===Qt)throw Error(c(174));return l}function bi(l,d){switch(qn(rr,d),qn(nr,l),qn(Un,Qt),l=d.nodeType,l){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:mn(null,"");break;default:l=l===8?d.parentNode:d,d=l.namespaceURI||null,l=l.tagName,d=mn(d,l)}Ar(Un),qn(Un,d)}function jr(){Ar(Un),Ar(nr),Ar(rr)}function Co(l){Jn(rr.current);var d=Jn(Un.current),x=mn(d,l.type);d!==x&&(qn(nr,l),qn(Un,x))}function $o(l){nr.current===l&&(Ar(Un),Ar(nr))}var En=Zs(0);function ur(l){for(var d=l;d!==null;){if(d.tag===13){var x=d.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||x.data==="$?"||x.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var Yn=[];function Vr(){for(var l=0;l<Yn.length;l++)Yn[l]._workInProgressVersionPrimary=null;Yn.length=0}var Ti=me.ReactCurrentDispatcher,fr=me.ReactCurrentBatchConfig,ri=0,Mr=null,Rr=null,Zr=null,Go=!1,qo=!1,us=0,Nc=0;function ii(){throw Error(c(321))}function qu(l,d){if(d===null)return!1;for(var x=0;x<d.length&&x<l.length;x++)if(!jo(l[x],d[x]))return!1;return!0}function Zd(l,d,x,A,D,U){if(ri=U,Mr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,Ti.current=l===null||l.memoizedState===null?ng:rg,l=x(A,D),qo){U=0;do{if(qo=!1,us=0,25<=U)throw Error(c(301));U+=1,Zr=Rr=null,d.updateQueue=null,Ti.current=Ys,l=x(A,D)}while(qo)}if(Ti.current=Yi,d=Rr!==null&&Rr.next!==null,ri=0,Zr=Rr=Mr=null,Go=!1,d)throw Error(c(300));return l}function Hd(){var l=us!==0;return us=0,l}function Ta(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zr===null?Mr.memoizedState=Zr=l:Zr=Zr.next=l,Zr}function Wo(){if(Rr===null){var l=Mr.alternate;l=l!==null?l.memoizedState:null}else l=Rr.next;var d=Zr===null?Mr.memoizedState:Zr.next;if(d!==null)Zr=d,Rr=l;else{if(l===null)throw Error(c(310));Rr=l,l={memoizedState:Rr.memoizedState,baseState:Rr.baseState,baseQueue:Rr.baseQueue,queue:Rr.queue,next:null},Zr===null?Mr.memoizedState=Zr=l:Zr=Zr.next=l}return Zr}function Wl(l,d){return typeof d=="function"?d(l):d}function Xd(l){var d=Wo(),x=d.queue;if(x===null)throw Error(c(311));x.lastRenderedReducer=l;var A=Rr,D=A.baseQueue,U=x.pending;if(U!==null){if(D!==null){var re=D.next;D.next=U.next,U.next=re}A.baseQueue=D=U,x.pending=null}if(D!==null){U=D.next,A=A.baseState;var Ce=re=null,Oe=null,tt=U;do{var Rt=tt.lane;if((ri&Rt)===Rt)Oe!==null&&(Oe=Oe.next={lane:0,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null}),A=tt.hasEagerState?tt.eagerState:l(A,tt.action);else{var Ot={lane:Rt,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null};Oe===null?(Ce=Oe=Ot,re=A):Oe=Oe.next=Ot,Mr.lanes|=Rt,to|=Rt}tt=tt.next}while(tt!==null&&tt!==U);Oe===null?re=A:Oe.next=Ce,jo(A,d.memoizedState)||(ji=!0),d.memoizedState=A,d.baseState=re,d.baseQueue=Oe,x.lastRenderedState=A}if(l=x.interleaved,l!==null){D=l;do U=D.lane,Mr.lanes|=U,to|=U,D=D.next;while(D!==l)}else D===null&&(x.lanes=0);return[d.memoizedState,x.dispatch]}function Gh(l){var d=Wo(),x=d.queue;if(x===null)throw Error(c(311));x.lastRenderedReducer=l;var A=x.dispatch,D=x.pending,U=d.memoizedState;if(D!==null){x.pending=null;var re=D=D.next;do U=l(U,re.action),re=re.next;while(re!==D);jo(U,d.memoizedState)||(ji=!0),d.memoizedState=U,d.baseQueue===null&&(d.baseState=U),x.lastRenderedState=U}return[U,A]}function qh(){}function Ea(l,d){var x=Mr,A=Wo(),D=d(),U=!jo(A.memoizedState,D);if(U&&(A.memoizedState=D,ji=!0),A=A.queue,Sa(cp.bind(null,x,A,l),[l]),A.getSnapshot!==d||U||Zr!==null&&Zr.memoizedState.tag&1){if(x.flags|=2048,Wu(9,up.bind(null,x,A,D,d),void 0,null),Si===null)throw Error(c(349));(ri&30)!==0||Wh(x,d,D)}return D}function Wh(l,d,x){l.flags|=16384,l={getSnapshot:d,value:x},d=Mr.updateQueue,d===null?(d={lastEffect:null,stores:null},Mr.updateQueue=d,d.stores=[l]):(x=d.stores,x===null?d.stores=[l]:x.push(l))}function up(l,d,x,A){d.value=x,d.getSnapshot=A,Xm(d)&&Km(l)}function cp(l,d,x){return x(function(){Xm(d)&&Km(l)})}function Xm(l){var d=l.getSnapshot;l=l.value;try{var x=d();return!jo(l,x)}catch{return!0}}function Km(l){var d=rt(l,1);d!==null&&ta(d,l,1,-1)}function Ym(l){var d=Ta();return typeof l=="function"&&(l=l()),d.memoizedState=d.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wl,lastRenderedState:l},d.queue=l,l=l.dispatch=ei.bind(null,Mr,l),[d.memoizedState,l]}function Wu(l,d,x,A){return l={tag:l,create:d,destroy:x,deps:A,next:null},d=Mr.updateQueue,d===null?(d={lastEffect:null,stores:null},Mr.updateQueue=d,d.lastEffect=l.next=l):(x=d.lastEffect,x===null?d.lastEffect=l.next=l:(A=x.next,x.next=l,l.next=A,d.lastEffect=l)),l}function jc(){return Wo().memoizedState}function il(l,d,x,A){var D=Ta();Mr.flags|=l,D.memoizedState=Wu(1|d,x,void 0,A===void 0?null:A)}function As(l,d,x,A){var D=Wo();A=A===void 0?null:A;var U=void 0;if(Rr!==null){var re=Rr.memoizedState;if(U=re.destroy,A!==null&&qu(A,re.deps)){D.memoizedState=Wu(d,x,U,A);return}}Mr.flags|=l,D.memoizedState=Wu(1|d,x,U,A)}function Ms(l,d){return il(8390656,8,l,d)}function Sa(l,d){return As(2048,8,l,d)}function ol(l,d){return As(4,2,l,d)}function Zl(l,d){return As(4,4,l,d)}function Jm(l,d){if(typeof d=="function")return l=l(),d(l),function(){d(null)};if(d!=null)return l=l(),d.current=l,function(){d.current=null}}function Qm(l,d,x){return x=x!=null?x.concat([l]):null,As(4,4,Jm.bind(null,d,l),x)}function hp(){}function eg(l,d){var x=Wo();d=d===void 0?null:d;var A=x.memoizedState;return A!==null&&d!==null&&qu(d,A[1])?A[0]:(x.memoizedState=[l,d],l)}function dp(l,d){var x=Wo();d=d===void 0?null:d;var A=x.memoizedState;return A!==null&&d!==null&&qu(d,A[1])?A[0]:(l=l(),x.memoizedState=[l,d],l)}function fp(l,d,x){return(ri&21)===0?(l.baseState&&(l.baseState=!1,ji=!0),l.memoizedState=x):(jo(x,d)||(x=so(),Mr.lanes|=x,to|=x,l.baseState=!0),d)}function Ks(l,d){var x=er;er=x!==0&&4>x?x:4,l(!0);var A=fr.transition;fr.transition={};try{l(!1),d()}finally{er=x,fr.transition=A}}function tg(){return Wo().memoizedState}function e_(l,d,x){var A=Ia(l);if(x={lane:A,action:x,hasEagerState:!1,eagerState:null,next:null},nn(l))sl(d,x);else if(x=Ze(l,d,x,A),x!==null){var D=ko();ta(x,l,A,D),Zh(x,d,A)}}function ei(l,d,x){var A=Ia(l),D={lane:A,action:x,hasEagerState:!1,eagerState:null,next:null};if(nn(l))sl(d,D);else{var U=l.alternate;if(l.lanes===0&&(U===null||U.lanes===0)&&(U=d.lastRenderedReducer,U!==null))try{var re=d.lastRenderedState,Ce=U(re,x);if(D.hasEagerState=!0,D.eagerState=Ce,jo(Ce,re)){var Oe=d.interleaved;Oe===null?(D.next=D,yt(d)):(D.next=Oe.next,Oe.next=D),d.interleaved=D;return}}catch{}finally{}x=Ze(l,d,D,A),x!==null&&(D=ko(),ta(x,l,A,D),Zh(x,d,A))}}function nn(l){var d=l.alternate;return l===Mr||d!==null&&d===Mr}function sl(l,d){qo=Go=!0;var x=l.pending;x===null?d.next=d:(d.next=x.next,x.next=d),l.pending=d}function Zh(l,d,x){if((x&4194240)!==0){var A=d.lanes;A&=l.pendingLanes,x|=A,d.lanes=x,Va(l,x)}}var Yi={readContext:nt,useCallback:ii,useContext:ii,useEffect:ii,useImperativeHandle:ii,useInsertionEffect:ii,useLayoutEffect:ii,useMemo:ii,useReducer:ii,useRef:ii,useState:ii,useDebugValue:ii,useDeferredValue:ii,useTransition:ii,useMutableSource:ii,useSyncExternalStore:ii,useId:ii,unstable_isNewReconciler:!1},ng={readContext:nt,useCallback:function(l,d){return Ta().memoizedState=[l,d===void 0?null:d],l},useContext:nt,useEffect:Ms,useImperativeHandle:function(l,d,x){return x=x!=null?x.concat([l]):null,il(4194308,4,Jm.bind(null,d,l),x)},useLayoutEffect:function(l,d){return il(4194308,4,l,d)},useInsertionEffect:function(l,d){return il(4,2,l,d)},useMemo:function(l,d){var x=Ta();return d=d===void 0?null:d,l=l(),x.memoizedState=[l,d],l},useReducer:function(l,d,x){var A=Ta();return d=x!==void 0?x(d):d,A.memoizedState=A.baseState=d,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:d},A.queue=l,l=l.dispatch=e_.bind(null,Mr,l),[A.memoizedState,l]},useRef:function(l){var d=Ta();return l={current:l},d.memoizedState=l},useState:Ym,useDebugValue:hp,useDeferredValue:function(l){return Ta().memoizedState=l},useTransition:function(){var l=Ym(!1),d=l[0];return l=Ks.bind(null,l[1]),Ta().memoizedState=l,[d,l]},useMutableSource:function(){},useSyncExternalStore:function(l,d,x){var A=Mr,D=Ta();if(g){if(x===void 0)throw Error(c(407));x=x()}else{if(x=d(),Si===null)throw Error(c(349));(ri&30)!==0||Wh(A,d,x)}D.memoizedState=x;var U={value:x,getSnapshot:d};return D.queue=U,Ms(cp.bind(null,A,U,l),[l]),A.flags|=2048,Wu(9,up.bind(null,A,U,x,d),void 0,null),x},useId:function(){var l=Ta(),d=Si.identifierPrefix;if(g){var x=ls,A=Hs;x=(A&~(1<<32-ci(A)-1)).toString(32)+x,d=":"+d+"R"+x,x=us++,0<x&&(d+="H"+x.toString(32)),d+=":"}else x=Nc++,d=":"+d+"r"+x.toString(32)+":";return l.memoizedState=d},unstable_isNewReconciler:!1},rg={readContext:nt,useCallback:eg,useContext:nt,useEffect:Sa,useImperativeHandle:Qm,useInsertionEffect:ol,useLayoutEffect:Zl,useMemo:dp,useReducer:Xd,useRef:jc,useState:function(){return Xd(Wl)},useDebugValue:hp,useDeferredValue:function(l){var d=Wo();return fp(d,Rr.memoizedState,l)},useTransition:function(){var l=Xd(Wl)[0],d=Wo().memoizedState;return[l,d]},useMutableSource:qh,useSyncExternalStore:Ea,useId:tg,unstable_isNewReconciler:!1},Ys={readContext:nt,useCallback:eg,useContext:nt,useEffect:Sa,useImperativeHandle:Qm,useInsertionEffect:ol,useLayoutEffect:Zl,useMemo:dp,useReducer:Gh,useRef:jc,useState:function(){return Gh(Wl)},useDebugValue:hp,useDeferredValue:function(l){var d=Wo();return Rr===null?d.memoizedState=l:fp(d,Rr.memoizedState,l)},useTransition:function(){var l=Gh(Wl)[0],d=Wo().memoizedState;return[l,d]},useMutableSource:qh,useSyncExternalStore:Ea,useId:tg,unstable_isNewReconciler:!1};function cs(l,d){if(l&&l.defaultProps){d=Le({},d),l=l.defaultProps;for(var x in l)d[x]===void 0&&(d[x]=l[x]);return d}return d}function al(l,d,x,A){d=l.memoizedState,x=x(A,d),x=x==null?d:Le({},d,x),l.memoizedState=x,l.lanes===0&&(l.updateQueue.baseState=x)}var Hl={isMounted:function(l){return(l=l._reactInternals)?Cr(l)===l:!1},enqueueSetState:function(l,d,x){l=l._reactInternals;var A=ko(),D=Ia(l),U=Jt(A,D);U.payload=d,x!=null&&(U.callback=x),d=dn(l,U,D),d!==null&&(ta(d,l,D,A),Zt(d,l,D))},enqueueReplaceState:function(l,d,x){l=l._reactInternals;var A=ko(),D=Ia(l),U=Jt(A,D);U.tag=1,U.payload=d,x!=null&&(U.callback=x),d=dn(l,U,D),d!==null&&(ta(d,l,D,A),Zt(d,l,D))},enqueueForceUpdate:function(l,d){l=l._reactInternals;var x=ko(),A=Ia(l),D=Jt(x,A);D.tag=2,d!=null&&(D.callback=d),d=dn(l,D,A),d!==null&&(ta(d,l,A,x),Zt(d,l,A))}};function Xl(l,d,x,A,D,U,re){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(A,U,re):d.prototype&&d.prototype.isPureReactComponent?!pa(x,A)||!pa(D,U):!0}function Kd(l,d,x){var A=!1,D=xa,U=d.contextType;return typeof U=="object"&&U!==null?U=nt(U):(D=Ki(d)?el:Li.current,A=d.contextTypes,U=(A=A!=null)?Di(l,D):xa),d=new d(x,U),l.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=Hl,l.stateNode=d,d._reactInternals=l,A&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=D,l.__reactInternalMemoizedMaskedChildContext=U),d}function Hh(l,d,x,A){l=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(x,A),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(x,A),d.state!==l&&Hl.enqueueReplaceState(d,d.state,null)}function Yd(l,d,x,A){var D=l.stateNode;D.props=x,D.state=l.memoizedState,D.refs={},ht(l);var U=d.contextType;typeof U=="object"&&U!==null?D.context=nt(U):(U=Ki(d)?el:Li.current,D.context=Di(l,U)),D.state=l.memoizedState,U=d.getDerivedStateFromProps,typeof U=="function"&&(al(l,d,U,x),D.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(d=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),d!==D.state&&Hl.enqueueReplaceState(D,D.state,null),Pn(l,x,D,A),D.state=l.memoizedState),typeof D.componentDidMount=="function"&&(l.flags|=4194308)}function Zu(l,d){try{var x="",A=d;do x+=qt(A),A=A.return;while(A);var D=x}catch(U){D=`
Error generating stack: `+U.message+`
`+U.stack}return{value:l,source:d,stack:D,digest:null}}function pp(l,d,x){return{value:l,source:null,stack:x??null,digest:d??null}}function Xh(l,d){try{console.error(d.value)}catch(x){setTimeout(function(){throw x})}}var ig=typeof WeakMap=="function"?WeakMap:Map;function Vc(l,d,x){x=Jt(-1,x),x.tag=3,x.payload={element:null};var A=d.value;return x.callback=function(){od||(od=!0,Ep=A),Xh(l,d)},x}function Hu(l,d,x){x=Jt(-1,x),x.tag=3;var A=l.type.getDerivedStateFromError;if(typeof A=="function"){var D=d.value;x.payload=function(){return A(D)},x.callback=function(){Xh(l,d)}}var U=l.stateNode;return U!==null&&typeof U.componentDidCatch=="function"&&(x.callback=function(){Xh(l,d),typeof A!="function"&&(mo===null?mo=new Set([this]):mo.add(this));var re=d.stack;this.componentDidCatch(d.value,{componentStack:re!==null?re:""})}),x}function Ca(l,d,x){var A=l.pingCache;if(A===null){A=l.pingCache=new ig;var D=new Set;A.set(d,D)}else D=A.get(d),D===void 0&&(D=new Set,A.set(d,D));D.has(x)||(D.add(x),l=Ip.bind(null,l,d,x),d.then(l,l))}function Jd(l){do{var d;if((d=l.tag===13)&&(d=l.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return l;l=l.return}while(l!==null);return null}function mp(l,d,x,A,D){return(l.mode&1)===0?(l===d?l.flags|=65536:(l.flags|=128,x.flags|=131072,x.flags&=-52805,x.tag===1&&(x.alternate===null?x.tag=17:(d=Jt(-1,1),d.tag=2,dn(x,d,1))),x.lanes|=1),l):(l.flags|=65536,l.lanes=D,l)}var Kh=me.ReactCurrentOwner,ji=!1;function Lr(l,d,x,A){d.child=l===null?ve(d,null,x,A):ge(d,l.child,x,A)}function Uc(l,d,x,A,D){x=x.render;var U=d.ref;return qe(d,D),A=Zd(l,d,x,A,U,D),x=Hd(),l!==null&&!ji?(d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~D,Aa(l,d,D)):(g&&x&&ba(d),d.flags|=1,Lr(l,d,A,D),d.child)}function Ji(l,d,x,A,D){if(l===null){var U=x.type;return typeof U=="function"&&!nc(U)&&U.defaultProps===void 0&&x.compare===null&&x.defaultProps===void 0?(d.tag=15,d.type=U,hs(l,d,U,A,D)):(l=mf(x.type,null,A,d,d.mode,D),l.ref=d.ref,l.return=d,d.child=l)}if(U=l.child,(l.lanes&D)===0){var re=U.memoizedProps;if(x=x.compare,x=x!==null?x:pa,x(re,A)&&l.ref===d.ref)return Aa(l,d,D)}return d.flags|=1,l=nu(U,A),l.ref=d.ref,l.return=d,d.child=l}function hs(l,d,x,A,D){if(l!==null){var U=l.memoizedProps;if(pa(U,A)&&l.ref===d.ref)if(ji=!1,d.pendingProps=A=U,(l.lanes&D)!==0)(l.flags&131072)!==0&&(ji=!0);else return d.lanes=l.lanes,Aa(l,d,D)}return ef(l,d,x,A,D)}function Qd(l,d,x){var A=d.pendingProps,D=A.children,U=l!==null?l.memoizedState:null;if(A.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},qn(Vi,ti),ti|=x;else{if((x&1073741824)===0)return l=U!==null?U.baseLanes|x:x,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:l,cachePool:null,transitions:null},d.updateQueue=null,qn(Vi,ti),ti|=l,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=U!==null?U.baseLanes:x,qn(Vi,ti),ti|=A}else U!==null?(A=U.baseLanes|x,d.memoizedState=null):A=x,qn(Vi,ti),ti|=A;return Lr(l,d,D,x),d.child}function Ur(l,d){var x=d.ref;(l===null&&x!==null||l!==null&&l.ref!==x)&&(d.flags|=512,d.flags|=2097152)}function ef(l,d,x,A,D){var U=Ki(x)?el:Li.current;return U=Di(d,U),qe(d,D),x=Zd(l,d,x,A,U,D),A=Hd(),l!==null&&!ji?(d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~D,Aa(l,d,D)):(g&&A&&ba(d),d.flags|=1,Lr(l,d,x,D),d.child)}function $c(l,d,x,A,D){if(Ki(x)){var U=!0;Cs(d)}else U=!1;if(qe(d,D),d.stateNode===null)Jh(l,d),Kd(d,x,A),Yd(d,x,A,D),A=!0;else if(l===null){var re=d.stateNode,Ce=d.memoizedProps;re.props=Ce;var Oe=re.context,tt=x.contextType;typeof tt=="object"&&tt!==null?tt=nt(tt):(tt=Ki(x)?el:Li.current,tt=Di(d,tt));var Rt=x.getDerivedStateFromProps,Ot=typeof Rt=="function"||typeof re.getSnapshotBeforeUpdate=="function";Ot||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(Ce!==A||Oe!==tt)&&Hh(d,re,A,tt),mt=!1;var Ct=d.memoizedState;re.state=Ct,Pn(d,A,re,D),Oe=d.memoizedState,Ce!==A||Ct!==Oe||fo.current||mt?(typeof Rt=="function"&&(al(d,x,Rt,A),Oe=d.memoizedState),(Ce=mt||Xl(d,x,Ce,A,Ct,Oe,tt))?(Ot||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount()),typeof re.componentDidMount=="function"&&(d.flags|=4194308)):(typeof re.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=A,d.memoizedState=Oe),re.props=A,re.state=Oe,re.context=tt,A=Ce):(typeof re.componentDidMount=="function"&&(d.flags|=4194308),A=!1)}else{re=d.stateNode,wt(l,d),Ce=d.memoizedProps,tt=d.type===d.elementType?Ce:cs(d.type,Ce),re.props=tt,Ot=d.pendingProps,Ct=re.context,Oe=x.contextType,typeof Oe=="object"&&Oe!==null?Oe=nt(Oe):(Oe=Ki(x)?el:Li.current,Oe=Di(d,Oe));var tn=x.getDerivedStateFromProps;(Rt=typeof tn=="function"||typeof re.getSnapshotBeforeUpdate=="function")||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(Ce!==Ot||Ct!==Oe)&&Hh(d,re,A,Oe),mt=!1,Ct=d.memoizedState,re.state=Ct,Pn(d,A,re,D);var an=d.memoizedState;Ce!==Ot||Ct!==an||fo.current||mt?(typeof tn=="function"&&(al(d,x,tn,A),an=d.memoizedState),(tt=mt||Xl(d,x,tt,A,Ct,an,Oe)||!1)?(Rt||typeof re.UNSAFE_componentWillUpdate!="function"&&typeof re.componentWillUpdate!="function"||(typeof re.componentWillUpdate=="function"&&re.componentWillUpdate(A,an,Oe),typeof re.UNSAFE_componentWillUpdate=="function"&&re.UNSAFE_componentWillUpdate(A,an,Oe)),typeof re.componentDidUpdate=="function"&&(d.flags|=4),typeof re.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof re.componentDidUpdate!="function"||Ce===l.memoizedProps&&Ct===l.memoizedState||(d.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||Ce===l.memoizedProps&&Ct===l.memoizedState||(d.flags|=1024),d.memoizedProps=A,d.memoizedState=an),re.props=A,re.state=an,re.context=Oe,A=tt):(typeof re.componentDidUpdate!="function"||Ce===l.memoizedProps&&Ct===l.memoizedState||(d.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||Ce===l.memoizedProps&&Ct===l.memoizedState||(d.flags|=1024),A=!1)}return ds(l,d,x,A,U,D)}function ds(l,d,x,A,D,U){Ur(l,d);var re=(d.flags&128)!==0;if(!A&&!re)return D&&Uu(d,x,!1),Aa(l,d,U);A=d.stateNode,Kh.current=d;var Ce=re&&typeof x.getDerivedStateFromError!="function"?null:A.render();return d.flags|=1,l!==null&&re?(d.child=ge(d,l.child,null,U),d.child=ge(d,null,Ce,U)):Lr(l,d,Ce,U),d.memoizedState=A.state,D&&Uu(d,x,!0),d.child}function og(l){var d=l.stateNode;d.pendingContext?Uo(l,d.pendingContext,d.pendingContext!==d.context):d.context&&Uo(l,d.context,!1),bi(l,d.containerInfo)}function sg(l,d,x,A,D){return ie(),ae(D),d.flags|=256,Lr(l,d,x,A),d.child}var tf={dehydrated:null,treeContext:null,retryLane:0};function nf(l){return{baseLanes:l,cachePool:null,transitions:null}}function Kl(l,d,x){var A=d.pendingProps,D=En.current,U=!1,re=(d.flags&128)!==0,Ce;if((Ce=re)||(Ce=l!==null&&l.memoizedState===null?!1:(D&2)!==0),Ce?(U=!0,d.flags&=-129):(l===null||l.memoizedState!==null)&&(D|=1),qn(En,D&1),l===null)return L(d),l=d.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((d.mode&1)===0?d.lanes=1:l.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(re=A.children,l=A.fallback,U?(A=d.mode,U=d.child,re={mode:"hidden",children:re},(A&1)===0&&U!==null?(U.childLanes=0,U.pendingProps=re):U=gf(re,A,0,null),l=rc(l,A,x,null),U.return=d,l.return=d,U.sibling=l,d.child=U,d.child.memoizedState=nf(x),d.memoizedState=tf,l):rf(d,re));if(D=l.memoizedState,D!==null&&(Ce=D.dehydrated,Ce!==null))return ag(l,d,re,A,Ce,D,x);if(U){U=A.fallback,re=d.mode,D=l.child,Ce=D.sibling;var Oe={mode:"hidden",children:A.children};return(re&1)===0&&d.child!==D?(A=d.child,A.childLanes=0,A.pendingProps=Oe,d.deletions=null):(A=nu(D,Oe),A.subtreeFlags=D.subtreeFlags&14680064),Ce!==null?U=nu(Ce,U):(U=rc(U,re,x,null),U.flags|=2),U.return=d,A.return=d,A.sibling=U,d.child=A,A=U,U=d.child,re=l.child.memoizedState,re=re===null?nf(x):{baseLanes:re.baseLanes|x,cachePool:null,transitions:re.transitions},U.memoizedState=re,U.childLanes=l.childLanes&~x,d.memoizedState=tf,A}return U=l.child,l=U.sibling,A=nu(U,{mode:"visible",children:A.children}),(d.mode&1)===0&&(A.lanes=x),A.return=d,A.sibling=null,l!==null&&(x=d.deletions,x===null?(d.deletions=[l],d.flags|=16):x.push(l)),d.child=A,d.memoizedState=null,A}function rf(l,d){return d=gf({mode:"visible",children:d},l.mode,0,null),d.return=l,l.child=d}function Yh(l,d,x,A){return A!==null&&ae(A),ge(d,l.child,null,x),l=rf(d,d.pendingProps.children),l.flags|=2,d.memoizedState=null,l}function ag(l,d,x,A,D,U,re){if(x)return d.flags&256?(d.flags&=-257,A=pp(Error(c(422))),Yh(l,d,re,A)):d.memoizedState!==null?(d.child=l.child,d.flags|=128,null):(U=A.fallback,D=d.mode,A=gf({mode:"visible",children:A.children},D,0,null),U=rc(U,D,re,null),U.flags|=2,A.return=d,U.return=d,A.sibling=U,d.child=A,(d.mode&1)!==0&&ge(d,l.child,null,re),d.child.memoizedState=nf(re),d.memoizedState=tf,U);if((d.mode&1)===0)return Yh(l,d,re,null);if(D.data==="$!"){if(A=D.nextSibling&&D.nextSibling.dataset,A)var Ce=A.dgst;return A=Ce,U=Error(c(419)),A=pp(U,A,void 0),Yh(l,d,re,A)}if(Ce=(re&l.childLanes)!==0,ji||Ce){if(A=Si,A!==null){switch(re&-re){case 4:D=2;break;case 16:D=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:D=32;break;case 536870912:D=268435456;break;default:D=0}D=(D&(A.suspendedLanes|re))!==0?0:D,D!==0&&D!==U.retryLane&&(U.retryLane=D,rt(l,D),ta(A,l,D,-1))}return Ap(),A=pp(Error(c(421))),Yh(l,d,re,A)}return D.data==="$?"?(d.flags|=128,d.child=l.child,d=s_.bind(null,l),D._reactRetry=d,null):(l=U.treeContext,u=Ss(D.nextSibling),r=d,g=!0,v=null,l!==null&&(Eo[So++]=Hs,Eo[So++]=ls,Eo[So++]=rl,Hs=l.id,ls=l.overflow,rl=d),d=rf(d,A.children),d.flags|=4096,d)}function gp(l,d,x){l.lanes|=d;var A=l.alternate;A!==null&&(A.lanes|=d),vt(l.return,d,x)}function yp(l,d,x,A,D){var U=l.memoizedState;U===null?l.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:A,tail:x,tailMode:D}:(U.isBackwards=d,U.rendering=null,U.renderingStartTime=0,U.last=A,U.tail=x,U.tailMode=D)}function lg(l,d,x){var A=d.pendingProps,D=A.revealOrder,U=A.tail;if(Lr(l,d,A.children,x),A=En.current,(A&2)!==0)A=A&1|2,d.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=d.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&gp(l,x,d);else if(l.tag===19)gp(l,x,d);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===d)break e;for(;l.sibling===null;){if(l.return===null||l.return===d)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}A&=1}if(qn(En,A),(d.mode&1)===0)d.memoizedState=null;else switch(D){case"forwards":for(x=d.child,D=null;x!==null;)l=x.alternate,l!==null&&ur(l)===null&&(D=x),x=x.sibling;x=D,x===null?(D=d.child,d.child=null):(D=x.sibling,x.sibling=null),yp(d,!1,D,x,U);break;case"backwards":for(x=null,D=d.child,d.child=null;D!==null;){if(l=D.alternate,l!==null&&ur(l)===null){d.child=D;break}l=D.sibling,D.sibling=x,x=D,D=l}yp(d,!0,x,null,U);break;case"together":yp(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function Jh(l,d){(d.mode&1)===0&&l!==null&&(l.alternate=null,d.alternate=null,d.flags|=2)}function Aa(l,d,x){if(l!==null&&(d.dependencies=l.dependencies),to|=d.lanes,(x&d.childLanes)===0)return null;if(l!==null&&d.child!==l.child)throw Error(c(153));if(d.child!==null){for(l=d.child,x=nu(l,l.pendingProps),d.child=x,x.return=d;l.sibling!==null;)l=l.sibling,x=x.sibling=nu(l,l.pendingProps),x.return=d;x.sibling=null}return d.child}function Qh(l,d,x){switch(d.tag){case 3:og(d),ie();break;case 5:Co(d);break;case 1:Ki(d.type)&&Cs(d);break;case 4:bi(d,d.stateNode.containerInfo);break;case 10:var A=d.type._context,D=d.memoizedProps.value;qn(Pe,A._currentValue),A._currentValue=D;break;case 13:if(A=d.memoizedState,A!==null)return A.dehydrated!==null?(qn(En,En.current&1),d.flags|=128,null):(x&d.child.childLanes)!==0?Kl(l,d,x):(qn(En,En.current&1),l=Aa(l,d,x),l!==null?l.sibling:null);qn(En,En.current&1);break;case 19:if(A=(x&d.childLanes)!==0,(l.flags&128)!==0){if(A)return lg(l,d,x);d.flags|=128}if(D=d.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),qn(En,En.current),A)break;return null;case 22:case 23:return d.lanes=0,Qd(l,d,x)}return Aa(l,d,x)}var of,ed,sf,Qi;of=function(l,d){for(var x=d.child;x!==null;){if(x.tag===5||x.tag===6)l.appendChild(x.stateNode);else if(x.tag!==4&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===d)break;for(;x.sibling===null;){if(x.return===null||x.return===d)return;x=x.return}x.sibling.return=x.return,x=x.sibling}},ed=function(){},sf=function(l,d,x,A){var D=l.memoizedProps;if(D!==A){l=d.stateNode,Jn(Un.current);var U=null;switch(x){case"input":D=pn(l,D),A=pn(l,A),U=[];break;case"select":D=Le({},D,{value:void 0}),A=Le({},A,{value:void 0}),U=[];break;case"textarea":D=Zi(l,D),A=Zi(l,A),U=[];break;default:typeof D.onClick!="function"&&typeof A.onClick=="function"&&(l.onclick=Fl)}ts(x,A);var re;x=null;for(tt in D)if(!A.hasOwnProperty(tt)&&D.hasOwnProperty(tt)&&D[tt]!=null)if(tt==="style"){var Ce=D[tt];for(re in Ce)Ce.hasOwnProperty(re)&&(x||(x={}),x[re]="")}else tt!=="dangerouslySetInnerHTML"&&tt!=="children"&&tt!=="suppressContentEditableWarning"&&tt!=="suppressHydrationWarning"&&tt!=="autoFocus"&&(_.hasOwnProperty(tt)?U||(U=[]):(U=U||[]).push(tt,null));for(tt in A){var Oe=A[tt];if(Ce=D!=null?D[tt]:void 0,A.hasOwnProperty(tt)&&Oe!==Ce&&(Oe!=null||Ce!=null))if(tt==="style")if(Ce){for(re in Ce)!Ce.hasOwnProperty(re)||Oe&&Oe.hasOwnProperty(re)||(x||(x={}),x[re]="");for(re in Oe)Oe.hasOwnProperty(re)&&Ce[re]!==Oe[re]&&(x||(x={}),x[re]=Oe[re])}else x||(U||(U=[]),U.push(tt,x)),x=Oe;else tt==="dangerouslySetInnerHTML"?(Oe=Oe?Oe.__html:void 0,Ce=Ce?Ce.__html:void 0,Oe!=null&&Ce!==Oe&&(U=U||[]).push(tt,Oe)):tt==="children"?typeof Oe!="string"&&typeof Oe!="number"||(U=U||[]).push(tt,""+Oe):tt!=="suppressContentEditableWarning"&&tt!=="suppressHydrationWarning"&&(_.hasOwnProperty(tt)?(Oe!=null&&tt==="onScroll"&&hr("scroll",l),U||Ce===Oe||(U=[])):(U=U||[]).push(tt,Oe))}x&&(U=U||[]).push("style",x);var tt=U;(d.updateQueue=tt)&&(d.flags|=4)}},Qi=function(l,d,x,A){x!==A&&(d.flags|=4)};function Xu(l,d){if(!g)switch(l.tailMode){case"hidden":d=l.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?l.tail=null:x.sibling=null;break;case"collapsed":x=l.tail;for(var A=null;x!==null;)x.alternate!==null&&(A=x),x=x.sibling;A===null?d||l.tail===null?l.tail=null:l.tail.sibling=null:A.sibling=null}}function eo(l){var d=l.alternate!==null&&l.alternate.child===l.child,x=0,A=0;if(d)for(var D=l.child;D!==null;)x|=D.lanes|D.childLanes,A|=D.subtreeFlags&14680064,A|=D.flags&14680064,D.return=l,D=D.sibling;else for(D=l.child;D!==null;)x|=D.lanes|D.childLanes,A|=D.subtreeFlags,A|=D.flags,D.return=l,D=D.sibling;return l.subtreeFlags|=A,l.childLanes=x,d}function Ma(l,d,x){var A=d.pendingProps;switch(f(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return eo(d),null;case 1:return Ki(d.type)&&Bc(),eo(d),null;case 3:return A=d.stateNode,jr(),Ar(fo),Ar(Li),Vr(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(l===null||l.child===null)&&(F(d)?d.flags|=4:l===null||l.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,v!==null&&(ul(v),v=null))),ed(l,d),eo(d),null;case 5:$o(d);var D=Jn(rr.current);if(x=d.type,l!==null&&d.stateNode!=null)sf(l,d,x,A,D),l.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!A){if(d.stateNode===null)throw Error(c(166));return eo(d),null}if(l=Jn(Un.current),F(d)){A=d.stateNode,x=d.type;var U=d.memoizedProps;switch(A[co]=d,A[Ws]=U,l=(d.mode&1)!==0,x){case"dialog":hr("cancel",A),hr("close",A);break;case"iframe":case"object":case"embed":hr("load",A);break;case"video":case"audio":for(D=0;D<To.length;D++)hr(To[D],A);break;case"source":hr("error",A);break;case"img":case"image":case"link":hr("error",A),hr("load",A);break;case"details":hr("toggle",A);break;case"input":Pr(A,U),hr("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!U.multiple},hr("invalid",A);break;case"textarea":Hi(A,U),hr("invalid",A)}ts(x,U),D=null;for(var re in U)if(U.hasOwnProperty(re)){var Ce=U[re];re==="children"?typeof Ce=="string"?A.textContent!==Ce&&(U.suppressHydrationWarning!==!0&&Ja(A.textContent,Ce,l),D=["children",Ce]):typeof Ce=="number"&&A.textContent!==""+Ce&&(U.suppressHydrationWarning!==!0&&Ja(A.textContent,Ce,l),D=["children",""+Ce]):_.hasOwnProperty(re)&&Ce!=null&&re==="onScroll"&&hr("scroll",A)}switch(x){case"input":Bn(A),Kr(A,U,!0);break;case"textarea":Bn(A),It(A);break;case"select":case"option":break;default:typeof U.onClick=="function"&&(A.onclick=Fl)}A=D,d.updateQueue=A,A!==null&&(d.flags|=4)}else{re=D.nodeType===9?D:D.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Ht(x)),l==="http://www.w3.org/1999/xhtml"?x==="script"?(l=re.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof A.is=="string"?l=re.createElement(x,{is:A.is}):(l=re.createElement(x),x==="select"&&(re=l,A.multiple?re.multiple=!0:A.size&&(re.size=A.size))):l=re.createElementNS(l,x),l[co]=d,l[Ws]=A,of(l,d,!1,!1),d.stateNode=l;e:{switch(re=yo(x,A),x){case"dialog":hr("cancel",l),hr("close",l),D=A;break;case"iframe":case"object":case"embed":hr("load",l),D=A;break;case"video":case"audio":for(D=0;D<To.length;D++)hr(To[D],l);D=A;break;case"source":hr("error",l),D=A;break;case"img":case"image":case"link":hr("error",l),hr("load",l),D=A;break;case"details":hr("toggle",l),D=A;break;case"input":Pr(l,A),D=pn(l,A),hr("invalid",l);break;case"option":D=A;break;case"select":l._wrapperState={wasMultiple:!!A.multiple},D=Le({},A,{value:void 0}),hr("invalid",l);break;case"textarea":Hi(l,A),D=Zi(l,A),hr("invalid",l);break;default:D=A}ts(x,D),Ce=D;for(U in Ce)if(Ce.hasOwnProperty(U)){var Oe=Ce[U];U==="style"?Yr(l,Oe):U==="dangerouslySetInnerHTML"?(Oe=Oe?Oe.__html:void 0,Oe!=null&&Wn(l,Oe)):U==="children"?typeof Oe=="string"?(x!=="textarea"||Oe!=="")&&un(l,Oe):typeof Oe=="number"&&un(l,""+Oe):U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&U!=="autoFocus"&&(_.hasOwnProperty(U)?Oe!=null&&U==="onScroll"&&hr("scroll",l):Oe!=null&&ce(l,U,Oe,re))}switch(x){case"input":Bn(l),Kr(l,A,!1);break;case"textarea":Bn(l),It(l);break;case"option":A.value!=null&&l.setAttribute("value",""+Ft(A.value));break;case"select":l.multiple=!!A.multiple,U=A.value,U!=null?Ii(l,!!A.multiple,U,!1):A.defaultValue!=null&&Ii(l,!!A.multiple,A.defaultValue,!0);break;default:typeof D.onClick=="function"&&(l.onclick=Fl)}switch(x){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return eo(d),null;case 6:if(l&&d.stateNode!=null)Qi(l,d,l.memoizedProps,A);else{if(typeof A!="string"&&d.stateNode===null)throw Error(c(166));if(x=Jn(rr.current),Jn(Un.current),F(d)){if(A=d.stateNode,x=d.memoizedProps,A[co]=d,(U=A.nodeValue!==x)&&(l=r,l!==null))switch(l.tag){case 3:Ja(A.nodeValue,x,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&Ja(A.nodeValue,x,(l.mode&1)!==0)}U&&(d.flags|=4)}else A=(x.nodeType===9?x:x.ownerDocument).createTextNode(A),A[co]=d,d.stateNode=A}return eo(d),null;case 13:if(Ar(En),A=d.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(g&&u!==null&&(d.mode&1)!==0&&(d.flags&128)===0)W(),ie(),d.flags|=98560,U=!1;else if(U=F(d),A!==null&&A.dehydrated!==null){if(l===null){if(!U)throw Error(c(318));if(U=d.memoizedState,U=U!==null?U.dehydrated:null,!U)throw Error(c(317));U[co]=d}else ie(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;eo(d),U=!1}else v!==null&&(ul(v),v=null),U=!0;if(!U)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=x,d):(A=A!==null,A!==(l!==null&&l.memoizedState!==null)&&A&&(d.child.flags|=8192,(d.mode&1)!==0&&(l===null||(En.current&1)!==0?ir===0&&(ir=3):Ap())),d.updateQueue!==null&&(d.flags|=4),eo(d),null);case 4:return jr(),ed(l,d),l===null&&Gs(d.stateNode.containerInfo),eo(d),null;case 10:return He(d.type._context),eo(d),null;case 17:return Ki(d.type)&&Bc(),eo(d),null;case 19:if(Ar(En),U=d.memoizedState,U===null)return eo(d),null;if(A=(d.flags&128)!==0,re=U.rendering,re===null)if(A)Xu(U,!1);else{if(ir!==0||l!==null&&(l.flags&128)!==0)for(l=d.child;l!==null;){if(re=ur(l),re!==null){for(d.flags|=128,Xu(U,!1),A=re.updateQueue,A!==null&&(d.updateQueue=A,d.flags|=4),d.subtreeFlags=0,A=x,x=d.child;x!==null;)U=x,l=A,U.flags&=14680066,re=U.alternate,re===null?(U.childLanes=0,U.lanes=l,U.child=null,U.subtreeFlags=0,U.memoizedProps=null,U.memoizedState=null,U.updateQueue=null,U.dependencies=null,U.stateNode=null):(U.childLanes=re.childLanes,U.lanes=re.lanes,U.child=re.child,U.subtreeFlags=0,U.deletions=null,U.memoizedProps=re.memoizedProps,U.memoizedState=re.memoizedState,U.updateQueue=re.updateQueue,U.type=re.type,l=re.dependencies,U.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),x=x.sibling;return qn(En,En.current&1|2),d.child}l=l.sibling}U.tail!==null&&Nr()>Xc&&(d.flags|=128,A=!0,Xu(U,!1),d.lanes=4194304)}else{if(!A)if(l=ur(re),l!==null){if(d.flags|=128,A=!0,x=l.updateQueue,x!==null&&(d.updateQueue=x,d.flags|=4),Xu(U,!0),U.tail===null&&U.tailMode==="hidden"&&!re.alternate&&!g)return eo(d),null}else 2*Nr()-U.renderingStartTime>Xc&&x!==1073741824&&(d.flags|=128,A=!0,Xu(U,!1),d.lanes=4194304);U.isBackwards?(re.sibling=d.child,d.child=re):(x=U.last,x!==null?x.sibling=re:d.child=re,U.last=re)}return U.tail!==null?(d=U.tail,U.rendering=d,U.tail=d.sibling,U.renderingStartTime=Nr(),d.sibling=null,x=En.current,qn(En,A?x&1|2:x&1),d):(eo(d),null);case 22:case 23:return ff(),A=d.memoizedState!==null,l!==null&&l.memoizedState!==null!==A&&(d.flags|=8192),A&&(d.mode&1)!==0?(ti&1073741824)!==0&&(eo(d),d.subtreeFlags&6&&(d.flags|=8192)):eo(d),null;case 24:return null;case 25:return null}throw Error(c(156,d.tag))}function t_(l,d){switch(f(d),d.tag){case 1:return Ki(d.type)&&Bc(),l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 3:return jr(),Ar(fo),Ar(Li),Vr(),l=d.flags,(l&65536)!==0&&(l&128)===0?(d.flags=l&-65537|128,d):null;case 5:return $o(d),null;case 13:if(Ar(En),l=d.memoizedState,l!==null&&l.dehydrated!==null){if(d.alternate===null)throw Error(c(340));ie()}return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 19:return Ar(En),null;case 4:return jr(),null;case 10:return He(d.type._context),null;case 22:case 23:return ff(),null;case 24:return null;default:return null}}var ka=!1,Ei=!1,ks=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function Gc(l,d){var x=l.ref;if(x!==null)if(typeof x=="function")try{x(null)}catch(A){si(l,d,A)}else x.current=null}function qc(l,d,x){try{x()}catch(A){si(l,d,A)}}var _p=!1;function n_(l,d){if(Nl=bl,l=Vd(),jh(l)){if("selectionStart"in l)var x={start:l.selectionStart,end:l.selectionEnd};else e:{x=(x=l.ownerDocument)&&x.defaultView||window;var A=x.getSelection&&x.getSelection();if(A&&A.rangeCount!==0){x=A.anchorNode;var D=A.anchorOffset,U=A.focusNode;A=A.focusOffset;try{x.nodeType,U.nodeType}catch{x=null;break e}var re=0,Ce=-1,Oe=-1,tt=0,Rt=0,Ot=l,Ct=null;t:for(;;){for(var tn;Ot!==x||D!==0&&Ot.nodeType!==3||(Ce=re+D),Ot!==U||A!==0&&Ot.nodeType!==3||(Oe=re+A),Ot.nodeType===3&&(re+=Ot.nodeValue.length),(tn=Ot.firstChild)!==null;)Ct=Ot,Ot=tn;for(;;){if(Ot===l)break t;if(Ct===x&&++tt===D&&(Ce=re),Ct===U&&++Rt===A&&(Oe=re),(tn=Ot.nextSibling)!==null)break;Ot=Ct,Ct=Ot.parentNode}Ot=tn}x=Ce===-1||Oe===-1?null:{start:Ce,end:Oe}}else x=null}x=x||{start:0,end:0}}else x=null;for(Rc={focusedElem:l,selectionRange:x},bl=!1,Kt=d;Kt!==null;)if(d=Kt,l=d.child,(d.subtreeFlags&1028)!==0&&l!==null)l.return=d,Kt=l;else for(;Kt!==null;){d=Kt;try{var an=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(an!==null){var cn=an.memoizedProps,ai=an.memoizedState,Ye=d.stateNode,je=Ye.getSnapshotBeforeUpdate(d.elementType===d.type?cn:cs(d.type,cn),ai);Ye.__reactInternalSnapshotBeforeUpdate=je}break;case 3:var et=d.stateNode.containerInfo;et.nodeType===1?et.textContent="":et.nodeType===9&&et.documentElement&&et.removeChild(et.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(c(163))}}catch(Ut){si(d,d.return,Ut)}if(l=d.sibling,l!==null){l.return=d.return,Kt=l;break}Kt=d.return}return an=_p,_p=!1,an}function Ku(l,d,x){var A=d.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var D=A=A.next;do{if((D.tag&l)===l){var U=D.destroy;D.destroy=void 0,U!==void 0&&qc(d,x,U)}D=D.next}while(D!==A)}}function fs(l,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var x=d=d.next;do{if((x.tag&l)===l){var A=x.create;x.destroy=A()}x=x.next}while(x!==d)}}function ll(l){var d=l.ref;if(d!==null){var x=l.stateNode;switch(l.tag){case 5:l=x;break;default:l=x}typeof d=="function"?d(l):d.current=l}}function vp(l){var d=l.alternate;d!==null&&(l.alternate=null,vp(d)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(d=l.stateNode,d!==null&&(delete d[co],delete d[Ws],delete d[Dc],delete d[$h],delete d[Wd])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function xp(l){return l.tag===5||l.tag===3||l.tag===4}function ug(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||xp(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Wc(l,d,x){var A=l.tag;if(A===5||A===6)l=l.stateNode,d?x.nodeType===8?x.parentNode.insertBefore(l,d):x.insertBefore(l,d):(x.nodeType===8?(d=x.parentNode,d.insertBefore(l,x)):(d=x,d.appendChild(l)),x=x._reactRootContainer,x!=null||d.onclick!==null||(d.onclick=Fl));else if(A!==4&&(l=l.child,l!==null))for(Wc(l,d,x),l=l.sibling;l!==null;)Wc(l,d,x),l=l.sibling}function td(l,d,x){var A=l.tag;if(A===5||A===6)l=l.stateNode,d?x.insertBefore(l,d):x.appendChild(l);else if(A!==4&&(l=l.child,l!==null))for(td(l,d,x),l=l.sibling;l!==null;)td(l,d,x),l=l.sibling}var oi=null,po=!1;function Ps(l,d,x){for(x=x.child;x!==null;)nd(l,d,x),x=x.sibling}function nd(l,d,x){if(oo&&typeof oo.onCommitFiberUnmount=="function")try{oo.onCommitFiberUnmount(Do,x)}catch{}switch(x.tag){case 5:Ei||Gc(x,d);case 6:var A=oi,D=po;oi=null,Ps(l,d,x),oi=A,po=D,oi!==null&&(po?(l=oi,x=x.stateNode,l.nodeType===8?l.parentNode.removeChild(x):l.removeChild(x)):oi.removeChild(x.stateNode));break;case 18:oi!==null&&(po?(l=oi,x=x.stateNode,l.nodeType===8?Vu(l.parentNode,x):l.nodeType===1&&Vu(l,x),is(l)):Vu(oi,x.stateNode));break;case 4:A=oi,D=po,oi=x.stateNode.containerInfo,po=!0,Ps(l,d,x),oi=A,po=D;break;case 0:case 11:case 14:case 15:if(!Ei&&(A=x.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){D=A=A.next;do{var U=D,re=U.destroy;U=U.tag,re!==void 0&&((U&2)!==0||(U&4)!==0)&&qc(x,d,re),D=D.next}while(D!==A)}Ps(l,d,x);break;case 1:if(!Ei&&(Gc(x,d),A=x.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=x.memoizedProps,A.state=x.memoizedState,A.componentWillUnmount()}catch(Ce){si(x,d,Ce)}Ps(l,d,x);break;case 21:Ps(l,d,x);break;case 22:x.mode&1?(Ei=(A=Ei)||x.memoizedState!==null,Ps(l,d,x),Ei=A):Ps(l,d,x);break;default:Ps(l,d,x)}}function wp(l){var d=l.updateQueue;if(d!==null){l.updateQueue=null;var x=l.stateNode;x===null&&(x=l.stateNode=new ks),d.forEach(function(A){var D=a_.bind(null,l,A);x.has(A)||(x.add(A),A.then(D,D))})}}function Ao(l,d){var x=d.deletions;if(x!==null)for(var A=0;A<x.length;A++){var D=x[A];try{var U=l,re=d,Ce=re;e:for(;Ce!==null;){switch(Ce.tag){case 5:oi=Ce.stateNode,po=!1;break e;case 3:oi=Ce.stateNode.containerInfo,po=!0;break e;case 4:oi=Ce.stateNode.containerInfo,po=!0;break e}Ce=Ce.return}if(oi===null)throw Error(c(160));nd(U,re,D),oi=null,po=!1;var Oe=D.alternate;Oe!==null&&(Oe.return=null),D.return=null}catch(tt){si(D,d,tt)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)af(d,l),d=d.sibling}function af(l,d){var x=l.alternate,A=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ao(d,l),Js(l),A&4){try{Ku(3,l,l.return),fs(3,l)}catch(cn){si(l,l.return,cn)}try{Ku(5,l,l.return)}catch(cn){si(l,l.return,cn)}}break;case 1:Ao(d,l),Js(l),A&512&&x!==null&&Gc(x,x.return);break;case 5:if(Ao(d,l),Js(l),A&512&&x!==null&&Gc(x,x.return),l.flags&32){var D=l.stateNode;try{un(D,"")}catch(cn){si(l,l.return,cn)}}if(A&4&&(D=l.stateNode,D!=null)){var U=l.memoizedProps,re=x!==null?x.memoizedProps:U,Ce=l.type,Oe=l.updateQueue;if(l.updateQueue=null,Oe!==null)try{Ce==="input"&&U.type==="radio"&&U.name!=null&&Nn(D,U),yo(Ce,re);var tt=yo(Ce,U);for(re=0;re<Oe.length;re+=2){var Rt=Oe[re],Ot=Oe[re+1];Rt==="style"?Yr(D,Ot):Rt==="dangerouslySetInnerHTML"?Wn(D,Ot):Rt==="children"?un(D,Ot):ce(D,Rt,Ot,tt)}switch(Ce){case"input":jn(D,U);break;case"textarea":Ri(D,U);break;case"select":var Ct=D._wrapperState.wasMultiple;D._wrapperState.wasMultiple=!!U.multiple;var tn=U.value;tn!=null?Ii(D,!!U.multiple,tn,!1):Ct!==!!U.multiple&&(U.defaultValue!=null?Ii(D,!!U.multiple,U.defaultValue,!0):Ii(D,!!U.multiple,U.multiple?[]:"",!1))}D[Ws]=U}catch(cn){si(l,l.return,cn)}}break;case 6:if(Ao(d,l),Js(l),A&4){if(l.stateNode===null)throw Error(c(162));D=l.stateNode,U=l.memoizedProps;try{D.nodeValue=U}catch(cn){si(l,l.return,cn)}}break;case 3:if(Ao(d,l),Js(l),A&4&&x!==null&&x.memoizedState.isDehydrated)try{is(d.containerInfo)}catch(cn){si(l,l.return,cn)}break;case 4:Ao(d,l),Js(l);break;case 13:Ao(d,l),Js(l),D=l.child,D.flags&8192&&(U=D.memoizedState!==null,D.stateNode.isHidden=U,!U||D.alternate!==null&&D.alternate.memoizedState!==null||(id=Nr())),A&4&&wp(l);break;case 22:if(Rt=x!==null&&x.memoizedState!==null,l.mode&1?(Ei=(tt=Ei)||Rt,Ao(d,l),Ei=tt):Ao(d,l),Js(l),A&8192){if(tt=l.memoizedState!==null,(l.stateNode.isHidden=tt)&&!Rt&&(l.mode&1)!==0)for(Kt=l,Rt=l.child;Rt!==null;){for(Ot=Kt=Rt;Kt!==null;){switch(Ct=Kt,tn=Ct.child,Ct.tag){case 0:case 11:case 14:case 15:Ku(4,Ct,Ct.return);break;case 1:Gc(Ct,Ct.return);var an=Ct.stateNode;if(typeof an.componentWillUnmount=="function"){A=Ct,x=Ct.return;try{d=A,an.props=d.memoizedProps,an.state=d.memoizedState,an.componentWillUnmount()}catch(cn){si(A,x,cn)}}break;case 5:Gc(Ct,Ct.return);break;case 22:if(Ct.memoizedState!==null){Tp(Ot);continue}}tn!==null?(tn.return=Ct,Kt=tn):Tp(Ot)}Rt=Rt.sibling}e:for(Rt=null,Ot=l;;){if(Ot.tag===5){if(Rt===null){Rt=Ot;try{D=Ot.stateNode,tt?(U=D.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none"):(Ce=Ot.stateNode,Oe=Ot.memoizedProps.style,re=Oe!=null&&Oe.hasOwnProperty("display")?Oe.display:null,Ce.style.display=pr("display",re))}catch(cn){si(l,l.return,cn)}}}else if(Ot.tag===6){if(Rt===null)try{Ot.stateNode.nodeValue=tt?"":Ot.memoizedProps}catch(cn){si(l,l.return,cn)}}else if((Ot.tag!==22&&Ot.tag!==23||Ot.memoizedState===null||Ot===l)&&Ot.child!==null){Ot.child.return=Ot,Ot=Ot.child;continue}if(Ot===l)break e;for(;Ot.sibling===null;){if(Ot.return===null||Ot.return===l)break e;Rt===Ot&&(Rt=null),Ot=Ot.return}Rt===Ot&&(Rt=null),Ot.sibling.return=Ot.return,Ot=Ot.sibling}}break;case 19:Ao(d,l),Js(l),A&4&&wp(l);break;case 21:break;default:Ao(d,l),Js(l)}}function Js(l){var d=l.flags;if(d&2){try{e:{for(var x=l.return;x!==null;){if(xp(x)){var A=x;break e}x=x.return}throw Error(c(160))}switch(A.tag){case 5:var D=A.stateNode;A.flags&32&&(un(D,""),A.flags&=-33);var U=ug(l);td(l,U,D);break;case 3:case 4:var re=A.stateNode.containerInfo,Ce=ug(l);Wc(l,Ce,re);break;default:throw Error(c(161))}}catch(Oe){si(l,l.return,Oe)}l.flags&=-3}d&4096&&(l.flags&=-4097)}function Zc(l,d,x){Kt=l,bp(l)}function bp(l,d,x){for(var A=(l.mode&1)!==0;Kt!==null;){var D=Kt,U=D.child;if(D.tag===22&&A){var re=D.memoizedState!==null||ka;if(!re){var Ce=D.alternate,Oe=Ce!==null&&Ce.memoizedState!==null||Ei;Ce=ka;var tt=Ei;if(ka=re,(Ei=Oe)&&!tt)for(Kt=D;Kt!==null;)re=Kt,Oe=re.child,re.tag===22&&re.memoizedState!==null?cg(D):Oe!==null?(Oe.return=re,Kt=Oe):cg(D);for(;U!==null;)Kt=U,bp(U),U=U.sibling;Kt=D,ka=Ce,Ei=tt}lf(l)}else(D.subtreeFlags&8772)!==0&&U!==null?(U.return=D,Kt=U):lf(l)}}function lf(l){for(;Kt!==null;){var d=Kt;if((d.flags&8772)!==0){var x=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Ei||fs(5,d);break;case 1:var A=d.stateNode;if(d.flags&4&&!Ei)if(x===null)A.componentDidMount();else{var D=d.elementType===d.type?x.memoizedProps:cs(d.type,x.memoizedProps);A.componentDidUpdate(D,x.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var U=d.updateQueue;U!==null&&Dn(d,U,A);break;case 3:var re=d.updateQueue;if(re!==null){if(x=null,d.child!==null)switch(d.child.tag){case 5:x=d.child.stateNode;break;case 1:x=d.child.stateNode}Dn(d,re,x)}break;case 5:var Ce=d.stateNode;if(x===null&&d.flags&4){x=Ce;var Oe=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":Oe.autoFocus&&x.focus();break;case"img":Oe.src&&(x.src=Oe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var tt=d.alternate;if(tt!==null){var Rt=tt.memoizedState;if(Rt!==null){var Ot=Rt.dehydrated;Ot!==null&&is(Ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(c(163))}Ei||d.flags&512&&ll(d)}catch(Ct){si(d,d.return,Ct)}}if(d===l){Kt=null;break}if(x=d.sibling,x!==null){x.return=d.return,Kt=x;break}Kt=d.return}}function Tp(l){for(;Kt!==null;){var d=Kt;if(d===l){Kt=null;break}var x=d.sibling;if(x!==null){x.return=d.return,Kt=x;break}Kt=d.return}}function cg(l){for(;Kt!==null;){var d=Kt;try{switch(d.tag){case 0:case 11:case 15:var x=d.return;try{fs(4,d)}catch(Oe){si(d,x,Oe)}break;case 1:var A=d.stateNode;if(typeof A.componentDidMount=="function"){var D=d.return;try{A.componentDidMount()}catch(Oe){si(d,D,Oe)}}var U=d.return;try{ll(d)}catch(Oe){si(d,U,Oe)}break;case 5:var re=d.return;try{ll(d)}catch(Oe){si(d,re,Oe)}}}catch(Oe){si(d,d.return,Oe)}if(d===l){Kt=null;break}var Ce=d.sibling;if(Ce!==null){Ce.return=d.return,Kt=Ce;break}Kt=d.return}}var r_=Math.ceil,Yl=me.ReactCurrentDispatcher,uf=me.ReactCurrentOwner,zi=me.ReactCurrentBatchConfig,sn=0,Si=null,vr=null,Br=0,ti=0,Vi=Zs(0),ir=0,Hc=null,to=0,rd=0,Jl=0,Yu=null,Mo=null,id=0,Xc=1/0,Qs=null,od=!1,Ep=null,mo=null,Pa=!1,ea=null,Ju=0,Qu=0,cf=null,hf=-1,sd=0;function ko(){return(sn&6)!==0?Nr():hf!==-1?hf:hf=Nr()}function Ia(l){return(l.mode&1)===0?1:(sn&2)!==0&&Br!==0?Br&-Br:ue.transition!==null?(sd===0&&(sd=so()),sd):(l=er,l!==0||(l=window.event,l=l===void 0?16:vc(l.type)),l)}function ta(l,d,x,A){if(50<Qu)throw Qu=0,cf=null,Error(c(185));Cn(l,x,A),((sn&2)===0||l!==Si)&&(l===Si&&((sn&2)===0&&(rd|=x),ir===4&&Ql(l,Br)),go(l,A),x===1&&sn===0&&(d.mode&1)===0&&(Xc=Nr()+500,$l&&Bt()))}function go(l,d){var x=l.callbackNode;Gn(l,d);var A=Ns(l,l===Si?Br:0);if(A===0)x!==null&&Qn(x),l.callbackNode=null,l.callbackPriority=0;else if(d=A&-A,l.callbackPriority!==d){if(x!=null&&Qn(x),d===1)l.tag===0?nl(ec.bind(null,l)):tl(ec.bind(null,l)),qd(function(){(sn&6)===0&&Bt()}),x=null;else{switch(wo(A)){case 1:x=Lo;break;case 4:x=_s;break;case 16:x=yl;break;case 536870912:x=la;break;default:x=yl}x=ld(x,Sp.bind(null,l))}l.callbackPriority=d,l.callbackNode=x}}function Sp(l,d){if(hf=-1,sd=0,(sn&6)!==0)throw Error(c(327));var x=l.callbackNode;if(Zo()&&l.callbackNode!==x)return null;var A=Ns(l,l===Si?Br:0);if(A===0)return null;if((A&30)!==0||(A&l.expiredLanes)!==0||d)d=ad(l,A);else{d=A;var D=sn;sn|=2;var U=Cp();(Si!==l||Br!==d)&&(Qs=null,Xc=Nr()+500,tc(l,d));do try{o_();break}catch(Ce){dg(l,Ce)}while(!0);Fe(),Yl.current=U,sn=D,vr!==null?d=0:(Si=null,Br=0,d=ir)}if(d!==0){if(d===2&&(D=Ln(l),D!==0&&(A=D,d=df(l,D))),d===1)throw x=Hc,tc(l,0),Ql(l,A),go(l,Nr()),x;if(d===6)Ql(l,A);else{if(D=l.current.alternate,(A&30)===0&&!hg(D)&&(d=ad(l,A),d===2&&(U=Ln(l),U!==0&&(A=U,d=df(l,U))),d===1))throw x=Hc,tc(l,0),Ql(l,A),go(l,Nr()),x;switch(l.finishedWork=D,l.finishedLanes=A,d){case 0:case 1:throw Error(c(345));case 2:tu(l,Mo,Qs);break;case 3:if(Ql(l,A),(A&130023424)===A&&(d=id+500-Nr(),10<d)){if(Ns(l,0)!==0)break;if(D=l.suspendedLanes,(D&A)!==A){ko(),l.pingedLanes|=l.suspendedLanes&D;break}l.timeoutHandle=_a(tu.bind(null,l,Mo,Qs),d);break}tu(l,Mo,Qs);break;case 4:if(Ql(l,A),(A&4194240)===A)break;for(d=l.eventTimes,D=-1;0<A;){var re=31-ci(A);U=1<<re,re=d[re],re>D&&(D=re),A&=~U}if(A=D,A=Nr()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*r_(A/1960))-A,10<A){l.timeoutHandle=_a(tu.bind(null,l,Mo,Qs),A);break}tu(l,Mo,Qs);break;case 5:tu(l,Mo,Qs);break;default:throw Error(c(329))}}}return go(l,Nr()),l.callbackNode===x?Sp.bind(null,l):null}function df(l,d){var x=Yu;return l.current.memoizedState.isDehydrated&&(tc(l,d).flags|=256),l=ad(l,d),l!==2&&(d=Mo,Mo=x,d!==null&&ul(d)),l}function ul(l){Mo===null?Mo=l:Mo.push.apply(Mo,l)}function hg(l){for(var d=l;;){if(d.flags&16384){var x=d.updateQueue;if(x!==null&&(x=x.stores,x!==null))for(var A=0;A<x.length;A++){var D=x[A],U=D.getSnapshot;D=D.value;try{if(!jo(U(),D))return!1}catch{return!1}}}if(x=d.child,d.subtreeFlags&16384&&x!==null)x.return=d,d=x;else{if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Ql(l,d){for(d&=~Jl,d&=~rd,l.suspendedLanes|=d,l.pingedLanes&=~d,l=l.expirationTimes;0<d;){var x=31-ci(d),A=1<<x;l[x]=-1,d&=~A}}function ec(l){if((sn&6)!==0)throw Error(c(327));Zo();var d=Ns(l,0);if((d&1)===0)return go(l,Nr()),null;var x=ad(l,d);if(l.tag!==0&&x===2){var A=Ln(l);A!==0&&(d=A,x=df(l,A))}if(x===1)throw x=Hc,tc(l,0),Ql(l,d),go(l,Nr()),x;if(x===6)throw Error(c(345));return l.finishedWork=l.current.alternate,l.finishedLanes=d,tu(l,Mo,Qs),go(l,Nr()),null}function Kc(l,d){var x=sn;sn|=1;try{return l(d)}finally{sn=x,sn===0&&(Xc=Nr()+500,$l&&Bt())}}function eu(l){ea!==null&&ea.tag===0&&(sn&6)===0&&Zo();var d=sn;sn|=1;var x=zi.transition,A=er;try{if(zi.transition=null,er=1,l)return l()}finally{er=A,zi.transition=x,sn=d,(sn&6)===0&&Bt()}}function ff(){ti=Vi.current,Ar(Vi)}function tc(l,d){l.finishedWork=null,l.finishedLanes=0;var x=l.timeoutHandle;if(x!==-1&&(l.timeoutHandle=-1,Uh(x)),vr!==null)for(x=vr.return;x!==null;){var A=x;switch(f(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&Bc();break;case 3:jr(),Ar(fo),Ar(Li),Vr();break;case 5:$o(A);break;case 4:jr();break;case 13:Ar(En);break;case 19:Ar(En);break;case 10:He(A.type._context);break;case 22:case 23:ff()}x=x.return}if(Si=l,vr=l=nu(l.current,null),Br=ti=d,ir=0,Hc=null,Jl=rd=to=0,Mo=Yu=null,Xe!==null){for(d=0;d<Xe.length;d++)if(x=Xe[d],A=x.interleaved,A!==null){x.interleaved=null;var D=A.next,U=x.pending;if(U!==null){var re=U.next;U.next=D,A.next=re}x.pending=A}Xe=null}return l}function dg(l,d){do{var x=vr;try{if(Fe(),Ti.current=Yi,Go){for(var A=Mr.memoizedState;A!==null;){var D=A.queue;D!==null&&(D.pending=null),A=A.next}Go=!1}if(ri=0,Zr=Rr=Mr=null,qo=!1,us=0,uf.current=null,x===null||x.return===null){ir=1,Hc=d,vr=null;break}e:{var U=l,re=x.return,Ce=x,Oe=d;if(d=Br,Ce.flags|=32768,Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var tt=Oe,Rt=Ce,Ot=Rt.tag;if((Rt.mode&1)===0&&(Ot===0||Ot===11||Ot===15)){var Ct=Rt.alternate;Ct?(Rt.updateQueue=Ct.updateQueue,Rt.memoizedState=Ct.memoizedState,Rt.lanes=Ct.lanes):(Rt.updateQueue=null,Rt.memoizedState=null)}var tn=Jd(re);if(tn!==null){tn.flags&=-257,mp(tn,re,Ce,U,d),tn.mode&1&&Ca(U,tt,d),d=tn,Oe=tt;var an=d.updateQueue;if(an===null){var cn=new Set;cn.add(Oe),d.updateQueue=cn}else an.add(Oe);break e}else{if((d&1)===0){Ca(U,tt,d),Ap();break e}Oe=Error(c(426))}}else if(g&&Ce.mode&1){var ai=Jd(re);if(ai!==null){(ai.flags&65536)===0&&(ai.flags|=256),mp(ai,re,Ce,U,d),ae(Zu(Oe,Ce));break e}}U=Oe=Zu(Oe,Ce),ir!==4&&(ir=2),Yu===null?Yu=[U]:Yu.push(U),U=re;do{switch(U.tag){case 3:U.flags|=65536,d&=-d,U.lanes|=d;var Ye=Vc(U,Oe,d);on(U,Ye);break e;case 1:Ce=Oe;var je=U.type,et=U.stateNode;if((U.flags&128)===0&&(typeof je.getDerivedStateFromError=="function"||et!==null&&typeof et.componentDidCatch=="function"&&(mo===null||!mo.has(et)))){U.flags|=65536,d&=-d,U.lanes|=d;var Ut=Hu(U,Ce,d);on(U,Ut);break e}}U=U.return}while(U!==null)}kp(x)}catch(hn){d=hn,vr===x&&x!==null&&(vr=x=x.return);continue}break}while(!0)}function Cp(){var l=Yl.current;return Yl.current=Yi,l===null?Yi:l}function Ap(){(ir===0||ir===3||ir===2)&&(ir=4),Si===null||(to&268435455)===0&&(rd&268435455)===0||Ql(Si,Br)}function ad(l,d){var x=sn;sn|=2;var A=Cp();(Si!==l||Br!==d)&&(Qs=null,tc(l,d));do try{i_();break}catch(D){dg(l,D)}while(!0);if(Fe(),sn=x,Yl.current=A,vr!==null)throw Error(c(261));return Si=null,Br=0,ir}function i_(){for(;vr!==null;)Mp(vr)}function o_(){for(;vr!==null&&!gh();)Mp(vr)}function Mp(l){var d=pf(l.alternate,l,ti);l.memoizedProps=l.pendingProps,d===null?kp(l):vr=d,uf.current=null}function kp(l){var d=l;do{var x=d.alternate;if(l=d.return,(d.flags&32768)===0){if(x=Ma(x,d,ti),x!==null){vr=x;return}}else{if(x=t_(x,d),x!==null){x.flags&=32767,vr=x;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{ir=6,vr=null;return}}if(d=d.sibling,d!==null){vr=d;return}vr=d=l}while(d!==null);ir===0&&(ir=5)}function tu(l,d,x){var A=er,D=zi.transition;try{zi.transition=null,er=1,Pp(l,d,x,A)}finally{zi.transition=D,er=A}return null}function Pp(l,d,x,A){do Zo();while(ea!==null);if((sn&6)!==0)throw Error(c(327));x=l.finishedWork;var D=l.finishedLanes;if(x===null)return null;if(l.finishedWork=null,l.finishedLanes=0,x===l.current)throw Error(c(177));l.callbackNode=null,l.callbackPriority=0;var U=x.lanes|x.childLanes;if(xo(l,U),l===Si&&(vr=Si=null,Br=0),(x.subtreeFlags&2064)===0&&(x.flags&2064)===0||Pa||(Pa=!0,ld(yl,function(){return Zo(),null})),U=(x.flags&15990)!==0,(x.subtreeFlags&15990)!==0||U){U=zi.transition,zi.transition=null;var re=er;er=1;var Ce=sn;sn|=4,uf.current=null,n_(l,x),af(x,l),ap(Rc),bl=!!Nl,Rc=Nl=null,l.current=x,Zc(x),vu(),sn=Ce,er=re,zi.transition=U}else l.current=x;if(Pa&&(Pa=!1,ea=l,Ju=D),U=l.pendingLanes,U===0&&(mo=null),ot(x.stateNode),go(l,Nr()),d!==null)for(A=l.onRecoverableError,x=0;x<d.length;x++)D=d[x],A(D.value,{componentStack:D.stack,digest:D.digest});if(od)throw od=!1,l=Ep,Ep=null,l;return(Ju&1)!==0&&l.tag!==0&&Zo(),U=l.pendingLanes,(U&1)!==0?l===cf?Qu++:(Qu=0,cf=l):Qu=0,Bt(),null}function Zo(){if(ea!==null){var l=wo(Ju),d=zi.transition,x=er;try{if(zi.transition=null,er=16>l?16:l,ea===null)var A=!1;else{if(l=ea,ea=null,Ju=0,(sn&6)!==0)throw Error(c(331));var D=sn;for(sn|=4,Kt=l.current;Kt!==null;){var U=Kt,re=U.child;if((Kt.flags&16)!==0){var Ce=U.deletions;if(Ce!==null){for(var Oe=0;Oe<Ce.length;Oe++){var tt=Ce[Oe];for(Kt=tt;Kt!==null;){var Rt=Kt;switch(Rt.tag){case 0:case 11:case 15:Ku(8,Rt,U)}var Ot=Rt.child;if(Ot!==null)Ot.return=Rt,Kt=Ot;else for(;Kt!==null;){Rt=Kt;var Ct=Rt.sibling,tn=Rt.return;if(vp(Rt),Rt===tt){Kt=null;break}if(Ct!==null){Ct.return=tn,Kt=Ct;break}Kt=tn}}}var an=U.alternate;if(an!==null){var cn=an.child;if(cn!==null){an.child=null;do{var ai=cn.sibling;cn.sibling=null,cn=ai}while(cn!==null)}}Kt=U}}if((U.subtreeFlags&2064)!==0&&re!==null)re.return=U,Kt=re;else e:for(;Kt!==null;){if(U=Kt,(U.flags&2048)!==0)switch(U.tag){case 0:case 11:case 15:Ku(9,U,U.return)}var Ye=U.sibling;if(Ye!==null){Ye.return=U.return,Kt=Ye;break e}Kt=U.return}}var je=l.current;for(Kt=je;Kt!==null;){re=Kt;var et=re.child;if((re.subtreeFlags&2064)!==0&&et!==null)et.return=re,Kt=et;else e:for(re=je;Kt!==null;){if(Ce=Kt,(Ce.flags&2048)!==0)try{switch(Ce.tag){case 0:case 11:case 15:fs(9,Ce)}}catch(hn){si(Ce,Ce.return,hn)}if(Ce===re){Kt=null;break e}var Ut=Ce.sibling;if(Ut!==null){Ut.return=Ce.return,Kt=Ut;break e}Kt=Ce.return}}if(sn=D,Bt(),oo&&typeof oo.onPostCommitFiberRoot=="function")try{oo.onPostCommitFiberRoot(Do,l)}catch{}A=!0}return A}finally{er=x,zi.transition=d}}return!1}function Po(l,d,x){d=Zu(x,d),d=Vc(l,d,1),l=dn(l,d,1),d=ko(),l!==null&&(Cn(l,1,d),go(l,d))}function si(l,d,x){if(l.tag===3)Po(l,l,x);else for(;d!==null;){if(d.tag===3){Po(d,l,x);break}else if(d.tag===1){var A=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(mo===null||!mo.has(A))){l=Zu(x,l),l=Hu(d,l,1),d=dn(d,l,1),l=ko(),d!==null&&(Cn(d,1,l),go(d,l));break}}d=d.return}}function Ip(l,d,x){var A=l.pingCache;A!==null&&A.delete(d),d=ko(),l.pingedLanes|=l.suspendedLanes&x,Si===l&&(Br&x)===x&&(ir===4||ir===3&&(Br&130023424)===Br&&500>Nr()-id?tc(l,0):Jl|=x),go(l,d)}function fg(l,d){d===0&&((l.mode&1)===0?d=1:(d=_l,_l<<=1,(_l&130023424)===0&&(_l=4194304)));var x=ko();l=rt(l,d),l!==null&&(Cn(l,d,x),go(l,x))}function s_(l){var d=l.memoizedState,x=0;d!==null&&(x=d.retryLane),fg(l,x)}function a_(l,d){var x=0;switch(l.tag){case 13:var A=l.stateNode,D=l.memoizedState;D!==null&&(x=D.retryLane);break;case 19:A=l.stateNode;break;default:throw Error(c(314))}A!==null&&A.delete(d),fg(l,x)}var pf;pf=function(l,d,x){if(l!==null)if(l.memoizedProps!==d.pendingProps||fo.current)ji=!0;else{if((l.lanes&x)===0&&(d.flags&128)===0)return ji=!1,Qh(l,d,x);ji=(l.flags&131072)!==0}else ji=!1,g&&(d.flags&1048576)!==0&&Fc(d,ql,d.index);switch(d.lanes=0,d.tag){case 2:var A=d.type;Jh(l,d),l=d.pendingProps;var D=Di(d,Li.current);qe(d,x),D=Zd(null,d,A,l,D,x);var U=Hd();return d.flags|=1,typeof D=="object"&&D!==null&&typeof D.render=="function"&&D.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,Ki(A)?(U=!0,Cs(d)):U=!1,d.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,ht(d),D.updater=Hl,d.stateNode=D,D._reactInternals=d,Yd(d,A,l,x),d=ds(null,d,A,!0,U,x)):(d.tag=0,g&&U&&ba(d),Lr(null,d,D,x),d=d.child),d;case 16:A=d.elementType;e:{switch(Jh(l,d),l=d.pendingProps,D=A._init,A=D(A._payload),d.type=A,D=d.tag=l_(A),l=cs(A,l),D){case 0:d=ef(null,d,A,l,x);break e;case 1:d=$c(null,d,A,l,x);break e;case 11:d=Uc(null,d,A,l,x);break e;case 14:d=Ji(null,d,A,cs(A.type,l),x);break e}throw Error(c(306,A,""))}return d;case 0:return A=d.type,D=d.pendingProps,D=d.elementType===A?D:cs(A,D),ef(l,d,A,D,x);case 1:return A=d.type,D=d.pendingProps,D=d.elementType===A?D:cs(A,D),$c(l,d,A,D,x);case 3:e:{if(og(d),l===null)throw Error(c(387));A=d.pendingProps,U=d.memoizedState,D=U.element,wt(l,d),Pn(d,A,null,x);var re=d.memoizedState;if(A=re.element,U.isDehydrated)if(U={element:A,isDehydrated:!1,cache:re.cache,pendingSuspenseBoundaries:re.pendingSuspenseBoundaries,transitions:re.transitions},d.updateQueue.baseState=U,d.memoizedState=U,d.flags&256){D=Zu(Error(c(423)),d),d=sg(l,d,A,x,D);break e}else if(A!==D){D=Zu(Error(c(424)),d),d=sg(l,d,A,x,D);break e}else for(u=Ss(d.stateNode.containerInfo.firstChild),r=d,g=!0,v=null,x=ve(d,null,A,x),d.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(ie(),A===D){d=Aa(l,d,x);break e}Lr(l,d,A,x)}d=d.child}return d;case 5:return Co(d),l===null&&L(d),A=d.type,D=d.pendingProps,U=l!==null?l.memoizedProps:null,re=D.children,jl(A,D)?re=null:U!==null&&jl(A,U)&&(d.flags|=32),Ur(l,d),Lr(l,d,re,x),d.child;case 6:return l===null&&L(d),null;case 13:return Kl(l,d,x);case 4:return bi(d,d.stateNode.containerInfo),A=d.pendingProps,l===null?d.child=ge(d,null,A,x):Lr(l,d,A,x),d.child;case 11:return A=d.type,D=d.pendingProps,D=d.elementType===A?D:cs(A,D),Uc(l,d,A,D,x);case 7:return Lr(l,d,d.pendingProps,x),d.child;case 8:return Lr(l,d,d.pendingProps.children,x),d.child;case 12:return Lr(l,d,d.pendingProps.children,x),d.child;case 10:e:{if(A=d.type._context,D=d.pendingProps,U=d.memoizedProps,re=D.value,qn(Pe,A._currentValue),A._currentValue=re,U!==null)if(jo(U.value,re)){if(U.children===D.children&&!fo.current){d=Aa(l,d,x);break e}}else for(U=d.child,U!==null&&(U.return=d);U!==null;){var Ce=U.dependencies;if(Ce!==null){re=U.child;for(var Oe=Ce.firstContext;Oe!==null;){if(Oe.context===A){if(U.tag===1){Oe=Jt(-1,x&-x),Oe.tag=2;var tt=U.updateQueue;if(tt!==null){tt=tt.shared;var Rt=tt.pending;Rt===null?Oe.next=Oe:(Oe.next=Rt.next,Rt.next=Oe),tt.pending=Oe}}U.lanes|=x,Oe=U.alternate,Oe!==null&&(Oe.lanes|=x),vt(U.return,x,d),Ce.lanes|=x;break}Oe=Oe.next}}else if(U.tag===10)re=U.type===d.type?null:U.child;else if(U.tag===18){if(re=U.return,re===null)throw Error(c(341));re.lanes|=x,Ce=re.alternate,Ce!==null&&(Ce.lanes|=x),vt(re,x,d),re=U.sibling}else re=U.child;if(re!==null)re.return=U;else for(re=U;re!==null;){if(re===d){re=null;break}if(U=re.sibling,U!==null){U.return=re.return,re=U;break}re=re.return}U=re}Lr(l,d,D.children,x),d=d.child}return d;case 9:return D=d.type,A=d.pendingProps.children,qe(d,x),D=nt(D),A=A(D),d.flags|=1,Lr(l,d,A,x),d.child;case 14:return A=d.type,D=cs(A,d.pendingProps),D=cs(A.type,D),Ji(l,d,A,D,x);case 15:return hs(l,d,d.type,d.pendingProps,x);case 17:return A=d.type,D=d.pendingProps,D=d.elementType===A?D:cs(A,D),Jh(l,d),d.tag=1,Ki(A)?(l=!0,Cs(d)):l=!1,qe(d,x),Kd(d,A,D),Yd(d,A,D,x),ds(null,d,A,!0,l,x);case 19:return lg(l,d,x);case 22:return Qd(l,d,x)}throw Error(c(156,d.tag))};function ld(l,d){return mh(l,d)}function pg(l,d,x,A){this.tag=l,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ui(l,d,x,A){return new pg(l,d,x,A)}function nc(l){return l=l.prototype,!(!l||!l.isReactComponent)}function l_(l){if(typeof l=="function")return nc(l)?1:0;if(l!=null){if(l=l.$$typeof,l===Lt)return 11;if(l===$n)return 14}return 2}function nu(l,d){var x=l.alternate;return x===null?(x=Ui(l.tag,d,l.key,l.mode),x.elementType=l.elementType,x.type=l.type,x.stateNode=l.stateNode,x.alternate=l,l.alternate=x):(x.pendingProps=d,x.type=l.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=l.flags&14680064,x.childLanes=l.childLanes,x.lanes=l.lanes,x.child=l.child,x.memoizedProps=l.memoizedProps,x.memoizedState=l.memoizedState,x.updateQueue=l.updateQueue,d=l.dependencies,x.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},x.sibling=l.sibling,x.index=l.index,x.ref=l.ref,x}function mf(l,d,x,A,D,U){var re=2;if(A=l,typeof l=="function")nc(l)&&(re=1);else if(typeof l=="string")re=5;else e:switch(l){case Se:return rc(x.children,D,U,d);case $e:re=8,D|=8;break;case dt:return l=Ui(12,x,d,D|2),l.elementType=dt,l.lanes=U,l;case lt:return l=Ui(13,x,d,D),l.elementType=lt,l.lanes=U,l;case zt:return l=Ui(19,x,d,D),l.elementType=zt,l.lanes=U,l;case fn:return gf(x,D,U,d);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case Y:re=10;break e;case pt:re=9;break e;case Lt:re=11;break e;case $n:re=14;break e;case ln:re=16,A=null;break e}throw Error(c(130,l==null?l:typeof l,""))}return d=Ui(re,x,d,D),d.elementType=l,d.type=A,d.lanes=U,d}function rc(l,d,x,A){return l=Ui(7,l,A,d),l.lanes=x,l}function gf(l,d,x,A){return l=Ui(22,l,A,d),l.elementType=fn,l.lanes=x,l.stateNode={isHidden:!1},l}function Rp(l,d,x){return l=Ui(6,l,null,d),l.lanes=x,l}function Lp(l,d,x){return d=Ui(4,l.children!==null?l.children:[],l.key,d),d.lanes=x,d.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},d}function Dp(l,d,x,A,D){this.tag=d,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vo(0),this.expirationTimes=vo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vo(0),this.identifierPrefix=A,this.onRecoverableError=D,this.mutableSourceEagerHydrationData=null}function zp(l,d,x,A,D,U,re,Ce,Oe){return l=new Dp(l,d,x,Ce,Oe),d===1?(d=1,U===!0&&(d|=8)):d=0,U=Ui(3,null,null,d),l.current=U,U.stateNode=l,U.memoizedState={element:A,isDehydrated:x,cache:null,transitions:null,pendingSuspenseBoundaries:null},ht(U),l}function Yc(l,d,x){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_e,key:A==null?null:""+A,children:l,containerInfo:d,implementation:x}}function mg(l){if(!l)return xa;l=l._reactInternals;e:{if(Cr(l)!==l||l.tag!==1)throw Error(c(170));var d=l;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(Ki(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(c(171))}if(l.tag===1){var x=l.type;if(Ki(x))return as(l,x,d)}return d}function Hr(l,d,x,A,D,U,re,Ce,Oe){return l=zp(x,A,!0,l,D,U,re,Ce,Oe),l.context=mg(null),x=l.current,A=ko(),D=Ia(x),U=Jt(A,D),U.callback=d??null,dn(x,U,D),l.current.lanes=D,Cn(l,D,A),go(l,A),l}function ic(l,d,x,A){var D=d.current,U=ko(),re=Ia(D);return x=mg(x),d.context===null?d.context=x:d.pendingContext=x,d=Jt(U,re),d.payload={element:l},A=A===void 0?null:A,A!==null&&(d.callback=A),l=dn(D,d,re),l!==null&&(ta(l,D,re,U),Zt(l,D,re)),re}function ud(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function cd(l,d){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var x=l.retryLane;l.retryLane=x!==0&&x<d?x:d}}function Jc(l,d){cd(l,d),(l=l.alternate)&&cd(l,d)}function hd(){return null}var Op=typeof reportError=="function"?reportError:function(l){console.error(l)};function yf(l){this._internalRoot=l}ru.prototype.render=yf.prototype.render=function(l){var d=this._internalRoot;if(d===null)throw Error(c(409));ic(l,d,null,null)},ru.prototype.unmount=yf.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var d=l.containerInfo;eu(function(){ic(null,l,null,null)}),d[ss]=null}};function ru(l){this._internalRoot=l}ru.prototype.unstable_scheduleHydration=function(l){if(l){var d=xl();l={blockedOn:null,target:l,priority:d};for(var x=0;x<dr.length&&d!==0&&d<dr[x].priority;x++);dr.splice(x,0,l),x===0&&vh(l)}};function dd(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Qc(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function _f(){}function u_(l,d,x,A,D){if(D){if(typeof A=="function"){var U=A;A=function(){var tt=ud(re);U.call(tt)}}var re=Hr(d,A,l,0,null,!1,!1,"",_f);return l._reactRootContainer=re,l[ss]=re.current,Gs(l.nodeType===8?l.parentNode:l),eu(),re}for(;D=l.lastChild;)l.removeChild(D);if(typeof A=="function"){var Ce=A;A=function(){var tt=ud(Oe);Ce.call(tt)}}var Oe=zp(l,0,!1,null,null,!1,!1,"",_f);return l._reactRootContainer=Oe,l[ss]=Oe.current,Gs(l.nodeType===8?l.parentNode:l),eu(function(){ic(d,Oe,x,A)}),Oe}function fd(l,d,x,A,D){var U=x._reactRootContainer;if(U){var re=U;if(typeof D=="function"){var Ce=D;D=function(){var Oe=ud(re);Ce.call(Oe)}}ic(d,re,l,D)}else re=u_(x,d,l,D,A);return ud(re)}_r=function(l){switch(l.tag){case 3:var d=l.stateNode;if(d.current.memoizedState.isDehydrated){var x=vl(d.pendingLanes);x!==0&&(Va(d,x|1),go(d,Nr()),(sn&6)===0&&(Xc=Nr()+500,Bt()))}break;case 13:eu(function(){var A=rt(l,1);if(A!==null){var D=ko();ta(A,l,1,D)}}),Jc(l,1)}},yc=function(l){if(l.tag===13){var d=rt(l,134217728);if(d!==null){var x=ko();ta(d,l,134217728,x)}Jc(l,134217728)}},vs=function(l){if(l.tag===13){var d=Ia(l),x=rt(l,d);if(x!==null){var A=ko();ta(x,l,d,A)}Jc(l,d)}},xl=function(){return er},wl=function(l,d){var x=er;try{return er=l,d()}finally{er=x}},we=function(l,d,x){switch(d){case"input":if(jn(l,x),d=x.name,x.type==="radio"&&d!=null){for(x=l;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<x.length;d++){var A=x[d];if(A!==l&&A.form===l.form){var D=zc(A);if(!D)throw Error(c(90));Xt(A),jn(A,D)}}}break;case"textarea":Ri(l,x);break;case"select":d=x.value,d!=null&&Ii(l,!!x.multiple,d,!1)}},Ve=Kc,Ge=eu;var pd={usingClientEntryPoint:!1,Events:[Ul,Qa,zc,Ae,De,Kc]},md={findFiberByHostInstance:ho,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Bp={bundleType:md.bundleType,version:md.version,rendererPackageName:md.rendererPackageName,rendererConfig:md.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:me.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=ja(l),l===null?null:l.stateNode},findFiberByHostInstance:md.findFiberByHostInstance||hd,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vf.isDisabled&&vf.supportsFiber)try{Do=vf.inject(Bp),oo=vf}catch{}}return Ds.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pd,Ds.createPortal=function(l,d){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dd(d))throw Error(c(200));return Yc(l,d,null,x)},Ds.createRoot=function(l,d){if(!dd(l))throw Error(c(299));var x=!1,A="",D=Op;return d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(A=d.identifierPrefix),d.onRecoverableError!==void 0&&(D=d.onRecoverableError)),d=zp(l,1,!1,null,null,x,!1,A,D),l[ss]=d.current,Gs(l.nodeType===8?l.parentNode:l),new yf(d)},Ds.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var d=l._reactInternals;if(d===void 0)throw typeof l.render=="function"?Error(c(188)):(l=Object.keys(l).join(","),Error(c(268,l)));return l=ja(d),l=l===null?null:l.stateNode,l},Ds.flushSync=function(l){return eu(l)},Ds.hydrate=function(l,d,x){if(!Qc(d))throw Error(c(200));return fd(null,l,d,!0,x)},Ds.hydrateRoot=function(l,d,x){if(!dd(l))throw Error(c(405));var A=x!=null&&x.hydratedSources||null,D=!1,U="",re=Op;if(x!=null&&(x.unstable_strictMode===!0&&(D=!0),x.identifierPrefix!==void 0&&(U=x.identifierPrefix),x.onRecoverableError!==void 0&&(re=x.onRecoverableError)),d=Hr(d,null,l,1,x??null,D,!1,U,re),l[ss]=d.current,Gs(l),A)for(l=0;l<A.length;l++)x=A[l],D=x._getVersion,D=D(x._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[x,D]:d.mutableSourceEagerHydrationData.push(x,D);return new ru(d)},Ds.render=function(l,d,x){if(!Qc(d))throw Error(c(200));return fd(null,l,d,!1,x)},Ds.unmountComponentAtNode=function(l){if(!Qc(l))throw Error(c(40));return l._reactRootContainer?(eu(function(){fd(null,null,l,!1,function(){l._reactRootContainer=null,l[ss]=null})}),!0):!1},Ds.unstable_batchedUpdates=Kc,Ds.unstable_renderSubtreeIntoContainer=function(l,d,x,A){if(!Qc(x))throw Error(c(200));if(l==null||l._reactInternals===void 0)throw Error(c(38));return fd(l,d,x,!1,A)},Ds.version="18.3.1-next-f1338f8080-20240426",Ds}var dw;function UM(){if(dw)return U_.exports;dw=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(s){console.error(s)}}return i(),U_.exports=VM(),U_.exports}var fw;function $M(){if(fw)return Bg;fw=1;var i=UM();return Bg.createRoot=i.createRoot,Bg.hydrateRoot=i.hydrateRoot,Bg}var GM=$M();const qM=Ay(GM),R0=Ee.createContext({});function L0(i){const s=Ee.useRef(null);return s.current===null&&(s.current=i()),s.current}const D0=typeof window<"u",uE=D0?Ee.useLayoutEffect:Ee.useEffect,My=Ee.createContext(null),z0=Ee.createContext({transformPagePoint:i=>i,isStatic:!1,reducedMotion:"never"});class WM extends Ee.Component{getSnapshotBeforeUpdate(s){const c=this.props.childRef.current;if(c&&s.isPresent&&!this.props.isPresent){const p=c.offsetParent,_=p instanceof HTMLElement&&p.offsetWidth||0,T=this.props.sizeRef.current;T.height=c.offsetHeight||0,T.width=c.offsetWidth||0,T.top=c.offsetTop,T.left=c.offsetLeft,T.right=_-T.width-T.left}return null}componentDidUpdate(){}render(){return this.props.children}}function ZM({children:i,isPresent:s,anchorX:c}){const p=Ee.useId(),_=Ee.useRef(null),T=Ee.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:S}=Ee.useContext(z0);return Ee.useInsertionEffect(()=>{const{width:k,height:o,top:I,left:O,right:V}=T.current;if(s||!_.current||!k||!o)return;const q=c==="left"?`left: ${O}`:`right: ${V}`;_.current.dataset.motionPopId=p;const ee=document.createElement("style");return S&&(ee.nonce=S),document.head.appendChild(ee),ee.sheet&&ee.sheet.insertRule(`
          [data-motion-pop-id="${p}"] {
            position: absolute !important;
            width: ${k}px !important;
            height: ${o}px !important;
            ${q}px !important;
            top: ${I}px !important;
          }
        `),()=>{document.head.removeChild(ee)}},[s]),Be.jsx(WM,{isPresent:s,childRef:_,sizeRef:T,children:Ee.cloneElement(i,{ref:_})})}const HM=({children:i,initial:s,isPresent:c,onExitComplete:p,custom:_,presenceAffectsLayout:T,mode:S,anchorX:k})=>{const o=L0(XM),I=Ee.useId();let O=!0,V=Ee.useMemo(()=>(O=!1,{id:I,initial:s,isPresent:c,custom:_,onExitComplete:q=>{o.set(q,!0);for(const ee of o.values())if(!ee)return;p&&p()},register:q=>(o.set(q,!1),()=>o.delete(q))}),[c,o,p]);return T&&O&&(V={...V}),Ee.useMemo(()=>{o.forEach((q,ee)=>o.set(ee,!1))},[c]),Ee.useEffect(()=>{!c&&!o.size&&p&&p()},[c]),S==="popLayout"&&(i=Be.jsx(ZM,{isPresent:c,anchorX:k,children:i})),Be.jsx(My.Provider,{value:V,children:i})};function XM(){return new Map}function cE(i=!0){const s=Ee.useContext(My);if(s===null)return[!0,null];const{isPresent:c,onExitComplete:p,register:_}=s,T=Ee.useId();Ee.useEffect(()=>{if(i)return _(T)},[i]);const S=Ee.useCallback(()=>i&&p&&p(T),[T,p,i]);return!c&&p?[!1,S]:[!0]}const Fg=i=>i.key||"";function pw(i){const s=[];return Ee.Children.forEach(i,c=>{Ee.isValidElement(c)&&s.push(c)}),s}const hE=({children:i,custom:s,initial:c=!0,onExitComplete:p,presenceAffectsLayout:_=!0,mode:T="sync",propagate:S=!1,anchorX:k="left"})=>{const[o,I]=cE(S),O=Ee.useMemo(()=>pw(i),[i]),V=S&&!o?[]:O.map(Fg),q=Ee.useRef(!0),ee=Ee.useRef(O),H=L0(()=>new Map),[j,Z]=Ee.useState(O),[ne,xe]=Ee.useState(O);uE(()=>{q.current=!1,ee.current=O;for(let de=0;de<ne.length;de++){const _e=Fg(ne[de]);V.includes(_e)?H.delete(_e):H.get(_e)!==!0&&H.set(_e,!1)}},[ne,V.length,V.join("-")]);const ce=[];if(O!==j){let de=[...O];for(let _e=0;_e<ne.length;_e++){const Se=ne[_e],$e=Fg(Se);V.includes($e)||(de.splice(_e,0,Se),ce.push(Se))}return T==="wait"&&ce.length&&(de=ce),xe(pw(de)),Z(O),null}const{forceRender:me}=Ee.useContext(R0);return Be.jsx(Be.Fragment,{children:ne.map(de=>{const _e=Fg(de),Se=S&&!o?!1:O===ne||V.includes(_e),$e=()=>{if(H.has(_e))H.set(_e,!0);else return;let dt=!0;H.forEach(Y=>{Y||(dt=!1)}),dt&&(me==null||me(),xe(ee.current),S&&(I==null||I()),p&&p())};return Be.jsx(HM,{isPresent:Se,initial:!q.current||c?void 0:!1,custom:s,presenceAffectsLayout:_,mode:T,onExitComplete:Se?void 0:$e,anchorX:k,children:de},_e)})})};function O0(i,s){i.indexOf(s)===-1&&i.push(s)}function B0(i,s){const c=i.indexOf(s);c>-1&&i.splice(c,1)}const hc=(i,s,c)=>c>s?s:c<i?i:c;let F0=()=>{};const dc={},dE=i=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(i),fE=i=>/^0[^.\s]+$/u.test(i);function N0(i){let s;return()=>(s===void 0&&(s=i()),s)}const Ba=i=>i,KM=(i,s)=>c=>s(i(c)),zm=(...i)=>i.reduce(KM),vm=(i,s,c)=>{const p=s-i;return p===0?1:(c-i)/p};class j0{constructor(){this.subscriptions=[]}add(s){return O0(this.subscriptions,s),()=>B0(this.subscriptions,s)}notify(s,c,p){const _=this.subscriptions.length;if(_)if(_===1)this.subscriptions[0](s,c,p);else for(let T=0;T<_;T++){const S=this.subscriptions[T];S&&S(s,c,p)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const fu=i=>i*1e3,pu=i=>i/1e3;function pE(i,s){return s?i*(1e3/s):0}const mE=(i,s,c)=>(((1-3*c+3*s)*i+(3*c-6*s))*i+3*s)*i,YM=1e-7,JM=12;function QM(i,s,c,p,_){let T,S,k=0;do S=s+(c-s)/2,T=mE(S,p,_)-i,T>0?c=S:s=S;while(Math.abs(T)>YM&&++k<JM);return S}function Om(i,s,c,p){if(i===s&&c===p)return Ba;const _=T=>QM(T,0,1,i,c);return T=>T===0||T===1?T:mE(_(T),s,p)}const gE=i=>s=>s<=.5?i(2*s)/2:(2-i(2*(1-s)))/2,yE=i=>s=>1-i(1-s),_E=Om(.33,1.53,.69,.99),V0=yE(_E),vE=gE(V0),xE=i=>(i*=2)<1?.5*V0(i):.5*(2-Math.pow(2,-10*(i-1))),U0=i=>1-Math.sin(Math.acos(i)),wE=yE(U0),bE=gE(U0),ek=Om(.42,0,1,1),tk=Om(0,0,.58,1),TE=Om(.42,0,.58,1),nk=i=>Array.isArray(i)&&typeof i[0]!="number",EE=i=>Array.isArray(i)&&typeof i[0]=="number",rk={linear:Ba,easeIn:ek,easeInOut:TE,easeOut:tk,circIn:U0,circInOut:bE,circOut:wE,backIn:V0,backInOut:vE,backOut:_E,anticipate:xE},ik=i=>typeof i=="string",mw=i=>{if(EE(i)){F0(i.length===4);const[s,c,p,_]=i;return Om(s,c,p,_)}else if(ik(i))return rk[i];return i},Ng=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],gw={value:null};function ok(i,s){let c=new Set,p=new Set,_=!1,T=!1;const S=new WeakSet;let k={delta:0,timestamp:0,isProcessing:!1},o=0;function I(V){S.has(V)&&(O.schedule(V),i()),o++,V(k)}const O={schedule:(V,q=!1,ee=!1)=>{const j=ee&&_?c:p;return q&&S.add(V),j.has(V)||j.add(V),V},cancel:V=>{p.delete(V),S.delete(V)},process:V=>{if(k=V,_){T=!0;return}_=!0,[c,p]=[p,c],c.forEach(I),s&&gw.value&&gw.value.frameloop[s].push(o),o=0,c.clear(),_=!1,T&&(T=!1,O.process(V))}};return O}const sk=40;function SE(i,s){let c=!1,p=!0;const _={delta:0,timestamp:0,isProcessing:!1},T=()=>c=!0,S=Ng.reduce((ce,me)=>(ce[me]=ok(T,s?me:void 0),ce),{}),{setup:k,read:o,resolveKeyframes:I,preUpdate:O,update:V,preRender:q,render:ee,postRender:H}=S,j=()=>{const ce=dc.useManualTiming?_.timestamp:performance.now();c=!1,dc.useManualTiming||(_.delta=p?1e3/60:Math.max(Math.min(ce-_.timestamp,sk),1)),_.timestamp=ce,_.isProcessing=!0,k.process(_),o.process(_),I.process(_),O.process(_),V.process(_),q.process(_),ee.process(_),H.process(_),_.isProcessing=!1,c&&s&&(p=!1,i(j))},Z=()=>{c=!0,p=!0,_.isProcessing||i(j)};return{schedule:Ng.reduce((ce,me)=>{const de=S[me];return ce[me]=(_e,Se=!1,$e=!1)=>(c||Z(),de.schedule(_e,Se,$e)),ce},{}),cancel:ce=>{for(let me=0;me<Ng.length;me++)S[Ng[me]].cancel(ce)},state:_,steps:S}}const{schedule:gi,cancel:ch,state:Io,steps:q_}=SE(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ba,!0);let Yg;function ak(){Yg=void 0}const zs={now:()=>(Yg===void 0&&zs.set(Io.isProcessing||dc.useManualTiming?Io.timestamp:performance.now()),Yg),set:i=>{Yg=i,queueMicrotask(ak)}},CE=i=>s=>typeof s=="string"&&s.startsWith(i),$0=CE("--"),lk=CE("var(--"),G0=i=>lk(i)?uk.test(i.split("/*")[0].trim()):!1,uk=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Kf={test:i=>typeof i=="number",parse:parseFloat,transform:i=>i},xm={...Kf,transform:i=>hc(0,1,i)},jg={...Kf,default:1},fm=i=>Math.round(i*1e5)/1e5,q0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function ck(i){return i==null}const hk=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,W0=(i,s)=>c=>!!(typeof c=="string"&&hk.test(c)&&c.startsWith(i)||s&&!ck(c)&&Object.prototype.hasOwnProperty.call(c,s)),AE=(i,s,c)=>p=>{if(typeof p!="string")return p;const[_,T,S,k]=p.match(q0);return{[i]:parseFloat(_),[s]:parseFloat(T),[c]:parseFloat(S),alpha:k!==void 0?parseFloat(k):1}},dk=i=>hc(0,255,i),W_={...Kf,transform:i=>Math.round(dk(i))},bd={test:W0("rgb","red"),parse:AE("red","green","blue"),transform:({red:i,green:s,blue:c,alpha:p=1})=>"rgba("+W_.transform(i)+", "+W_.transform(s)+", "+W_.transform(c)+", "+fm(xm.transform(p))+")"};function fk(i){let s="",c="",p="",_="";return i.length>5?(s=i.substring(1,3),c=i.substring(3,5),p=i.substring(5,7),_=i.substring(7,9)):(s=i.substring(1,2),c=i.substring(2,3),p=i.substring(3,4),_=i.substring(4,5),s+=s,c+=c,p+=p,_+=_),{red:parseInt(s,16),green:parseInt(c,16),blue:parseInt(p,16),alpha:_?parseInt(_,16)/255:1}}const Kv={test:W0("#"),parse:fk,transform:bd.transform},Bm=i=>({test:s=>typeof s=="string"&&s.endsWith(i)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${i}`}),lh=Bm("deg"),mu=Bm("%"),On=Bm("px"),pk=Bm("vh"),mk=Bm("vw"),yw={...mu,parse:i=>mu.parse(i)/100,transform:i=>mu.transform(i*100)},Nf={test:W0("hsl","hue"),parse:AE("hue","saturation","lightness"),transform:({hue:i,saturation:s,lightness:c,alpha:p=1})=>"hsla("+Math.round(i)+", "+mu.transform(fm(s))+", "+mu.transform(fm(c))+", "+fm(xm.transform(p))+")"},Jo={test:i=>bd.test(i)||Kv.test(i)||Nf.test(i),parse:i=>bd.test(i)?bd.parse(i):Nf.test(i)?Nf.parse(i):Kv.parse(i),transform:i=>typeof i=="string"?i:i.hasOwnProperty("red")?bd.transform(i):Nf.transform(i)},gk=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function yk(i){var s,c;return isNaN(i)&&typeof i=="string"&&(((s=i.match(q0))==null?void 0:s.length)||0)+(((c=i.match(gk))==null?void 0:c.length)||0)>0}const ME="number",kE="color",_k="var",vk="var(",_w="${}",xk=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function wm(i){const s=i.toString(),c=[],p={color:[],number:[],var:[]},_=[];let T=0;const k=s.replace(xk,o=>(Jo.test(o)?(p.color.push(T),_.push(kE),c.push(Jo.parse(o))):o.startsWith(vk)?(p.var.push(T),_.push(_k),c.push(o)):(p.number.push(T),_.push(ME),c.push(parseFloat(o))),++T,_w)).split(_w);return{values:c,split:k,indexes:p,types:_}}function PE(i){return wm(i).values}function IE(i){const{split:s,types:c}=wm(i),p=s.length;return _=>{let T="";for(let S=0;S<p;S++)if(T+=s[S],_[S]!==void 0){const k=c[S];k===ME?T+=fm(_[S]):k===kE?T+=Jo.transform(_[S]):T+=_[S]}return T}}const wk=i=>typeof i=="number"?0:i;function bk(i){const s=PE(i);return IE(i)(s.map(wk))}const hh={test:yk,parse:PE,createTransformer:IE,getAnimatableNone:bk};function Z_(i,s,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?i+(s-i)*6*c:c<1/2?s:c<2/3?i+(s-i)*(2/3-c)*6:i}function Tk({hue:i,saturation:s,lightness:c,alpha:p}){i/=360,s/=100,c/=100;let _=0,T=0,S=0;if(!s)_=T=S=c;else{const k=c<.5?c*(1+s):c+s-c*s,o=2*c-k;_=Z_(o,k,i+1/3),T=Z_(o,k,i),S=Z_(o,k,i-1/3)}return{red:Math.round(_*255),green:Math.round(T*255),blue:Math.round(S*255),alpha:p}}function py(i,s){return c=>c>0?s:i}const mi=(i,s,c)=>i+(s-i)*c,H_=(i,s,c)=>{const p=i*i,_=c*(s*s-p)+p;return _<0?0:Math.sqrt(_)},Ek=[Kv,bd,Nf],Sk=i=>Ek.find(s=>s.test(i));function vw(i){const s=Sk(i);if(!s)return!1;let c=s.parse(i);return s===Nf&&(c=Tk(c)),c}const xw=(i,s)=>{const c=vw(i),p=vw(s);if(!c||!p)return py(i,s);const _={...c};return T=>(_.red=H_(c.red,p.red,T),_.green=H_(c.green,p.green,T),_.blue=H_(c.blue,p.blue,T),_.alpha=mi(c.alpha,p.alpha,T),bd.transform(_))},Yv=new Set(["none","hidden"]);function Ck(i,s){return Yv.has(i)?c=>c<=0?i:s:c=>c>=1?s:i}function Ak(i,s){return c=>mi(i,s,c)}function Z0(i){return typeof i=="number"?Ak:typeof i=="string"?G0(i)?py:Jo.test(i)?xw:Pk:Array.isArray(i)?RE:typeof i=="object"?Jo.test(i)?xw:Mk:py}function RE(i,s){const c=[...i],p=c.length,_=i.map((T,S)=>Z0(T)(T,s[S]));return T=>{for(let S=0;S<p;S++)c[S]=_[S](T);return c}}function Mk(i,s){const c={...i,...s},p={};for(const _ in c)i[_]!==void 0&&s[_]!==void 0&&(p[_]=Z0(i[_])(i[_],s[_]));return _=>{for(const T in p)c[T]=p[T](_);return c}}function kk(i,s){const c=[],p={color:0,var:0,number:0};for(let _=0;_<s.values.length;_++){const T=s.types[_],S=i.indexes[T][p[T]],k=i.values[S]??0;c[_]=k,p[T]++}return c}const Pk=(i,s)=>{const c=hh.createTransformer(s),p=wm(i),_=wm(s);return p.indexes.var.length===_.indexes.var.length&&p.indexes.color.length===_.indexes.color.length&&p.indexes.number.length>=_.indexes.number.length?Yv.has(i)&&!_.values.length||Yv.has(s)&&!p.values.length?Ck(i,s):zm(RE(kk(p,_),_.values),c):py(i,s)};function LE(i,s,c){return typeof i=="number"&&typeof s=="number"&&typeof c=="number"?mi(i,s,c):Z0(i)(i,s)}const Ik=i=>{const s=({timestamp:c})=>i(c);return{start:()=>gi.update(s,!0),stop:()=>ch(s),now:()=>Io.isProcessing?Io.timestamp:zs.now()}},DE=(i,s,c=10)=>{let p="";const _=Math.max(Math.round(s/c),2);for(let T=0;T<_;T++)p+=i(T/(_-1))+", ";return`linear(${p.substring(0,p.length-2)})`},my=2e4;function H0(i){let s=0;const c=50;let p=i.next(s);for(;!p.done&&s<my;)s+=c,p=i.next(s);return s>=my?1/0:s}function Rk(i,s=100,c){const p=c({...i,keyframes:[0,s]}),_=Math.min(H0(p),my);return{type:"keyframes",ease:T=>p.next(_*T).value/s,duration:pu(_)}}const Lk=5;function zE(i,s,c){const p=Math.max(s-Lk,0);return pE(c-i(p),s-p)}const ki={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ww=.001;function Dk({duration:i=ki.duration,bounce:s=ki.bounce,velocity:c=ki.velocity,mass:p=ki.mass}){let _,T,S=1-s;S=hc(ki.minDamping,ki.maxDamping,S),i=hc(ki.minDuration,ki.maxDuration,pu(i)),S<1?(_=I=>{const O=I*S,V=O*i,q=O-c,ee=Jv(I,S),H=Math.exp(-V);return ww-q/ee*H},T=I=>{const V=I*S*i,q=V*c+c,ee=Math.pow(S,2)*Math.pow(I,2)*i,H=Math.exp(-V),j=Jv(Math.pow(I,2),S);return(-_(I)+ww>0?-1:1)*((q-ee)*H)/j}):(_=I=>{const O=Math.exp(-I*i),V=(I-c)*i+1;return-.001+O*V},T=I=>{const O=Math.exp(-I*i),V=(c-I)*(i*i);return O*V});const k=5/i,o=Ok(_,T,k);if(i=fu(i),isNaN(o))return{stiffness:ki.stiffness,damping:ki.damping,duration:i};{const I=Math.pow(o,2)*p;return{stiffness:I,damping:S*2*Math.sqrt(p*I),duration:i}}}const zk=12;function Ok(i,s,c){let p=c;for(let _=1;_<zk;_++)p=p-i(p)/s(p);return p}function Jv(i,s){return i*Math.sqrt(1-s*s)}const Bk=["duration","bounce"],Fk=["stiffness","damping","mass"];function bw(i,s){return s.some(c=>i[c]!==void 0)}function Nk(i){let s={velocity:ki.velocity,stiffness:ki.stiffness,damping:ki.damping,mass:ki.mass,isResolvedFromDuration:!1,...i};if(!bw(i,Fk)&&bw(i,Bk))if(i.visualDuration){const c=i.visualDuration,p=2*Math.PI/(c*1.2),_=p*p,T=2*hc(.05,1,1-(i.bounce||0))*Math.sqrt(_);s={...s,mass:ki.mass,stiffness:_,damping:T}}else{const c=Dk(i);s={...s,...c,mass:ki.mass},s.isResolvedFromDuration=!0}return s}function gy(i=ki.visualDuration,s=ki.bounce){const c=typeof i!="object"?{visualDuration:i,keyframes:[0,1],bounce:s}:i;let{restSpeed:p,restDelta:_}=c;const T=c.keyframes[0],S=c.keyframes[c.keyframes.length-1],k={done:!1,value:T},{stiffness:o,damping:I,mass:O,duration:V,velocity:q,isResolvedFromDuration:ee}=Nk({...c,velocity:-pu(c.velocity||0)}),H=q||0,j=I/(2*Math.sqrt(o*O)),Z=S-T,ne=pu(Math.sqrt(o/O)),xe=Math.abs(Z)<5;p||(p=xe?ki.restSpeed.granular:ki.restSpeed.default),_||(_=xe?ki.restDelta.granular:ki.restDelta.default);let ce;if(j<1){const de=Jv(ne,j);ce=_e=>{const Se=Math.exp(-j*ne*_e);return S-Se*((H+j*ne*Z)/de*Math.sin(de*_e)+Z*Math.cos(de*_e))}}else if(j===1)ce=de=>S-Math.exp(-ne*de)*(Z+(H+ne*Z)*de);else{const de=ne*Math.sqrt(j*j-1);ce=_e=>{const Se=Math.exp(-j*ne*_e),$e=Math.min(de*_e,300);return S-Se*((H+j*ne*Z)*Math.sinh($e)+de*Z*Math.cosh($e))/de}}const me={calculatedDuration:ee&&V||null,next:de=>{const _e=ce(de);if(ee)k.done=de>=V;else{let Se=de===0?H:0;j<1&&(Se=de===0?fu(H):zE(ce,de,_e));const $e=Math.abs(Se)<=p,dt=Math.abs(S-_e)<=_;k.done=$e&&dt}return k.value=k.done?S:_e,k},toString:()=>{const de=Math.min(H0(me),my),_e=DE(Se=>me.next(de*Se).value,de,30);return de+"ms "+_e},toTransition:()=>{}};return me}gy.applyToOptions=i=>{const s=Rk(i,100,gy);return i.ease=s.ease,i.duration=fu(s.duration),i.type="keyframes",i};function Qv({keyframes:i,velocity:s=0,power:c=.8,timeConstant:p=325,bounceDamping:_=10,bounceStiffness:T=500,modifyTarget:S,min:k,max:o,restDelta:I=.5,restSpeed:O}){const V=i[0],q={done:!1,value:V},ee=$e=>k!==void 0&&$e<k||o!==void 0&&$e>o,H=$e=>k===void 0?o:o===void 0||Math.abs(k-$e)<Math.abs(o-$e)?k:o;let j=c*s;const Z=V+j,ne=S===void 0?Z:S(Z);ne!==Z&&(j=ne-V);const xe=$e=>-j*Math.exp(-$e/p),ce=$e=>ne+xe($e),me=$e=>{const dt=xe($e),Y=ce($e);q.done=Math.abs(dt)<=I,q.value=q.done?ne:Y};let de,_e;const Se=$e=>{ee(q.value)&&(de=$e,_e=gy({keyframes:[q.value,H(q.value)],velocity:zE(ce,$e,q.value),damping:_,stiffness:T,restDelta:I,restSpeed:O}))};return Se(0),{calculatedDuration:null,next:$e=>{let dt=!1;return!_e&&de===void 0&&(dt=!0,me($e),Se($e)),de!==void 0&&$e>=de?_e.next($e-de):(!dt&&me($e),q)}}}function jk(i,s,c){const p=[],_=c||dc.mix||LE,T=i.length-1;for(let S=0;S<T;S++){let k=_(i[S],i[S+1]);if(s){const o=Array.isArray(s)?s[S]||Ba:s;k=zm(o,k)}p.push(k)}return p}function Vk(i,s,{clamp:c=!0,ease:p,mixer:_}={}){const T=i.length;if(F0(T===s.length),T===1)return()=>s[0];if(T===2&&s[0]===s[1])return()=>s[1];const S=i[0]===i[1];i[0]>i[T-1]&&(i=[...i].reverse(),s=[...s].reverse());const k=jk(s,p,_),o=k.length,I=O=>{if(S&&O<i[0])return s[0];let V=0;if(o>1)for(;V<i.length-2&&!(O<i[V+1]);V++);const q=vm(i[V],i[V+1],O);return k[V](q)};return c?O=>I(hc(i[0],i[T-1],O)):I}function Uk(i,s){const c=i[i.length-1];for(let p=1;p<=s;p++){const _=vm(0,s,p);i.push(mi(c,1,_))}}function $k(i){const s=[0];return Uk(s,i.length-1),s}function Gk(i,s){return i.map(c=>c*s)}function qk(i,s){return i.map(()=>s||TE).splice(0,i.length-1)}function pm({duration:i=300,keyframes:s,times:c,ease:p="easeInOut"}){const _=nk(p)?p.map(mw):mw(p),T={done:!1,value:s[0]},S=Gk(c&&c.length===s.length?c:$k(s),i),k=Vk(S,s,{ease:Array.isArray(_)?_:qk(s,_)});return{calculatedDuration:i,next:o=>(T.value=k(o),T.done=o>=i,T)}}const Wk=i=>i!==null;function X0(i,{repeat:s,repeatType:c="loop"},p,_=1){const T=i.filter(Wk),k=_<0||s&&c!=="loop"&&s%2===1?0:T.length-1;return!k||p===void 0?T[k]:p}const Zk={decay:Qv,inertia:Qv,tween:pm,keyframes:pm,spring:gy};function OE(i){typeof i.type=="string"&&(i.type=Zk[i.type])}class K0{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,c){return this.finished.then(s,c)}}const Hk=i=>i/100;class BE extends K0{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:c}=this.options;if(c&&c.updatedAt!==zs.now()&&this.tick(zs.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:p}=this.options;p&&p()},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;OE(s);const{type:c=pm,repeat:p=0,repeatDelay:_=0,repeatType:T,velocity:S=0}=s;let{keyframes:k}=s;const o=c||pm;o!==pm&&typeof k[0]!="number"&&(this.mixKeyframes=zm(Hk,LE(k[0],k[1])),k=[0,100]);const I=o({...s,keyframes:k});T==="mirror"&&(this.mirroredGenerator=o({...s,keyframes:[...k].reverse(),velocity:-S})),I.calculatedDuration===null&&(I.calculatedDuration=H0(I));const{calculatedDuration:O}=I;this.calculatedDuration=O,this.resolvedDuration=O+_,this.totalDuration=this.resolvedDuration*(p+1)-_,this.generator=I}updateTime(s){const c=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=c}tick(s,c=!1){const{generator:p,totalDuration:_,mixKeyframes:T,mirroredGenerator:S,resolvedDuration:k,calculatedDuration:o}=this;if(this.startTime===null)return p.next(0);const{delay:I=0,keyframes:O,repeat:V,repeatType:q,repeatDelay:ee,type:H,onUpdate:j,finalKeyframe:Z}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-_/this.speed,this.startTime)),c?this.currentTime=s:this.updateTime(s);const ne=this.currentTime-I*(this.playbackSpeed>=0?1:-1),xe=this.playbackSpeed>=0?ne<0:ne>_;this.currentTime=Math.max(ne,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=_);let ce=this.currentTime,me=p;if(V){const $e=Math.min(this.currentTime,_)/k;let dt=Math.floor($e),Y=$e%1;!Y&&$e>=1&&(Y=1),Y===1&&dt--,dt=Math.min(dt,V+1),!!(dt%2)&&(q==="reverse"?(Y=1-Y,ee&&(Y-=ee/k)):q==="mirror"&&(me=S)),ce=hc(0,1,Y)*k}const de=xe?{done:!1,value:O[0]}:me.next(ce);T&&(de.value=T(de.value));let{done:_e}=de;!xe&&o!==null&&(_e=this.playbackSpeed>=0?this.currentTime>=_:this.currentTime<=0);const Se=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&_e);return Se&&H!==Qv&&(de.value=X0(O,this.options,Z,this.speed)),j&&j(de.value),Se&&this.finish(),de}then(s,c){return this.finished.then(s,c)}get duration(){return pu(this.calculatedDuration)}get time(){return pu(this.currentTime)}set time(s){s=fu(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(zs.now());const c=this.playbackSpeed!==s;this.playbackSpeed=s,c&&(this.time=pu(this.currentTime))}play(){if(this.isStopped)return;const{driver:s=Ik,onPlay:c,startTime:p}=this.options;this.driver||(this.driver=s(T=>this.tick(T))),c&&c();const _=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=_):this.holdTime!==null?this.startTime=_-this.holdTime:this.startTime||(this.startTime=p??_),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(zs.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:s}=this.options;s&&s()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),s.observe(this)}}function Xk(i){for(let s=1;s<i.length;s++)i[s]??(i[s]=i[s-1])}const Td=i=>i*180/Math.PI,e0=i=>{const s=Td(Math.atan2(i[1],i[0]));return t0(s)},Kk={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:i=>(Math.abs(i[0])+Math.abs(i[3]))/2,rotate:e0,rotateZ:e0,skewX:i=>Td(Math.atan(i[1])),skewY:i=>Td(Math.atan(i[2])),skew:i=>(Math.abs(i[1])+Math.abs(i[2]))/2},t0=i=>(i=i%360,i<0&&(i+=360),i),Tw=e0,Ew=i=>Math.sqrt(i[0]*i[0]+i[1]*i[1]),Sw=i=>Math.sqrt(i[4]*i[4]+i[5]*i[5]),Yk={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Ew,scaleY:Sw,scale:i=>(Ew(i)+Sw(i))/2,rotateX:i=>t0(Td(Math.atan2(i[6],i[5]))),rotateY:i=>t0(Td(Math.atan2(-i[2],i[0]))),rotateZ:Tw,rotate:Tw,skewX:i=>Td(Math.atan(i[4])),skewY:i=>Td(Math.atan(i[1])),skew:i=>(Math.abs(i[1])+Math.abs(i[4]))/2};function Cw(i){return i.includes("scale")?1:0}function n0(i,s){if(!i||i==="none")return Cw(s);const c=i.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let p,_;if(c)p=Yk,_=c;else{const k=i.match(/^matrix\(([-\d.e\s,]+)\)$/u);p=Kk,_=k}if(!_)return Cw(s);const T=p[s],S=_[1].split(",").map(Qk);return typeof T=="function"?T(S):S[T]}const Jk=(i,s)=>{const{transform:c="none"}=getComputedStyle(i);return n0(c,s)};function Qk(i){return parseFloat(i.trim())}const Yf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Jf=new Set(Yf),Aw=i=>i===Kf||i===On,eP=new Set(["x","y","z"]),tP=Yf.filter(i=>!eP.has(i));function nP(i){const s=[];return tP.forEach(c=>{const p=i.getValue(c);p!==void 0&&(s.push([c,p.get()]),p.set(c.startsWith("scale")?1:0))}),s}const Wf={width:({x:i},{paddingLeft:s="0",paddingRight:c="0"})=>i.max-i.min-parseFloat(s)-parseFloat(c),height:({y:i},{paddingTop:s="0",paddingBottom:c="0"})=>i.max-i.min-parseFloat(s)-parseFloat(c),top:(i,{top:s})=>parseFloat(s),left:(i,{left:s})=>parseFloat(s),bottom:({y:i},{top:s})=>parseFloat(s)+(i.max-i.min),right:({x:i},{left:s})=>parseFloat(s)+(i.max-i.min),x:(i,{transform:s})=>n0(s,"x"),y:(i,{transform:s})=>n0(s,"y")};Wf.translateX=Wf.x;Wf.translateY=Wf.y;const Sd=new Set;let r0=!1,i0=!1,o0=!1;function FE(){if(i0){const i=Array.from(Sd).filter(p=>p.needsMeasurement),s=new Set(i.map(p=>p.element)),c=new Map;s.forEach(p=>{const _=nP(p);_.length&&(c.set(p,_),p.render())}),i.forEach(p=>p.measureInitialState()),s.forEach(p=>{p.render();const _=c.get(p);_&&_.forEach(([T,S])=>{var k;(k=p.getValue(T))==null||k.set(S)})}),i.forEach(p=>p.measureEndState()),i.forEach(p=>{p.suspendedScrollY!==void 0&&window.scrollTo(0,p.suspendedScrollY)})}i0=!1,r0=!1,Sd.forEach(i=>i.complete(o0)),Sd.clear()}function NE(){Sd.forEach(i=>{i.readKeyframes(),i.needsMeasurement&&(i0=!0)})}function rP(){o0=!0,NE(),FE(),o0=!1}class Y0{constructor(s,c,p,_,T,S=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...s],this.onComplete=c,this.name=p,this.motionValue=_,this.element=T,this.isAsync=S}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Sd.add(this),r0||(r0=!0,gi.read(NE),gi.resolveKeyframes(FE))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:c,element:p,motionValue:_}=this;if(s[0]===null){const T=_==null?void 0:_.get(),S=s[s.length-1];if(T!==void 0)s[0]=T;else if(p&&c){const k=p.readValue(c,S);k!=null&&(s[0]=k)}s[0]===void 0&&(s[0]=S),_&&T===void 0&&_.set(s[0])}Xk(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),Sd.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Sd.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const iP=i=>i.startsWith("--");function oP(i,s,c){iP(s)?i.style.setProperty(s,c):i.style[s]=c}const sP=N0(()=>window.ScrollTimeline!==void 0),aP={};function lP(i,s){const c=N0(i);return()=>aP[s]??c()}const jE=lP(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),lm=([i,s,c,p])=>`cubic-bezier(${i}, ${s}, ${c}, ${p})`,Mw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:lm([0,.65,.55,1]),circOut:lm([.55,0,1,.45]),backIn:lm([.31,.01,.66,-.59]),backOut:lm([.33,1.53,.69,.99])};function VE(i,s){if(i)return typeof i=="function"?jE()?DE(i,s):"ease-out":EE(i)?lm(i):Array.isArray(i)?i.map(c=>VE(c,s)||Mw.easeOut):Mw[i]}function uP(i,s,c,{delay:p=0,duration:_=300,repeat:T=0,repeatType:S="loop",ease:k="easeOut",times:o}={},I=void 0){const O={[s]:c};o&&(O.offset=o);const V=VE(k,_);Array.isArray(V)&&(O.easing=V);const q={delay:p,duration:_,easing:Array.isArray(V)?"linear":V,fill:"both",iterations:T+1,direction:S==="reverse"?"alternate":"normal"};return I&&(q.pseudoElement=I),i.animate(O,q)}function UE(i){return typeof i=="function"&&"applyToOptions"in i}function cP({type:i,...s}){return UE(i)&&jE()?i.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class hP extends K0{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:c,name:p,keyframes:_,pseudoElement:T,allowFlatten:S=!1,finalKeyframe:k,onComplete:o}=s;this.isPseudoElement=!!T,this.allowFlatten=S,this.options=s,F0(typeof s.type!="string");const I=cP(s);this.animation=uP(c,p,_,I,T),I.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!T){const O=X0(_,this.options,k,this.speed);this.updateMotionValue?this.updateMotionValue(O):oP(c,p,O),this.animation.cancel()}o==null||o(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var s,c;(c=(s=this.animation).finish)==null||c.call(s)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var s,c;this.isPseudoElement||(c=(s=this.animation).commitStyles)==null||c.call(s)}get duration(){var c,p;const s=((p=(c=this.animation.effect)==null?void 0:c.getComputedTiming)==null?void 0:p.call(c).duration)||0;return pu(Number(s))}get time(){return pu(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=fu(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:c}){var p;return this.allowFlatten&&((p=this.animation.effect)==null||p.updateTiming({easing:"linear"})),this.animation.onfinish=null,s&&sP()?(this.animation.timeline=s,Ba):c(this)}}const $E={anticipate:xE,backInOut:vE,circInOut:bE};function dP(i){return i in $E}function fP(i){typeof i.ease=="string"&&dP(i.ease)&&(i.ease=$E[i.ease])}const kw=10;class pP extends hP{constructor(s){fP(s),OE(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:c,onUpdate:p,onComplete:_,element:T,...S}=this.options;if(!c)return;if(s!==void 0){c.set(s);return}const k=new BE({...S,autoplay:!1}),o=fu(this.finishedTime??this.time);c.setWithVelocity(k.sample(o-kw).value,k.sample(o).value,kw),k.stop()}}const Pw=(i,s)=>s==="zIndex"?!1:!!(typeof i=="number"||Array.isArray(i)||typeof i=="string"&&(hh.test(i)||i==="0")&&!i.startsWith("url("));function mP(i){const s=i[0];if(i.length===1)return!0;for(let c=0;c<i.length;c++)if(i[c]!==s)return!0}function gP(i,s,c,p){const _=i[0];if(_===null)return!1;if(s==="display"||s==="visibility")return!0;const T=i[i.length-1],S=Pw(_,s),k=Pw(T,s);return!S||!k?!1:mP(i)||(c==="spring"||UE(c))&&p}const yP=new Set(["opacity","clipPath","filter","transform"]),_P=N0(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function vP(i){const{motionValue:s,name:c,repeatDelay:p,repeatType:_,damping:T,type:S}=i;if(!s||!s.owner||!(s.owner.current instanceof HTMLElement))return!1;const{onUpdate:k,transformTemplate:o}=s.owner.getProps();return _P()&&c&&yP.has(c)&&(c!=="transform"||!o)&&!k&&!p&&_!=="mirror"&&T!==0&&S!=="inertia"}const xP=40;class wP extends K0{constructor({autoplay:s=!0,delay:c=0,type:p="keyframes",repeat:_=0,repeatDelay:T=0,repeatType:S="loop",keyframes:k,name:o,motionValue:I,element:O,...V}){var H;super(),this.stop=()=>{var j,Z;this._animation?(this._animation.stop(),(j=this.stopTimeline)==null||j.call(this)):(Z=this.keyframeResolver)==null||Z.cancel()},this.createdAt=zs.now();const q={autoplay:s,delay:c,type:p,repeat:_,repeatDelay:T,repeatType:S,name:o,motionValue:I,element:O,...V},ee=(O==null?void 0:O.KeyframeResolver)||Y0;this.keyframeResolver=new ee(k,(j,Z,ne)=>this.onKeyframesResolved(j,Z,q,!ne),o,I,O),(H=this.keyframeResolver)==null||H.scheduleResolve()}onKeyframesResolved(s,c,p,_){this.keyframeResolver=void 0;const{name:T,type:S,velocity:k,delay:o,isHandoff:I,onUpdate:O}=p;this.resolvedAt=zs.now(),gP(s,T,S,k)||((dc.instantAnimations||!o)&&(O==null||O(X0(s,p,c))),s[0]=s[s.length-1],p.duration=0,p.repeat=0);const q={startTime:_?this.resolvedAt?this.resolvedAt-this.createdAt>xP?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:c,...p,keyframes:s},ee=!I&&vP(q)?new pP({...q,element:q.motionValue.owner.current}):new BE(q);ee.finished.then(()=>this.notifyFinished()).catch(Ba),this.pendingTimeline&&(this.stopTimeline=ee.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=ee}get finished(){return this._animation?this.animation.finished:this._finished}then(s,c){return this.finished.finally(s).then(()=>{})}get animation(){return this._animation||rP(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const bP=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function TP(i){const s=bP.exec(i);if(!s)return[,];const[,c,p,_]=s;return[`--${c??p}`,_]}function GE(i,s,c=1){const[p,_]=TP(i);if(!p)return;const T=window.getComputedStyle(s).getPropertyValue(p);if(T){const S=T.trim();return dE(S)?parseFloat(S):S}return G0(_)?GE(_,s,c+1):_}function J0(i,s){return(i==null?void 0:i[s])??(i==null?void 0:i.default)??i}const qE=new Set(["width","height","top","left","right","bottom",...Yf]),EP={test:i=>i==="auto",parse:i=>i},WE=i=>s=>s.test(i),ZE=[Kf,On,mu,lh,mk,pk,EP],Iw=i=>ZE.find(WE(i));function SP(i){return typeof i=="number"?i===0:i!==null?i==="none"||i==="0"||fE(i):!0}const CP=new Set(["brightness","contrast","saturate","opacity"]);function AP(i){const[s,c]=i.slice(0,-1).split("(");if(s==="drop-shadow")return i;const[p]=c.match(q0)||[];if(!p)return i;const _=c.replace(p,"");let T=CP.has(s)?1:0;return p!==c&&(T*=100),s+"("+T+_+")"}const MP=/\b([a-z-]*)\(.*?\)/gu,s0={...hh,getAnimatableNone:i=>{const s=i.match(MP);return s?s.map(AP).join(" "):i}},Rw={...Kf,transform:Math.round},kP={rotate:lh,rotateX:lh,rotateY:lh,rotateZ:lh,scale:jg,scaleX:jg,scaleY:jg,scaleZ:jg,skew:lh,skewX:lh,skewY:lh,distance:On,translateX:On,translateY:On,translateZ:On,x:On,y:On,z:On,perspective:On,transformPerspective:On,opacity:xm,originX:yw,originY:yw,originZ:On},Q0={borderWidth:On,borderTopWidth:On,borderRightWidth:On,borderBottomWidth:On,borderLeftWidth:On,borderRadius:On,radius:On,borderTopLeftRadius:On,borderTopRightRadius:On,borderBottomRightRadius:On,borderBottomLeftRadius:On,width:On,maxWidth:On,height:On,maxHeight:On,top:On,right:On,bottom:On,left:On,padding:On,paddingTop:On,paddingRight:On,paddingBottom:On,paddingLeft:On,margin:On,marginTop:On,marginRight:On,marginBottom:On,marginLeft:On,backgroundPositionX:On,backgroundPositionY:On,...kP,zIndex:Rw,fillOpacity:xm,strokeOpacity:xm,numOctaves:Rw},PP={...Q0,color:Jo,backgroundColor:Jo,outlineColor:Jo,fill:Jo,stroke:Jo,borderColor:Jo,borderTopColor:Jo,borderRightColor:Jo,borderBottomColor:Jo,borderLeftColor:Jo,filter:s0,WebkitFilter:s0},HE=i=>PP[i];function XE(i,s){let c=HE(i);return c!==s0&&(c=hh),c.getAnimatableNone?c.getAnimatableNone(s):void 0}const IP=new Set(["auto","none","0"]);function RP(i,s,c){let p=0,_;for(;p<i.length&&!_;){const T=i[p];typeof T=="string"&&!IP.has(T)&&wm(T).values.length&&(_=i[p]),p++}if(_&&c)for(const T of s)i[T]=XE(c,_)}class LP extends Y0{constructor(s,c,p,_,T){super(s,c,p,_,T,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:c,name:p}=this;if(!c||!c.current)return;super.readKeyframes();for(let o=0;o<s.length;o++){let I=s[o];if(typeof I=="string"&&(I=I.trim(),G0(I))){const O=GE(I,c.current);O!==void 0&&(s[o]=O),o===s.length-1&&(this.finalKeyframe=I)}}if(this.resolveNoneKeyframes(),!qE.has(p)||s.length!==2)return;const[_,T]=s,S=Iw(_),k=Iw(T);if(S!==k)if(Aw(S)&&Aw(k))for(let o=0;o<s.length;o++){const I=s[o];typeof I=="string"&&(s[o]=parseFloat(I))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:c}=this,p=[];for(let _=0;_<s.length;_++)(s[_]===null||SP(s[_]))&&p.push(_);p.length&&RP(s,p,c)}measureInitialState(){const{element:s,unresolvedKeyframes:c,name:p}=this;if(!s||!s.current)return;p==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Wf[p](s.measureViewportBox(),window.getComputedStyle(s.current)),c[0]=this.measuredOrigin;const _=c[c.length-1];_!==void 0&&s.getValue(p,_).jump(_,!1)}measureEndState(){var k;const{element:s,name:c,unresolvedKeyframes:p}=this;if(!s||!s.current)return;const _=s.getValue(c);_&&_.jump(this.measuredOrigin,!1);const T=p.length-1,S=p[T];p[T]=Wf[c](s.measureViewportBox(),window.getComputedStyle(s.current)),S!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=S),(k=this.removedTransforms)!=null&&k.length&&this.removedTransforms.forEach(([o,I])=>{s.getValue(o).set(I)}),this.resolveNoneKeyframes()}}function DP(i,s,c){if(i instanceof EventTarget)return[i];if(typeof i=="string"){let p=document;const _=(c==null?void 0:c[i])??p.querySelectorAll(i);return _?Array.from(_):[]}return Array.from(i)}const{schedule:ex}=SE(queueMicrotask,!1),ml={x:!1,y:!1};function KE(){return ml.x||ml.y}function zP(i){return i==="x"||i==="y"?ml[i]?null:(ml[i]=!0,()=>{ml[i]=!1}):ml.x||ml.y?null:(ml.x=ml.y=!0,()=>{ml.x=ml.y=!1})}function YE(i,s){const c=DP(i),p=new AbortController,_={passive:!0,...s,signal:p.signal};return[c,_,()=>p.abort()]}function Lw(i){return!(i.pointerType==="touch"||KE())}function OP(i,s,c={}){const[p,_,T]=YE(i,c),S=k=>{if(!Lw(k))return;const{target:o}=k,I=s(o,k);if(typeof I!="function"||!o)return;const O=V=>{Lw(V)&&(I(V),o.removeEventListener("pointerleave",O))};o.addEventListener("pointerleave",O,_)};return p.forEach(k=>{k.addEventListener("pointerenter",S,_)}),T}const JE=(i,s)=>s?i===s?!0:JE(i,s.parentElement):!1,tx=i=>i.pointerType==="mouse"?typeof i.button!="number"||i.button<=0:i.isPrimary!==!1,BP=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function FP(i){return BP.has(i.tagName)||i.tabIndex!==-1}const um=new WeakSet;function Dw(i){return s=>{s.key==="Enter"&&i(s)}}function X_(i,s){i.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const NP=(i,s)=>{const c=i.currentTarget;if(!c)return;const p=Dw(()=>{if(um.has(c))return;X_(c,"down");const _=Dw(()=>{X_(c,"up")}),T=()=>X_(c,"cancel");c.addEventListener("keyup",_,s),c.addEventListener("blur",T,s)});c.addEventListener("keydown",p,s),c.addEventListener("blur",()=>c.removeEventListener("keydown",p),s)};function zw(i){return tx(i)&&!KE()}function jP(i,s,c={}){const[p,_,T]=YE(i,c),S=k=>{const o=k.currentTarget;if(!zw(k)||um.has(o))return;um.add(o);const I=s(o,k),O=(ee,H)=>{window.removeEventListener("pointerup",V),window.removeEventListener("pointercancel",q),!(!zw(ee)||!um.has(o))&&(um.delete(o),typeof I=="function"&&I(ee,{success:H}))},V=ee=>{O(ee,o===window||o===document||c.useGlobalTarget||JE(o,ee.target))},q=ee=>{O(ee,!1)};window.addEventListener("pointerup",V,_),window.addEventListener("pointercancel",q,_)};return p.forEach(k=>{(c.useGlobalTarget?window:k).addEventListener("pointerdown",S,_),k instanceof HTMLElement&&(k.addEventListener("focus",I=>NP(I,_)),!FP(k)&&!k.hasAttribute("tabindex")&&(k.tabIndex=0))}),T}const Ow=30,VP=i=>!isNaN(parseFloat(i));class UP{constructor(s,c={}){this.version="12.9.1",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(p,_=!0)=>{var S,k;const T=zs.now();this.updatedAt!==T&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(p),this.current!==this.prev&&((S=this.events.change)==null||S.notify(this.current)),_&&((k=this.events.renderRequest)==null||k.notify(this.current))},this.hasAnimated=!1,this.setCurrent(s),this.owner=c.owner}setCurrent(s){this.current=s,this.updatedAt=zs.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=VP(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,c){this.events[s]||(this.events[s]=new j0);const p=this.events[s].add(c);return s==="change"?()=>{p(),gi.read(()=>{this.events.change.getSize()||this.stop()})}:p}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,c){this.passiveEffect=s,this.stopPassiveEffect=c}set(s,c=!0){!c||!this.passiveEffect?this.updateAndNotify(s,c):this.passiveEffect(s,this.updateAndNotify)}setWithVelocity(s,c,p){this.set(c),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-p}jump(s,c=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,c&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=zs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>Ow)return 0;const c=Math.min(this.updatedAt-this.prevUpdatedAt,Ow);return pE(parseFloat(this.current)-parseFloat(this.prevFrameValue),c)}start(s){return this.stop(),new Promise(c=>{this.hasAnimated=!0,this.animation=s(c),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var s;(s=this.events.destroy)==null||s.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function bm(i,s){return new UP(i,s)}const $P=[...ZE,Jo,hh],GP=i=>$P.find(WE(i)),QE=(i,s)=>s&&typeof i=="number"?s.transform(i):i,eS=Ee.createContext({strict:!1}),Bw={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Zf={};for(const i in Bw)Zf[i]={isEnabled:s=>Bw[i].some(c=>!!s[c])};function qP(i){for(const s in i)Zf[s]={...Zf[s],...i[s]}}const WP=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function yy(i){return i.startsWith("while")||i.startsWith("drag")&&i!=="draggable"||i.startsWith("layout")||i.startsWith("onTap")||i.startsWith("onPan")||i.startsWith("onLayout")||WP.has(i)}let tS=i=>!yy(i);function ZP(i){i&&(tS=s=>s.startsWith("on")?!yy(s):i(s))}try{ZP(require("@emotion/is-prop-valid").default)}catch{}function HP(i,s,c){const p={};for(const _ in i)_==="values"&&typeof i.values=="object"||(tS(_)||c===!0&&yy(_)||!s&&!yy(_)||i.draggable&&_.startsWith("onDrag"))&&(p[_]=i[_]);return p}function XP(i){if(typeof Proxy>"u")return i;const s=new Map,c=(...p)=>i(...p);return new Proxy(c,{get:(p,_)=>_==="create"?i:(s.has(_)||s.set(_,i(_)),s.get(_))})}const ky=Ee.createContext({});function Py(i){return i!==null&&typeof i=="object"&&typeof i.start=="function"}function Tm(i){return typeof i=="string"||Array.isArray(i)}const nx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],rx=["initial",...nx];function Iy(i){return Py(i.animate)||rx.some(s=>Tm(i[s]))}function nS(i){return!!(Iy(i)||i.variants)}function KP(i,s){if(Iy(i)){const{initial:c,animate:p}=i;return{initial:c===!1||Tm(c)?c:void 0,animate:Tm(p)?p:void 0}}return i.inherit!==!1?s:{}}function YP(i){const{initial:s,animate:c}=KP(i,Ee.useContext(ky));return Ee.useMemo(()=>({initial:s,animate:c}),[Fw(s),Fw(c)])}function Fw(i){return Array.isArray(i)?i.join(" "):i}const JP=Symbol.for("motionComponentSymbol");function jf(i){return i&&typeof i=="object"&&Object.prototype.hasOwnProperty.call(i,"current")}function QP(i,s,c){return Ee.useCallback(p=>{p&&i.onMount&&i.onMount(p),s&&(p?s.mount(p):s.unmount()),c&&(typeof c=="function"?c(p):jf(c)&&(c.current=p))},[s])}const ix=i=>i.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),eI="framerAppearId",rS="data-"+ix(eI),iS=Ee.createContext({});function tI(i,s,c,p,_){var j,Z;const{visualElement:T}=Ee.useContext(ky),S=Ee.useContext(eS),k=Ee.useContext(My),o=Ee.useContext(z0).reducedMotion,I=Ee.useRef(null);p=p||S.renderer,!I.current&&p&&(I.current=p(i,{visualState:s,parent:T,props:c,presenceContext:k,blockInitialAnimation:k?k.initial===!1:!1,reducedMotionConfig:o}));const O=I.current,V=Ee.useContext(iS);O&&!O.projection&&_&&(O.type==="html"||O.type==="svg")&&nI(I.current,c,_,V);const q=Ee.useRef(!1);Ee.useInsertionEffect(()=>{O&&q.current&&O.update(c,k)});const ee=c[rS],H=Ee.useRef(!!ee&&!((j=window.MotionHandoffIsComplete)!=null&&j.call(window,ee))&&((Z=window.MotionHasOptimisedAnimation)==null?void 0:Z.call(window,ee)));return uE(()=>{O&&(q.current=!0,window.MotionIsMounted=!0,O.updateFeatures(),ex.render(O.render),H.current&&O.animationState&&O.animationState.animateChanges())}),Ee.useEffect(()=>{O&&(!H.current&&O.animationState&&O.animationState.animateChanges(),H.current&&(queueMicrotask(()=>{var ne;(ne=window.MotionHandoffMarkAsComplete)==null||ne.call(window,ee)}),H.current=!1))}),O}function nI(i,s,c,p){const{layoutId:_,layout:T,drag:S,dragConstraints:k,layoutScroll:o,layoutRoot:I,layoutCrossfade:O}=s;i.projection=new c(i.latestValues,s["data-framer-portal-id"]?void 0:oS(i.parent)),i.projection.setOptions({layoutId:_,layout:T,alwaysMeasureLayout:!!S||k&&jf(k),visualElement:i,animationType:typeof T=="string"?T:"both",initialPromotionConfig:p,crossfade:O,layoutScroll:o,layoutRoot:I})}function oS(i){if(i)return i.options.allowProjection!==!1?i.projection:oS(i.parent)}function rI({preloadedFeatures:i,createVisualElement:s,useRender:c,useVisualState:p,Component:_}){i&&qP(i);function T(k,o){let I;const O={...Ee.useContext(z0),...k,layoutId:iI(k)},{isStatic:V}=O,q=YP(k),ee=p(k,V);if(!V&&D0){oI();const H=sI(O);I=H.MeasureLayout,q.visualElement=tI(_,ee,O,s,H.ProjectionNode)}return Be.jsxs(ky.Provider,{value:q,children:[I&&q.visualElement?Be.jsx(I,{visualElement:q.visualElement,...O}):null,c(_,k,QP(ee,q.visualElement,o),ee,V,q.visualElement)]})}T.displayName=`motion.${typeof _=="string"?_:`create(${_.displayName??_.name??""})`}`;const S=Ee.forwardRef(T);return S[JP]=_,S}function iI({layoutId:i}){const s=Ee.useContext(R0).id;return s&&i!==void 0?s+"-"+i:i}function oI(i,s){Ee.useContext(eS).strict}function sI(i){const{drag:s,layout:c}=Zf;if(!s&&!c)return{};const p={...s,...c};return{MeasureLayout:s!=null&&s.isEnabled(i)||c!=null&&c.isEnabled(i)?p.MeasureLayout:void 0,ProjectionNode:p.ProjectionNode}}const Em={};function aI(i){for(const s in i)Em[s]=i[s],$0(s)&&(Em[s].isCSSVariable=!0)}function sS(i,{layout:s,layoutId:c}){return Jf.has(i)||i.startsWith("origin")||(s||c!==void 0)&&(!!Em[i]||i==="opacity")}const es=i=>!!(i&&i.getVelocity),lI={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},uI=Yf.length;function cI(i,s,c){let p="",_=!0;for(let T=0;T<uI;T++){const S=Yf[T],k=i[S];if(k===void 0)continue;let o=!0;if(typeof k=="number"?o=k===(S.startsWith("scale")?1:0):o=parseFloat(k)===0,!o||c){const I=QE(k,Q0[S]);if(!o){_=!1;const O=lI[S]||S;p+=`${O}(${I}) `}c&&(s[S]=I)}}return p=p.trim(),c?p=c(s,_?"":p):_&&(p="none"),p}function ox(i,s,c){const{style:p,vars:_,transformOrigin:T}=i;let S=!1,k=!1;for(const o in s){const I=s[o];if(Jf.has(o)){S=!0;continue}else if($0(o)){_[o]=I;continue}else{const O=QE(I,Q0[o]);o.startsWith("origin")?(k=!0,T[o]=O):p[o]=O}}if(s.transform||(S||c?p.transform=cI(s,i.transform,c):p.transform&&(p.transform="none")),k){const{originX:o="50%",originY:I="50%",originZ:O=0}=T;p.transformOrigin=`${o} ${I} ${O}`}}const sx=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function aS(i,s,c){for(const p in s)!es(s[p])&&!sS(p,c)&&(i[p]=s[p])}function hI({transformTemplate:i},s){return Ee.useMemo(()=>{const c=sx();return ox(c,s,i),Object.assign({},c.vars,c.style)},[s])}function dI(i,s){const c=i.style||{},p={};return aS(p,c,i),Object.assign(p,hI(i,s)),p}function fI(i,s){const c={},p=dI(i,s);return i.drag&&i.dragListener!==!1&&(c.draggable=!1,p.userSelect=p.WebkitUserSelect=p.WebkitTouchCallout="none",p.touchAction=i.drag===!0?"none":`pan-${i.drag==="x"?"y":"x"}`),i.tabIndex===void 0&&(i.onTap||i.onTapStart||i.whileTap)&&(c.tabIndex=0),c.style=p,c}const pI=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ax(i){return typeof i!="string"||i.includes("-")?!1:!!(pI.indexOf(i)>-1||/[A-Z]/u.test(i))}const mI={offset:"stroke-dashoffset",array:"stroke-dasharray"},gI={offset:"strokeDashoffset",array:"strokeDasharray"};function yI(i,s,c=1,p=0,_=!0){i.pathLength=1;const T=_?mI:gI;i[T.offset]=On.transform(-p);const S=On.transform(s),k=On.transform(c);i[T.array]=`${S} ${k}`}function lS(i,{attrX:s,attrY:c,attrScale:p,pathLength:_,pathSpacing:T=1,pathOffset:S=0,...k},o,I){if(ox(i,k,I),o){i.style.viewBox&&(i.attrs.viewBox=i.style.viewBox);return}i.attrs=i.style,i.style={};const{attrs:O,style:V}=i;O.transform&&(V.transform=O.transform,delete O.transform),(V.transform||O.transformOrigin)&&(V.transformOrigin=O.transformOrigin??"50% 50%",delete O.transformOrigin),V.transform&&(V.transformBox="fill-box",delete O.transformBox),s!==void 0&&(O.x=s),c!==void 0&&(O.y=c),p!==void 0&&(O.scale=p),_!==void 0&&yI(O,_,T,S,!1)}const uS=()=>({...sx(),attrs:{}}),cS=i=>typeof i=="string"&&i.toLowerCase()==="svg";function _I(i,s,c,p){const _=Ee.useMemo(()=>{const T=uS();return lS(T,s,cS(p),i.transformTemplate),{...T.attrs,style:{...T.style}}},[s]);if(i.style){const T={};aS(T,i.style,i),_.style={...T,..._.style}}return _}function vI(i=!1){return(c,p,_,{latestValues:T},S)=>{const o=(ax(c)?_I:fI)(p,T,S,c),I=HP(p,typeof c=="string",i),O=c!==Ee.Fragment?{...I,...o,ref:_}:{},{children:V}=p,q=Ee.useMemo(()=>es(V)?V.get():V,[V]);return Ee.createElement(c,{...O,children:q})}}function Nw(i){const s=[{},{}];return i==null||i.values.forEach((c,p)=>{s[0][p]=c.get(),s[1][p]=c.getVelocity()}),s}function lx(i,s,c,p){if(typeof s=="function"){const[_,T]=Nw(p);s=s(c!==void 0?c:i.custom,_,T)}if(typeof s=="string"&&(s=i.variants&&i.variants[s]),typeof s=="function"){const[_,T]=Nw(p);s=s(c!==void 0?c:i.custom,_,T)}return s}function Jg(i){return es(i)?i.get():i}function xI({scrapeMotionValuesFromProps:i,createRenderState:s},c,p,_){return{latestValues:wI(c,p,_,i),renderState:s()}}const hS=i=>(s,c)=>{const p=Ee.useContext(ky),_=Ee.useContext(My),T=()=>xI(i,s,p,_);return c?T():L0(T)};function wI(i,s,c,p){const _={},T=p(i,{});for(const q in T)_[q]=Jg(T[q]);let{initial:S,animate:k}=i;const o=Iy(i),I=nS(i);s&&I&&!o&&i.inherit!==!1&&(S===void 0&&(S=s.initial),k===void 0&&(k=s.animate));let O=c?c.initial===!1:!1;O=O||S===!1;const V=O?k:S;if(V&&typeof V!="boolean"&&!Py(V)){const q=Array.isArray(V)?V:[V];for(let ee=0;ee<q.length;ee++){const H=lx(i,q[ee]);if(H){const{transitionEnd:j,transition:Z,...ne}=H;for(const xe in ne){let ce=ne[xe];if(Array.isArray(ce)){const me=O?ce.length-1:0;ce=ce[me]}ce!==null&&(_[xe]=ce)}for(const xe in j)_[xe]=j[xe]}}}return _}function ux(i,s,c){var T;const{style:p}=i,_={};for(const S in p)(es(p[S])||s.style&&es(s.style[S])||sS(S,i)||((T=c==null?void 0:c.getValue(S))==null?void 0:T.liveStyle)!==void 0)&&(_[S]=p[S]);return _}const bI={useVisualState:hS({scrapeMotionValuesFromProps:ux,createRenderState:sx})};function dS(i,s,c){const p=ux(i,s,c);for(const _ in i)if(es(i[_])||es(s[_])){const T=Yf.indexOf(_)!==-1?"attr"+_.charAt(0).toUpperCase()+_.substring(1):_;p[T]=i[_]}return p}const TI={useVisualState:hS({scrapeMotionValuesFromProps:dS,createRenderState:uS})};function EI(i,s){return function(p,{forwardMotionProps:_}={forwardMotionProps:!1}){const S={...ax(p)?TI:bI,preloadedFeatures:i,useRender:vI(_),createVisualElement:s,Component:p};return rI(S)}}function Sm(i,s,c){const p=i.getProps();return lx(p,s,c!==void 0?c:p.custom,i)}const a0=i=>Array.isArray(i);function SI(i,s,c){i.hasValue(s)?i.getValue(s).set(c):i.addValue(s,bm(c))}function CI(i){return a0(i)?i[i.length-1]||0:i}function AI(i,s){const c=Sm(i,s);let{transitionEnd:p={},transition:_={},...T}=c||{};T={...T,...p};for(const S in T){const k=CI(T[S]);SI(i,S,k)}}function MI(i){return!!(es(i)&&i.add)}function l0(i,s){const c=i.getValue("willChange");if(MI(c))return c.add(s);if(!c&&dc.WillChange){const p=new dc.WillChange("auto");i.addValue("willChange",p),p.add(s)}}function fS(i){return i.props[rS]}const kI=i=>i!==null;function PI(i,{repeat:s,repeatType:c="loop"},p){const _=i.filter(kI),T=s&&c!=="loop"&&s%2===1?0:_.length-1;return _[T]}const II={type:"spring",stiffness:500,damping:25,restSpeed:10},RI=i=>({type:"spring",stiffness:550,damping:i===0?2*Math.sqrt(550):30,restSpeed:10}),LI={type:"keyframes",duration:.8},DI={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},zI=(i,{keyframes:s})=>s.length>2?LI:Jf.has(i)?i.startsWith("scale")?RI(s[1]):II:DI;function OI({when:i,delay:s,delayChildren:c,staggerChildren:p,staggerDirection:_,repeat:T,repeatType:S,repeatDelay:k,from:o,elapsed:I,...O}){return!!Object.keys(O).length}const cx=(i,s,c,p={},_,T)=>S=>{const k=J0(p,i)||{},o=k.delay||p.delay||0;let{elapsed:I=0}=p;I=I-fu(o);const O={keyframes:Array.isArray(c)?c:[null,c],ease:"easeOut",velocity:s.getVelocity(),...k,delay:-I,onUpdate:q=>{s.set(q),k.onUpdate&&k.onUpdate(q)},onComplete:()=>{S(),k.onComplete&&k.onComplete()},name:i,motionValue:s,element:T?void 0:_};OI(k)||Object.assign(O,zI(i,O)),O.duration&&(O.duration=fu(O.duration)),O.repeatDelay&&(O.repeatDelay=fu(O.repeatDelay)),O.from!==void 0&&(O.keyframes[0]=O.from);let V=!1;if((O.type===!1||O.duration===0&&!O.repeatDelay)&&(O.duration=0,O.delay===0&&(V=!0)),(dc.instantAnimations||dc.skipAnimations)&&(V=!0,O.duration=0,O.delay=0),O.allowFlatten=!k.type&&!k.ease,V&&!T&&s.get()!==void 0){const q=PI(O.keyframes,k);if(q!==void 0){gi.update(()=>{O.onUpdate(q),O.onComplete()});return}}return new wP(O)};function BI({protectedKeys:i,needsAnimating:s},c){const p=i.hasOwnProperty(c)&&s[c]!==!0;return s[c]=!1,p}function pS(i,s,{delay:c=0,transitionOverride:p,type:_}={}){let{transition:T=i.getDefaultTransition(),transitionEnd:S,...k}=s;p&&(T=p);const o=[],I=_&&i.animationState&&i.animationState.getState()[_];for(const O in k){const V=i.getValue(O,i.latestValues[O]??null),q=k[O];if(q===void 0||I&&BI(I,O))continue;const ee={delay:c,...J0(T||{},O)},H=V.get();if(H!==void 0&&!V.isAnimating&&!Array.isArray(q)&&q===H&&!ee.velocity)continue;let j=!1;if(window.MotionHandoffAnimation){const ne=fS(i);if(ne){const xe=window.MotionHandoffAnimation(ne,O,gi);xe!==null&&(ee.startTime=xe,j=!0)}}l0(i,O),V.start(cx(O,V,q,i.shouldReduceMotion&&qE.has(O)?{type:!1}:ee,i,j));const Z=V.animation;Z&&o.push(Z)}return S&&Promise.all(o).then(()=>{gi.update(()=>{S&&AI(i,S)})}),o}function u0(i,s,c={}){var o;const p=Sm(i,s,c.type==="exit"?(o=i.presenceContext)==null?void 0:o.custom:void 0);let{transition:_=i.getDefaultTransition()||{}}=p||{};c.transitionOverride&&(_=c.transitionOverride);const T=p?()=>Promise.all(pS(i,p,c)):()=>Promise.resolve(),S=i.variantChildren&&i.variantChildren.size?(I=0)=>{const{delayChildren:O=0,staggerChildren:V,staggerDirection:q}=_;return FI(i,s,O+I,V,q,c)}:()=>Promise.resolve(),{when:k}=_;if(k){const[I,O]=k==="beforeChildren"?[T,S]:[S,T];return I().then(()=>O())}else return Promise.all([T(),S(c.delay)])}function FI(i,s,c=0,p=0,_=1,T){const S=[],k=(i.variantChildren.size-1)*p,o=_===1?(I=0)=>I*p:(I=0)=>k-I*p;return Array.from(i.variantChildren).sort(NI).forEach((I,O)=>{I.notify("AnimationStart",s),S.push(u0(I,s,{...T,delay:c+o(O)}).then(()=>I.notify("AnimationComplete",s)))}),Promise.all(S)}function NI(i,s){return i.sortNodePosition(s)}function jI(i,s,c={}){i.notify("AnimationStart",s);let p;if(Array.isArray(s)){const _=s.map(T=>u0(i,T,c));p=Promise.all(_)}else if(typeof s=="string")p=u0(i,s,c);else{const _=typeof s=="function"?Sm(i,s,c.custom):s;p=Promise.all(pS(i,_,c))}return p.then(()=>{i.notify("AnimationComplete",s)})}function mS(i,s){if(!Array.isArray(s))return!1;const c=s.length;if(c!==i.length)return!1;for(let p=0;p<c;p++)if(s[p]!==i[p])return!1;return!0}const VI=rx.length;function gS(i){if(!i)return;if(!i.isControllingVariants){const c=i.parent?gS(i.parent)||{}:{};return i.props.initial!==void 0&&(c.initial=i.props.initial),c}const s={};for(let c=0;c<VI;c++){const p=rx[c],_=i.props[p];(Tm(_)||_===!1)&&(s[p]=_)}return s}const UI=[...nx].reverse(),$I=nx.length;function GI(i){return s=>Promise.all(s.map(({animation:c,options:p})=>jI(i,c,p)))}function qI(i){let s=GI(i),c=jw(),p=!0;const _=o=>(I,O)=>{var q;const V=Sm(i,O,o==="exit"?(q=i.presenceContext)==null?void 0:q.custom:void 0);if(V){const{transition:ee,transitionEnd:H,...j}=V;I={...I,...j,...H}}return I};function T(o){s=o(i)}function S(o){const{props:I}=i,O=gS(i.parent)||{},V=[],q=new Set;let ee={},H=1/0;for(let Z=0;Z<$I;Z++){const ne=UI[Z],xe=c[ne],ce=I[ne]!==void 0?I[ne]:O[ne],me=Tm(ce),de=ne===o?xe.isActive:null;de===!1&&(H=Z);let _e=ce===O[ne]&&ce!==I[ne]&&me;if(_e&&p&&i.manuallyAnimateOnMount&&(_e=!1),xe.protectedKeys={...ee},!xe.isActive&&de===null||!ce&&!xe.prevProp||Py(ce)||typeof ce=="boolean")continue;const Se=WI(xe.prevProp,ce);let $e=Se||ne===o&&xe.isActive&&!_e&&me||Z>H&&me,dt=!1;const Y=Array.isArray(ce)?ce:[ce];let pt=Y.reduce(_(ne),{});de===!1&&(pt={});const{prevResolvedValues:Lt={}}=xe,lt={...Lt,...pt},zt=fn=>{$e=!0,q.has(fn)&&(dt=!0,q.delete(fn)),xe.needsAnimating[fn]=!0;const gt=i.getValue(fn);gt&&(gt.liveStyle=!1)};for(const fn in lt){const gt=pt[fn],Et=Lt[fn];if(ee.hasOwnProperty(fn))continue;let Le=!1;a0(gt)&&a0(Et)?Le=!mS(gt,Et):Le=gt!==Et,Le?gt!=null?zt(fn):q.add(fn):gt!==void 0&&q.has(fn)?zt(fn):xe.protectedKeys[fn]=!0}xe.prevProp=ce,xe.prevResolvedValues=pt,xe.isActive&&(ee={...ee,...pt}),p&&i.blockInitialAnimation&&($e=!1),$e&&(!(_e&&Se)||dt)&&V.push(...Y.map(fn=>({animation:fn,options:{type:ne}})))}if(q.size){const Z={};if(typeof I.initial!="boolean"){const ne=Sm(i,Array.isArray(I.initial)?I.initial[0]:I.initial);ne&&ne.transition&&(Z.transition=ne.transition)}q.forEach(ne=>{const xe=i.getBaseTarget(ne),ce=i.getValue(ne);ce&&(ce.liveStyle=!0),Z[ne]=xe??null}),V.push({animation:Z})}let j=!!V.length;return p&&(I.initial===!1||I.initial===I.animate)&&!i.manuallyAnimateOnMount&&(j=!1),p=!1,j?s(V):Promise.resolve()}function k(o,I){var V;if(c[o].isActive===I)return Promise.resolve();(V=i.variantChildren)==null||V.forEach(q=>{var ee;return(ee=q.animationState)==null?void 0:ee.setActive(o,I)}),c[o].isActive=I;const O=S(o);for(const q in c)c[q].protectedKeys={};return O}return{animateChanges:S,setActive:k,setAnimateFunction:T,getState:()=>c,reset:()=>{c=jw(),p=!0}}}function WI(i,s){return typeof s=="string"?s!==i:Array.isArray(s)?!mS(s,i):!1}function xd(i=!1){return{isActive:i,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function jw(){return{animate:xd(!0),whileInView:xd(),whileHover:xd(),whileTap:xd(),whileDrag:xd(),whileFocus:xd(),exit:xd()}}class fh{constructor(s){this.isMounted=!1,this.node=s}update(){}}class ZI extends fh{constructor(s){super(s),s.animationState||(s.animationState=qI(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();Py(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:c}=this.node.prevProps||{};s!==c&&this.updateAnimationControlsSubscription()}unmount(){var s;this.node.animationState.reset(),(s=this.unmountControls)==null||s.call(this)}}let HI=0;class XI extends fh{constructor(){super(...arguments),this.id=HI++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:c}=this.node.presenceContext,{isPresent:p}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===p)return;const _=this.node.animationState.setActive("exit",!s);c&&!s&&_.then(()=>{c(this.id)})}mount(){const{register:s,onExitComplete:c}=this.node.presenceContext||{};c&&c(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const KI={animation:{Feature:ZI},exit:{Feature:XI}};function Cm(i,s,c,p={passive:!0}){return i.addEventListener(s,c,p),()=>i.removeEventListener(s,c)}function Fm(i){return{point:{x:i.pageX,y:i.pageY}}}const YI=i=>s=>tx(s)&&i(s,Fm(s));function mm(i,s,c,p){return Cm(i,s,YI(c),p)}function yS({top:i,left:s,right:c,bottom:p}){return{x:{min:s,max:c},y:{min:i,max:p}}}function JI({x:i,y:s}){return{top:s.min,right:i.max,bottom:s.max,left:i.min}}function QI(i,s){if(!s)return i;const c=s({x:i.left,y:i.top}),p=s({x:i.right,y:i.bottom});return{top:c.y,left:c.x,bottom:p.y,right:p.x}}const _S=1e-4,eR=1-_S,tR=1+_S,vS=.01,nR=0-vS,rR=0+vS;function ms(i){return i.max-i.min}function iR(i,s,c){return Math.abs(i-s)<=c}function Vw(i,s,c,p=.5){i.origin=p,i.originPoint=mi(s.min,s.max,i.origin),i.scale=ms(c)/ms(s),i.translate=mi(c.min,c.max,i.origin)-i.originPoint,(i.scale>=eR&&i.scale<=tR||isNaN(i.scale))&&(i.scale=1),(i.translate>=nR&&i.translate<=rR||isNaN(i.translate))&&(i.translate=0)}function gm(i,s,c,p){Vw(i.x,s.x,c.x,p?p.originX:void 0),Vw(i.y,s.y,c.y,p?p.originY:void 0)}function Uw(i,s,c){i.min=c.min+s.min,i.max=i.min+ms(s)}function oR(i,s,c){Uw(i.x,s.x,c.x),Uw(i.y,s.y,c.y)}function $w(i,s,c){i.min=s.min-c.min,i.max=i.min+ms(s)}function ym(i,s,c){$w(i.x,s.x,c.x),$w(i.y,s.y,c.y)}const Gw=()=>({translate:0,scale:1,origin:0,originPoint:0}),Vf=()=>({x:Gw(),y:Gw()}),qw=()=>({min:0,max:0}),Oi=()=>({x:qw(),y:qw()});function Da(i){return[i("x"),i("y")]}function K_(i){return i===void 0||i===1}function c0({scale:i,scaleX:s,scaleY:c}){return!K_(i)||!K_(s)||!K_(c)}function wd(i){return c0(i)||xS(i)||i.z||i.rotate||i.rotateX||i.rotateY||i.skewX||i.skewY}function xS(i){return Ww(i.x)||Ww(i.y)}function Ww(i){return i&&i!=="0%"}function _y(i,s,c){const p=i-c,_=s*p;return c+_}function Zw(i,s,c,p,_){return _!==void 0&&(i=_y(i,_,p)),_y(i,c,p)+s}function h0(i,s=0,c=1,p,_){i.min=Zw(i.min,s,c,p,_),i.max=Zw(i.max,s,c,p,_)}function wS(i,{x:s,y:c}){h0(i.x,s.translate,s.scale,s.originPoint),h0(i.y,c.translate,c.scale,c.originPoint)}const Hw=.999999999999,Xw=1.0000000000001;function sR(i,s,c,p=!1){const _=c.length;if(!_)return;s.x=s.y=1;let T,S;for(let k=0;k<_;k++){T=c[k],S=T.projectionDelta;const{visualElement:o}=T.options;o&&o.props.style&&o.props.style.display==="contents"||(p&&T.options.layoutScroll&&T.scroll&&T!==T.root&&$f(i,{x:-T.scroll.offset.x,y:-T.scroll.offset.y}),S&&(s.x*=S.x.scale,s.y*=S.y.scale,wS(i,S)),p&&wd(T.latestValues)&&$f(i,T.latestValues))}s.x<Xw&&s.x>Hw&&(s.x=1),s.y<Xw&&s.y>Hw&&(s.y=1)}function Uf(i,s){i.min=i.min+s,i.max=i.max+s}function Kw(i,s,c,p,_=.5){const T=mi(i.min,i.max,_);h0(i,s,c,T,p)}function $f(i,s){Kw(i.x,s.x,s.scaleX,s.scale,s.originX),Kw(i.y,s.y,s.scaleY,s.scale,s.originY)}function bS(i,s){return yS(QI(i.getBoundingClientRect(),s))}function aR(i,s,c){const p=bS(i,c),{scroll:_}=s;return _&&(Uf(p.x,_.offset.x),Uf(p.y,_.offset.y)),p}const TS=({current:i})=>i?i.ownerDocument.defaultView:null,Yw=(i,s)=>Math.abs(i-s);function lR(i,s){const c=Yw(i.x,s.x),p=Yw(i.y,s.y);return Math.sqrt(c**2+p**2)}class ES{constructor(s,c,{transformPagePoint:p,contextWindow:_,dragSnapToOrigin:T=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const V=J_(this.lastMoveEventInfo,this.history),q=this.startEvent!==null,ee=lR(V.offset,{x:0,y:0})>=3;if(!q&&!ee)return;const{point:H}=V,{timestamp:j}=Io;this.history.push({...H,timestamp:j});const{onStart:Z,onMove:ne}=this.handlers;q||(Z&&Z(this.lastMoveEvent,V),this.startEvent=this.lastMoveEvent),ne&&ne(this.lastMoveEvent,V)},this.handlePointerMove=(V,q)=>{this.lastMoveEvent=V,this.lastMoveEventInfo=Y_(q,this.transformPagePoint),gi.update(this.updatePoint,!0)},this.handlePointerUp=(V,q)=>{this.end();const{onEnd:ee,onSessionEnd:H,resumeAnimation:j}=this.handlers;if(this.dragSnapToOrigin&&j&&j(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const Z=J_(V.type==="pointercancel"?this.lastMoveEventInfo:Y_(q,this.transformPagePoint),this.history);this.startEvent&&ee&&ee(V,Z),H&&H(V,Z)},!tx(s))return;this.dragSnapToOrigin=T,this.handlers=c,this.transformPagePoint=p,this.contextWindow=_||window;const S=Fm(s),k=Y_(S,this.transformPagePoint),{point:o}=k,{timestamp:I}=Io;this.history=[{...o,timestamp:I}];const{onSessionStart:O}=c;O&&O(s,J_(k,this.history)),this.removeListeners=zm(mm(this.contextWindow,"pointermove",this.handlePointerMove),mm(this.contextWindow,"pointerup",this.handlePointerUp),mm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),ch(this.updatePoint)}}function Y_(i,s){return s?{point:s(i.point)}:i}function Jw(i,s){return{x:i.x-s.x,y:i.y-s.y}}function J_({point:i},s){return{point:i,delta:Jw(i,SS(s)),offset:Jw(i,uR(s)),velocity:cR(s,.1)}}function uR(i){return i[0]}function SS(i){return i[i.length-1]}function cR(i,s){if(i.length<2)return{x:0,y:0};let c=i.length-1,p=null;const _=SS(i);for(;c>=0&&(p=i[c],!(_.timestamp-p.timestamp>fu(s)));)c--;if(!p)return{x:0,y:0};const T=pu(_.timestamp-p.timestamp);if(T===0)return{x:0,y:0};const S={x:(_.x-p.x)/T,y:(_.y-p.y)/T};return S.x===1/0&&(S.x=0),S.y===1/0&&(S.y=0),S}function hR(i,{min:s,max:c},p){return s!==void 0&&i<s?i=p?mi(s,i,p.min):Math.max(i,s):c!==void 0&&i>c&&(i=p?mi(c,i,p.max):Math.min(i,c)),i}function Qw(i,s,c){return{min:s!==void 0?i.min+s:void 0,max:c!==void 0?i.max+c-(i.max-i.min):void 0}}function dR(i,{top:s,left:c,bottom:p,right:_}){return{x:Qw(i.x,c,_),y:Qw(i.y,s,p)}}function eb(i,s){let c=s.min-i.min,p=s.max-i.max;return s.max-s.min<i.max-i.min&&([c,p]=[p,c]),{min:c,max:p}}function fR(i,s){return{x:eb(i.x,s.x),y:eb(i.y,s.y)}}function pR(i,s){let c=.5;const p=ms(i),_=ms(s);return _>p?c=vm(s.min,s.max-p,i.min):p>_&&(c=vm(i.min,i.max-_,s.min)),hc(0,1,c)}function mR(i,s){const c={};return s.min!==void 0&&(c.min=s.min-i.min),s.max!==void 0&&(c.max=s.max-i.min),c}const d0=.35;function gR(i=d0){return i===!1?i=0:i===!0&&(i=d0),{x:tb(i,"left","right"),y:tb(i,"top","bottom")}}function tb(i,s,c){return{min:nb(i,s),max:nb(i,c)}}function nb(i,s){return typeof i=="number"?i:i[s]||0}const yR=new WeakMap;class _R{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Oi(),this.visualElement=s}start(s,{snapToCursor:c=!1}={}){const{presenceContext:p}=this.visualElement;if(p&&p.isPresent===!1)return;const _=O=>{const{dragSnapToOrigin:V}=this.getProps();V?this.pauseAnimation():this.stopAnimation(),c&&this.snapToCursor(Fm(O).point)},T=(O,V)=>{const{drag:q,dragPropagation:ee,onDragStart:H}=this.getProps();if(q&&!ee&&(this.openDragLock&&this.openDragLock(),this.openDragLock=zP(q),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Da(Z=>{let ne=this.getAxisMotionValue(Z).get()||0;if(mu.test(ne)){const{projection:xe}=this.visualElement;if(xe&&xe.layout){const ce=xe.layout.layoutBox[Z];ce&&(ne=ms(ce)*(parseFloat(ne)/100))}}this.originPoint[Z]=ne}),H&&gi.postRender(()=>H(O,V)),l0(this.visualElement,"transform");const{animationState:j}=this.visualElement;j&&j.setActive("whileDrag",!0)},S=(O,V)=>{const{dragPropagation:q,dragDirectionLock:ee,onDirectionLock:H,onDrag:j}=this.getProps();if(!q&&!this.openDragLock)return;const{offset:Z}=V;if(ee&&this.currentDirection===null){this.currentDirection=vR(Z),this.currentDirection!==null&&H&&H(this.currentDirection);return}this.updateAxis("x",V.point,Z),this.updateAxis("y",V.point,Z),this.visualElement.render(),j&&j(O,V)},k=(O,V)=>this.stop(O,V),o=()=>Da(O=>{var V;return this.getAnimationState(O)==="paused"&&((V=this.getAxisMotionValue(O).animation)==null?void 0:V.play())}),{dragSnapToOrigin:I}=this.getProps();this.panSession=new ES(s,{onSessionStart:_,onStart:T,onMove:S,onSessionEnd:k,resumeAnimation:o},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:I,contextWindow:TS(this.visualElement)})}stop(s,c){const p=this.isDragging;if(this.cancel(),!p)return;const{velocity:_}=c;this.startAnimation(_);const{onDragEnd:T}=this.getProps();T&&gi.postRender(()=>T(s,c))}cancel(){this.isDragging=!1;const{projection:s,animationState:c}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:p}=this.getProps();!p&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),c&&c.setActive("whileDrag",!1)}updateAxis(s,c,p){const{drag:_}=this.getProps();if(!p||!Vg(s,_,this.currentDirection))return;const T=this.getAxisMotionValue(s);let S=this.originPoint[s]+p[s];this.constraints&&this.constraints[s]&&(S=hR(S,this.constraints[s],this.elastic[s])),T.set(S)}resolveConstraints(){var T;const{dragConstraints:s,dragElastic:c}=this.getProps(),p=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(T=this.visualElement.projection)==null?void 0:T.layout,_=this.constraints;s&&jf(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&p?this.constraints=dR(p.layoutBox,s):this.constraints=!1,this.elastic=gR(c),_!==this.constraints&&p&&this.constraints&&!this.hasMutatedConstraints&&Da(S=>{this.constraints!==!1&&this.getAxisMotionValue(S)&&(this.constraints[S]=mR(p.layoutBox[S],this.constraints[S]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:c}=this.getProps();if(!s||!jf(s))return!1;const p=s.current,{projection:_}=this.visualElement;if(!_||!_.layout)return!1;const T=aR(p,_.root,this.visualElement.getTransformPagePoint());let S=fR(_.layout.layoutBox,T);if(c){const k=c(JI(S));this.hasMutatedConstraints=!!k,k&&(S=yS(k))}return S}startAnimation(s){const{drag:c,dragMomentum:p,dragElastic:_,dragTransition:T,dragSnapToOrigin:S,onDragTransitionEnd:k}=this.getProps(),o=this.constraints||{},I=Da(O=>{if(!Vg(O,c,this.currentDirection))return;let V=o&&o[O]||{};S&&(V={min:0,max:0});const q=_?200:1e6,ee=_?40:1e7,H={type:"inertia",velocity:p?s[O]:0,bounceStiffness:q,bounceDamping:ee,timeConstant:750,restDelta:1,restSpeed:10,...T,...V};return this.startAxisValueAnimation(O,H)});return Promise.all(I).then(k)}startAxisValueAnimation(s,c){const p=this.getAxisMotionValue(s);return l0(this.visualElement,s),p.start(cx(s,p,0,c,this.visualElement,!1))}stopAnimation(){Da(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){Da(s=>{var c;return(c=this.getAxisMotionValue(s).animation)==null?void 0:c.pause()})}getAnimationState(s){var c;return(c=this.getAxisMotionValue(s).animation)==null?void 0:c.state}getAxisMotionValue(s){const c=`_drag${s.toUpperCase()}`,p=this.visualElement.getProps(),_=p[c];return _||this.visualElement.getValue(s,(p.initial?p.initial[s]:void 0)||0)}snapToCursor(s){Da(c=>{const{drag:p}=this.getProps();if(!Vg(c,p,this.currentDirection))return;const{projection:_}=this.visualElement,T=this.getAxisMotionValue(c);if(_&&_.layout){const{min:S,max:k}=_.layout.layoutBox[c];T.set(s[c]-mi(S,k,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:c}=this.getProps(),{projection:p}=this.visualElement;if(!jf(c)||!p||!this.constraints)return;this.stopAnimation();const _={x:0,y:0};Da(S=>{const k=this.getAxisMotionValue(S);if(k&&this.constraints!==!1){const o=k.get();_[S]=pR({min:o,max:o},this.constraints[S])}});const{transformTemplate:T}=this.visualElement.getProps();this.visualElement.current.style.transform=T?T({},""):"none",p.root&&p.root.updateScroll(),p.updateLayout(),this.resolveConstraints(),Da(S=>{if(!Vg(S,s,null))return;const k=this.getAxisMotionValue(S),{min:o,max:I}=this.constraints[S];k.set(mi(o,I,_[S]))})}addListeners(){if(!this.visualElement.current)return;yR.set(this.visualElement,this);const s=this.visualElement.current,c=mm(s,"pointerdown",o=>{const{drag:I,dragListener:O=!0}=this.getProps();I&&O&&this.start(o)}),p=()=>{const{dragConstraints:o}=this.getProps();jf(o)&&o.current&&(this.constraints=this.resolveRefConstraints())},{projection:_}=this.visualElement,T=_.addEventListener("measure",p);_&&!_.layout&&(_.root&&_.root.updateScroll(),_.updateLayout()),gi.read(p);const S=Cm(window,"resize",()=>this.scalePositionWithinConstraints()),k=_.addEventListener("didUpdate",({delta:o,hasLayoutChanged:I})=>{this.isDragging&&I&&(Da(O=>{const V=this.getAxisMotionValue(O);V&&(this.originPoint[O]+=o[O].translate,V.set(V.get()+o[O].translate))}),this.visualElement.render())});return()=>{S(),c(),T(),k&&k()}}getProps(){const s=this.visualElement.getProps(),{drag:c=!1,dragDirectionLock:p=!1,dragPropagation:_=!1,dragConstraints:T=!1,dragElastic:S=d0,dragMomentum:k=!0}=s;return{...s,drag:c,dragDirectionLock:p,dragPropagation:_,dragConstraints:T,dragElastic:S,dragMomentum:k}}}function Vg(i,s,c){return(s===!0||s===i)&&(c===null||c===i)}function vR(i,s=10){let c=null;return Math.abs(i.y)>s?c="y":Math.abs(i.x)>s&&(c="x"),c}class xR extends fh{constructor(s){super(s),this.removeGroupControls=Ba,this.removeListeners=Ba,this.controls=new _R(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ba}unmount(){this.removeGroupControls(),this.removeListeners()}}const rb=i=>(s,c)=>{i&&gi.postRender(()=>i(s,c))};class wR extends fh{constructor(){super(...arguments),this.removePointerDownListener=Ba}onPointerDown(s){this.session=new ES(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:TS(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:c,onPan:p,onPanEnd:_}=this.node.getProps();return{onSessionStart:rb(s),onStart:rb(c),onMove:p,onEnd:(T,S)=>{delete this.session,_&&gi.postRender(()=>_(T,S))}}}mount(){this.removePointerDownListener=mm(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Qg={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ib(i,s){return s.max===s.min?0:i/(s.max-s.min)*100}const nm={correct:(i,s)=>{if(!s.target)return i;if(typeof i=="string")if(On.test(i))i=parseFloat(i);else return i;const c=ib(i,s.target.x),p=ib(i,s.target.y);return`${c}% ${p}%`}},bR={correct:(i,{treeScale:s,projectionDelta:c})=>{const p=i,_=hh.parse(i);if(_.length>5)return p;const T=hh.createTransformer(i),S=typeof _[0]!="number"?1:0,k=c.x.scale*s.x,o=c.y.scale*s.y;_[0+S]/=k,_[1+S]/=o;const I=mi(k,o,.5);return typeof _[2+S]=="number"&&(_[2+S]/=I),typeof _[3+S]=="number"&&(_[3+S]/=I),T(_)}};class TR extends Ee.Component{componentDidMount(){const{visualElement:s,layoutGroup:c,switchLayoutGroup:p,layoutId:_}=this.props,{projection:T}=s;aI(ER),T&&(c.group&&c.group.add(T),p&&p.register&&_&&p.register(T),T.root.didUpdate(),T.addEventListener("animationComplete",()=>{this.safeToRemove()}),T.setOptions({...T.options,onExitComplete:()=>this.safeToRemove()})),Qg.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:c,visualElement:p,drag:_,isPresent:T}=this.props,S=p.projection;return S&&(S.isPresent=T,_||s.layoutDependency!==c||c===void 0||s.isPresent!==T?S.willUpdate():this.safeToRemove(),s.isPresent!==T&&(T?S.promote():S.relegate()||gi.postRender(()=>{const k=S.getStack();(!k||!k.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),ex.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:c,switchLayoutGroup:p}=this.props,{projection:_}=s;_&&(_.scheduleCheckAfterUnmount(),c&&c.group&&c.group.remove(_),p&&p.deregister&&p.deregister(_))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function CS(i){const[s,c]=cE(),p=Ee.useContext(R0);return Be.jsx(TR,{...i,layoutGroup:p,switchLayoutGroup:Ee.useContext(iS),isPresent:s,safeToRemove:c})}const ER={borderRadius:{...nm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:nm,borderTopRightRadius:nm,borderBottomLeftRadius:nm,borderBottomRightRadius:nm,boxShadow:bR};function SR(i,s,c){const p=es(i)?i:bm(i);return p.start(cx("",p,s,c)),p.animation}function CR(i){return i instanceof SVGElement&&i.tagName!=="svg"}const AR=(i,s)=>i.depth-s.depth;class MR{constructor(){this.children=[],this.isDirty=!1}add(s){O0(this.children,s),this.isDirty=!0}remove(s){B0(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(AR),this.isDirty=!1,this.children.forEach(s)}}function kR(i,s){const c=zs.now(),p=({timestamp:_})=>{const T=_-c;T>=s&&(ch(p),i(T-s))};return gi.setup(p,!0),()=>ch(p)}const AS=["TopLeft","TopRight","BottomLeft","BottomRight"],PR=AS.length,ob=i=>typeof i=="string"?parseFloat(i):i,sb=i=>typeof i=="number"||On.test(i);function IR(i,s,c,p,_,T){_?(i.opacity=mi(0,c.opacity??1,RR(p)),i.opacityExit=mi(s.opacity??1,0,LR(p))):T&&(i.opacity=mi(s.opacity??1,c.opacity??1,p));for(let S=0;S<PR;S++){const k=`border${AS[S]}Radius`;let o=ab(s,k),I=ab(c,k);if(o===void 0&&I===void 0)continue;o||(o=0),I||(I=0),o===0||I===0||sb(o)===sb(I)?(i[k]=Math.max(mi(ob(o),ob(I),p),0),(mu.test(I)||mu.test(o))&&(i[k]+="%")):i[k]=I}(s.rotate||c.rotate)&&(i.rotate=mi(s.rotate||0,c.rotate||0,p))}function ab(i,s){return i[s]!==void 0?i[s]:i.borderRadius}const RR=MS(0,.5,wE),LR=MS(.5,.95,Ba);function MS(i,s,c){return p=>p<i?0:p>s?1:c(vm(i,s,p))}function lb(i,s){i.min=s.min,i.max=s.max}function La(i,s){lb(i.x,s.x),lb(i.y,s.y)}function ub(i,s){i.translate=s.translate,i.scale=s.scale,i.originPoint=s.originPoint,i.origin=s.origin}function cb(i,s,c,p,_){return i-=s,i=_y(i,1/c,p),_!==void 0&&(i=_y(i,1/_,p)),i}function DR(i,s=0,c=1,p=.5,_,T=i,S=i){if(mu.test(s)&&(s=parseFloat(s),s=mi(S.min,S.max,s/100)-S.min),typeof s!="number")return;let k=mi(T.min,T.max,p);i===T&&(k-=s),i.min=cb(i.min,s,c,k,_),i.max=cb(i.max,s,c,k,_)}function hb(i,s,[c,p,_],T,S){DR(i,s[c],s[p],s[_],s.scale,T,S)}const zR=["x","scaleX","originX"],OR=["y","scaleY","originY"];function db(i,s,c,p){hb(i.x,s,zR,c?c.x:void 0,p?p.x:void 0),hb(i.y,s,OR,c?c.y:void 0,p?p.y:void 0)}function fb(i){return i.translate===0&&i.scale===1}function kS(i){return fb(i.x)&&fb(i.y)}function pb(i,s){return i.min===s.min&&i.max===s.max}function BR(i,s){return pb(i.x,s.x)&&pb(i.y,s.y)}function mb(i,s){return Math.round(i.min)===Math.round(s.min)&&Math.round(i.max)===Math.round(s.max)}function PS(i,s){return mb(i.x,s.x)&&mb(i.y,s.y)}function gb(i){return ms(i.x)/ms(i.y)}function yb(i,s){return i.translate===s.translate&&i.scale===s.scale&&i.originPoint===s.originPoint}class FR{constructor(){this.members=[]}add(s){O0(this.members,s),s.scheduleRender()}remove(s){if(B0(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const c=this.members[this.members.length-1];c&&this.promote(c)}}relegate(s){const c=this.members.findIndex(_=>s===_);if(c===0)return!1;let p;for(let _=c;_>=0;_--){const T=this.members[_];if(T.isPresent!==!1){p=T;break}}return p?(this.promote(p),!0):!1}promote(s,c){const p=this.lead;if(s!==p&&(this.prevLead=p,this.lead=s,s.show(),p)){p.instance&&p.scheduleRender(),s.scheduleRender(),s.resumeFrom=p,c&&(s.resumeFrom.preserveOpacity=!0),p.snapshot&&(s.snapshot=p.snapshot,s.snapshot.latestValues=p.animationValues||p.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:_}=s.options;_===!1&&p.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:c,resumingFrom:p}=s;c.onExitComplete&&c.onExitComplete(),p&&p.options.onExitComplete&&p.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function NR(i,s,c){let p="";const _=i.x.translate/s.x,T=i.y.translate/s.y,S=(c==null?void 0:c.z)||0;if((_||T||S)&&(p=`translate3d(${_}px, ${T}px, ${S}px) `),(s.x!==1||s.y!==1)&&(p+=`scale(${1/s.x}, ${1/s.y}) `),c){const{transformPerspective:I,rotate:O,rotateX:V,rotateY:q,skewX:ee,skewY:H}=c;I&&(p=`perspective(${I}px) ${p}`),O&&(p+=`rotate(${O}deg) `),V&&(p+=`rotateX(${V}deg) `),q&&(p+=`rotateY(${q}deg) `),ee&&(p+=`skewX(${ee}deg) `),H&&(p+=`skewY(${H}deg) `)}const k=i.x.scale*s.x,o=i.y.scale*s.y;return(k!==1||o!==1)&&(p+=`scale(${k}, ${o})`),p||"none"}const Q_=["","X","Y","Z"],jR={visibility:"hidden"},_b=1e3;let VR=0;function ev(i,s,c,p){const{latestValues:_}=s;_[i]&&(c[i]=_[i],s.setStaticValue(i,0),p&&(p[i]=0))}function IS(i){if(i.hasCheckedOptimisedAppear=!0,i.root===i)return;const{visualElement:s}=i.options;if(!s)return;const c=fS(s);if(window.MotionHasOptimisedAnimation(c,"transform")){const{layout:_,layoutId:T}=i.options;window.MotionCancelOptimisedAnimation(c,"transform",gi,!(_||T))}const{parent:p}=i;p&&!p.hasCheckedOptimisedAppear&&IS(p)}function RS({attachResizeListener:i,defaultParent:s,measureScroll:c,checkIsScrollRoot:p,resetTransform:_}){return class{constructor(S={},k=s==null?void 0:s()){this.id=VR++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(GR),this.nodes.forEach(XR),this.nodes.forEach(KR),this.nodes.forEach(qR)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=S,this.root=k?k.root||k:this,this.path=k?[...k.path,k]:[],this.parent=k,this.depth=k?k.depth+1:0;for(let o=0;o<this.path.length;o++)this.path[o].shouldResetTransform=!0;this.root===this&&(this.nodes=new MR)}addEventListener(S,k){return this.eventHandlers.has(S)||this.eventHandlers.set(S,new j0),this.eventHandlers.get(S).add(k)}notifyListeners(S,...k){const o=this.eventHandlers.get(S);o&&o.notify(...k)}hasListeners(S){return this.eventHandlers.has(S)}mount(S,k=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=CR(S),this.instance=S;const{layoutId:o,layout:I,visualElement:O}=this.options;if(O&&!O.current&&O.mount(S),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),k&&(I||o)&&(this.isLayoutDirty=!0),i){let V;const q=()=>this.root.updateBlockedByResize=!1;i(S,()=>{this.root.updateBlockedByResize=!0,V&&V(),V=kR(q,250),Qg.hasAnimatedSinceResize&&(Qg.hasAnimatedSinceResize=!1,this.nodes.forEach(xb))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&O&&(o||I)&&this.addEventListener("didUpdate",({delta:V,hasLayoutChanged:q,hasRelativeLayoutChanged:ee,layout:H})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const j=this.options.transition||O.getDefaultTransition()||tL,{onLayoutAnimationStart:Z,onLayoutAnimationComplete:ne}=O.getProps(),xe=!this.targetLayout||!PS(this.targetLayout,H),ce=!q&&ee;if(this.options.layoutRoot||this.resumeFrom||ce||q&&(xe||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(V,ce);const me={...J0(j,"layout"),onPlay:Z,onComplete:ne};(O.shouldReduceMotion||this.options.layoutRoot)&&(me.delay=0,me.type=!1),this.startAnimation(me)}else q||xb(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=H})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const S=this.getStack();S&&S.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ch(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(YR),this.animationId++)}getTransformTemplate(){const{visualElement:S}=this.options;return S&&S.getProps().transformTemplate}willUpdate(S=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&IS(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let O=0;O<this.path.length;O++){const V=this.path[O];V.shouldResetTransform=!0,V.updateScroll("snapshot"),V.options.layoutRoot&&V.willUpdate(!1)}const{layoutId:k,layout:o}=this.options;if(k===void 0&&!o)return;const I=this.getTransformTemplate();this.prevTransformTemplateValue=I?I(this.latestValues,""):void 0,this.updateSnapshot(),S&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(vb);return}this.isUpdating||this.nodes.forEach(ZR),this.isUpdating=!1,this.nodes.forEach(HR),this.nodes.forEach(UR),this.nodes.forEach($R),this.clearAllSnapshots();const k=zs.now();Io.delta=hc(0,1e3/60,k-Io.timestamp),Io.timestamp=k,Io.isProcessing=!0,q_.update.process(Io),q_.preRender.process(Io),q_.render.process(Io),Io.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ex.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(WR),this.sharedNodes.forEach(JR)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ms(this.snapshot.measuredBox.x)&&!ms(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let o=0;o<this.path.length;o++)this.path[o].updateScroll();const S=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Oi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:k}=this.options;k&&k.notify("LayoutMeasure",this.layout.layoutBox,S?S.layoutBox:void 0)}updateScroll(S="measure"){let k=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===S&&(k=!1),k){const o=p(this.instance);this.scroll={animationId:this.root.animationId,phase:S,isRoot:o,offset:c(this.instance),wasRoot:this.scroll?this.scroll.isRoot:o}}}resetTransform(){if(!_)return;const S=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,k=this.projectionDelta&&!kS(this.projectionDelta),o=this.getTransformTemplate(),I=o?o(this.latestValues,""):void 0,O=I!==this.prevTransformTemplateValue;S&&(k||wd(this.latestValues)||O)&&(_(this.instance,I),this.shouldResetTransform=!1,this.scheduleRender())}measure(S=!0){const k=this.measurePageBox();let o=this.removeElementScroll(k);return S&&(o=this.removeTransform(o)),nL(o),{animationId:this.root.animationId,measuredBox:k,layoutBox:o,latestValues:{},source:this.id}}measurePageBox(){var I;const{visualElement:S}=this.options;if(!S)return Oi();const k=S.measureViewportBox();if(!(((I=this.scroll)==null?void 0:I.wasRoot)||this.path.some(rL))){const{scroll:O}=this.root;O&&(Uf(k.x,O.offset.x),Uf(k.y,O.offset.y))}return k}removeElementScroll(S){var o;const k=Oi();if(La(k,S),(o=this.scroll)!=null&&o.wasRoot)return k;for(let I=0;I<this.path.length;I++){const O=this.path[I],{scroll:V,options:q}=O;O!==this.root&&V&&q.layoutScroll&&(V.wasRoot&&La(k,S),Uf(k.x,V.offset.x),Uf(k.y,V.offset.y))}return k}applyTransform(S,k=!1){const o=Oi();La(o,S);for(let I=0;I<this.path.length;I++){const O=this.path[I];!k&&O.options.layoutScroll&&O.scroll&&O!==O.root&&$f(o,{x:-O.scroll.offset.x,y:-O.scroll.offset.y}),wd(O.latestValues)&&$f(o,O.latestValues)}return wd(this.latestValues)&&$f(o,this.latestValues),o}removeTransform(S){const k=Oi();La(k,S);for(let o=0;o<this.path.length;o++){const I=this.path[o];if(!I.instance||!wd(I.latestValues))continue;c0(I.latestValues)&&I.updateSnapshot();const O=Oi(),V=I.measurePageBox();La(O,V),db(k,I.latestValues,I.snapshot?I.snapshot.layoutBox:void 0,O)}return wd(this.latestValues)&&db(k,this.latestValues),k}setTargetDelta(S){this.targetDelta=S,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(S){this.options={...this.options,...S,crossfade:S.crossfade!==void 0?S.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Io.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(S=!1){var q;const k=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=k.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=k.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=k.isSharedProjectionDirty);const o=!!this.resumingFrom||this!==k;if(!(S||o&&this.isSharedProjectionDirty||this.isProjectionDirty||(q=this.parent)!=null&&q.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:O,layoutId:V}=this.options;if(!(!this.layout||!(O||V))){if(this.resolvedRelativeTargetAt=Io.timestamp,!this.targetDelta&&!this.relativeTarget){const ee=this.getClosestProjectingParent();ee&&ee.layout&&this.animationProgress!==1?(this.relativeParent=ee,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Oi(),this.relativeTargetOrigin=Oi(),ym(this.relativeTargetOrigin,this.layout.layoutBox,ee.layout.layoutBox),La(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Oi(),this.targetWithTransforms=Oi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),oR(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):La(this.target,this.layout.layoutBox),wS(this.target,this.targetDelta)):La(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const ee=this.getClosestProjectingParent();ee&&!!ee.resumingFrom==!!this.resumingFrom&&!ee.options.layoutScroll&&ee.target&&this.animationProgress!==1?(this.relativeParent=ee,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Oi(),this.relativeTargetOrigin=Oi(),ym(this.relativeTargetOrigin,this.target,ee.target),La(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||c0(this.parent.latestValues)||xS(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var H;const S=this.getLead(),k=!!this.resumingFrom||this!==S;let o=!0;if((this.isProjectionDirty||(H=this.parent)!=null&&H.isProjectionDirty)&&(o=!1),k&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(o=!1),this.resolvedRelativeTargetAt===Io.timestamp&&(o=!1),o)return;const{layout:I,layoutId:O}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(I||O))return;La(this.layoutCorrected,this.layout.layoutBox);const V=this.treeScale.x,q=this.treeScale.y;sR(this.layoutCorrected,this.treeScale,this.path,k),S.layout&&!S.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(S.target=S.layout.layoutBox,S.targetWithTransforms=Oi());const{target:ee}=S;if(!ee){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ub(this.prevProjectionDelta.x,this.projectionDelta.x),ub(this.prevProjectionDelta.y,this.projectionDelta.y)),gm(this.projectionDelta,this.layoutCorrected,ee,this.latestValues),(this.treeScale.x!==V||this.treeScale.y!==q||!yb(this.projectionDelta.x,this.prevProjectionDelta.x)||!yb(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",ee))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(S=!0){var k;if((k=this.options.visualElement)==null||k.scheduleRender(),S){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Vf(),this.projectionDelta=Vf(),this.projectionDeltaWithTransform=Vf()}setAnimationOrigin(S,k=!1){const o=this.snapshot,I=o?o.latestValues:{},O={...this.latestValues},V=Vf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!k;const q=Oi(),ee=o?o.source:void 0,H=this.layout?this.layout.source:void 0,j=ee!==H,Z=this.getStack(),ne=!Z||Z.members.length<=1,xe=!!(j&&!ne&&this.options.crossfade===!0&&!this.path.some(eL));this.animationProgress=0;let ce;this.mixTargetDelta=me=>{const de=me/1e3;wb(V.x,S.x,de),wb(V.y,S.y,de),this.setTargetDelta(V),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ym(q,this.layout.layoutBox,this.relativeParent.layout.layoutBox),QR(this.relativeTarget,this.relativeTargetOrigin,q,de),ce&&BR(this.relativeTarget,ce)&&(this.isProjectionDirty=!1),ce||(ce=Oi()),La(ce,this.relativeTarget)),j&&(this.animationValues=O,IR(O,I,this.latestValues,de,xe,ne)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=de},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(S){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ch(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gi.update(()=>{Qg.hasAnimatedSinceResize=!0,this.currentAnimation=SR(0,_b,{...S,onUpdate:k=>{this.mixTargetDelta(k),S.onUpdate&&S.onUpdate(k)},onStop:()=>{},onComplete:()=>{S.onComplete&&S.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const S=this.getStack();S&&S.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(_b),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const S=this.getLead();let{targetWithTransforms:k,target:o,layout:I,latestValues:O}=S;if(!(!k||!o||!I)){if(this!==S&&this.layout&&I&&LS(this.options.animationType,this.layout.layoutBox,I.layoutBox)){o=this.target||Oi();const V=ms(this.layout.layoutBox.x);o.x.min=S.target.x.min,o.x.max=o.x.min+V;const q=ms(this.layout.layoutBox.y);o.y.min=S.target.y.min,o.y.max=o.y.min+q}La(k,o),$f(k,O),gm(this.projectionDeltaWithTransform,this.layoutCorrected,k,O)}}registerSharedNode(S,k){this.sharedNodes.has(S)||this.sharedNodes.set(S,new FR),this.sharedNodes.get(S).add(k);const I=k.options.initialPromotionConfig;k.promote({transition:I?I.transition:void 0,preserveFollowOpacity:I&&I.shouldPreserveFollowOpacity?I.shouldPreserveFollowOpacity(k):void 0})}isLead(){const S=this.getStack();return S?S.lead===this:!0}getLead(){var k;const{layoutId:S}=this.options;return S?((k=this.getStack())==null?void 0:k.lead)||this:this}getPrevLead(){var k;const{layoutId:S}=this.options;return S?(k=this.getStack())==null?void 0:k.prevLead:void 0}getStack(){const{layoutId:S}=this.options;if(S)return this.root.sharedNodes.get(S)}promote({needsReset:S,transition:k,preserveFollowOpacity:o}={}){const I=this.getStack();I&&I.promote(this,o),S&&(this.projectionDelta=void 0,this.needsReset=!0),k&&this.setOptions({transition:k})}relegate(){const S=this.getStack();return S?S.relegate(this):!1}resetSkewAndRotation(){const{visualElement:S}=this.options;if(!S)return;let k=!1;const{latestValues:o}=S;if((o.z||o.rotate||o.rotateX||o.rotateY||o.rotateZ||o.skewX||o.skewY)&&(k=!0),!k)return;const I={};o.z&&ev("z",S,I,this.animationValues);for(let O=0;O<Q_.length;O++)ev(`rotate${Q_[O]}`,S,I,this.animationValues),ev(`skew${Q_[O]}`,S,I,this.animationValues);S.render();for(const O in I)S.setStaticValue(O,I[O]),this.animationValues&&(this.animationValues[O]=I[O]);S.scheduleRender()}getProjectionStyles(S){if(!this.instance||this.isSVG)return;if(!this.isVisible)return jR;const k={visibility:""},o=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,k.opacity="",k.pointerEvents=Jg(S==null?void 0:S.pointerEvents)||"",k.transform=o?o(this.latestValues,""):"none",k;const I=this.getLead();if(!this.projectionDelta||!this.layout||!I.target){const ee={};return this.options.layoutId&&(ee.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,ee.pointerEvents=Jg(S==null?void 0:S.pointerEvents)||""),this.hasProjected&&!wd(this.latestValues)&&(ee.transform=o?o({},""):"none",this.hasProjected=!1),ee}const O=I.animationValues||I.latestValues;this.applyTransformsToTarget(),k.transform=NR(this.projectionDeltaWithTransform,this.treeScale,O),o&&(k.transform=o(O,k.transform));const{x:V,y:q}=this.projectionDelta;k.transformOrigin=`${V.origin*100}% ${q.origin*100}% 0`,I.animationValues?k.opacity=I===this?O.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:O.opacityExit:k.opacity=I===this?O.opacity!==void 0?O.opacity:"":O.opacityExit!==void 0?O.opacityExit:0;for(const ee in Em){if(O[ee]===void 0)continue;const{correct:H,applyTo:j,isCSSVariable:Z}=Em[ee],ne=k.transform==="none"?O[ee]:H(O[ee],I);if(j){const xe=j.length;for(let ce=0;ce<xe;ce++)k[j[ce]]=ne}else Z?this.options.visualElement.renderState.vars[ee]=ne:k[ee]=ne}return this.options.layoutId&&(k.pointerEvents=I===this?Jg(S==null?void 0:S.pointerEvents)||"":"none"),k}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(S=>{var k;return(k=S.currentAnimation)==null?void 0:k.stop()}),this.root.nodes.forEach(vb),this.root.sharedNodes.clear()}}}function UR(i){i.updateLayout()}function $R(i){var c;const s=((c=i.resumeFrom)==null?void 0:c.snapshot)||i.snapshot;if(i.isLead()&&i.layout&&s&&i.hasListeners("didUpdate")){const{layoutBox:p,measuredBox:_}=i.layout,{animationType:T}=i.options,S=s.source!==i.layout.source;T==="size"?Da(V=>{const q=S?s.measuredBox[V]:s.layoutBox[V],ee=ms(q);q.min=p[V].min,q.max=q.min+ee}):LS(T,s.layoutBox,p)&&Da(V=>{const q=S?s.measuredBox[V]:s.layoutBox[V],ee=ms(p[V]);q.max=q.min+ee,i.relativeTarget&&!i.currentAnimation&&(i.isProjectionDirty=!0,i.relativeTarget[V].max=i.relativeTarget[V].min+ee)});const k=Vf();gm(k,p,s.layoutBox);const o=Vf();S?gm(o,i.applyTransform(_,!0),s.measuredBox):gm(o,p,s.layoutBox);const I=!kS(k);let O=!1;if(!i.resumeFrom){const V=i.getClosestProjectingParent();if(V&&!V.resumeFrom){const{snapshot:q,layout:ee}=V;if(q&&ee){const H=Oi();ym(H,s.layoutBox,q.layoutBox);const j=Oi();ym(j,p,ee.layoutBox),PS(H,j)||(O=!0),V.options.layoutRoot&&(i.relativeTarget=j,i.relativeTargetOrigin=H,i.relativeParent=V)}}}i.notifyListeners("didUpdate",{layout:p,snapshot:s,delta:o,layoutDelta:k,hasLayoutChanged:I,hasRelativeLayoutChanged:O})}else if(i.isLead()){const{onExitComplete:p}=i.options;p&&p()}i.options.transition=void 0}function GR(i){i.parent&&(i.isProjecting()||(i.isProjectionDirty=i.parent.isProjectionDirty),i.isSharedProjectionDirty||(i.isSharedProjectionDirty=!!(i.isProjectionDirty||i.parent.isProjectionDirty||i.parent.isSharedProjectionDirty)),i.isTransformDirty||(i.isTransformDirty=i.parent.isTransformDirty))}function qR(i){i.isProjectionDirty=i.isSharedProjectionDirty=i.isTransformDirty=!1}function WR(i){i.clearSnapshot()}function vb(i){i.clearMeasurements()}function ZR(i){i.isLayoutDirty=!1}function HR(i){const{visualElement:s}=i.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),i.resetTransform()}function xb(i){i.finishAnimation(),i.targetDelta=i.relativeTarget=i.target=void 0,i.isProjectionDirty=!0}function XR(i){i.resolveTargetDelta()}function KR(i){i.calcProjection()}function YR(i){i.resetSkewAndRotation()}function JR(i){i.removeLeadSnapshot()}function wb(i,s,c){i.translate=mi(s.translate,0,c),i.scale=mi(s.scale,1,c),i.origin=s.origin,i.originPoint=s.originPoint}function bb(i,s,c,p){i.min=mi(s.min,c.min,p),i.max=mi(s.max,c.max,p)}function QR(i,s,c,p){bb(i.x,s.x,c.x,p),bb(i.y,s.y,c.y,p)}function eL(i){return i.animationValues&&i.animationValues.opacityExit!==void 0}const tL={duration:.45,ease:[.4,0,.1,1]},Tb=i=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(i),Eb=Tb("applewebkit/")&&!Tb("chrome/")?Math.round:Ba;function Sb(i){i.min=Eb(i.min),i.max=Eb(i.max)}function nL(i){Sb(i.x),Sb(i.y)}function LS(i,s,c){return i==="position"||i==="preserve-aspect"&&!iR(gb(s),gb(c),.2)}function rL(i){var s;return i!==i.root&&((s=i.scroll)==null?void 0:s.wasRoot)}const iL=RS({attachResizeListener:(i,s)=>Cm(i,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),tv={current:void 0},DS=RS({measureScroll:i=>({x:i.scrollLeft,y:i.scrollTop}),defaultParent:()=>{if(!tv.current){const i=new iL({});i.mount(window),i.setOptions({layoutScroll:!0}),tv.current=i}return tv.current},resetTransform:(i,s)=>{i.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:i=>window.getComputedStyle(i).position==="fixed"}),oL={pan:{Feature:wR},drag:{Feature:xR,ProjectionNode:DS,MeasureLayout:CS}};function Cb(i,s,c){const{props:p}=i;i.animationState&&p.whileHover&&i.animationState.setActive("whileHover",c==="Start");const _="onHover"+c,T=p[_];T&&gi.postRender(()=>T(s,Fm(s)))}class sL extends fh{mount(){const{current:s}=this.node;s&&(this.unmount=OP(s,(c,p)=>(Cb(this.node,p,"Start"),_=>Cb(this.node,_,"End"))))}unmount(){}}class aL extends fh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=zm(Cm(this.node.current,"focus",()=>this.onFocus()),Cm(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Ab(i,s,c){const{props:p}=i;if(i.current instanceof HTMLButtonElement&&i.current.disabled)return;i.animationState&&p.whileTap&&i.animationState.setActive("whileTap",c==="Start");const _="onTap"+(c==="End"?"":c),T=p[_];T&&gi.postRender(()=>T(s,Fm(s)))}class lL extends fh{mount(){const{current:s}=this.node;s&&(this.unmount=jP(s,(c,p)=>(Ab(this.node,p,"Start"),(_,{success:T})=>Ab(this.node,_,T?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const f0=new WeakMap,nv=new WeakMap,uL=i=>{const s=f0.get(i.target);s&&s(i)},cL=i=>{i.forEach(uL)};function hL({root:i,...s}){const c=i||document;nv.has(c)||nv.set(c,{});const p=nv.get(c),_=JSON.stringify(s);return p[_]||(p[_]=new IntersectionObserver(cL,{root:i,...s})),p[_]}function dL(i,s,c){const p=hL(s);return f0.set(i,c),p.observe(i),()=>{f0.delete(i),p.unobserve(i)}}const fL={some:0,all:1};class pL extends fh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:c,margin:p,amount:_="some",once:T}=s,S={root:c?c.current:void 0,rootMargin:p,threshold:typeof _=="number"?_:fL[_]},k=o=>{const{isIntersecting:I}=o;if(this.isInView===I||(this.isInView=I,T&&!I&&this.hasEnteredView))return;I&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",I);const{onViewportEnter:O,onViewportLeave:V}=this.node.getProps(),q=I?O:V;q&&q(o)};return dL(this.node.current,S,k)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:c}=this.node;["amount","margin","root"].some(mL(s,c))&&this.startObserver()}unmount(){}}function mL({viewport:i={}},{viewport:s={}}={}){return c=>i[c]!==s[c]}const gL={inView:{Feature:pL},tap:{Feature:lL},focus:{Feature:aL},hover:{Feature:sL}},yL={layout:{ProjectionNode:DS,MeasureLayout:CS}},p0={current:null},zS={current:!1};function _L(){if(zS.current=!0,!!D0)if(window.matchMedia){const i=window.matchMedia("(prefers-reduced-motion)"),s=()=>p0.current=i.matches;i.addListener(s),s()}else p0.current=!1}const vL=new WeakMap;function xL(i,s,c){for(const p in s){const _=s[p],T=c[p];if(es(_))i.addValue(p,_);else if(es(T))i.addValue(p,bm(_,{owner:i}));else if(T!==_)if(i.hasValue(p)){const S=i.getValue(p);S.liveStyle===!0?S.jump(_):S.hasAnimated||S.set(_)}else{const S=i.getStaticValue(p);i.addValue(p,bm(S!==void 0?S:_,{owner:i}))}}for(const p in c)s[p]===void 0&&i.removeValue(p);return s}const Mb=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class wL{scrapeMotionValuesFromProps(s,c,p){return{}}constructor({parent:s,props:c,presenceContext:p,reducedMotionConfig:_,blockInitialAnimation:T,visualState:S},k={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Y0,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const q=zs.now();this.renderScheduledAt<q&&(this.renderScheduledAt=q,gi.render(this.render,!1,!0))};const{latestValues:o,renderState:I}=S;this.latestValues=o,this.baseTarget={...o},this.initialValues=c.initial?{...o}:{},this.renderState=I,this.parent=s,this.props=c,this.presenceContext=p,this.depth=s?s.depth+1:0,this.reducedMotionConfig=_,this.options=k,this.blockInitialAnimation=!!T,this.isControllingVariants=Iy(c),this.isVariantNode=nS(c),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:O,...V}=this.scrapeMotionValuesFromProps(c,{},this);for(const q in V){const ee=V[q];o[q]!==void 0&&es(ee)&&ee.set(o[q],!1)}}mount(s){this.current=s,vL.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((c,p)=>this.bindToMotionValue(p,c)),zS.current||_L(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:p0.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),ch(this.notifyUpdate),ch(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const c=this.features[s];c&&(c.unmount(),c.isMounted=!1)}this.current=null}bindToMotionValue(s,c){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const p=Jf.has(s);p&&this.onBindTransform&&this.onBindTransform();const _=c.on("change",k=>{this.latestValues[s]=k,this.props.onUpdate&&gi.preRender(this.notifyUpdate),p&&this.projection&&(this.projection.isTransformDirty=!0)}),T=c.on("renderRequest",this.scheduleRender);let S;window.MotionCheckAppearSync&&(S=window.MotionCheckAppearSync(this,s,c)),this.valueSubscriptions.set(s,()=>{_(),T(),S&&S(),c.owner&&c.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in Zf){const c=Zf[s];if(!c)continue;const{isEnabled:p,Feature:_}=c;if(!this.features[s]&&_&&p(this.props)&&(this.features[s]=new _(this)),this.features[s]){const T=this.features[s];T.isMounted?T.update():(T.mount(),T.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Oi()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,c){this.latestValues[s]=c}update(s,c){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=c;for(let p=0;p<Mb.length;p++){const _=Mb[p];this.propEventSubscriptions[_]&&(this.propEventSubscriptions[_](),delete this.propEventSubscriptions[_]);const T="on"+_,S=s[T];S&&(this.propEventSubscriptions[_]=this.on(_,S))}this.prevMotionValues=xL(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const c=this.getClosestVariantNode();if(c)return c.variantChildren&&c.variantChildren.add(s),()=>c.variantChildren.delete(s)}addValue(s,c){const p=this.values.get(s);c!==p&&(p&&this.removeValue(s),this.bindToMotionValue(s,c),this.values.set(s,c),this.latestValues[s]=c.get())}removeValue(s){this.values.delete(s);const c=this.valueSubscriptions.get(s);c&&(c(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,c){if(this.props.values&&this.props.values[s])return this.props.values[s];let p=this.values.get(s);return p===void 0&&c!==void 0&&(p=bm(c===null?void 0:c,{owner:this}),this.addValue(s,p)),p}readValue(s,c){let p=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return p!=null&&(typeof p=="string"&&(dE(p)||fE(p))?p=parseFloat(p):!GP(p)&&hh.test(c)&&(p=XE(s,c)),this.setBaseTarget(s,es(p)?p.get():p)),es(p)?p.get():p}setBaseTarget(s,c){this.baseTarget[s]=c}getBaseTarget(s){var T;const{initial:c}=this.props;let p;if(typeof c=="string"||typeof c=="object"){const S=lx(this.props,c,(T=this.presenceContext)==null?void 0:T.custom);S&&(p=S[s])}if(c&&p!==void 0)return p;const _=this.getBaseTargetFromProps(this.props,s);return _!==void 0&&!es(_)?_:this.initialValues[s]!==void 0&&p===void 0?void 0:this.baseTarget[s]}on(s,c){return this.events[s]||(this.events[s]=new j0),this.events[s].add(c)}notify(s,...c){this.events[s]&&this.events[s].notify(...c)}}class OS extends wL{constructor(){super(...arguments),this.KeyframeResolver=LP}sortInstanceNodePosition(s,c){return s.compareDocumentPosition(c)&2?1:-1}getBaseTargetFromProps(s,c){return s.style?s.style[c]:void 0}removeValueFromRenderState(s,{vars:c,style:p}){delete c[s],delete p[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;es(s)&&(this.childSubscription=s.on("change",c=>{this.current&&(this.current.textContent=`${c}`)}))}}function BS(i,{style:s,vars:c},p,_){Object.assign(i.style,s,_&&_.getProjectionStyles(p));for(const T in c)i.style.setProperty(T,c[T])}function bL(i){return window.getComputedStyle(i)}class TL extends OS{constructor(){super(...arguments),this.type="html",this.renderInstance=BS}readValueFromInstance(s,c){if(Jf.has(c))return Jk(s,c);{const p=bL(s),_=($0(c)?p.getPropertyValue(c):p[c])||0;return typeof _=="string"?_.trim():_}}measureInstanceViewportBox(s,{transformPagePoint:c}){return bS(s,c)}build(s,c,p){ox(s,c,p.transformTemplate)}scrapeMotionValuesFromProps(s,c,p){return ux(s,c,p)}}const FS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function EL(i,s,c,p){BS(i,s,void 0,p);for(const _ in s.attrs)i.setAttribute(FS.has(_)?_:ix(_),s.attrs[_])}class SL extends OS{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Oi}getBaseTargetFromProps(s,c){return s[c]}readValueFromInstance(s,c){if(Jf.has(c)){const p=HE(c);return p&&p.default||0}return c=FS.has(c)?c:ix(c),s.getAttribute(c)}scrapeMotionValuesFromProps(s,c,p){return dS(s,c,p)}build(s,c,p){lS(s,c,this.isSVGTag,p.transformTemplate)}renderInstance(s,c,p,_){EL(s,c,p,_)}mount(s){this.isSVGTag=cS(s.tagName),super.mount(s)}}const CL=(i,s)=>ax(i)?new SL(s):new TL(s,{allowProjection:i!==Ee.Fragment}),AL=EI({...KI,...gL,...oL,...yL},CL),Cd=XP(AL);var rm={},kb;function ML(){if(kb)return rm;kb=1,Object.defineProperty(rm,"__esModule",{value:!0}),rm.parse=S,rm.serialize=I;const i=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,s=/^[\u0021-\u003A\u003C-\u007E]*$/,c=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,p=/^[\u0020-\u003A\u003D-\u007E]*$/,_=Object.prototype.toString,T=(()=>{const q=function(){};return q.prototype=Object.create(null),q})();function S(q,ee){const H=new T,j=q.length;if(j<2)return H;const Z=(ee==null?void 0:ee.decode)||O;let ne=0;do{const xe=q.indexOf("=",ne);if(xe===-1)break;const ce=q.indexOf(";",ne),me=ce===-1?j:ce;if(xe>me){ne=q.lastIndexOf(";",xe-1)+1;continue}const de=k(q,ne,xe),_e=o(q,xe,de),Se=q.slice(de,_e);if(H[Se]===void 0){let $e=k(q,xe+1,me),dt=o(q,me,$e);const Y=Z(q.slice($e,dt));H[Se]=Y}ne=me+1}while(ne<j);return H}function k(q,ee,H){do{const j=q.charCodeAt(ee);if(j!==32&&j!==9)return ee}while(++ee<H);return H}function o(q,ee,H){for(;ee>H;){const j=q.charCodeAt(--ee);if(j!==32&&j!==9)return ee+1}return H}function I(q,ee,H){const j=(H==null?void 0:H.encode)||encodeURIComponent;if(!i.test(q))throw new TypeError(`argument name is invalid: ${q}`);const Z=j(ee);if(!s.test(Z))throw new TypeError(`argument val is invalid: ${ee}`);let ne=q+"="+Z;if(!H)return ne;if(H.maxAge!==void 0){if(!Number.isInteger(H.maxAge))throw new TypeError(`option maxAge is invalid: ${H.maxAge}`);ne+="; Max-Age="+H.maxAge}if(H.domain){if(!c.test(H.domain))throw new TypeError(`option domain is invalid: ${H.domain}`);ne+="; Domain="+H.domain}if(H.path){if(!p.test(H.path))throw new TypeError(`option path is invalid: ${H.path}`);ne+="; Path="+H.path}if(H.expires){if(!V(H.expires)||!Number.isFinite(H.expires.valueOf()))throw new TypeError(`option expires is invalid: ${H.expires}`);ne+="; Expires="+H.expires.toUTCString()}if(H.httpOnly&&(ne+="; HttpOnly"),H.secure&&(ne+="; Secure"),H.partitioned&&(ne+="; Partitioned"),H.priority)switch(typeof H.priority=="string"?H.priority.toLowerCase():void 0){case"low":ne+="; Priority=Low";break;case"medium":ne+="; Priority=Medium";break;case"high":ne+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${H.priority}`)}if(H.sameSite)switch(typeof H.sameSite=="string"?H.sameSite.toLowerCase():H.sameSite){case!0:case"strict":ne+="; SameSite=Strict";break;case"lax":ne+="; SameSite=Lax";break;case"none":ne+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${H.sameSite}`)}return ne}function O(q){if(q.indexOf("%")===-1)return q;try{return decodeURIComponent(q)}catch{return q}}function V(q){return _.call(q)==="[object Date]"}return rm}ML();/**
 * react-router v7.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Pb="popstate";function kL(i={}){function s(p,_){let{pathname:T,search:S,hash:k}=p.location;return m0("",{pathname:T,search:S,hash:k},_.state&&_.state.usr||null,_.state&&_.state.key||"default")}function c(p,_){return typeof _=="string"?_:Am(_)}return IL(s,c,null,i)}function yi(i,s){if(i===!1||i===null||typeof i>"u")throw new Error(s)}function yu(i,s){if(!i){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function PL(){return Math.random().toString(36).substring(2,10)}function Ib(i,s){return{usr:i.state,key:i.key,idx:s}}function m0(i,s,c=null,p){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof s=="string"?Qf(s):s,state:c,key:s&&s.key||p||PL()}}function Am({pathname:i="/",search:s="",hash:c=""}){return s&&s!=="?"&&(i+=s.charAt(0)==="?"?s:"?"+s),c&&c!=="#"&&(i+=c.charAt(0)==="#"?c:"#"+c),i}function Qf(i){let s={};if(i){let c=i.indexOf("#");c>=0&&(s.hash=i.substring(c),i=i.substring(0,c));let p=i.indexOf("?");p>=0&&(s.search=i.substring(p),i=i.substring(0,p)),i&&(s.pathname=i)}return s}function IL(i,s,c,p={}){let{window:_=document.defaultView,v5Compat:T=!1}=p,S=_.history,k="POP",o=null,I=O();I==null&&(I=0,S.replaceState({...S.state,idx:I},""));function O(){return(S.state||{idx:null}).idx}function V(){k="POP";let Z=O(),ne=Z==null?null:Z-I;I=Z,o&&o({action:k,location:j.location,delta:ne})}function q(Z,ne){k="PUSH";let xe=m0(j.location,Z,ne);I=O()+1;let ce=Ib(xe,I),me=j.createHref(xe);try{S.pushState(ce,"",me)}catch(de){if(de instanceof DOMException&&de.name==="DataCloneError")throw de;_.location.assign(me)}T&&o&&o({action:k,location:j.location,delta:1})}function ee(Z,ne){k="REPLACE";let xe=m0(j.location,Z,ne);I=O();let ce=Ib(xe,I),me=j.createHref(xe);S.replaceState(ce,"",me),T&&o&&o({action:k,location:j.location,delta:0})}function H(Z){let ne=_.location.origin!=="null"?_.location.origin:_.location.href,xe=typeof Z=="string"?Z:Am(Z);return xe=xe.replace(/ $/,"%20"),yi(ne,`No window.location.(origin|href) available to create URL for href: ${xe}`),new URL(xe,ne)}let j={get action(){return k},get location(){return i(_,S)},listen(Z){if(o)throw new Error("A history only accepts one active listener");return _.addEventListener(Pb,V),o=Z,()=>{_.removeEventListener(Pb,V),o=null}},createHref(Z){return s(_,Z)},createURL:H,encodeLocation(Z){let ne=H(Z);return{pathname:ne.pathname,search:ne.search,hash:ne.hash}},push:q,replace:ee,go(Z){return S.go(Z)}};return j}function NS(i,s,c="/"){return RL(i,s,c,!1)}function RL(i,s,c,p){let _=typeof s=="string"?Qf(s):s,T=fc(_.pathname||"/",c);if(T==null)return null;let S=jS(i);LL(S);let k=null;for(let o=0;k==null&&o<S.length;++o){let I=GL(T);k=UL(S[o],I,p)}return k}function jS(i,s=[],c=[],p=""){let _=(T,S,k)=>{let o={relativePath:k===void 0?T.path||"":k,caseSensitive:T.caseSensitive===!0,childrenIndex:S,route:T};o.relativePath.startsWith("/")&&(yi(o.relativePath.startsWith(p),`Absolute route path "${o.relativePath}" nested under path "${p}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),o.relativePath=o.relativePath.slice(p.length));let I=uc([p,o.relativePath]),O=c.concat(o);T.children&&T.children.length>0&&(yi(T.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${I}".`),jS(T.children,s,O,I)),!(T.path==null&&!T.index)&&s.push({path:I,score:jL(I,T.index),routesMeta:O})};return i.forEach((T,S)=>{var k;if(T.path===""||!((k=T.path)!=null&&k.includes("?")))_(T,S);else for(let o of VS(T.path))_(T,S,o)}),s}function VS(i){let s=i.split("/");if(s.length===0)return[];let[c,...p]=s,_=c.endsWith("?"),T=c.replace(/\?$/,"");if(p.length===0)return _?[T,""]:[T];let S=VS(p.join("/")),k=[];return k.push(...S.map(o=>o===""?T:[T,o].join("/"))),_&&k.push(...S),k.map(o=>i.startsWith("/")&&o===""?"/":o)}function LL(i){i.sort((s,c)=>s.score!==c.score?c.score-s.score:VL(s.routesMeta.map(p=>p.childrenIndex),c.routesMeta.map(p=>p.childrenIndex)))}var DL=/^:[\w-]+$/,zL=3,OL=2,BL=1,FL=10,NL=-2,Rb=i=>i==="*";function jL(i,s){let c=i.split("/"),p=c.length;return c.some(Rb)&&(p+=NL),s&&(p+=OL),c.filter(_=>!Rb(_)).reduce((_,T)=>_+(DL.test(T)?zL:T===""?BL:FL),p)}function VL(i,s){return i.length===s.length&&i.slice(0,-1).every((p,_)=>p===s[_])?i[i.length-1]-s[s.length-1]:0}function UL(i,s,c=!1){let{routesMeta:p}=i,_={},T="/",S=[];for(let k=0;k<p.length;++k){let o=p[k],I=k===p.length-1,O=T==="/"?s:s.slice(T.length)||"/",V=vy({path:o.relativePath,caseSensitive:o.caseSensitive,end:I},O),q=o.route;if(!V&&I&&c&&!p[p.length-1].route.index&&(V=vy({path:o.relativePath,caseSensitive:o.caseSensitive,end:!1},O)),!V)return null;Object.assign(_,V.params),S.push({params:_,pathname:uc([T,V.pathname]),pathnameBase:HL(uc([T,V.pathnameBase])),route:q}),V.pathnameBase!=="/"&&(T=uc([T,V.pathnameBase]))}return S}function vy(i,s){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[c,p]=$L(i.path,i.caseSensitive,i.end),_=s.match(c);if(!_)return null;let T=_[0],S=T.replace(/(.)\/+$/,"$1"),k=_.slice(1);return{params:p.reduce((I,{paramName:O,isOptional:V},q)=>{if(O==="*"){let H=k[q]||"";S=T.slice(0,T.length-H.length).replace(/(.)\/+$/,"$1")}const ee=k[q];return V&&!ee?I[O]=void 0:I[O]=(ee||"").replace(/%2F/g,"/"),I},{}),pathname:T,pathnameBase:S,pattern:i}}function $L(i,s=!1,c=!0){yu(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let p=[],_="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(S,k,o)=>(p.push({paramName:k,isOptional:o!=null}),o?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(p.push({paramName:"*"}),_+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):c?_+="\\/*$":i!==""&&i!=="/"&&(_+="(?:(?=\\/|$))"),[new RegExp(_,s?void 0:"i"),p]}function GL(i){try{return i.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return yu(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${s}).`),i}}function fc(i,s){if(s==="/")return i;if(!i.toLowerCase().startsWith(s.toLowerCase()))return null;let c=s.endsWith("/")?s.length-1:s.length,p=i.charAt(c);return p&&p!=="/"?null:i.slice(c)||"/"}function qL(i,s="/"){let{pathname:c,search:p="",hash:_=""}=typeof i=="string"?Qf(i):i;return{pathname:c?c.startsWith("/")?c:WL(c,s):s,search:XL(p),hash:KL(_)}}function WL(i,s){let c=s.replace(/\/+$/,"").split("/");return i.split("/").forEach(_=>{_===".."?c.length>1&&c.pop():_!=="."&&c.push(_)}),c.length>1?c.join("/"):"/"}function rv(i,s,c,p){return`Cannot include a '${i}' character in a manually specified \`to.${s}\` field [${JSON.stringify(p)}].  Please separate it out to the \`to.${c}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ZL(i){return i.filter((s,c)=>c===0||s.route.path&&s.route.path.length>0)}function US(i){let s=ZL(i);return s.map((c,p)=>p===s.length-1?c.pathname:c.pathnameBase)}function $S(i,s,c,p=!1){let _;typeof i=="string"?_=Qf(i):(_={...i},yi(!_.pathname||!_.pathname.includes("?"),rv("?","pathname","search",_)),yi(!_.pathname||!_.pathname.includes("#"),rv("#","pathname","hash",_)),yi(!_.search||!_.search.includes("#"),rv("#","search","hash",_)));let T=i===""||_.pathname==="",S=T?"/":_.pathname,k;if(S==null)k=c;else{let V=s.length-1;if(!p&&S.startsWith("..")){let q=S.split("/");for(;q[0]==="..";)q.shift(),V-=1;_.pathname=q.join("/")}k=V>=0?s[V]:"/"}let o=qL(_,k),I=S&&S!=="/"&&S.endsWith("/"),O=(T||S===".")&&c.endsWith("/");return!o.pathname.endsWith("/")&&(I||O)&&(o.pathname+="/"),o}var uc=i=>i.join("/").replace(/\/\/+/g,"/"),HL=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),XL=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,KL=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function YL(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var GS=["POST","PUT","PATCH","DELETE"];new Set(GS);var JL=["GET",...GS];new Set(JL);var ep=Ee.createContext(null);ep.displayName="DataRouter";var Ry=Ee.createContext(null);Ry.displayName="DataRouterState";var qS=Ee.createContext({isTransitioning:!1});qS.displayName="ViewTransition";var QL=Ee.createContext(new Map);QL.displayName="Fetchers";var e3=Ee.createContext(null);e3.displayName="Await";var _u=Ee.createContext(null);_u.displayName="Navigation";var Nm=Ee.createContext(null);Nm.displayName="Location";var mc=Ee.createContext({outlet:null,matches:[],isDataRoute:!1});mc.displayName="Route";var hx=Ee.createContext(null);hx.displayName="RouteError";function t3(i,{relative:s}={}){yi(jm(),"useHref() may be used only in the context of a <Router> component.");let{basename:c,navigator:p}=Ee.useContext(_u),{hash:_,pathname:T,search:S}=Vm(i,{relative:s}),k=T;return c!=="/"&&(k=T==="/"?c:uc([c,T])),p.createHref({pathname:k,search:S,hash:_})}function jm(){return Ee.useContext(Nm)!=null}function Fa(){return yi(jm(),"useLocation() may be used only in the context of a <Router> component."),Ee.useContext(Nm).location}var WS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ZS(i){Ee.useContext(_u).static||Ee.useLayoutEffect(i)}function aa(){let{isDataRoute:i}=Ee.useContext(mc);return i?p3():n3()}function n3(){yi(jm(),"useNavigate() may be used only in the context of a <Router> component.");let i=Ee.useContext(ep),{basename:s,navigator:c}=Ee.useContext(_u),{matches:p}=Ee.useContext(mc),{pathname:_}=Fa(),T=JSON.stringify(US(p)),S=Ee.useRef(!1);return ZS(()=>{S.current=!0}),Ee.useCallback((o,I={})=>{if(yu(S.current,WS),!S.current)return;if(typeof o=="number"){c.go(o);return}let O=$S(o,JSON.parse(T),_,I.relative==="path");i==null&&s!=="/"&&(O.pathname=O.pathname==="/"?s:uc([s,O.pathname])),(I.replace?c.replace:c.push)(O,I.state,I)},[s,c,T,_,i])}Ee.createContext(null);function Vm(i,{relative:s}={}){let{matches:c}=Ee.useContext(mc),{pathname:p}=Fa(),_=JSON.stringify(US(c));return Ee.useMemo(()=>$S(i,JSON.parse(_),p,s==="path"),[i,_,p,s])}function r3(i,s){return HS(i,s)}function HS(i,s,c,p){var xe;yi(jm(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:_,static:T}=Ee.useContext(_u),{matches:S}=Ee.useContext(mc),k=S[S.length-1],o=k?k.params:{},I=k?k.pathname:"/",O=k?k.pathnameBase:"/",V=k&&k.route;{let ce=V&&V.path||"";XS(I,!V||ce.endsWith("*")||ce.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${I}" (under <Route path="${ce}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ce}"> to <Route path="${ce==="/"?"*":`${ce}/*`}">.`)}let q=Fa(),ee;if(s){let ce=typeof s=="string"?Qf(s):s;yi(O==="/"||((xe=ce.pathname)==null?void 0:xe.startsWith(O)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${O}" but pathname "${ce.pathname}" was given in the \`location\` prop.`),ee=ce}else ee=q;let H=ee.pathname||"/",j=H;if(O!=="/"){let ce=O.replace(/^\//,"").split("/");j="/"+H.replace(/^\//,"").split("/").slice(ce.length).join("/")}let Z=!T&&c&&c.matches&&c.matches.length>0?c.matches:NS(i,{pathname:j});yu(V||Z!=null,`No routes matched location "${ee.pathname}${ee.search}${ee.hash}" `),yu(Z==null||Z[Z.length-1].route.element!==void 0||Z[Z.length-1].route.Component!==void 0||Z[Z.length-1].route.lazy!==void 0,`Matched leaf route at location "${ee.pathname}${ee.search}${ee.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ne=l3(Z&&Z.map(ce=>Object.assign({},ce,{params:Object.assign({},o,ce.params),pathname:uc([O,_.encodeLocation?_.encodeLocation(ce.pathname).pathname:ce.pathname]),pathnameBase:ce.pathnameBase==="/"?O:uc([O,_.encodeLocation?_.encodeLocation(ce.pathnameBase).pathname:ce.pathnameBase])})),S,c,p);return s&&ne?Ee.createElement(Nm.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...ee},navigationType:"POP"}},ne):ne}function i3(){let i=f3(),s=YL(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),c=i instanceof Error?i.stack:null,p="rgba(200,200,200, 0.5)",_={padding:"0.5rem",backgroundColor:p},T={padding:"2px 4px",backgroundColor:p},S=null;return console.error("Error handled by React Router default ErrorBoundary:",i),S=Ee.createElement(Ee.Fragment,null,Ee.createElement("p",null,"💿 Hey developer 👋"),Ee.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Ee.createElement("code",{style:T},"ErrorBoundary")," or"," ",Ee.createElement("code",{style:T},"errorElement")," prop on your route.")),Ee.createElement(Ee.Fragment,null,Ee.createElement("h2",null,"Unexpected Application Error!"),Ee.createElement("h3",{style:{fontStyle:"italic"}},s),c?Ee.createElement("pre",{style:_},c):null,S)}var o3=Ee.createElement(i3,null),s3=class extends Ee.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,s){return s.location!==i.location||s.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:s.error,location:s.location,revalidation:i.revalidation||s.revalidation}}componentDidCatch(i,s){console.error("React Router caught the following error during render",i,s)}render(){return this.state.error!==void 0?Ee.createElement(mc.Provider,{value:this.props.routeContext},Ee.createElement(hx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function a3({routeContext:i,match:s,children:c}){let p=Ee.useContext(ep);return p&&p.static&&p.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(p.staticContext._deepestRenderedBoundaryId=s.route.id),Ee.createElement(mc.Provider,{value:i},c)}function l3(i,s=[],c=null,p=null){if(i==null){if(!c)return null;if(c.errors)i=c.matches;else if(s.length===0&&!c.initialized&&c.matches.length>0)i=c.matches;else return null}let _=i,T=c==null?void 0:c.errors;if(T!=null){let o=_.findIndex(I=>I.route.id&&(T==null?void 0:T[I.route.id])!==void 0);yi(o>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(T).join(",")}`),_=_.slice(0,Math.min(_.length,o+1))}let S=!1,k=-1;if(c)for(let o=0;o<_.length;o++){let I=_[o];if((I.route.HydrateFallback||I.route.hydrateFallbackElement)&&(k=o),I.route.id){let{loaderData:O,errors:V}=c,q=I.route.loader&&!O.hasOwnProperty(I.route.id)&&(!V||V[I.route.id]===void 0);if(I.route.lazy||q){S=!0,k>=0?_=_.slice(0,k+1):_=[_[0]];break}}}return _.reduceRight((o,I,O)=>{let V,q=!1,ee=null,H=null;c&&(V=T&&I.route.id?T[I.route.id]:void 0,ee=I.route.errorElement||o3,S&&(k<0&&O===0?(XS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),q=!0,H=null):k===O&&(q=!0,H=I.route.hydrateFallbackElement||null)));let j=s.concat(_.slice(0,O+1)),Z=()=>{let ne;return V?ne=ee:q?ne=H:I.route.Component?ne=Ee.createElement(I.route.Component,null):I.route.element?ne=I.route.element:ne=o,Ee.createElement(a3,{match:I,routeContext:{outlet:o,matches:j,isDataRoute:c!=null},children:ne})};return c&&(I.route.ErrorBoundary||I.route.errorElement||O===0)?Ee.createElement(s3,{location:c.location,revalidation:c.revalidation,component:ee,error:V,children:Z(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):Z()},null)}function dx(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function u3(i){let s=Ee.useContext(ep);return yi(s,dx(i)),s}function c3(i){let s=Ee.useContext(Ry);return yi(s,dx(i)),s}function h3(i){let s=Ee.useContext(mc);return yi(s,dx(i)),s}function fx(i){let s=h3(i),c=s.matches[s.matches.length-1];return yi(c.route.id,`${i} can only be used on routes that contain a unique "id"`),c.route.id}function d3(){return fx("useRouteId")}function f3(){var p;let i=Ee.useContext(hx),s=c3("useRouteError"),c=fx("useRouteError");return i!==void 0?i:(p=s.errors)==null?void 0:p[c]}function p3(){let{router:i}=u3("useNavigate"),s=fx("useNavigate"),c=Ee.useRef(!1);return ZS(()=>{c.current=!0}),Ee.useCallback(async(_,T={})=>{yu(c.current,WS),c.current&&(typeof _=="number"?i.navigate(_):await i.navigate(_,{fromRouteId:s,...T}))},[i,s])}var Lb={};function XS(i,s,c){!s&&!Lb[i]&&(Lb[i]=!0,yu(!1,c))}Ee.memo(m3);function m3({routes:i,future:s,state:c}){return HS(i,void 0,c,s)}function pl(i){yi(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function g3({basename:i="/",children:s=null,location:c,navigationType:p="POP",navigator:_,static:T=!1}){yi(!jm(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let S=i.replace(/^\/*/,"/"),k=Ee.useMemo(()=>({basename:S,navigator:_,static:T,future:{}}),[S,_,T]);typeof c=="string"&&(c=Qf(c));let{pathname:o="/",search:I="",hash:O="",state:V=null,key:q="default"}=c,ee=Ee.useMemo(()=>{let H=fc(o,S);return H==null?null:{location:{pathname:H,search:I,hash:O,state:V,key:q},navigationType:p}},[S,o,I,O,V,q,p]);return yu(ee!=null,`<Router basename="${S}"> is not able to match the URL "${o}${I}${O}" because it does not start with the basename, so the <Router> won't render anything.`),ee==null?null:Ee.createElement(_u.Provider,{value:k},Ee.createElement(Nm.Provider,{children:s,value:ee}))}function y3({children:i,location:s}){return r3(g0(i),s)}function g0(i,s=[]){let c=[];return Ee.Children.forEach(i,(p,_)=>{if(!Ee.isValidElement(p))return;let T=[...s,_];if(p.type===Ee.Fragment){c.push.apply(c,g0(p.props.children,T));return}yi(p.type===pl,`[${typeof p.type=="string"?p.type:p.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),yi(!p.props.index||!p.props.children,"An index route cannot have child routes.");let S={id:p.props.id||T.join("-"),caseSensitive:p.props.caseSensitive,element:p.props.element,Component:p.props.Component,index:p.props.index,path:p.props.path,loader:p.props.loader,action:p.props.action,hydrateFallbackElement:p.props.hydrateFallbackElement,HydrateFallback:p.props.HydrateFallback,errorElement:p.props.errorElement,ErrorBoundary:p.props.ErrorBoundary,hasErrorBoundary:p.props.hasErrorBoundary===!0||p.props.ErrorBoundary!=null||p.props.errorElement!=null,shouldRevalidate:p.props.shouldRevalidate,handle:p.props.handle,lazy:p.props.lazy};p.props.children&&(S.children=g0(p.props.children,T)),c.push(S)}),c}var ey="get",ty="application/x-www-form-urlencoded";function Ly(i){return i!=null&&typeof i.tagName=="string"}function _3(i){return Ly(i)&&i.tagName.toLowerCase()==="button"}function v3(i){return Ly(i)&&i.tagName.toLowerCase()==="form"}function x3(i){return Ly(i)&&i.tagName.toLowerCase()==="input"}function w3(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function b3(i,s){return i.button===0&&(!s||s==="_self")&&!w3(i)}var Ug=null;function T3(){if(Ug===null)try{new FormData(document.createElement("form"),0),Ug=!1}catch{Ug=!0}return Ug}var E3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function iv(i){return i!=null&&!E3.has(i)?(yu(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ty}"`),null):i}function S3(i,s){let c,p,_,T,S;if(v3(i)){let k=i.getAttribute("action");p=k?fc(k,s):null,c=i.getAttribute("method")||ey,_=iv(i.getAttribute("enctype"))||ty,T=new FormData(i)}else if(_3(i)||x3(i)&&(i.type==="submit"||i.type==="image")){let k=i.form;if(k==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=i.getAttribute("formaction")||k.getAttribute("action");if(p=o?fc(o,s):null,c=i.getAttribute("formmethod")||k.getAttribute("method")||ey,_=iv(i.getAttribute("formenctype"))||iv(k.getAttribute("enctype"))||ty,T=new FormData(k,i),!T3()){let{name:I,type:O,value:V}=i;if(O==="image"){let q=I?`${I}.`:"";T.append(`${q}x`,"0"),T.append(`${q}y`,"0")}else I&&T.append(I,V)}}else{if(Ly(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');c=ey,p=null,_=ty,S=i}return T&&_==="text/plain"&&(S=T,T=void 0),{action:p,method:c.toLowerCase(),encType:_,formData:T,body:S}}function px(i,s){if(i===!1||i===null||typeof i>"u")throw new Error(s)}async function C3(i,s){if(i.id in s)return s[i.id];try{let c=await import(i.module);return s[i.id]=c,c}catch(c){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(c),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function A3(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function M3(i,s,c){let p=await Promise.all(i.map(async _=>{let T=s.routes[_.route.id];if(T){let S=await C3(T,c);return S.links?S.links():[]}return[]}));return R3(p.flat(1).filter(A3).filter(_=>_.rel==="stylesheet"||_.rel==="preload").map(_=>_.rel==="stylesheet"?{..._,rel:"prefetch",as:"style"}:{..._,rel:"prefetch"}))}function Db(i,s,c,p,_,T){let S=(o,I)=>c[I]?o.route.id!==c[I].route.id:!0,k=(o,I)=>{var O;return c[I].pathname!==o.pathname||((O=c[I].route.path)==null?void 0:O.endsWith("*"))&&c[I].params["*"]!==o.params["*"]};return T==="assets"?s.filter((o,I)=>S(o,I)||k(o,I)):T==="data"?s.filter((o,I)=>{var V;let O=p.routes[o.route.id];if(!O||!O.hasLoader)return!1;if(S(o,I)||k(o,I))return!0;if(o.route.shouldRevalidate){let q=o.route.shouldRevalidate({currentUrl:new URL(_.pathname+_.search+_.hash,window.origin),currentParams:((V=c[0])==null?void 0:V.params)||{},nextUrl:new URL(i,window.origin),nextParams:o.params,defaultShouldRevalidate:!0});if(typeof q=="boolean")return q}return!0}):[]}function k3(i,s,{includeHydrateFallback:c}={}){return P3(i.map(p=>{let _=s.routes[p.route.id];if(!_)return[];let T=[_.module];return _.clientActionModule&&(T=T.concat(_.clientActionModule)),_.clientLoaderModule&&(T=T.concat(_.clientLoaderModule)),c&&_.hydrateFallbackModule&&(T=T.concat(_.hydrateFallbackModule)),_.imports&&(T=T.concat(_.imports)),T}).flat(1))}function P3(i){return[...new Set(i)]}function I3(i){let s={},c=Object.keys(i).sort();for(let p of c)s[p]=i[p];return s}function R3(i,s){let c=new Set;return new Set(s),i.reduce((p,_)=>{let T=JSON.stringify(I3(_));return c.has(T)||(c.add(T),p.push({key:T,link:_})),p},[])}function L3(i,s){let c=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return c.pathname==="/"?c.pathname="_root.data":s&&fc(c.pathname,s)==="/"?c.pathname=`${s.replace(/\/$/,"")}/_root.data`:c.pathname=`${c.pathname.replace(/\/$/,"")}.data`,c}function KS(){let i=Ee.useContext(ep);return px(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function D3(){let i=Ee.useContext(Ry);return px(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var mx=Ee.createContext(void 0);mx.displayName="FrameworkContext";function YS(){let i=Ee.useContext(mx);return px(i,"You must render this element inside a <HydratedRouter> element"),i}function z3(i,s){let c=Ee.useContext(mx),[p,_]=Ee.useState(!1),[T,S]=Ee.useState(!1),{onFocus:k,onBlur:o,onMouseEnter:I,onMouseLeave:O,onTouchStart:V}=s,q=Ee.useRef(null);Ee.useEffect(()=>{if(i==="render"&&S(!0),i==="viewport"){let j=ne=>{ne.forEach(xe=>{S(xe.isIntersecting)})},Z=new IntersectionObserver(j,{threshold:.5});return q.current&&Z.observe(q.current),()=>{Z.disconnect()}}},[i]),Ee.useEffect(()=>{if(p){let j=setTimeout(()=>{S(!0)},100);return()=>{clearTimeout(j)}}},[p]);let ee=()=>{_(!0)},H=()=>{_(!1),S(!1)};return c?i!=="intent"?[T,q,{}]:[T,q,{onFocus:im(k,ee),onBlur:im(o,H),onMouseEnter:im(I,ee),onMouseLeave:im(O,H),onTouchStart:im(V,ee)}]:[!1,q,{}]}function im(i,s){return c=>{i&&i(c),c.defaultPrevented||s(c)}}function O3({page:i,...s}){let{router:c}=KS(),p=Ee.useMemo(()=>NS(c.routes,i,c.basename),[c.routes,i,c.basename]);return p?Ee.createElement(F3,{page:i,matches:p,...s}):null}function B3(i){let{manifest:s,routeModules:c}=YS(),[p,_]=Ee.useState([]);return Ee.useEffect(()=>{let T=!1;return M3(i,s,c).then(S=>{T||_(S)}),()=>{T=!0}},[i,s,c]),p}function F3({page:i,matches:s,...c}){let p=Fa(),{manifest:_,routeModules:T}=YS(),{basename:S}=KS(),{loaderData:k,matches:o}=D3(),I=Ee.useMemo(()=>Db(i,s,o,_,p,"data"),[i,s,o,_,p]),O=Ee.useMemo(()=>Db(i,s,o,_,p,"assets"),[i,s,o,_,p]),V=Ee.useMemo(()=>{if(i===p.pathname+p.search+p.hash)return[];let H=new Set,j=!1;if(s.forEach(ne=>{var ce;let xe=_.routes[ne.route.id];!xe||!xe.hasLoader||(!I.some(me=>me.route.id===ne.route.id)&&ne.route.id in k&&((ce=T[ne.route.id])!=null&&ce.shouldRevalidate)||xe.hasClientLoader?j=!0:H.add(ne.route.id))}),H.size===0)return[];let Z=L3(i,S);return j&&H.size>0&&Z.searchParams.set("_routes",s.filter(ne=>H.has(ne.route.id)).map(ne=>ne.route.id).join(",")),[Z.pathname+Z.search]},[S,k,p,_,I,s,i,T]),q=Ee.useMemo(()=>k3(O,_),[O,_]),ee=B3(O);return Ee.createElement(Ee.Fragment,null,V.map(H=>Ee.createElement("link",{key:H,rel:"prefetch",as:"fetch",href:H,...c})),q.map(H=>Ee.createElement("link",{key:H,rel:"modulepreload",href:H,...c})),ee.map(({key:H,link:j})=>Ee.createElement("link",{key:H,...j})))}function N3(...i){return s=>{i.forEach(c=>{typeof c=="function"?c(s):c!=null&&(c.current=s)})}}var JS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{JS&&(window.__reactRouterVersion="7.4.0")}catch{}function j3({basename:i,children:s,window:c}){let p=Ee.useRef();p.current==null&&(p.current=kL({window:c,v5Compat:!0}));let _=p.current,[T,S]=Ee.useState({action:_.action,location:_.location}),k=Ee.useCallback(o=>{Ee.startTransition(()=>S(o))},[S]);return Ee.useLayoutEffect(()=>_.listen(k),[_,k]),Ee.createElement(g3,{basename:i,children:s,location:T.location,navigationType:T.action,navigator:_})}var QS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eC=Ee.forwardRef(function({onClick:s,discover:c="render",prefetch:p="none",relative:_,reloadDocument:T,replace:S,state:k,target:o,to:I,preventScrollReset:O,viewTransition:V,...q},ee){let{basename:H}=Ee.useContext(_u),j=typeof I=="string"&&QS.test(I),Z,ne=!1;if(typeof I=="string"&&j&&(Z=I,JS))try{let dt=new URL(window.location.href),Y=I.startsWith("//")?new URL(dt.protocol+I):new URL(I),pt=fc(Y.pathname,H);Y.origin===dt.origin&&pt!=null?I=pt+Y.search+Y.hash:ne=!0}catch{yu(!1,`<Link to="${I}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let xe=t3(I,{relative:_}),[ce,me,de]=z3(p,q),_e=G3(I,{replace:S,state:k,target:o,preventScrollReset:O,relative:_,viewTransition:V});function Se(dt){s&&s(dt),dt.defaultPrevented||_e(dt)}let $e=Ee.createElement("a",{...q,...de,href:Z||xe,onClick:ne||T?s:Se,ref:N3(ee,me),target:o,"data-discover":!j&&c==="render"?"true":void 0});return ce&&!j?Ee.createElement(Ee.Fragment,null,$e,Ee.createElement(O3,{page:xe})):$e});eC.displayName="Link";var V3=Ee.forwardRef(function({"aria-current":s="page",caseSensitive:c=!1,className:p="",end:_=!1,style:T,to:S,viewTransition:k,children:o,...I},O){let V=Vm(S,{relative:I.relative}),q=Fa(),ee=Ee.useContext(Ry),{navigator:H,basename:j}=Ee.useContext(_u),Z=ee!=null&&X3(V)&&k===!0,ne=H.encodeLocation?H.encodeLocation(V).pathname:V.pathname,xe=q.pathname,ce=ee&&ee.navigation&&ee.navigation.location?ee.navigation.location.pathname:null;c||(xe=xe.toLowerCase(),ce=ce?ce.toLowerCase():null,ne=ne.toLowerCase()),ce&&j&&(ce=fc(ce,j)||ce);const me=ne!=="/"&&ne.endsWith("/")?ne.length-1:ne.length;let de=xe===ne||!_&&xe.startsWith(ne)&&xe.charAt(me)==="/",_e=ce!=null&&(ce===ne||!_&&ce.startsWith(ne)&&ce.charAt(ne.length)==="/"),Se={isActive:de,isPending:_e,isTransitioning:Z},$e=de?s:void 0,dt;typeof p=="function"?dt=p(Se):dt=[p,de?"active":null,_e?"pending":null,Z?"transitioning":null].filter(Boolean).join(" ");let Y=typeof T=="function"?T(Se):T;return Ee.createElement(eC,{...I,"aria-current":$e,className:dt,ref:O,style:Y,to:S,viewTransition:k},typeof o=="function"?o(Se):o)});V3.displayName="NavLink";var U3=Ee.forwardRef(({discover:i="render",fetcherKey:s,navigate:c,reloadDocument:p,replace:_,state:T,method:S=ey,action:k,onSubmit:o,relative:I,preventScrollReset:O,viewTransition:V,...q},ee)=>{let H=Z3(),j=H3(k,{relative:I}),Z=S.toLowerCase()==="get"?"get":"post",ne=typeof k=="string"&&QS.test(k),xe=ce=>{if(o&&o(ce),ce.defaultPrevented)return;ce.preventDefault();let me=ce.nativeEvent.submitter,de=(me==null?void 0:me.getAttribute("formmethod"))||S;H(me||ce.currentTarget,{fetcherKey:s,method:de,navigate:c,replace:_,state:T,relative:I,preventScrollReset:O,viewTransition:V})};return Ee.createElement("form",{ref:ee,method:Z,action:j,onSubmit:p?o:xe,...q,"data-discover":!ne&&i==="render"?"true":void 0})});U3.displayName="Form";function $3(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function tC(i){let s=Ee.useContext(ep);return yi(s,$3(i)),s}function G3(i,{target:s,replace:c,state:p,preventScrollReset:_,relative:T,viewTransition:S}={}){let k=aa(),o=Fa(),I=Vm(i,{relative:T});return Ee.useCallback(O=>{if(b3(O,s)){O.preventDefault();let V=c!==void 0?c:Am(o)===Am(I);k(i,{replace:V,state:p,preventScrollReset:_,relative:T,viewTransition:S})}},[o,k,I,c,p,s,i,_,T,S])}var q3=0,W3=()=>`__${String(++q3)}__`;function Z3(){let{router:i}=tC("useSubmit"),{basename:s}=Ee.useContext(_u),c=d3();return Ee.useCallback(async(p,_={})=>{let{action:T,method:S,encType:k,formData:o,body:I}=S3(p,s);if(_.navigate===!1){let O=_.fetcherKey||W3();await i.fetch(O,c,_.action||T,{preventScrollReset:_.preventScrollReset,formData:o,body:I,formMethod:_.method||S,formEncType:_.encType||k,flushSync:_.flushSync})}else await i.navigate(_.action||T,{preventScrollReset:_.preventScrollReset,formData:o,body:I,formMethod:_.method||S,formEncType:_.encType||k,replace:_.replace,state:_.state,fromRouteId:c,flushSync:_.flushSync,viewTransition:_.viewTransition})},[i,s,c])}function H3(i,{relative:s}={}){let{basename:c}=Ee.useContext(_u),p=Ee.useContext(mc);yi(p,"useFormAction must be used inside a RouteContext");let[_]=p.matches.slice(-1),T={...Vm(i||".",{relative:s})},S=Fa();if(i==null){T.search=S.search;let k=new URLSearchParams(T.search),o=k.getAll("index");if(o.some(O=>O==="")){k.delete("index"),o.filter(V=>V).forEach(V=>k.append("index",V));let O=k.toString();T.search=O?`?${O}`:""}}return(!i||i===".")&&_.route.index&&(T.search=T.search?T.search.replace(/^\?/,"?index&"):"?index"),c!=="/"&&(T.pathname=T.pathname==="/"?c:uc([c,T.pathname])),Am(T)}function X3(i,s={}){let c=Ee.useContext(qS);yi(c!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:p}=tC("useViewTransitionState"),_=Vm(i,{relative:s.relative});if(!c.isTransitioning)return!1;let T=fc(c.currentLocation.pathname,p)||c.currentLocation.pathname,S=fc(c.nextLocation.pathname,p)||c.nextLocation.pathname;return vy(_.pathname,S)!=null||vy(_.pathname,T)!=null}new TextEncoder;var ny={exports:{}},K3=ny.exports,zb;function Y3(){return zb||(zb=1,function(i,s){var c={};(function(p,_){i.exports=_()})(K3,function(){var p,_,T;function S(o,I){if(!p)p=I;else if(!_)_=I;else{var O="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+p+")(sharedChunk); ("+_+")(sharedChunk); self.onerror = null;",V={};p(V),T=I(V),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(T.workerUrl=window.URL.createObjectURL(new Blob([O],{type:"text/javascript"})))}}S(["exports"],function(o){var I=typeof self<"u"?self:{},O="2.15.0";let V;const q={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(V==null){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{V=c.API_URL_REGEX!=null?new RegExp(c.API_URL_REGEX):t}catch{V=t}}return V},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!q.API_URL)return null;try{const t=new URL(q.API_URL);return t.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":t.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ee={supported:!1,testSupport:function(t){!Z&&j&&(ne?xe(t):H=t)}};let H,j,Z=!1,ne=!1;function xe(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,j),t.isContextLost())return;ee.supported=!0}catch{}t.deleteTexture(e),Z=!0}I.document&&(j=I.document.createElement("img"),j.onload=function(){H&&xe(H),H=null,ne=!0},j.onerror=function(){Z=!0,H=null},j.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ce="01";function me(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var de=_e;function _e(t,e,n,a){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=a}_e.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,a=0;a<8;a++){var h=this.sampleCurveX(n)-t;if(Math.abs(h)<e)return n;var m=this.sampleCurveDerivativeX(n);if(Math.abs(m)<1e-6)break;n-=h/m}var y=0,w=1;for(n=t,a=0;a<20&&(h=this.sampleCurveX(n),!(Math.abs(h-t)<e));a++)t>h?y=n:w=n,n=.5*(w-y)+y;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var Se=me(de),$e=dt;function dt(t,e){this.x=t,this.y=e}dt.prototype={clone:function(){return new dt(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),a=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=a,this},_rotateAround:function(t,e){var n=Math.cos(t),a=Math.sin(t),h=e.y+a*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-a*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},dt.convert=function(t){return t instanceof dt?t:Array.isArray(t)?new dt(t[0],t[1]):t};var Y=me($e);const pt=Math.PI/180,Lt=180/Math.PI;function lt(t){return t*pt}function zt(t){return t*Lt}const $n=[[0,0],[1,0],[1,1],[0,1]];function ln(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function fn(t,e,n,a){const h=new Se(t,e,n,a);return function(m){return h.solve(m)}}const gt=fn(.25,.1,.25,1);function Et(t,e,n){return Math.min(n,Math.max(e,t))}function Le(t,e,n){return(n=Et((n-t)/(e-t),0,1))*n*(3-2*n)}function te(t,e,n){const a=n-e,h=((t-e)%a+a)%a+e;return h===e?n:h}function Ue(t,e,n){if(!t.length)return n(null,[]);let a=t.length;const h=new Array(t.length);let m=null;t.forEach((y,w)=>{e(y,(E,C)=>{E&&(m=E),h[w]=C,--a==0&&n(m,h)})})}function Pt(t){const e=[];for(const n in t)e.push(t[n]);return e}function kt(t,...e){for(const n of e)for(const a in n)t[a]=n[a];return t}let qt=1;function Wt(){return qt++}function St(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Ft(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function en(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function yn(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function Bn(t,e){return t.indexOf(e,t.length-e.length)!==-1}function Xt(t,e,n){const a={};for(const h in t)a[h]=e.call(this,t[h],h,t);return a}function Fn(t,e,n){const a={};for(const h in t)e.call(n||this,t[h],h,t)&&(a[h]=t[h]);return a}function pn(t){return Array.isArray(t)?t.map(pn):typeof t=="object"&&t?Xt(t,pn):t}const Pr={};function Nn(t){Pr[t]||(typeof console<"u"&&console.warn(t),Pr[t]=!0)}function jn(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function Kr(t){let e=0;for(let n,a,h=0,m=t.length,y=m-1;h<m;y=h++)n=t[h],a=t[y],e+=(a.x-n.x)*(n.y+a.y);return e}function Dr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function lr(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,a,h,m)=>{const y=h||m;return e[a]=!y||y.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let Ii=null;function Zi(t){if(Ii==null){const e=t.navigator?t.navigator.userAgent:null;Ii=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Ii}function Hi(t){try{const e=I[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ri(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}const It="mapbox-tiles";let Ht=500,mn=50,xn,Wn;function un(){try{return I.caches}catch{}}function tr(){un()&&!xn&&(xn=I.caches.open(It))}function zr(t){const e=t.indexOf("?");if(e<0)return t;const n=function(h){const m=h.indexOf("?");return m>0?h.slice(m+1).split("&"):[]}(t),a=n.filter(h=>{const m=h.split("=");return m[0]==="language"||m[0]==="worldview"});return a.length?`${t.slice(0,e)}?${a.join("&")}`:t.slice(0,e)}let pr=1/0;const Yr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Yr);class io extends Error{constructor(e,n,a){n===401&&Ve(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ts=Dr()?()=>self.worker&&self.worker.referrer:()=>(I.location.protocol==="blob:"?I.parent:I).location.href,yo=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(ts())&&!/^\w+:/.test(n))){if(I.fetch&&I.Request&&I.AbortController&&I.Request.prototype.hasOwnProperty("signal"))return function(a,h){const m=new I.AbortController,y=new I.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:ts(),referrerPolicy:a.referrerPolicy,signal:m.signal});let w=!1,E=!1;const C=(R=y.url).indexOf("sku=")>0&&Ve(R);var R;a.type==="json"&&y.headers.set("Accept","application/json");const z=($,G,K)=>{if(E)return;if($&&$.message!=="SecurityError"&&Nn($.toString()),G&&K)return B(G);const oe=Date.now();I.fetch(y).then(fe=>{if(fe.ok){const Te=C?fe.clone():null;return B(fe,Te,oe)}return h(new io(fe.statusText,fe.status,a.url))}).catch(fe=>{fe.name!=="AbortError"&&h(new Error(`${fe.message} ${a.url}`))})},B=($,G,K)=>{(a.type==="arrayBuffer"?$.arrayBuffer():a.type==="json"?$.json():$.text()).then(oe=>{E||(G&&K&&function(fe,Te,pe){if(tr(),!xn)return;const be={status:Te.status,statusText:Te.statusText,headers:new I.Headers};Te.headers.forEach((Ke,We)=>be.headers.set(We,Ke));const ke=lr(Te.headers.get("Cache-Control")||"");if(ke["no-store"])return;ke["max-age"]&&be.headers.set("Expires",new Date(pe+1e3*ke["max-age"]).toUTCString());const Me=be.headers.get("Expires");Me&&(new Date(Me).getTime()-pe<42e4||function(Ke,We){if(Wn===void 0)try{new Response(new ReadableStream),Wn=!0}catch{Wn=!1}Wn?We(Ke.body):Ke.blob().then(We)}(Te,Ke=>{const We=new I.Response(Ke,be);tr(),xn&&xn.then(st=>st.put(zr(fe.url),We)).catch(st=>Nn(st.message))}))}(y,G,K),w=!0,h(null,oe,$.headers.get("Cache-Control"),$.headers.get("Expires")))}).catch(oe=>{E||h(new Error(oe.message))})};return C?function($,G){if(tr(),!xn)return G(null);const K=zr($.url);xn.then(oe=>{oe.match(K).then(fe=>{const Te=function(pe){if(!pe)return!1;const be=new Date(pe.headers.get("Expires")||0),ke=lr(pe.headers.get("Cache-Control")||"");return be>Date.now()&&!ke["no-cache"]}(fe);oe.delete(K),Te&&oe.put(K,fe.clone()),G(null,fe,Te)}).catch(G)}).catch(G)}(y,z):z(null,null),{cancel:()=>{E=!0,w||m.abort()}}}(t,e);if(Dr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(a,h){const m=new I.XMLHttpRequest;m.open(a.method||"GET",a.url,!0),a.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const y in a.headers)m.setRequestHeader(y,a.headers[y]);return a.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=a.credentials==="include",m.onerror=()=>{h(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let y=m.response;if(a.type==="json")try{y=JSON.parse(m.response)}catch(w){return h(w)}h(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else h(new io(m.statusText,m.status,a.url))},m.send(a.body),{cancel:()=>m.abort()}}(t,e)},gs=function(t,e){return yo(kt(t,{type:"arrayBuffer"}),e)};function ys(t){const e=I.document.createElement("a");return e.href=t,e.protocol===I.document.location.protocol&&e.host===I.document.location.host}const we="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let J,Q;J=[],Q=0;const ye=function(t,e){if(ee.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Q>=q.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return J.push(m),m}Q++;let n=!1;const a=()=>{if(!n)for(n=!0,Q--;J.length&&Q<q.MAX_PARALLEL_IMAGE_REQUESTS;){const m=J.shift(),{requestParameters:y,callback:w,cancelled:E}=m;E||(m.cancel=ye(y,w).cancel)}},h=gs(t,(m,y,w,E)=>{a(),m?e(m):y&&(I.createImageBitmap?function(C,R){const z=new I.Blob([new Uint8Array(C)],{type:"image/png"});I.createImageBitmap(z).then(B=>{R(null,B)}).catch(B=>{R(new Error(`Could not load image because of ${B.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(C,R)=>e(C,R,w,E)):function(C,R){const z=new I.Image,B=I.URL;z.onload=()=>{R(null,z),B.revokeObjectURL(z.src),z.onload=null,I.requestAnimationFrame(()=>{z.src=we})},z.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const $=new I.Blob([new Uint8Array(C)],{type:"image/png"});z.src=C.byteLength?B.createObjectURL($):we}(y,(C,R)=>e(C,R,w,E)))});return{cancel:()=>{h.cancel(),a()}}},Ae="NO_ACCESS_TOKEN";function De(t){return t.indexOf("mapbox:")===0}function Ve(t){return q.API_URL_REGEX.test(t)}function Ge(t){return q.API_CDN_URL_REGEX.test(t)}function ze(t){return q.API_STYLE_REGEX.test(t)&&!Je(t)}function Je(t){return q.API_SPRITE_REGEX.test(t)}const Tt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Dt(t){const e=t.match(Tt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function xt(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const bn="mapbox.eventData";function Tn(t){if(!t)return null;const e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(I.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class wn{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=Tn(q.ACCESS_TOKEN);let a="";return a=n&&n.u?I.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(h,m)=>String.fromCharCode(+("0x"+m)))):q.ACCESS_TOKEN||"",e?`${bn}.${e}:${a}`:`${bn}:${a}`}fetchEventData(){const e=Hi("localStorage"),n=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const h=I.localStorage.getItem(n);h&&(this.eventData=JSON.parse(h));const m=I.localStorage.getItem(a);m&&(this.anonId=m)}catch{Nn("Unable to read from LocalStorage")}}saveEventData(){const e=Hi("localStorage"),n=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{I.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&I.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Nn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,a,h){if(!q.EVENTS_URL)return;const m=Dt(q.EVENTS_URL);m.params.push(`access_token=${h||q.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(e).toISOString()},w=n?kt(y,n):y,E={url:xt(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};this.pendingRequest=function(C,R){return yo(kt(C,{method:"POST"}),R)}(E,C=>{this.pendingRequest=null,a(C),this.saveEventData(),this.processRequests(h)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const Sn=new class extends wn{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){q.EVENTS_URL&&q.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>De(n)||Ve(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Tn(q.ACCESS_TOKEN),n=e?e.u:q.ACCESS_TOKEN;let a=n!==this.eventData.tokenU;en(this.anonId)||(this.anonId=St(),a=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const m=new Date(this.eventData.lastSuccess),y=new Date(h),w=(h-this.eventData.lastSuccess)/864e5;a=a||w>=1||w<-1||m.getDate()!==y.getDate()}else a=!0;a?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:ce,"enabled.telemetry":!1,userId:this.anonId},m=>{m||(this.eventData.lastSuccess=h,this.eventData.tokenU=n)},t):this.processRequests()}},Vn=Sn.postTurnstileEvent.bind(Sn),Ir=new class extends wn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,a){this.skuToken=e,this.errorCb=a,q.EVENTS_URL&&(n||q.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Ae)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),en(this.anonId)||(this.anonId=St()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:ce,skuToken:this.skuToken,userId:this.anonId},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},t))}},Jr=Ir.postMapLoadEvent.bind(Ir),Fi=new class extends wn{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){q.EVENTS_URL&&(t||q.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:n}=this.queue.shift(),a=function(h){const m=I.performance.getEntriesByType("resource"),y=I.performance.getEntriesByType("mark"),w=function(B){const $={};if(B){for(const G in B)if(G!=="other")for(const K of B[G]){const oe=`${G}ResolveRangeMin`,fe=`${G}ResolveRangeMax`,Te=`${G}RequestCount`,pe=`${G}RequestCachedCount`;$[oe]=Math.min($[oe]||1/0,K.startTime),$[fe]=Math.max($[fe]||-1/0,K.responseEnd);const be=ke=>{$[ke]===void 0&&($[ke]=0),++$[ke]};K.transferSize!==void 0&&K.transferSize===0&&be(pe),be(Te)}}return $}(function(B,$){const G={};if(B)for(const K of B){const oe=$(K);G[oe]===void 0&&(G[oe]=[]),G[oe].push(K)}return G}(m,mh)),E=I.devicePixelRatio,C=I.navigator.connection||I.navigator.mozConnection||I.navigator.webkitConnection,R={counters:[],metadata:[],attributes:[]},z=(B,$,G)=>{G!=null&&B.push({name:$,value:G.toString()})};for(const B in w)z(R.counters,B,w[B]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(z(R.counters,"interactionRangeMin",h.interactionRange[0]),z(R.counters,"interactionRangeMax",h.interactionRange[1])),y)for(const B of Object.keys(ja)){const $=ja[B],G=y.find(K=>K.name===$);G&&z(R.counters,$,G.startTime)}return z(R.counters,"visibilityHidden",h.visibilityHidden),z(R.attributes,"style",function(B){if(B)for(const $ of B){const G=$.name.split("?")[0];if(ze(G)){const K=G.split("/").slice(-2);if(K.length===2)return`mapbox://styles/${K[0]}/${K[1]}`}}}(m)),z(R.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),z(R.attributes,"fogEnabled",h.fogEnabled?"true":"false"),z(R.attributes,"projection",h.projection),z(R.attributes,"zoom",h.zoom),z(R.metadata,"devicePixelRatio",E),z(R.metadata,"connectionEffectiveType",C?C.effectiveType:void 0),z(R.metadata,"navigatorUserAgent",I.navigator.userAgent),z(R.metadata,"screenWidth",I.screen.width),z(R.metadata,"screenHeight",I.screen.height),z(R.metadata,"windowWidth",I.innerWidth),z(R.metadata,"windowHeight",I.innerHeight),z(R.metadata,"mapWidth",h.width/E),z(R.metadata,"mapHeight",h.height/E),z(R.metadata,"webglRenderer",h.renderer),z(R.metadata,"webglVendor",h.vendor),z(R.metadata,"sdkVersion",O),z(R.metadata,"sdkIdentifier","mapbox-gl-js"),R}(n);for(const h of a.metadata);for(const h of a.counters);for(const h of a.attributes);this.postEvent(e,a,()=>{},t)}},Cr=Fi.postPerformanceEvent.bind(Fi),ns=new class extends wn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,a){if(!q.API_URL||!q.SESSION_PATH)return;const h=Dt(q.API_URL+q.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${a||q.ACCESS_TOKEN||""}`);const m={url:xt(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(y,w){return yo(kt(y,{method:"GET"}),w)}(m,y=>{this.pendingRequest=null,n(y),this.saveEventData(),this.processRequests(a)})}getSessionAPI(t,e,n,a){this.skuToken=e,this.errorCb=a,q.SESSION_PATH&&q.API_URL&&(n||q.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Ae)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},t)}},ui=ns.getSessionAPI.bind(ns),Xi=new Set,ja={create:"create",load:"load",fullLoad:"fullLoad"},Id={mark(t){I.performance.mark(t)},measure(t,e,n){I.performance.measure(t,e,n)}};function mh(t){const e=t.name.split("?")[0];return Ge(e)&&e.includes("mapbox-gl.js")?"javascript":Ge(e)&&e.includes("mapbox-gl.css")?"css":function(n){return q.API_FONTS_REGEX.test(n)}(e)?"fontRange":Je(e)?"sprite":ze(e)?"style":function(n){return q.API_TILEJSON_REGEX.test(n)}(e)?"tilejson":"other"}const Qn=I.performance;function gh(t){const e=t?t.url.toString():void 0;return Qn.getEntriesByName(e)}let vu,Nr,gc,Lo;const _s={now:()=>gc!==void 0?gc:I.performance.now(),setNow(t){gc=t},restoreNow(){gc=void 0},frame(t){const e=I.requestAnimationFrame(t);return{cancel:()=>I.cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:n,height:a}=t;Lo||(Lo=I.document.createElement("canvas"));const h=Lo.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(n>Lo.width||a>Lo.height)&&(Lo.width=n,Lo.height=a),h.clearRect(-e,-e,n+2*e,a+2*e),h.drawImage(t,0,0,n,a),h.getImageData(-e,-e,n+2*e,a+2*e)},resolveURL:t=>(vu||(vu=I.document.createElement("a")),vu.href=t,vu.href),get devicePixelRatio(){return I.devicePixelRatio},get prefersReducedMotion(){return!!I.matchMedia&&(Nr==null&&(Nr=I.matchMedia("(prefers-reduced-motion: reduce)")),Nr.matches)}};function yl(t,e,n){n[t]&&n[t].indexOf(e)!==-1||(n[t]=n[t]||[],n[t].push(e))}function yh(t,e,n){if(n&&n[t]){const a=n[t].indexOf(e);a!==-1&&n[t].splice(a,1)}}class la{constructor(e,n={}){kt(this,n),this.type=e}}class Do extends la{constructor(e,n={}){super("error",kt({error:e},n))}}class oo{on(e,n){return this._listeners=this._listeners||{},yl(e,n,this._listeners),this}off(e,n){return yh(e,n,this._listeners),yh(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},yl(e,n,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,n){typeof e=="string"&&(e=new la(e,n||{}));const a=e.type;if(this.listens(a)){e.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const w of h)w.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const w of m)yh(a,w,this._oneTimeListeners),w.call(this,e);const y=this._eventedParent;y&&(kt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof Do&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var ot=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ci(t,...e){for(const n of e)for(const a in n)t[a]=n[a];return t}function Qr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function _i(t){if(Array.isArray(t))return t.map(_i);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=_i(t[n]);return e}return Qr(t)}class Rd extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}var _o=Rd;class _l{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[a,h]of n)this.bindings[a]=h}concat(e){return new _l(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var vl=_l;const Ns={kind:"null"},$t={kind:"number"},Gn={kind:"string"},Ln={kind:"boolean"},so={kind:"color"},vo={kind:"object"},Cn={kind:"value"},xo={kind:"collator"},Va={kind:"formatted"},er={kind:"resolvedImage"};function wo(t,e){return{kind:"array",itemType:t,N:e}}function _r(t){if(t.kind==="array"){const e=_r(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}const yc=[Ns,$t,Gn,Ln,so,Va,vo,wo(Cn),er];function vs(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!vs(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(const n of yc)if(!vs(n,e))return null}}return`Expected ${_r(t)} but found ${_r(e)} instead.`}function xl(t,e){return e.some(n=>n.kind===t.kind)}function wl(t,e){return e.some(n=>n==="null"?t===null:n==="array"?Array.isArray(t):n==="object"?t&&!Array.isArray(t)&&typeof t=="object":n===typeof t)}var xu,wu={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function zo(t){return(t=Math.round(t))<0?0:t>255?255:t}function Oo(t){return zo(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function rs(t){return(e=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function xs(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{xu={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in wu)return wu[n].slice();if(n[0]==="#")return n.length===4?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:n.length===7&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var a=n.indexOf("("),h=n.indexOf(")");if(a!==-1&&h+1===n.length){var m=n.substr(0,a),y=n.substr(a+1,h-(a+1)).split(","),w=1;switch(m){case"rgba":if(y.length!==4)return null;w=rs(y.pop());case"rgb":return y.length!==3?null:[Oo(y[0]),Oo(y[1]),Oo(y[2]),w];case"hsla":if(y.length!==4)return null;w=rs(y.pop());case"hsl":if(y.length!==3)return null;var E=(parseFloat(y[0])%360+360)%360/360,C=rs(y[1]),R=rs(y[2]),z=R<=.5?R*(C+1):R+C-R*C,B=2*R-z;return[zo(255*xs(B,z,E+1/3)),zo(255*xs(B,z,E)),zo(255*xs(B,z,E-1/3)),w];default:return null}}return null}}catch{}class vi{constructor(e,n,a,h=1){this.r=e,this.g=n,this.b=a,this.a=h}static parse(e){if(!e)return;if(e instanceof vi)return e;if(typeof e!="string")return;const n=xu(e);return n?new vi(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,a,h]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(a)},${h})`}toArray(){const{r:e,g:n,b:a,a:h}=this;return h===0?[0,0,0,0]:[255*e/h,255*n/h,255*a/h,h]}toArray01(){const{r:e,g:n,b:a,a:h}=this;return h===0?[0,0,0,0]:[e/h,n/h,a/h,h]}toArray01PremultipliedAlpha(){const{r:e,g:n,b:a,a:h}=this;return[e,n,a,h]}}vi.black=new vi(0,0,0,1),vi.white=new vi(1,1,1,1),vi.transparent=new vi(0,0,0,0),vi.red=new vi(1,0,0,1),vi.blue=new vi(0,0,1,1);var dr=vi;class _h{constructor(e,n,a){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class _c{constructor(e,n,a,h,m){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=a,this.fontStack=h,this.textColor=m}}class xi{constructor(e){this.sections=e}static fromString(e){return new xi([new _c(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof xi?e:xi.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const a={};n.fontStack&&(a["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(a["font-scale"]=n.scale),n.textColor&&(a["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(a)}return e}}class Bo{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Bo({name:e,available:!1}):null}serialize(){return["image",this.name]}}function vh(t,e,n,a){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[t,e,n,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[t,e,n,a]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ua(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof dr||t instanceof _h||t instanceof xi||t instanceof Bo)return!0;if(Array.isArray(t)){for(const e of t)if(!ua(e))return!1;return!0}if(typeof t=="object"){for(const e in t)if(!ua(t[e]))return!1;return!0}return!1}function Or(t){if(t===null)return Ns;if(typeof t=="string")return Gn;if(typeof t=="boolean")return Ln;if(typeof t=="number")return $t;if(t instanceof dr)return so;if(t instanceof _h)return xo;if(t instanceof xi)return Va;if(t instanceof Bo)return er;if(Array.isArray(t)){const e=t.length;let n;for(const a of t){const h=Or(a);if(n){if(n===h)continue;n=Cn;break}n=h}return wo(n||Cn,e)}return vo}function bu(t){const e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof dr||t instanceof xi||t instanceof Bo?t.toString():JSON.stringify(t)}class Ua{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ua(e[1]))return n.error("invalid value");const a=e[1];let h=Or(a);const m=n.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new Ua(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof dr?["rgba"].concat(this.value.toArray()):this.value instanceof xi?this.value.serialize():this.value}}var is=Ua,Wr=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const bl={string:Gn,number:$t,boolean:Ln,object:vo};class xh{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let a,h=1;const m=e[0];if(m==="array"){let w,E;if(e.length>2){const C=e[1];if(typeof C!="string"||!(C in bl)||C==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);w=bl[C],h++}else w=Cn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);E=e[2],h++}a=wo(w,E)}else a=bl[m];const y=[];for(;h<e.length;h++){const w=n.parse(e[h],h,Cn);if(!w)return null;y.push(w)}return new xh(a,y)}evaluate(e){for(let n=0;n<this.args.length;n++){const a=this.args[n].evaluate(e);if(!vs(this.type,Or(a)))return a;if(n===this.args.length-1)throw new Wr(`Expected value to be of type ${_r(this.type)}, but found ${_r(Or(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const a=e.itemType;if(a.kind==="string"||a.kind==="number"||a.kind==="boolean"){n.push(a.kind);const h=e.N;(typeof h=="number"||this.args.length>1)&&n.push(h)}}return n.concat(this.args.map(a=>a.serialize()))}}var js=xh;class ws{constructor(e){this.type=Va,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return n.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=e.length-1;++y){const w=e[y];if(m&&typeof w=="object"&&!Array.isArray(w)){m=!1;let E=null;if(w["font-scale"]&&(E=n.parse(w["font-scale"],1,$t),!E))return null;let C=null;if(w["text-font"]&&(C=n.parse(w["text-font"],1,wo(Gn)),!C))return null;let R=null;if(w["text-color"]&&(R=n.parse(w["text-color"],1,so),!R))return null;const z=h[h.length-1];z.scale=E,z.font=C,z.textColor=R}else{const E=n.parse(e[y],1,Cn);if(!E)return null;const C=E.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:E,scale:null,font:null,textColor:null})}}return new ws(h)}evaluate(e){return new xi(this.sections.map(n=>{const a=n.content.evaluate(e);return Or(a)===er?new _c("",a,null,null,null):new _c(bu(a),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const a={};n.scale&&(a["font-scale"]=n.scale.serialize()),n.font&&(a["text-font"]=n.font.serialize()),n.textColor&&(a["text-color"]=n.textColor.serialize()),e.push(a)}return e}}class $a{constructor(e){this.type=er,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const a=n.parse(e[1],1,Gn);return a?new $a(a):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),a=Bo.fromString(n);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(n)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const wh={"to-boolean":Ln,"to-color":so,"to-number":$t,"to-string":Gn};class vc{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const a=e[0];if((a==="to-boolean"||a==="to-string")&&e.length!==2)return n.error("Expected one argument.");const h=wh[a],m=[];for(let y=1;y<e.length;y++){const w=n.parse(e[y],y,Cn);if(!w)return null;m.push(w)}return new vc(h,m)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let n,a;for(const h of this.args){if(n=h.evaluate(e),a=null,n instanceof dr)return n;if(typeof n=="string"){const m=e.parseColor(n);if(m)return m}else if(Array.isArray(n)&&(a=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:vh(n[0],n[1],n[2],n[3]),!a))return new dr(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Wr(a||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const a of this.args){if(n=a.evaluate(e),n===null)return 0;const h=Number(n);if(!isNaN(h))return h}throw new Wr(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?xi.fromString(bu(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Bo.fromString(bu(this.args[0].evaluate(e))):bu(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ws([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $a(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}var bo=vc;const Fo=["Unknown","Point","LineString","Polygon"];var Tl=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Fo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(a*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=dr.parse(t)),e}};class ca{constructor(e,n,a,h){this.name=e,this.type=n,this._evaluate=a,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const a=e[0],h=ca.definitions[a];if(!h)return n.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,w=y.filter(([C])=>!Array.isArray(C)||C.length===e.length-1);let E=null;for(const[C,R]of w){E=new Sh(n.registry,n.path,null,n.scope);const z=[];let B=!1;for(let $=1;$<e.length;$++){const G=e[$],K=Array.isArray(C)?C[$-1]:C.type,oe=E.parse(G,1+z.length,K);if(!oe){B=!0;break}z.push(oe)}if(!B)if(Array.isArray(C)&&C.length!==z.length)E.error(`Expected ${C.length} arguments, but found ${z.length} instead.`);else{for(let $=0;$<z.length;$++){const G=Array.isArray(C)?C[$]:C.type,K=z[$];E.concat($+1).checkSubtype(G,K.type)}if(E.errors.length===0)return new ca(a,m,R,z)}}if(w.length===1)n.errors.push(...E.errors);else{const C=(w.length?w:y).map(([z])=>{return B=z,Array.isArray(B)?`(${B.map(_r).join(", ")})`:`(${_r(B.type)}...)`;var B}).join(" | "),R=[];for(let z=1;z<e.length;z++){const B=n.parse(e[z],1+R.length);if(!B)return null;R.push(_r(B.type))}n.error(`Expected arguments of type ${C}, but found (${R.join(", ")}) instead.`)}return null}static register(e,n){ca.definitions=n;for(const a in n)e[a]=ca}}var No=ca;class ha{constructor(e,n,a){this.type=xo,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return n.error("Collator options argument must be an object.");const h=n.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,Ln);if(!h)return null;const m=n.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,Ln);if(!m)return null;let y=null;return a.locale&&(y=n.parse(a.locale,1,Gn),!y)?null:new ha(h,m,y)}evaluate(e){return new _h(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const bs=8192;function Ni(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function os(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Ga(t,e){const n=(180+t[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(n*h*bs),Math.round(a*h*bs)]}function El(t,e,n){const a=t[0]-e[0],h=t[1]-e[1],m=t[0]-n[0],y=t[1]-n[1];return a*y-m*h==0&&a*m<=0&&h*y<=0}function xc(t,e){let n=!1;for(let y=0,w=e.length;y<w;y++){const E=e[y];for(let C=0,R=E.length;C<R-1;C++){if(El(t,E[C],E[C+1]))return!1;(h=E[C])[1]>(a=t)[1]!=(m=E[C+1])[1]>a[1]&&a[0]<(m[0]-h[0])*(a[1]-h[1])/(m[1]-h[1])+h[0]&&(n=!n)}}var a,h,m;return n}function Tu(t,e){for(let n=0;n<e.length;n++)if(xc(t,e[n]))return!0;return!1}function Eu(t,e,n,a){const h=a[0]-n[0],m=a[1]-n[1],y=(t[0]-n[0])*m-h*(t[1]-n[1]),w=(e[0]-n[0])*m-h*(e[1]-n[1]);return y>0&&w<0||y<0&&w>0}function Ts(t,e,n){for(const C of n)for(let R=0;R<C.length-1;++R)if((w=[(y=C[R+1])[0]-(m=C[R])[0],y[1]-m[1]])[0]*(E=[(h=e)[0]-(a=t)[0],h[1]-a[1]])[1]-w[1]*E[0]!=0&&Eu(a,h,m,y)&&Eu(m,y,a,h))return!0;var a,h,m,y,w,E;return!1}function Xn(t,e){for(let n=0;n<t.length;++n)if(!xc(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(Ts(t[n],t[n+1],e))return!1;return!0}function Ld(t,e){for(let n=0;n<e.length;n++)if(Xn(t,e[n]))return!0;return!1}function bh(t,e,n){const a=[];for(let h=0;h<t.length;h++){const m=[];for(let y=0;y<t[h].length;y++){const w=Ga(t[h][y],n);Ni(e,w),m.push(w)}a.push(m)}return a}function Dd(t,e,n){const a=[];for(let h=0;h<t.length;h++){const m=bh(t[h],e,n);a.push(m)}return a}function Th(t,e,n,a){if(t[0]<n[0]||t[0]>n[2]){const h=.5*a;let m=t[0]-n[0]>h?-a:n[0]-t[0]>h?a:0;m===0&&(m=t[0]-n[2]>h?-a:n[2]-t[0]>h?a:0),t[0]+=m}Ni(e,t)}function wc(t,e,n,a){const h=Math.pow(2,a.z)*bs,m=[a.x*bs,a.y*bs],y=[];if(!t)return y;for(const w of t)for(const E of w){const C=[E.x+m[0],E.y+m[1]];Th(C,e,n,h),y.push(C)}return y}function Eh(t,e,n,a){const h=Math.pow(2,a.z)*bs,m=[a.x*bs,a.y*bs],y=[];if(!t)return y;for(const E of t){const C=[];for(const R of E){const z=[R.x+m[0],R.y+m[1]];Ni(e,z),C.push(z)}y.push(C)}if(e[2]-e[0]<=h/2){(w=e)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const E of y)for(const C of E)Th(C,e,n,h)}var w;return y}class Sl{constructor(e,n){this.type=Ln,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ua(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let h=0;h<a.features.length;++h){const m=a.features[h].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Sl(a,a.features[h].geometry)}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Sl(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Sl(a,a)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(!y)return!1;if(a.type==="Polygon"){const w=bh(a.coordinates,m,y),E=wc(n.geometry(),h,m,y);if(!os(h,m))return!1;for(const C of E)if(!xc(C,w))return!1}if(a.type==="MultiPolygon"){const w=Dd(a.coordinates,m,y),E=wc(n.geometry(),h,m,y);if(!os(h,m))return!1;for(const C of E)if(!Tu(C,w))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(!y)return!1;if(a.type==="Polygon"){const w=bh(a.coordinates,m,y),E=Eh(n.geometry(),h,m,y);if(!os(h,m))return!1;for(const C of E)if(!Xn(C,w))return!1}if(a.type==="MultiPolygon"){const w=Dd(a.coordinates,m,y),E=Eh(n.geometry(),h,m,y);if(!os(h,m))return!1;for(const C of E)if(!Ld(C,w))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var bc=Sl;function Cl(t){if(t instanceof No&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof bc)return!1;let e=!0;return t.eachChild(n=>{e&&!Cl(n)&&(e=!1)}),e}function Vs(t){if(t instanceof No&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(n=>{e&&!Vs(n)&&(e=!1)}),e}function da(t,e){if(t instanceof No&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(a=>{n&&!da(a,e)&&(n=!1)}),n}class Tc{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const a=e[1];return n.scope.has(a)?new Tc(a,n.scope.get(a)):n.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var zd=Tc;class Su{constructor(e,n=[],a,h=new vl,m=[]){this.registry=e,this.path=n,this.key=n.map(y=>`[${y}]`).join(""),this.scope=h,this.errors=m,this.expectedType=a}parse(e,n,a,h,m={}){return n?this.concat(n,a,h)._parse(e,m):this._parse(e,m)}_parse(e,n){function a(h,m,y){return y==="assert"?new js(m,[h]):y==="coerce"?new bo(m,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const w=this.expectedType,E=y.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||E.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(w,E))return null}else y=a(y,w,n.typeAnnotation||"coerce");else y=a(y,w,n.typeAnnotation||"assert")}if(!(y instanceof is)&&y.type.kind!=="resolvedImage"&&Cu(y)){const w=new Tl;try{y=new is(y.type,y.evaluate(w))}catch(E){return this.error(E.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,a){const h=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new Su(this.registry,h,n||null,m,this.errors)}error(e,...n){const a=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new _o(a,e))}checkSubtype(e,n){const a=vs(e,n);return a&&this.error(a),a}}var Sh=Su;function Cu(t){if(t instanceof zd)return Cu(t.boundExpression);if(t instanceof No&&t.name==="error"||t instanceof ha||t instanceof bc)return!1;const e=t instanceof bo||t instanceof js;let n=!0;return t.eachChild(a=>{n=e?n&&Cu(a):n&&a instanceof is}),!!n&&Cl(t)&&da(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ec(t,e){const n=t.length-1;let a,h,m=0,y=n,w=0;for(;m<=y;)if(w=Math.floor((m+y)/2),a=t[w],h=t[w+1],a<=e){if(w===n||e<h)return w;m=w+1}else{if(!(a>e))throw new Wr("Input is not a number.");y=w-1}return 0}class Sc{constructor(e,n,a){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[h,m]of a)this.labels.push(h),this.outputs.push(m)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const a=n.parse(e[1],1,$t);if(!a)return null;const h=[];let m=null;n.expectedType&&n.expectedType.kind!=="value"&&(m=n.expectedType);for(let y=1;y<e.length;y+=2){const w=y===1?-1/0:e[y],E=e[y+1],C=y,R=y+1;if(typeof w!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(h.length&&h[h.length-1][0]>=w)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const z=n.parse(E,R,m);if(!z)return null;m=m||z.type,h.push([w,z])}return new Sc(m,a,h)}evaluate(e){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return a[0].evaluate(e);const m=n.length;return h>=n[m-1]?a[m-1].evaluate(e):a[Ec(n,h)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}var Ch=Sc;function Zn(t,e,n){return t*(1-n)+e*n}var Au=Object.freeze({__proto__:null,array:function(t,e,n){return t.map((a,h)=>Zn(a,e[h],n))},color:function(t,e,n){return new dr(Zn(t.r,e.r,n),Zn(t.g,e.g,n),Zn(t.b,e.b,n),Zn(t.a,e.a,n))},number:Zn});const Od=.95047,Ah=1.08883,Bd=4/29,qa=6/29,Mh=3*qa*qa,op=qa*qa*qa,kh=Math.PI/180,Mu=180/Math.PI;function Ph(t){return t>op?Math.pow(t,1/3):t/Mh+Bd}function Cc(t){return t>qa?t*t*t:Mh*(t-Bd)}function Ac(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ku(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ih(t){const e=ku(t.r),n=ku(t.g),a=ku(t.b),h=Ph((.4124564*e+.3575761*n+.1804375*a)/Od),m=Ph((.2126729*e+.7151522*n+.072175*a)/1);return{l:116*m-16,a:500*(h-m),b:200*(m-Ph((.0193339*e+.119192*n+.9503041*a)/Ah)),alpha:t.a}}function Rh(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,a=isNaN(t.b)?e:e-t.b/200;return e=1*Cc(e),n=Od*Cc(n),a=Ah*Cc(a),new dr(Ac(3.2404542*n-1.5371385*e-.4985314*a),Ac(-.969266*n+1.8760108*e+.041556*a),Ac(.0556434*n-.2040259*e+1.0572252*a),t.alpha)}function Al(t,e,n){const a=e-t;return t+n*(a>180||a<-180?a-360*Math.round(a/360):a)}const Pu={forward:Ih,reverse:Rh,interpolate:function(t,e,n){return{l:Zn(t.l,e.l,n),a:Zn(t.a,e.a,n),b:Zn(t.b,e.b,n),alpha:Zn(t.alpha,e.alpha,n)}}},Ml={forward:function(t){const{l:e,a:n,b:a}=Ih(t),h=Math.atan2(a,n)*Mu;return{h:h<0?h+360:h,c:Math.sqrt(n*n+a*a),l:e,alpha:t.a}},reverse:function(t){const e=t.h*kh,n=t.c;return Rh({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:Al(t.h,e.h,n),c:Zn(t.c,e.c,n),l:Zn(t.l,e.l,n),alpha:Zn(t.alpha,e.alpha,n)}}};var Lh=Object.freeze({__proto__:null,hcl:Ml,lab:Pu});class kl{constructor(e,n,a,h,m){this.type=e,this.operator=n,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[y,w]of m)this.labels.push(y),this.outputs.push(w)}static interpolationFactor(e,n,a,h){let m=0;if(e.name==="exponential")m=Mc(n,e.base,a,h);else if(e.name==="linear")m=Mc(n,1,a,h);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new Se(y[0],y[1],y[2],y[3]).solve(Mc(n,1,a,h))}return m}static parse(e,n){let[a,h,m,...y]=e;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const C=h[1];if(typeof C!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:C}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const C=h.slice(1);if(C.length!==4||C.some(R=>typeof R!="number"||R<0||R>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:C}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(m=n.parse(m,2,$t),!m)return null;const w=[];let E=null;a==="interpolate-hcl"||a==="interpolate-lab"?E=so:n.expectedType&&n.expectedType.kind!=="value"&&(E=n.expectedType);for(let C=0;C<y.length;C+=2){const R=y[C],z=y[C+1],B=C+3,$=C+4;if(typeof R!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(w.length&&w[w.length-1][0]>=R)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const G=n.parse(z,$,E);if(!G)return null;E=E||G.type,w.push([R,G])}return E.kind==="number"||E.kind==="color"||E.kind==="array"&&E.itemType.kind==="number"&&typeof E.N=="number"?new kl(E,a,h,m,w):n.error(`Type ${_r(E)} is not interpolatable.`)}evaluate(e){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return a[0].evaluate(e);const m=n.length;if(h>=n[m-1])return a[m-1].evaluate(e);const y=Ec(n,h),w=kl.interpolationFactor(this.interpolation,h,n[y],n[y+1]),E=a[y].evaluate(e),C=a[y+1].evaluate(e);return this.operator==="interpolate"?Au[this.type.kind.toLowerCase()](E,C,w):this.operator==="interpolate-hcl"?Ml.reverse(Ml.interpolate(Ml.forward(E),Ml.forward(C),w)):Pu.reverse(Pu.interpolate(Pu.forward(E),Pu.forward(C),w))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)n.push(this.labels[a],this.outputs[a].serialize());return n}}function Mc(t,e,n,a){const h=a-n,m=t-n;return h===0?0:e===1?m/h:(Math.pow(e,m)-1)/(Math.pow(e,h)-1)}var ao=kl;class fa{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let a=null;const h=n.expectedType;h&&h.kind!=="value"&&(a=h);const m=[];for(const w of e.slice(1)){const E=n.parse(w,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!E)return null;a=a||E.type,m.push(E)}const y=h&&m.some(w=>vs(h,w.type));return new fa(y?Cn:a,m)}evaluate(e){let n,a=null,h=0;for(const m of this.args){if(h++,a=m.evaluate(e),a&&a instanceof Bo&&!a.available&&(n||(n=a),a=null,h===this.args.length))return n;if(a!==null)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Dh=fa;class Wa{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return n.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return n.error("Variable names must contain only alphanumeric characters or '_'.",m);const w=n.parse(e[m+1],m+1);if(!w)return null;a.push([y,w])}const h=n.parse(e[e.length-1],e.length-1,n.expectedType,a);return h?new Wa(a,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,a]of this.bindings)e.push(n,a.serialize());return e.push(this.result.serialize()),e}}var Fd=Wa;class kc{constructor(e,n,a){this.type=e,this.index=n,this.input=a}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,$t),h=n.parse(e[2],2,wo(n.expectedType||Cn));return a&&h?new kc(h.type.itemType,a,h):null}evaluate(e){const n=this.index.evaluate(e),a=this.input.evaluate(e);if(n<0)throw new Wr(`Array index out of bounds: ${n} < 0.`);if(n>=a.length)throw new Wr(`Array index out of bounds: ${n} > ${a.length-1}.`);if(n!==Math.floor(n))throw new Wr(`Array index must be an integer, but found ${n} instead.`);return a[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var zh=kc;class Iu{constructor(e,n){this.type=Ln,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,Cn),h=n.parse(e[2],2,Cn);return a&&h?xl(a.type,[Ln,Gn,$t,Ns,Cn])?new Iu(a,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${_r(a.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(a==null)return!1;if(!wl(n,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${_r(Or(n))} instead.`);if(!wl(a,["string","array"]))throw new Wr(`Expected second argument to be of type array or string, but found ${_r(Or(a))} instead.`);return a.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Ru=Iu;class Pl{constructor(e,n,a){this.type=$t,this.needle=e,this.haystack=n,this.fromIndex=a}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,Cn),h=n.parse(e[2],2,Cn);if(!a||!h)return null;if(!xl(a.type,[Ln,Gn,$t,Ns,Cn]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${_r(a.type)} instead`);if(e.length===4){const m=n.parse(e[3],3,$t);return m?new Pl(a,h,m):null}return new Pl(a,h)}evaluate(e){const n=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!wl(n,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${_r(Or(n))} instead.`);if(!wl(a,["string","array"]))throw new Wr(`Expected second argument to be of type array or string, but found ${_r(Or(a))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return a.indexOf(n,h)}return a.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Oh=Pl;class Bh{constructor(e,n,a,h,m,y){this.inputType=e,this.type=n,this.input=a,this.cases=h,this.outputs=m,this.otherwise=y}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let a,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const m={},y=[];for(let C=2;C<e.length-1;C+=2){let R=e[C];const z=e[C+1];Array.isArray(R)||(R=[R]);const B=n.concat(C);if(R.length===0)return B.error("Expected at least one branch label.");for(const G of R){if(typeof G!="number"&&typeof G!="string")return B.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return B.error("Numeric branch labels must be integer values.");if(a){if(B.checkSubtype(a,Or(G)))return null}else a=Or(G);if(m[String(G)]!==void 0)return B.error("Branch labels must be unique.");m[String(G)]=y.length}const $=n.parse(z,C,h);if(!$)return null;h=h||$.type,y.push($)}const w=n.parse(e[1],1,Cn);if(!w)return null;const E=n.parse(e[e.length-1],e.length-1,h);return E?w.type.kind!=="value"&&n.concat(1).checkSubtype(a,w.type)?null:new Bh(a,h,w,m,y,E):null}evaluate(e){const n=this.input.evaluate(e);return(Or(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),a=[],h={};for(const y of n){const w=h[this.cases[y]];w===void 0?(h[this.cases[y]]=a.length,a.push([this.cases[y],[y]])):a[w][1].push(y)}const m=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,w]of a)e.push(w.length===1?m(w[0]):w.map(m)),e.push(this.outputs[y].serialize());return e.push(this.otherwise.serialize()),e}}var sp=Bh;class Fh{constructor(e,n,a){this.type=e,this.branches=n,this.otherwise=a}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let a;n.expectedType&&n.expectedType.kind!=="value"&&(a=n.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const w=n.parse(e[y],y,Ln);if(!w)return null;const E=n.parse(e[y+1],y+1,a);if(!E)return null;h.push([w,E]),a=a||E.type}const m=n.parse(e[e.length-1],e.length-1,a);return m?new Fh(a,h,m):null}evaluate(e){for(const[n,a]of this.branches)if(n.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,a]of this.branches)e(n),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Nd=Fh;class Lu{constructor(e,n,a,h){this.type=e,this.input=n,this.beginIndex=a,this.endIndex=h}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,Cn),h=n.parse(e[2],2,$t);if(!a||!h)return null;if(!xl(a.type,[wo(Cn),Gn,Cn]))return n.error(`Expected first argument to be of type array or string, but found ${_r(a.type)} instead`);if(e.length===4){const m=n.parse(e[3],3,$t);return m?new Lu(a.type,a,h,m):null}return new Lu(a.type,a,h)}evaluate(e){const n=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!wl(n,["string","array"]))throw new Wr(`Expected first argument to be of type array or string, but found ${_r(Or(n))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return n.slice(a,h)}return n.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var jo=Lu;function pa(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Nh(t,e,n,a){return a.compare(e,n)===0}function Za(t,e,n){const a=t!=="=="&&t!=="!=";return class nC{constructor(m,y,w){this.type=Ln,this.lhs=m,this.rhs=y,this.collator=w,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const w=m[0];let E=y.parse(m[1],1,Cn);if(!E)return null;if(!pa(w,E.type))return y.concat(1).error(`"${w}" comparisons are not supported for type '${_r(E.type)}'.`);let C=y.parse(m[2],2,Cn);if(!C)return null;if(!pa(w,C.type))return y.concat(2).error(`"${w}" comparisons are not supported for type '${_r(C.type)}'.`);if(E.type.kind!==C.type.kind&&E.type.kind!=="value"&&C.type.kind!=="value")return y.error(`Cannot compare types '${_r(E.type)}' and '${_r(C.type)}'.`);a&&(E.type.kind==="value"&&C.type.kind!=="value"?E=new js(C.type,[E]):E.type.kind!=="value"&&C.type.kind==="value"&&(C=new js(E.type,[C])));let R=null;if(m.length===4){if(E.type.kind!=="string"&&C.type.kind!=="string"&&E.type.kind!=="value"&&C.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(R=y.parse(m[3],3,xo),!R)return null}return new nC(E,C,R)}evaluate(m){const y=this.lhs.evaluate(m),w=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const E=Or(y),C=Or(w);if(E.kind!==C.kind||E.kind!=="string"&&E.kind!=="number")throw new Wr(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${E.kind}, ${C.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const E=Or(y),C=Or(w);if(E.kind!=="string"||C.kind!=="string")return e(m,y,w)}return this.collator?n(m,y,w,this.collator.evaluate(m)):e(m,y,w)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[t];return this.eachChild(y=>{m.push(y.serialize())}),m}}}const jd=Za("==",function(t,e,n){return e===n},Nh),Vd=Za("!=",function(t,e,n){return e!==n},function(t,e,n,a){return!Nh(0,e,n,a)}),jh=Za("<",function(t,e,n){return e<n},function(t,e,n,a){return a.compare(e,n)<0}),ap=Za(">",function(t,e,n){return e>n},function(t,e,n,a){return a.compare(e,n)>0}),lp=Za("<=",function(t,e,n){return e<=n},function(t,e,n,a){return a.compare(e,n)<=0}),Ha=Za(">=",function(t,e,n){return e>=n},function(t,e,n,a){return a.compare(e,n)>=0});class Il{constructor(e,n,a,h,m,y){this.type=Gn,this.number=e,this.locale=n,this.currency=a,this.unit=h,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const a=n.parse(e[1],1,$t);if(!a)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=n.parse(h.locale,1,Gn),!m))return null;let y=null;if(h.currency&&(y=n.parse(h.currency,1,Gn),!y))return null;let w=null;if(h.unit&&(w=n.parse(h.unit,1,Gn),!w))return null;let E=null;if(h["min-fraction-digits"]&&(E=n.parse(h["min-fraction-digits"],1,$t),!E))return null;let C=null;return h["max-fraction-digits"]&&(C=n.parse(h["max-fraction-digits"],1,$t),!C)?null:new Il(a,m,y,w,E,C)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Es{constructor(e){this.type=$t,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=n.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${_r(a.type)} instead.`):new Es(a):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new Wr(`Expected value to be of type string or array, but found ${_r(Or(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const Pc={"==":jd,"!=":Vd,">":ap,"<":jh,">=":Ha,"<=":lp,array:js,at:zh,boolean:js,case:Nd,coalesce:Dh,collator:ha,format:ws,image:$a,in:Ru,"index-of":Oh,interpolate:ao,"interpolate-hcl":ao,"interpolate-lab":ao,length:Es,let:Fd,literal:is,match:sp,number:js,"number-format":Il,object:js,slice:jo,step:Ch,string:js,"to-boolean":bo,"to-color":bo,"to-number":bo,"to-string":bo,var:zd,within:bc};function Vh(t,[e,n,a,h]){e=e.evaluate(t),n=n.evaluate(t),a=a.evaluate(t);const m=h?h.evaluate(t):1,y=vh(e,n,a,m);if(y)throw new Wr(y);return new dr(e/255*m,n/255*m,a/255*m,m)}function Vo(t,e){return t in e}function Us(t,e){const n=e[t];return n===void 0?null:n}function lo(t){return{type:t}}No.register(Pc,{error:[{kind:"error"},[Gn],(t,[e])=>{throw new Wr(e.evaluate(t))}],typeof:[Gn,[Cn],(t,[e])=>_r(Or(e.evaluate(t)))],"to-rgba":[wo($t,4),[so],(t,[e])=>e.evaluate(t).toArray()],rgb:[so,[$t,$t,$t],Vh],rgba:[so,[$t,$t,$t,$t],Vh],has:{type:Ln,overloads:[[[Gn],(t,[e])=>Vo(e.evaluate(t),t.properties())],[[Gn,vo],(t,[e,n])=>Vo(e.evaluate(t),n.evaluate(t))]]},get:{type:Cn,overloads:[[[Gn],(t,[e])=>Us(e.evaluate(t),t.properties())],[[Gn,vo],(t,[e,n])=>Us(e.evaluate(t),n.evaluate(t))]]},"feature-state":[Cn,[Gn],(t,[e])=>Us(e.evaluate(t),t.featureState||{})],properties:[vo,[],t=>t.properties()],"geometry-type":[Gn,[],t=>t.geometryType()],id:[Cn,[],t=>t.id()],zoom:[$t,[],t=>t.globals.zoom],pitch:[$t,[],t=>t.globals.pitch||0],"distance-from-center":[$t,[],t=>t.distanceFromCenter()],"heatmap-density":[$t,[],t=>t.globals.heatmapDensity||0],"line-progress":[$t,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[$t,[],t=>t.globals.skyRadialProgress||0],accumulated:[Cn,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[$t,lo($t),(t,e)=>{let n=0;for(const a of e)n+=a.evaluate(t);return n}],"*":[$t,lo($t),(t,e)=>{let n=1;for(const a of e)n*=a.evaluate(t);return n}],"-":{type:$t,overloads:[[[$t,$t],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[$t],(t,[e])=>-e.evaluate(t)]]},"/":[$t,[$t,$t],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[$t,[$t,$t],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[$t,[],()=>Math.LN2],pi:[$t,[],()=>Math.PI],e:[$t,[],()=>Math.E],"^":[$t,[$t,$t],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[$t,[$t],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[$t,[$t],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[$t,[$t],(t,[e])=>Math.log(e.evaluate(t))],log2:[$t,[$t],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[$t,[$t],(t,[e])=>Math.sin(e.evaluate(t))],cos:[$t,[$t],(t,[e])=>Math.cos(e.evaluate(t))],tan:[$t,[$t],(t,[e])=>Math.tan(e.evaluate(t))],asin:[$t,[$t],(t,[e])=>Math.asin(e.evaluate(t))],acos:[$t,[$t],(t,[e])=>Math.acos(e.evaluate(t))],atan:[$t,[$t],(t,[e])=>Math.atan(e.evaluate(t))],min:[$t,lo($t),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[$t,lo($t),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[$t,[$t],(t,[e])=>Math.abs(e.evaluate(t))],round:[$t,[$t],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[$t,[$t],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[$t,[$t],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Ln,[Gn,Cn],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[Ln,[Cn],(t,[e])=>t.id()===e.value],"filter-type-==":[Ln,[Gn],(t,[e])=>t.geometryType()===e.value],"filter-<":[Ln,[Gn,Cn],(t,[e,n])=>{const a=t.properties()[e.value],h=n.value;return typeof a==typeof h&&a<h}],"filter-id-<":[Ln,[Cn],(t,[e])=>{const n=t.id(),a=e.value;return typeof n==typeof a&&n<a}],"filter->":[Ln,[Gn,Cn],(t,[e,n])=>{const a=t.properties()[e.value],h=n.value;return typeof a==typeof h&&a>h}],"filter-id->":[Ln,[Cn],(t,[e])=>{const n=t.id(),a=e.value;return typeof n==typeof a&&n>a}],"filter-<=":[Ln,[Gn,Cn],(t,[e,n])=>{const a=t.properties()[e.value],h=n.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[Ln,[Cn],(t,[e])=>{const n=t.id(),a=e.value;return typeof n==typeof a&&n<=a}],"filter->=":[Ln,[Gn,Cn],(t,[e,n])=>{const a=t.properties()[e.value],h=n.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[Ln,[Cn],(t,[e])=>{const n=t.id(),a=e.value;return typeof n==typeof a&&n>=a}],"filter-has":[Ln,[Cn],(t,[e])=>e.value in t.properties()],"filter-has-id":[Ln,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[Ln,[wo(Gn)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Ln,[wo(Cn)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Ln,[Gn,wo(Cn)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Ln,[Gn,wo(Cn)],(t,[e,n])=>function(a,h,m,y){for(;m<=y;){const w=m+y>>1;if(h[w]===a)return!0;h[w]>a?y=w-1:m=w+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Ln,overloads:[[[Ln,Ln],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[lo(Ln),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Ln,overloads:[[[Ln,Ln],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[lo(Ln),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Ln,[Ln],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Ln,[Gn],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Gn,[Gn],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Gn,[Gn],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Gn,lo(Cn),(t,e)=>e.map(n=>bu(n.evaluate(t))).join("")],"resolved-locale":[Gn,[xo],(t,[e])=>e.evaluate(t).resolvedLocale()]});var Rl=Pc;function Du(t){return{result:"success",value:t}}function ma(t){return{result:"error",value:t}}function Xa(t){return t["property-type"]==="data-driven"}function zu(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Ou(t){return!!t.expression&&t.expression.interpolated}function Kn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function Ll(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function $s(t){return t}function Dl(t,e){const n=e.type==="color",a=t.stops&&typeof t.stops[0][0]=="object",h=a||!(a||t.property!==void 0),m=t.type||(Ou(e)?"exponential":"interval");if(n&&((t=ci({},t)).stops&&(t.stops=t.stops.map(C=>[C[0],dr.parse(C[1])])),t.default=dr.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!Lh[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let y,w,E;if(m==="exponential")y=To;else if(m==="interval")y=Ic;else if(m==="categorical"){y=Ud,w=Object.create(null);for(const C of t.stops)w[C[0]]=C[1];E=typeof t.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);y=$d}if(a){const C={},R=[];for(let $=0;$<t.stops.length;$++){const G=t.stops[$],K=G[0].zoom;C[K]===void 0&&(C[K]={zoom:K,type:t.type,property:t.property,default:t.default,stops:[]},R.push(K)),C[K].stops.push([G[0].value,G[1]])}const z=[];for(const $ of R)z.push([C[$].zoom,Dl(C[$],e)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:ao.interpolationFactor.bind(void 0,B),zoomStops:z.map($=>$[0]),evaluate:({zoom:$},G)=>To({stops:z,base:t.base},e,$).evaluate($,G)}}if(h){const C=m==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:ao.interpolationFactor.bind(void 0,C),zoomStops:t.stops.map(R=>R[0]),evaluate:({zoom:R})=>y(t,e,R,w,E)}}return{kind:"source",evaluate(C,R){const z=R&&R.properties?R.properties[t.property]:void 0;return z===void 0?ga(t.default,e.default):y(t,e,z,w,E)}}}function ga(t,e,n){return t!==void 0?t:e!==void 0?e:n!==void 0?n:void 0}function Ud(t,e,n,a,h){return ga(typeof n===h?a[n]:void 0,t.default,e.default)}function Ic(t,e,n){if(Kn(n)!=="number")return ga(t.default,e.default);const a=t.stops.length;if(a===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[a-1][0])return t.stops[a-1][1];const h=Ec(t.stops.map(m=>m[0]),n);return t.stops[h][1]}function To(t,e,n){const a=t.base!==void 0?t.base:1;if(Kn(n)!=="number")return ga(t.default,e.default);const h=t.stops.length;if(h===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[h-1][0])return t.stops[h-1][1];const m=Ec(t.stops.map(R=>R[0]),n),y=function(R,z,B,$){const G=$-B,K=R-B;return G===0?0:z===1?K/G:(Math.pow(z,K)-1)/(Math.pow(z,G)-1)}(n,a,t.stops[m][0],t.stops[m+1][0]),w=t.stops[m][1],E=t.stops[m+1][1];let C=Au[e.type]||$s;if(t.colorSpace&&t.colorSpace!=="rgb"){const R=Lh[t.colorSpace];C=(z,B)=>R.reverse(R.interpolate(R.forward(z),R.forward(B),y))}return typeof w.evaluate=="function"?{evaluate(...R){const z=w.evaluate.apply(void 0,R),B=E.evaluate.apply(void 0,R);if(z!==void 0&&B!==void 0)return C(z,B,y)}}:C(w,E,y)}function $d(t,e,n){return e.type==="color"?n=dr.parse(n):e.type==="formatted"?n=xi.fromString(n.toString()):e.type==="resolvedImage"?n=Bo.fromString(n.toString()):Kn(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),ga(n,t.default,e.default)}class Bu{constructor(e,n){this.expression=e,this._warningHistory={},this._evaluator=new Tl,this._defaultValue=n?function(a){return a.type==="color"&&(Ll(a.default)||Array.isArray(a.default))?new dr(0,0,0,0):a.type==="color"?dr.parse(a.default)||null:a.default===void 0?null:a.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,a,h,m,y,w,E){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=a,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,a,h,m,y,w,E){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=E||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Wr(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function Ka(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Rl}function hr(t,e){const n=new Sh(Rl,[],e?function(h){const m={color:so,string:Gn,number:$t,enum:Gn,boolean:Ln,formatted:Va,resolvedImage:er};return h.type==="array"?wo(m[h.value]||Cn,h.length):m[h.type]}(e):void 0),a=n.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?Du(new Bu(a,e)):ma(n.errors)}class Fu{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!Vs(n.expression)}evaluateWithoutErrorHandling(e,n,a,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,a,h,m,y)}evaluate(e,n,a,h,m,y){return this._styleExpression.evaluate(e,n,a,h,m,y)}}class ya{constructor(e,n,a,h){this.kind=e,this.zoomStops=a,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Vs(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,n,a,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,a,h,m,y)}evaluate(e,n,a,h,m,y){return this._styleExpression.evaluate(e,n,a,h,m,y)}interpolationFactor(e,n,a){return this.interpolationType?ao.interpolationFactor(this.interpolationType,e,n,a):0}}function Gs(t,e){if((t=hr(t,e)).result==="error")return t;const n=t.value.expression,a=Cl(n);if(!a&&!Xa(e))return ma([new _o("","data expressions not supported")]);const h=da(n,["zoom","pitch","distance-from-center"]);if(!h&&!zu(e))return ma([new _o("","zoom expressions not supported")]);const m=zl(n);return m||h?m instanceof _o?ma([m]):m instanceof ao&&!Ou(e)?ma([new _o("",'"interpolate" expressions cannot be used with this property')]):Du(m?new ya(a?"camera":"composite",t.value,m.labels,m instanceof ao?m.interpolation:void 0):new Fu(a?"constant":"source",t.value)):ma([new _o("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Nu{constructor(e,n){this._parameters=e,this._specification=n,ci(this,Dl(this._parameters,this._specification))}static deserialize(e){return new Nu(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function zl(t){let e=null;if(t instanceof Fd)e=zl(t.result);else if(t instanceof Dh){for(const n of t.args)if(e=zl(n),e)break}else(t instanceof Ch||t instanceof ao)&&t.input instanceof No&&t.input.name==="zoom"&&(e=t);return e instanceof _o||t.eachChild(n=>{const a=zl(n);a instanceof _o?e=a:!e&&a?e=new _o("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new _o("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class Nt{constructor(e,n,a,h){this.message=(e?`${e}: `:"")+a,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function uo(t){const e=t.key,n=t.value,a=t.valueSpec||{},h=t.objectElementValidators||{},m=t.style,y=t.styleSpec;let w=[];const E=Kn(n);if(E!=="object")return[new Nt(e,n,`object expected, ${E} found`)];for(const C in n){const R=C.split(".")[0];let z;h[R]?z=h[R]:a[R]?z=qn:h["*"]?z=h["*"]:a["*"]&&(z=qn),z?w=w.concat(z({key:(e&&`${e}.`)+C,value:n[C],valueSpec:a[R]||a["*"],style:m,styleSpec:y,object:n,objectKey:C},n)):w.push(new Nt(e,n[C],`unknown property "${C}"`))}for(const C in a)h[C]||a[C].required&&a[C].default===void 0&&n[C]===void 0&&w.push(new Nt(e,n,`missing required property "${C}"`));return w}function Ya(t){const e=t.value,n=t.valueSpec,a=t.style,h=t.styleSpec,m=t.key,y=t.arrayElementValidator||qn;if(Kn(e)!=="array")return[new Nt(m,e,`array expected, ${Kn(e)} found`)];if(n.length&&e.length!==n.length)return[new Nt(m,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new Nt(m,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let w={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};h.$version<7&&(w.function=n.function),Kn(n.value)==="object"&&(w=n.value);let E=[];for(let C=0;C<e.length;C++)E=E.concat(y({array:e,arrayIndex:C,value:e[C],valueSpec:w,style:a,styleSpec:h,key:`${m}[${C}]`}));return E}function Ol(t){const e=t.key,n=t.value,a=t.valueSpec;let h=Kn(n);if(h==="number"&&n!=n&&(h="NaN"),h!=="number")return[new Nt(e,n,`number expected, ${h} found`)];if("minimum"in a){let m=a.minimum;if(Kn(a.minimum)==="array"&&(m=a.minimum[t.arrayIndex]),n<m)return[new Nt(e,n,`${n} is less than the minimum value ${m}`)]}if("maximum"in a){let m=a.maximum;if(Kn(a.maximum)==="array"&&(m=a.maximum[t.arrayIndex]),n>m)return[new Nt(e,n,`${n} is greater than the maximum value ${m}`)]}return[]}function ju(t){const e=t.valueSpec,n=Qr(t.value.type);let a,h,m,y={};const w=n!=="categorical"&&t.value.property===void 0,E=!w,C=Kn(t.value.stops)==="array"&&Kn(t.value.stops[0])==="array"&&Kn(t.value.stops[0][0])==="object",R=uo({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function($){if(n==="identity")return[new Nt($.key,$.value,'identity function may not have a "stops" property')];let G=[];const K=$.value;return G=G.concat(Ya({key:$.key,value:K,valueSpec:$.valueSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:z})),Kn(K)==="array"&&K.length===0&&G.push(new Nt($.key,K,"array must have at least one stop")),G},default:function($){return qn({key:$.key,value:$.value,valueSpec:e,style:$.style,styleSpec:$.styleSpec})}}});return n==="identity"&&w&&R.push(new Nt(t.key,t.value,'missing required property "property"')),n==="identity"||t.value.stops||R.push(new Nt(t.key,t.value,'missing required property "stops"')),n==="exponential"&&t.valueSpec.expression&&!Ou(t.valueSpec)&&R.push(new Nt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(E&&!Xa(t.valueSpec)?R.push(new Nt(t.key,t.value,"property functions not supported")):w&&!zu(t.valueSpec)&&R.push(new Nt(t.key,t.value,"zoom functions not supported"))),n!=="categorical"&&!C||t.value.property!==void 0||R.push(new Nt(t.key,t.value,'"property" property is required')),R;function z($){let G=[];const K=$.value,oe=$.key;if(Kn(K)!=="array")return[new Nt(oe,K,`array expected, ${Kn(K)} found`)];if(K.length!==2)return[new Nt(oe,K,`array length 2 expected, length ${K.length} found`)];if(C){if(Kn(K[0])!=="object")return[new Nt(oe,K,`object expected, ${Kn(K[0])} found`)];if(K[0].zoom===void 0)return[new Nt(oe,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new Nt(oe,K,"object stop key must have value")];const fe=Qr(K[0].zoom);if(typeof fe!="number")return[new Nt(oe,K[0].zoom,"stop zoom values must be numbers")];if(m&&m>fe)return[new Nt(oe,K[0].zoom,"stop zoom values must appear in ascending order")];fe!==m&&(m=fe,h=void 0,y={}),G=G.concat(uo({key:`${oe}[0]`,value:K[0],valueSpec:{zoom:{}},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:Ol,value:B}}))}else G=G.concat(B({key:`${oe}[0]`,value:K[0],style:$.style,styleSpec:$.styleSpec},K));return Ka(_i(K[1]))?G.concat([new Nt(`${oe}[1]`,K[1],"expressions are not allowed in function stops.")]):G.concat(qn({key:`${oe}[1]`,value:K[1],valueSpec:e,style:$.style,styleSpec:$.styleSpec}))}function B($,G){const K=Kn($.value),oe=Qr($.value),fe=$.value!==null?$.value:G;if(a){if(K!==a)return[new Nt($.key,fe,`${K} stop domain type must match previous stop domain type ${a}`)]}else a=K;if(K!=="number"&&K!=="string"&&K!=="boolean"&&typeof oe!="number"&&typeof oe!="string"&&typeof oe!="boolean")return[new Nt($.key,fe,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&n!=="categorical"){let Te=`number expected, ${K} found`;return Xa(e)&&n===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Nt($.key,fe,Te)]}return n!=="categorical"||K!=="number"||typeof oe=="number"&&isFinite(oe)&&Math.floor(oe)===oe?n!=="categorical"&&K==="number"&&typeof oe=="number"&&typeof h=="number"&&h!==void 0&&oe<h?[new Nt($.key,fe,"stop domain values must appear in ascending order")]:(h=oe,n==="categorical"&&oe in y?[new Nt($.key,fe,"stop domain values must be unique")]:(y[oe]=!0,[])):[new Nt($.key,fe,`integer expected, found ${String(oe)}`)]}}function wi(t){const e=(t.expressionContext==="property"?Gs:hr)(_i(t.value),t.valueSpec);if(e.result==="error")return e.value.map(a=>new Nt(`${t.key}${a.key}`,t.value,a.message));const n=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!n.outputDefined())return[new Nt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!Vs(n))return[new Nt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter")return Bl(n,t);if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!da(n,["zoom","feature-state"]))return[new Nt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Cl(n))return[new Nt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Bl(t,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const h of e.valueSpec.expression.parameters)n.delete(h);if(n.size===0)return[];const a=[];return t instanceof No&&n.has(t.name)?[new Nt(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(h=>{a.push(...Bl(h,e))}),a)}function Ja(t){const e=t.key,n=t.value,a=t.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(Qr(n))===-1&&h.push(new Nt(e,n,`expected one of [${a.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(a.values).indexOf(Qr(n))===-1&&h.push(new Nt(e,n,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function Fl(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Fl(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Nl(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Fl(t)||(t=Vl(t));const n=t;let a=!0;try{a=function(C){if(!_a(C))return C;let R=_i(C);return jl(R),R=Rc(R),R}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const h=ot[`filter_${e}`],m=hr(a,h);let y=null;if(m.result==="error")throw new Error(m.value.map(C=>`${C.key}: ${C.message}`).join(", "));y=(C,R,z)=>m.value.evaluate(C,R,{},z);let w=null,E=null;if(a!==n){const C=hr(n,h);if(C.result==="error")throw new Error(C.value.map(R=>`${R.key}: ${R.message}`).join(", "));w=(R,z,B,$,G)=>C.value.evaluate(R,z,{},B,void 0,void 0,$,G),E=!Cl(C.value.expression)}return{filter:y,dynamicFilter:w||void 0,needGeometry:qd(a),needFeature:!!E}}function Rc(t){if(!Array.isArray(t))return t;const e=function(n){if(Uh.has(n[0])){for(let a=1;a<n.length;a++)if(_a(n[a]))return!0}return n}(t);return e===!0?e:e.map(n=>Rc(n))}function jl(t){let e=!1;const n=[];if(t[0]==="case"){for(let a=1;a<t.length-1;a+=2)e=e||_a(t[a]),n.push(t[a+1]);n.push(t[t.length-1])}else if(t[0]==="match"){e=e||_a(t[1]);for(let a=2;a<t.length-1;a+=2)n.push(t[a+1]);n.push(t[t.length-1])}else if(t[0]==="step"){e=e||_a(t[1]);for(let a=1;a<t.length-1;a+=2)n.push(t[a+1])}e&&(t.length=0,t.push("any",...n));for(let a=1;a<t.length;a++)jl(t[a])}function _a(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<t.length;n++)if(_a(t[n]))return!0;return!1}const Uh=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Gd(t,e){return t<e?-1:t>e?1:0}function qd(t){if(!Array.isArray(t))return!1;if(t[0]==="within")return!0;for(let e=1;e<t.length;e++)if(qd(t[e]))return!0;return!1}function Vl(t){if(!t)return!0;const e=t[0];return t.length<=1?e!=="any":e==="=="?Vu(t[1],t[2],"=="):e==="!="?qs(Vu(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Vu(t[1],t[2],e):e==="any"?(n=t.slice(1),["any"].concat(n.map(Vl))):e==="all"?["all"].concat(t.slice(1).map(Vl)):e==="none"?["all"].concat(t.slice(1).map(Vl).map(qs)):e==="in"?Ss(t[1],t.slice(2)):e==="!in"?qs(Ss(t[1],t.slice(2))):e==="has"?Lc(t[1]):e==="!has"?qs(Lc(t[1])):e!=="within"||t;var n}function Vu(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function Ss(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Gd)]]:["filter-in-small",t,["literal",e]]}}function Lc(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function qs(t){return["!",t]}function co(t){return Fl(_i(t.value))?wi(ci({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):Ws(t)}function Ws(t){const e=t.value,n=t.key;if(Kn(e)!=="array")return[new Nt(n,e,`array expected, ${Kn(e)} found`)];const a=t.styleSpec;let h,m=[];if(e.length<1)return[new Nt(n,e,"filter array must have at least 1 element")];switch(m=m.concat(Ja({key:`${n}[0]`,value:e[0],valueSpec:a.filter_operator,style:t.style,styleSpec:t.styleSpec})),Qr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Qr(e[1])==="$type"&&m.push(new Nt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Nt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=Kn(e[1]),h!=="string"&&m.push(new Nt(`${n}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=Kn(e[y]),Qr(e[1])==="$type"?m=m.concat(Ja({key:`${n}[${y}]`,value:e[y],valueSpec:a.geometry_type,style:t.style,styleSpec:t.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new Nt(`${n}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(Ws({key:`${n}[${y}]`,value:e[y],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":h=Kn(e[1]),e.length!==2?m.push(new Nt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new Nt(`${n}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=Kn(e[1]),e.length!==2?m.push(new Nt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&m.push(new Nt(`${n}[1]`,e[1],`object expected, ${h} found`))}return m}function ss(t,e){const n=t.key,a=t.style,h=t.styleSpec,m=t.value,y=t.objectKey,w=h[`${e}_${t.layerType}`];if(!w)return[];const E=y.match(/^(.*)-transition$/);if(e==="paint"&&E&&w[E[1]]&&w[E[1]].transition)return qn({key:n,value:m,valueSpec:h.transition,style:a,styleSpec:h});const C=t.valueSpec||w[y];if(!C)return[new Nt(n,m,`unknown property "${y}"`)];let R;if(Kn(m)==="string"&&Xa(C)&&!C.tokens&&(R=/^{([^}]+)}$/.exec(m))){const B=`\`{ "type": "identity", "property": ${R?JSON.stringify(R[1]):'"_"'} }\``;return[new Nt(n,m,`"${y}" does not support interpolation syntax
Use an identity property function instead: ${B}.`)]}const z=[];return t.layerType==="symbol"&&(y==="text-field"&&a&&!a.glyphs&&z.push(new Nt(n,m,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&Ll(_i(m))&&Qr(m.type)==="identity"&&z.push(new Nt(n,m,'"text-font" does not support identity functions'))),z.concat(qn({key:t.key,value:m,valueSpec:C,style:a,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:y}))}function Dc(t){return ss(t,"paint")}function $h(t){return ss(t,"layout")}function Wd(t){let e=[];const n=t.value,a=t.key,h=t.style,m=t.styleSpec;n.type||n.ref||e.push(new Nt(a,n,'either "type" or "ref" is required'));let y=Qr(n.type);const w=Qr(n.ref);if(n.id){const E=Qr(n.id);for(let C=0;C<t.arrayIndex;C++){const R=h.layers[C];Qr(R.id)===E&&e.push(new Nt(a,n.id,`duplicate layer id "${n.id}", previously used at line ${R.id.__line__}`))}}if("ref"in n){let E;["type","source","source-layer","filter","layout"].forEach(C=>{C in n&&e.push(new Nt(a,n[C],`"${C}" is prohibited for ref layers`))}),h.layers.forEach(C=>{Qr(C.id)===w&&(E=C)}),E?E.ref?e.push(new Nt(a,n.ref,"ref cannot reference another ref layer")):y=Qr(E.type):typeof w=="string"&&e.push(new Nt(a,n.ref,`ref layer "${w}" not found`))}else if(y!=="background"&&y!=="sky")if(n.source){const E=h.sources&&h.sources[n.source],C=E&&Qr(E.type);E?C==="vector"&&y==="raster"?e.push(new Nt(a,n.source,`layer "${n.id}" requires a raster source`)):C==="raster"&&y!=="raster"?e.push(new Nt(a,n.source,`layer "${n.id}" requires a vector source`)):C!=="vector"||n["source-layer"]?C==="raster-dem"&&y!=="hillshade"?e.push(new Nt(a,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||C==="geojson"&&E.lineMetrics||e.push(new Nt(a,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Nt(a,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new Nt(a,n.source,`source "${n.source}" not found`))}else e.push(new Nt(a,n,'missing required property "source"'));return e=e.concat(uo({key:a,value:n,valueSpec:m.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>qn({key:`${a}.type`,value:n.type,valueSpec:m.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:E=>co(ci({layerType:y},E)),layout:E=>uo({layer:n,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":C=>$h(ci({layerType:y},C))}}),paint:E=>uo({layer:n,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":C=>Dc(ci({layerType:y},C))}})}})),e}function ho(t){const e=t.value,n=t.key,a=Kn(e);return a!=="string"?[new Nt(n,e,`string expected, ${a} found`)]:[]}const Ul={promoteId:function({key:t,value:e}){if(Kn(e)==="string")return ho({key:t,value:e});{const n=[];for(const a in e)n.push(...ho({key:`${t}.${a}`,value:e[a]}));return n}}};function Qa(t){const e=t.value,n=t.key,a=t.styleSpec,h=t.style;if(!e.type)return[new Nt(n,e,'"type" is required')];const m=Qr(e.type);let y;switch(m){case"vector":case"raster":case"raster-dem":return y=uo({key:n,value:e,valueSpec:a[`source_${m.replace("-","_")}`],style:t.style,styleSpec:a,objectElementValidators:Ul}),y;case"geojson":if(y=uo({key:n,value:e,valueSpec:a.source_geojson,style:h,styleSpec:a,objectElementValidators:Ul}),e.cluster)for(const w in e.clusterProperties){const[E,C]=e.clusterProperties[w],R=typeof E=="string"?[E,["accumulated"],["get",w]]:E;y.push(...wi({key:`${n}.${w}.map`,value:C,expressionContext:"cluster-map"})),y.push(...wi({key:`${n}.${w}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return y;case"video":return uo({key:n,value:e,valueSpec:a.source_video,style:h,styleSpec:a});case"image":return uo({key:n,value:e,valueSpec:a.source_image,style:h,styleSpec:a});case"canvas":return[new Nt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ja({key:`${n}.type`,value:e.type,valueSpec:{values:zc(a)}})}}function zc(t){return t.source.reduce((e,n)=>{const a=t[n];return a.type.type==="enum"&&(e=e.concat(Object.keys(a.type.values))),e},[])}function Oc(t){const e=t.value,n=t.styleSpec,a=n.light,h=t.style;let m=[];const y=Kn(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Nt("light",e,`object expected, ${y} found`)]),m;for(const w in e){const E=w.match(/^(.*)-transition$/);m=m.concat(E&&a[E[1]]&&a[E[1]].transition?qn({key:w,value:e[w],valueSpec:n.transition,style:h,styleSpec:n}):a[w]?qn({key:w,value:e[w],valueSpec:a[w],style:h,styleSpec:n}):[new Nt(w,e[w],`unknown property "${w}"`)])}return m}function va(t){const e=t.value,n=t.key,a=t.style,h=t.styleSpec,m=h.terrain;let y=[];const w=Kn(e);if(e===void 0)return y;if(w!=="object")return y=y.concat([new Nt("terrain",e,`object expected, ${w} found`)]),y;for(const E in e){const C=E.match(/^(.*)-transition$/);y=y.concat(C&&m[C[1]]&&m[C[1]].transition?qn({key:E,value:e[E],valueSpec:h.transition,style:a,styleSpec:h}):m[E]?qn({key:E,value:e[E],valueSpec:m[E],style:a,styleSpec:h}):[new Nt(E,e[E],`unknown property "${E}"`)])}if(e.source){const E=a.sources&&a.sources[e.source],C=E&&Qr(E.type);E?C!=="raster-dem"&&y.push(new Nt(n,e.source,`terrain cannot be used with a source of type ${String(C)}, it only be used with a "raster-dem" source type`)):y.push(new Nt(n,e.source,`source "${e.source}" not found`))}else y.push(new Nt(n,e,'terrain is missing required property "source"'));return y}function Zs(t){const e=t.value,n=t.style,a=t.styleSpec,h=a.fog;let m=[];const y=Kn(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Nt("fog",e,`object expected, ${y} found`)]),m;for(const w in e){const E=w.match(/^(.*)-transition$/);m=m.concat(E&&h[E[1]]&&h[E[1]].transition?qn({key:w,value:e[w],valueSpec:a.transition,style:n,styleSpec:a}):h[w]?qn({key:w,value:e[w],valueSpec:h[w],style:n,styleSpec:a}):[new Nt(w,e[w],`unknown property "${w}"`)])}return m}const Ar={"*":()=>[],array:Ya,boolean:function(t){const e=t.value,n=t.key,a=Kn(e);return a!=="boolean"?[new Nt(n,e,`boolean expected, ${a} found`)]:[]},number:Ol,color:function(t){const e=t.key,n=t.value,a=Kn(n);return a!=="string"?[new Nt(e,n,`color expected, ${a} found`)]:xu(n)===null?[new Nt(e,n,`color expected, "${n}" found`)]:[]},enum:Ja,filter:co,function:ju,layer:Wd,object:uo,source:Qa,light:Oc,terrain:va,fog:Zs,string:ho,formatted:function(t){return ho(t).length===0?[]:wi(t)},resolvedImage:function(t){return ho(t).length===0?[]:wi(t)},projection:function(t){const e=t.value,n=t.styleSpec,a=n.projection,h=t.style;let m=[];const y=Kn(e);if(y==="object")for(const w in e)m=m.concat(qn({key:w,value:e[w],valueSpec:a[w],style:h,styleSpec:n}));else y!=="string"&&(m=m.concat([new Nt("projection",e,`object or string expected, ${y} found`)]));return m}};function qn(t){const e=t.value,n=t.valueSpec,a=t.styleSpec;return n.expression&&Ll(Qr(e))?ju(t):n.expression&&Ka(_i(e))?wi(t):n.type&&Ar[n.type]?Ar[n.type](t):uo(ci({},t,{valueSpec:n.type?a[n.type]:n}))}function xa(t){const e=t.value,n=t.key,a=ho(t);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Nt(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Nt(n,e,'"glyphs" url must include a "{range}" token'))),a}function Li(t,e=ot){return Di(qn({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:xa,"*":()=>[]}}))}const fo=t=>Di(Dc(t)),el=t=>Di($h(t));function Di(t){return t.slice().sort((e,n)=>e.line&&n.line?e.line-n.line:0)}function Ki(t,e){let n=!1;if(e&&e.length)for(const a of e)t.fire(new Do(new Error(a.message))),n=!0;return n}var Bc=as,Uo=3;function as(t,e,n){var a=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var h=new Int32Array(this.arrayBuffer);t=h[0],this.d=(e=h[1])+2*(n=h[2]);for(var m=0;m<this.d*this.d;m++){var y=h[Uo+m],w=h[Uo+m+1];a.push(y===w?null:h.subarray(y,w))}var E=h[Uo+a.length+1];this.keys=h.subarray(h[Uo+a.length],E),this.bboxes=h.subarray(E),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var C=0;C<this.d*this.d;C++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var R=n/e*t;this.min=-R,this.max=t+R}as.prototype.insert=function(t,e,n,a,h){this._forEachCell(e,n,a,h,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(a),this.bboxes.push(h)},as.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},as.prototype._insertCell=function(t,e,n,a,h,m){this.cells[h].push(m)},as.prototype.query=function(t,e,n,a,h){var m=this.min,y=this.max;if(t<=m&&e<=m&&y<=n&&y<=a&&!h)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(t,e,n,a,this._queryCell,w,{},h),w},as.prototype._queryCell=function(t,e,n,a,h,m,y,w){var E=this.cells[h];if(E!==null)for(var C=this.keys,R=this.bboxes,z=0;z<E.length;z++){var B=E[z];if(y[B]===void 0){var $=4*B;(w?w(R[$+0],R[$+1],R[$+2],R[$+3]):t<=R[$+2]&&e<=R[$+3]&&n>=R[$+0]&&a>=R[$+1])?(y[B]=!0,m.push(C[B])):y[B]=!1}}},as.prototype._forEachCell=function(t,e,n,a,h,m,y,w){for(var E=this._convertToCellCoord(t),C=this._convertToCellCoord(e),R=this._convertToCellCoord(n),z=this._convertToCellCoord(a),B=E;B<=R;B++)for(var $=C;$<=z;$++){var G=this.d*$+B;if((!w||w(this._convertFromCellCoord(B),this._convertFromCellCoord($),this._convertFromCellCoord(B+1),this._convertFromCellCoord($+1)))&&h.call(this,t,e,n,a,G,m,y,w))return}},as.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},as.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},as.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Uo+this.cells.length+1+1,n=0,a=0;a<this.cells.length;a++)n+=this.cells[a].length;var h=new Int32Array(e+n+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var m=e,y=0;y<t.length;y++){var w=t[y];h[Uo+y]=m,h.set(w,m),m+=w.length}return h[Uo+t.length]=m,h.set(this.keys,m),h[Uo+t.length+1]=m+=this.keys.length,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer};var Cs=me(Bc);const Uu={};function Vt(t,e,n={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Uu[e]={klass:t,omit:n.omit||[]}}Vt(Object,"Object"),Cs.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Cs.deserialize=function(t){return new Cs(t.buffer)},Object.defineProperty(Cs,"name",{value:"Grid"}),Vt(Cs,"Grid"),Vt(dr,"Color"),Vt(Error,"Error"),Vt(io,"AJAXError"),Vt(Bo,"ResolvedImage"),Vt(Nu,"StylePropertyFunction"),Vt(Bu,"StyleExpression",{omit:["_evaluator"]}),Vt(ya,"ZoomDependentExpression"),Vt(Fu,"ZoomConstantExpression"),Vt(No,"CompoundExpression",{omit:["_evaluate"]});for(const t in Rl)Uu[Rl[t]._classRegistryKey]||Vt(Rl[t],`Expression${t}`);function $l(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function $u(t){return I.ImageBitmap&&t instanceof I.ImageBitmap}function tl(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if($l(t)||$u(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof I.ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const a of t)n.push(tl(a,e));return n}if(typeof t=="object"){const n=t.constructor,a=n._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${a}`);const h=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const m in t)t.hasOwnProperty(m)&&(Uu[a].omit.indexOf(m)>=0||(h[m]=tl(t[m],e)));t instanceof Error&&(h.message=t.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(h.$name=a),h}throw new Error("can't serialize object of type "+typeof t)}function nl(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||$l(t)||$u(t)||ArrayBuffer.isView(t)||t instanceof I.ImageData)return t;if(Array.isArray(t))return t.map(nl);if(typeof t=="object"){const e=t.$name||"Object",{klass:n}=Uu[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const a=Object.create(n.prototype);for(const h of Object.keys(t))h!=="$name"&&(a[h]=nl(t[h]));return a}throw new Error("can't deserialize object of type "+typeof t)}const Bt={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function wa(t){for(const e of t)if(ql(e.charCodeAt(0)))return!0;return!1}function Gl(t){for(const e of t)if(!Gu(e.charCodeAt(0)))return!1;return!0}function Gu(t){return!(Bt.Arabic(t)||Bt["Arabic Supplement"](t)||Bt["Arabic Extended-A"](t)||Bt["Arabic Presentation Forms-A"](t)||Bt["Arabic Presentation Forms-B"](t))}function ql(t){return!(t!==746&&t!==747&&(t<4352||!(Bt["Bopomofo Extended"](t)||Bt.Bopomofo(t)||Bt["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Bt["CJK Compatibility Ideographs"](t)||Bt["CJK Compatibility"](t)||Bt["CJK Radicals Supplement"](t)||Bt["CJK Strokes"](t)||!(!Bt["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||Bt["CJK Unified Ideographs Extension A"](t)||Bt["CJK Unified Ideographs"](t)||Bt["Enclosed CJK Letters and Months"](t)||Bt["Hangul Compatibility Jamo"](t)||Bt["Hangul Jamo Extended-A"](t)||Bt["Hangul Jamo Extended-B"](t)||Bt["Hangul Jamo"](t)||Bt["Hangul Syllables"](t)||Bt.Hiragana(t)||Bt["Ideographic Description Characters"](t)||Bt.Kanbun(t)||Bt["Kangxi Radicals"](t)||Bt["Katakana Phonetic Extensions"](t)||Bt.Katakana(t)&&t!==12540||!(!Bt["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!Bt["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Bt["Unified Canadian Aboriginal Syllabics"](t)||Bt["Unified Canadian Aboriginal Syllabics Extended"](t)||Bt["Vertical Forms"](t)||Bt["Yijing Hexagram Symbols"](t)||Bt["Yi Syllables"](t)||Bt["Yi Radicals"](t))))}function Eo(t){return!(ql(t)||function(e){return!!(Bt["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Bt["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Bt["Letterlike Symbols"](e)||Bt["Number Forms"](e)||Bt["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Bt["Control Pictures"](e)&&e!==9251||Bt["Optical Character Recognition"](e)||Bt["Enclosed Alphanumerics"](e)||Bt["Geometric Shapes"](e)||Bt["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Bt["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Bt["CJK Symbols and Punctuation"](e)||Bt.Katakana(e)||Bt["Private Use Area"](e)||Bt["CJK Compatibility Forms"](e)||Bt["Small Form Variants"](e)||Bt["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function So(t){return t>=1424&&t<=2303||Bt["Arabic Presentation Forms-A"](t)||Bt["Arabic Presentation Forms-B"](t)}function rl(t,e){return!(!e&&So(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Bt.Khmer(t))}function Hs(t){for(const e of t)if(So(e.charCodeAt(0)))return!0;return!1}const ls="deferred",Xs="loading",Fc="loaded";let ba=null,f="unavailable",r=null;const u=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(f="error"),ba&&ba(t)};function g(){v.fire(new la("pluginStateChange",{pluginStatus:f,pluginURL:r}))}const v=new oo,b=function(){return f},M=function(){if(f!==ls||!r)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");f=Xs,g(),r&&gs({url:r},t=>{t?u(t):(f=Fc,g())})},P={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>f===Fc||P.applyArabicShaping!=null,isLoading:()=>f===Xs,setState(t){f=t.pluginStatus,r=t.pluginURL},isParsed:()=>P.applyArabicShaping!=null&&P.processBidirectionalText!=null&&P.processStyledBidirectionalText!=null,getPluginURL:()=>r};class L{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,a){for(const h of n)if(!rl(h.charCodeAt(0),a))return!1;return!0}(e,P.isLoaded())}}class N{constructor(e,n){this.property=e,this.value=n,this.expression=function(a,h){if(Ll(a))return new Nu(a,h);if(Ka(a)){const m=Gs(a,h);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=a;return typeof a=="string"&&h.type==="color"&&(m=dr.parse(a)),{kind:"constant",evaluate:()=>m}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,a){return this.property.possiblyEvaluate(this,e,n,a)}}class F{constructor(e){this.property=e,this.value=new N(e,void 0)}transitioned(e,n){return new ie(this.property,this.value,n,kt({},e.transition,this.transition),e.now)}untransitioned(){return new ie(this.property,this.value,null,{},0)}}class W{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return pn(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new F(this._values[e].property)),this._values[e].value=new N(this._values[e].property,n===null?void 0:pn(n))}getTransition(e){return pn(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new F(this._values[e].property)),this._values[e].transition=pn(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(e[n]=a);const h=this.getTransition(n);h!==void 0&&(e[`${n}-transition`]=h)}return e}transitioned(e,n){const a=new ae(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(e,n._values[h]);return a}untransitioned(){const e=new ae(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class ie{constructor(e,n,a,h,m){const y=h.delay||0,w=h.duration||0;m=m||0,this.property=e,this.value=n,this.begin=m+y,this.end=this.begin+w,e.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(e,n,a){const h=e.now||0,m=this.value.possiblyEvaluate(e,n,a),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(e,n,a);{const w=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,n,a),m,ln(w))}}return m}}class ae{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,a){const h=new he(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,n,a);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ue{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return pn(this._values[e].value)}setValue(e,n){this._values[e]=new N(this._values[e].property,n===null?void 0:pn(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(e[n]=a)}return e}possiblyEvaluate(e,n,a){const h=new he(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,n,a);return h}}class le{constructor(e,n,a){this.property=e,this.value=n,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,a,h){return this.property.evaluate(this.value,this.parameters,e,n,a,h)}}class he{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class X{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,a){const h=Au[this.specification.type];return h?h(e,n,a):e}}class se{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,a,h){return new le(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},a,h)}:e.expression,n)}interpolate(e,n,a){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new le(this,{kind:"constant",value:void 0},e.parameters);const h=Au[this.specification.type];return h?new le(this,{kind:"constant",value:h(e.value.value,n.value.value,a)},e.parameters):e}evaluate(e,n,a,h,m,y){return e.kind==="constant"?e.value:e.evaluate(n,a,h,m,y)}}class ge{constructor(e){this.specification=e}possiblyEvaluate(e,n,a,h){return!!e.expression.evaluate(n,null,{},a,h)}interpolate(){return!1}}class ve{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new L(0,{});for(const a in e){const h=e[a];h.specification.overridable&&this.overridableProperties.push(a);const m=this.defaultPropertyValues[a]=new N(h,void 0),y=this.defaultTransitionablePropertyValues[a]=new F(h);this.defaultTransitioningPropertyValues[a]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=m.possiblyEvaluate(n)}}}function Pe(t,e){return 256*(t=Et(Math.floor(t),0,255))+Et(Math.floor(e),0,255)}Vt(se,"DataDrivenProperty"),Vt(X,"DataConstantProperty"),Vt(ge,"ColorRampProperty");const Re={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ie{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ne{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Fe(t,e=1){let n=0,a=0;return{members:t.map(h=>{const m=Re[h.type].BYTES_PER_ELEMENT,y=n=He(n,Math.max(e,m)),w=h.components||1;return a=Math.max(a,m),n+=m*w,{name:h.name,type:h.type,components:w,offset:y}}),size:He(n,Math.max(a,e)),alignment:e}}function He(t,e){return Math.ceil(t/e)*e}class vt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const h=2*e;return this.int16[h+0]=n,this.int16[h+1]=a,e}}vt.prototype.bytesPerElement=4,Vt(vt,"StructArrayLayout2i4");class qe extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,a)}emplace(e,n,a,h){const m=3*e;return this.int16[m+0]=n,this.int16[m+1]=a,this.int16[m+2]=h,e}}qe.prototype.bytesPerElement=6,Vt(qe,"StructArrayLayout3i6");class nt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,a,h)}emplace(e,n,a,h,m){const y=4*e;return this.int16[y+0]=n,this.int16[y+1]=a,this.int16[y+2]=h,this.int16[y+3]=m,e}}nt.prototype.bytesPerElement=8,Vt(nt,"StructArrayLayout4i8");class Xe extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,a,h,m,y,w)}emplace(e,n,a,h,m,y,w,E){const C=6*e,R=12*e,z=3*e;return this.int16[C+0]=n,this.int16[C+1]=a,this.uint8[R+4]=h,this.uint8[R+5]=m,this.uint8[R+6]=y,this.uint8[R+7]=w,this.float32[z+2]=E,e}}Xe.prototype.bytesPerElement=12,Vt(Xe,"StructArrayLayout2i4ub1f12");class yt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,a,h)}emplace(e,n,a,h,m){const y=4*e;return this.float32[y+0]=n,this.float32[y+1]=a,this.float32[y+2]=h,this.float32[y+3]=m,e}}yt.prototype.bytesPerElement=16,Vt(yt,"StructArrayLayout4f16");class Ze extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,a,h,m)}emplace(e,n,a,h,m,y){const w=6*e,E=3*e;return this.uint16[w+0]=n,this.uint16[w+1]=a,this.uint16[w+2]=h,this.uint16[w+3]=m,this.float32[E+2]=y,e}}Ze.prototype.bytesPerElement=12,Vt(Ze,"StructArrayLayout4ui1f12");class rt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,a,h)}emplace(e,n,a,h,m){const y=4*e;return this.uint16[y+0]=n,this.uint16[y+1]=a,this.uint16[y+2]=h,this.uint16[y+3]=m,e}}rt.prototype.bytesPerElement=8,Vt(rt,"StructArrayLayout4ui8");class mt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,n,a,h,m,y)}emplace(e,n,a,h,m,y,w){const E=6*e;return this.int16[E+0]=n,this.int16[E+1]=a,this.int16[E+2]=h,this.int16[E+3]=m,this.int16[E+4]=y,this.int16[E+5]=w,e}}mt.prototype.bytesPerElement=12,Vt(mt,"StructArrayLayout6i12");class ht extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m,y,w,E,C,R,z,B){const $=this.length;return this.resize($+1),this.emplace($,e,n,a,h,m,y,w,E,C,R,z,B)}emplace(e,n,a,h,m,y,w,E,C,R,z,B,$){const G=12*e;return this.int16[G+0]=n,this.int16[G+1]=a,this.int16[G+2]=h,this.int16[G+3]=m,this.uint16[G+4]=y,this.uint16[G+5]=w,this.uint16[G+6]=E,this.uint16[G+7]=C,this.int16[G+8]=R,this.int16[G+9]=z,this.int16[G+10]=B,this.int16[G+11]=$,e}}ht.prototype.bytesPerElement=24,Vt(ht,"StructArrayLayout4i4ui4i24");class wt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,n,a,h,m,y)}emplace(e,n,a,h,m,y,w){const E=10*e,C=5*e;return this.int16[E+0]=n,this.int16[E+1]=a,this.int16[E+2]=h,this.float32[C+2]=m,this.float32[C+3]=y,this.float32[C+4]=w,e}}wt.prototype.bytesPerElement=20,Vt(wt,"StructArrayLayout3i3f20");class Jt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}Jt.prototype.bytesPerElement=4,Vt(Jt,"StructArrayLayout1ul4");class dn extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m,y,w,E,C,R,z,B,$){const G=this.length;return this.resize(G+1),this.emplace(G,e,n,a,h,m,y,w,E,C,R,z,B,$)}emplace(e,n,a,h,m,y,w,E,C,R,z,B,$,G){const K=20*e,oe=10*e;return this.int16[K+0]=n,this.int16[K+1]=a,this.int16[K+2]=h,this.int16[K+3]=m,this.int16[K+4]=y,this.float32[oe+3]=w,this.float32[oe+4]=E,this.float32[oe+5]=C,this.float32[oe+6]=R,this.int16[K+14]=z,this.uint32[oe+8]=B,this.uint16[K+18]=$,this.uint16[K+19]=G,e}}dn.prototype.bytesPerElement=40,Vt(dn,"StructArrayLayout5i4f1i1ul2ui40");class Zt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,a,h,m,y,w)}emplace(e,n,a,h,m,y,w,E){const C=8*e;return this.int16[C+0]=n,this.int16[C+1]=a,this.int16[C+2]=h,this.int16[C+4]=m,this.int16[C+5]=y,this.int16[C+6]=w,this.int16[C+7]=E,e}}Zt.prototype.bytesPerElement=16,Vt(Zt,"StructArrayLayout3i2i2i16");class on extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,a,h,m)}emplace(e,n,a,h,m,y){const w=4*e,E=8*e;return this.float32[w+0]=n,this.float32[w+1]=a,this.float32[w+2]=h,this.int16[E+6]=m,this.int16[E+7]=y,e}}on.prototype.bytesPerElement=16,Vt(on,"StructArrayLayout2f1f2i16");class Pn extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,a,h)}emplace(e,n,a,h,m){const y=12*e,w=3*e;return this.uint8[y+0]=n,this.uint8[y+1]=a,this.float32[w+1]=h,this.float32[w+2]=m,e}}Pn.prototype.bytesPerElement=12,Vt(Pn,"StructArrayLayout2ub2f12");class Dn extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,a)}emplace(e,n,a,h){const m=3*e;return this.float32[m+0]=n,this.float32[m+1]=a,this.float32[m+2]=h,e}}Dn.prototype.bytesPerElement=12,Vt(Dn,"StructArrayLayout3f12");class Qt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,a)}emplace(e,n,a,h){const m=3*e;return this.uint16[m+0]=n,this.uint16[m+1]=a,this.uint16[m+2]=h,e}}Qt.prototype.bytesPerElement=6,Vt(Qt,"StructArrayLayout3ui6");class Un extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m,y,w,E,C,R,z,B,$,G,K,oe,fe,Te,pe,be,ke){const Me=this.length;return this.resize(Me+1),this.emplace(Me,e,n,a,h,m,y,w,E,C,R,z,B,$,G,K,oe,fe,Te,pe,be,ke)}emplace(e,n,a,h,m,y,w,E,C,R,z,B,$,G,K,oe,fe,Te,pe,be,ke,Me){const Ke=30*e,We=15*e,st=60*e;return this.int16[Ke+0]=n,this.int16[Ke+1]=a,this.int16[Ke+2]=h,this.float32[We+2]=m,this.float32[We+3]=y,this.uint16[Ke+8]=w,this.uint16[Ke+9]=E,this.uint32[We+5]=C,this.uint32[We+6]=R,this.uint32[We+7]=z,this.uint16[Ke+16]=B,this.uint16[Ke+17]=$,this.uint16[Ke+18]=G,this.float32[We+10]=K,this.float32[We+11]=oe,this.uint8[st+48]=fe,this.uint8[st+49]=Te,this.uint8[st+50]=pe,this.uint32[We+13]=be,this.int16[Ke+28]=ke,this.uint8[st+58]=Me,e}}Un.prototype.bytesPerElement=60,Vt(Un,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class nr extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m,y,w,E,C,R,z,B,$,G,K,oe,fe,Te,pe,be,ke,Me,Ke,We,st,bt,Qe,ut,ct,_t){const At=this.length;return this.resize(At+1),this.emplace(At,e,n,a,h,m,y,w,E,C,R,z,B,$,G,K,oe,fe,Te,pe,be,ke,Me,Ke,We,st,bt,Qe,ut,ct,_t)}emplace(e,n,a,h,m,y,w,E,C,R,z,B,$,G,K,oe,fe,Te,pe,be,ke,Me,Ke,We,st,bt,Qe,ut,ct,_t,At){const it=38*e,jt=19*e;return this.int16[it+0]=n,this.int16[it+1]=a,this.int16[it+2]=h,this.float32[jt+2]=m,this.float32[jt+3]=y,this.int16[it+8]=w,this.int16[it+9]=E,this.int16[it+10]=C,this.int16[it+11]=R,this.int16[it+12]=z,this.int16[it+13]=B,this.uint16[it+14]=$,this.uint16[it+15]=G,this.uint16[it+16]=K,this.uint16[it+17]=oe,this.uint16[it+18]=fe,this.uint16[it+19]=Te,this.uint16[it+20]=pe,this.uint16[it+21]=be,this.uint16[it+22]=ke,this.uint16[it+23]=Me,this.uint16[it+24]=Ke,this.uint16[it+25]=We,this.uint16[it+26]=st,this.uint16[it+27]=bt,this.uint16[it+28]=Qe,this.uint32[jt+15]=ut,this.float32[jt+16]=ct,this.float32[jt+17]=_t,this.float32[jt+18]=At,e}}nr.prototype.bytesPerElement=76,Vt(nr,"StructArrayLayout3i2f6i15ui1ul3f76");class rr extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}rr.prototype.bytesPerElement=4,Vt(rr,"StructArrayLayout1f4");class Jn extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,a,h,m)}emplace(e,n,a,h,m,y){const w=5*e;return this.float32[w+0]=n,this.float32[w+1]=a,this.float32[w+2]=h,this.float32[w+3]=m,this.float32[w+4]=y,e}}Jn.prototype.bytesPerElement=20,Vt(Jn,"StructArrayLayout5f20");class bi extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,a,h)}emplace(e,n,a,h,m){const y=6*e;return this.uint32[3*e+0]=n,this.uint16[y+2]=a,this.uint16[y+3]=h,this.uint16[y+4]=m,e}}bi.prototype.bytesPerElement=12,Vt(bi,"StructArrayLayout1ul3ui12");class jr extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const h=2*e;return this.uint16[h+0]=n,this.uint16[h+1]=a,e}}jr.prototype.bytesPerElement=4,Vt(jr,"StructArrayLayout2ui4");class Co extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}Co.prototype.bytesPerElement=2,Vt(Co,"StructArrayLayout1ui2");class $o extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const h=2*e;return this.float32[h+0]=n,this.float32[h+1]=a,e}}$o.prototype.bytesPerElement=8,Vt($o,"StructArrayLayout2f8");class En extends Ie{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}En.prototype.size=40;class ur extends dn{get(e){return new En(this,e)}}Vt(ur,"CollisionBoxArray");class Yn extends Ie{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Yn.prototype.size=60;class Vr extends Un{get(e){return new Yn(this,e)}}Vt(Vr,"PlacedSymbolArray");class Ti extends Ie{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ti.prototype.size=76;class fr extends nr{get(e){return new Ti(this,e)}}Vt(fr,"SymbolInstanceArray");class ri extends rr{getoffsetX(e){return this.float32[1*e+0]}}Vt(ri,"GlyphOffsetArray");class Mr extends vt{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Vt(Mr,"SymbolLineVertexArray");class Rr extends Ie{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Rr.prototype.size=12;class Zr extends bi{get(e){return new Rr(this,e)}}Vt(Zr,"FeatureIndexArray");class Go extends jr{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Vt(Go,"FillExtrusionCentroidArray");const qo=Fe([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),us=Fe([{name:"a_dash",components:4,type:"Uint16"}]);var Nc={exports:{}},ii={exports:{}};ii.exports=function(t,e){var n,a,h,m,y,w,E,C;for(a=t.length-(n=3&t.length),h=e,y=3432918353,w=461845907,C=0;C<a;)E=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,h=27492+(65535&(m=5*(65535&(h=(h^=E=(65535&(E=(E=(65535&E)*y+(((E>>>16)*y&65535)<<16)&4294967295)<<15|E>>>17))*w+(((E>>>16)*w&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(E=0,n){case 3:E^=(255&t.charCodeAt(C+2))<<16;case 2:E^=(255&t.charCodeAt(C+1))<<8;case 1:h^=E=(65535&(E=(E=(65535&(E^=255&t.charCodeAt(C)))*y+(((E>>>16)*y&65535)<<16)&4294967295)<<15|E>>>17))*w+(((E>>>16)*w&65535)<<16)&4294967295}return h^=t.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var qu=ii.exports,Zd={exports:{}};Zd.exports=function(t,e){for(var n,a=t.length,h=e^a,m=0;a>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(m)|(255&t.charCodeAt(++m))<<8|(255&t.charCodeAt(++m))<<16|(255&t.charCodeAt(++m))<<24))+((1540483477*(n>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),a-=4,++m;switch(a){case 3:h^=(255&t.charCodeAt(m+2))<<16;case 2:h^=(255&t.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&t.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Hd=qu,Ta=Zd.exports;Nc.exports=Hd,Nc.exports.murmur3=Hd,Nc.exports.murmur2=Ta;var Wo=me(Nc.exports);class Wl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,a,h){this.ids.push(Xd(e)),this.positions.push(n,a,h)}getPositions(e){const n=Xd(e);let a=0,h=this.ids.length-1;for(;a<h;){const y=a+h>>1;this.ids[y]>=n?h=y:a=y+1}const m=[];for(;this.ids[a]===n;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(e,n){const a=new Float64Array(e.ids),h=new Uint32Array(e.positions);return Gh(a,h,0,a.length-1),n&&n.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(e){const n=new Wl;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function Xd(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Wo(String(t))}function Gh(t,e,n,a){for(;n<a;){const h=t[n+a>>1];let m=n-1,y=a+1;for(;;){do m++;while(t[m]<h);do y--;while(t[y]>h);if(m>=y)break;qh(t,m,y),qh(e,3*m,3*y),qh(e,3*m+1,3*y+1),qh(e,3*m+2,3*y+2)}y-n<a-y?(Gh(t,e,n,y),n=y+1):(Gh(t,e,y+1,a),a=y)}}function qh(t,e,n){const a=t[e];t[e]=t[n],t[n]=a}Vt(Wl,"FeaturePositionMap");class Ea{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}}class Wh extends Ea{constructor(e){super(e),this.current=0}set(e,n,a){this.fetchUniformLocation(e,n)&&this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class up extends Ea{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,a){this.fetchUniformLocation(e,n)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3])))}}class cp extends Ea{constructor(e){super(e),this.current=dr.transparent}set(e,n,a){this.fetchUniformLocation(e,n)&&(a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a)))}}const Xm=new Float32Array(16),Km=new Float32Array(9),Ym=new Float32Array(4);function Wu(t){return[Pe(255*t.r,255*t.g),Pe(255*t.b,255*t.a)]}class jc{constructor(e,n,a){this.value=e,this.uniformNames=n.map(h=>`u_${h}`),this.type=a}setUniform(e,n,a,h,m){n.set(e,m,h.constantOr(this.value))}getBinding(e,n){return this.type==="color"?new cp(e):new Wh(e)}}class il{constructor(e,n){this.uniformNames=n.map(a=>`u_${a}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,n,a,h,m){const y=m==="u_pattern"||m==="u_dash"?this.pattern:m==="u_pixel_ratio"?this.pixelRatio:null;y&&n.set(e,m,y)}getBinding(e,n){return n==="u_pattern"||n==="u_dash"?new up(e):new Wh(e)}}class As{constructor(e,n,a,h){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=n.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,n,a,h,m,y){const w=this.paintVertexArray.length,E=this.expression.evaluate(new L(0),n,{},m,h,y);this.paintVertexArray.resize(e),this._setPaintValue(w,e,E)}updatePaintArray(e,n,a,h,m){const y=this.expression.evaluate({zoom:0},a,h,void 0,m);this._setPaintValue(e,n,y)}_setPaintValue(e,n,a){if(this.type==="color"){const h=Wu(a);for(let m=e;m<n;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=e;h<n;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ms{constructor(e,n,a,h,m,y){this.expression=e,this.uniformNames=n.map(w=>`u_${w}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=n.map(w=>({name:`a_${w}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,n,a,h,m,y){const w=this.expression.evaluate(new L(this.zoom),n,{},m,h,y),E=this.expression.evaluate(new L(this.zoom+1),n,{},m,h,y),C=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(C,e,w,E)}updatePaintArray(e,n,a,h,m){const y=this.expression.evaluate({zoom:this.zoom},a,h,void 0,m),w=this.expression.evaluate({zoom:this.zoom+1},a,h,void 0,m);this._setPaintValue(e,n,y,w)}_setPaintValue(e,n,a,h){if(this.type==="color"){const m=Wu(a),y=Wu(h);for(let w=e;w<n;w++)this.paintVertexArray.emplace(w,m[0],m[1],y[0],y[1])}else{for(let m=e;m<n;m++)this.paintVertexArray.emplace(m,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,a,h,m){const y=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,w=Et(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);n.set(e,m,w)}getBinding(e,n){return new Wh(e)}}class Sa{constructor(e,n,a,h,m){this.expression=e,this.layerId=m,this.paintVertexAttributes=(a==="array"?us:qo).members;for(let y=0;y<n.length;++y);this.paintVertexArray=new h}populatePaintArray(e,n,a){const h=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(h,e,n.patterns&&n.patterns[this.layerId],a)}updatePaintArray(e,n,a,h,m,y){this._setPaintValues(e,n,a.patterns&&a.patterns[this.layerId],y)}_setPaintValues(e,n,a,h){if(!h||!a)return;const m=h[a];if(!m)return;const{tl:y,br:w,pixelRatio:E}=m;for(let C=e;C<n;C++)this.paintVertexArray.emplace(C,y[0],y[1],w[0],w[1],E)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ol{constructor(e,n,a=()=>!0){this.binders={},this._buffers=[];const h=[];for(const m in e.paint._values){if(!a(m))continue;const y=e.paint.get(m);if(!(y instanceof le&&Xa(y.property.specification)))continue;const w=Qm(m,e.type),E=y.value,C=y.property.specification.type,R=!!y.property.useIntegerZoom,z=m==="line-dasharray"||m.endsWith("pattern"),B=m==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(E.kind!=="constant"||B)if(E.kind==="source"||B||z){const $=dp(m,C,"source");this.binders[m]=z?new Sa(E,w,C,$,e.id):new As(E,w,C,$),h.push(`/a_${m}`)}else{const $=dp(m,C,"composite");this.binders[m]=new Ms(E,w,C,R,n,$),h.push(`/z_${m}`)}else this.binders[m]=z?new il(E.value,w):new jc(E.value,w,C),h.push(`/u_${m}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof As||n instanceof Ms?n.maxValue:0}populatePaintArrays(e,n,a,h,m,y){for(const w in this.binders){const E=this.binders[w];(E instanceof As||E instanceof Ms||E instanceof Sa)&&E.populatePaintArray(e,n,a,h,m,y)}}setConstantPatternPositions(e){for(const n in this.binders){const a=this.binders[n];a instanceof il&&a.setConstantPatternPositions(e)}}updatePaintArrays(e,n,a,h,m,y){let w=!1;for(const E in e){const C=n.getPositions(E);for(const R of C){const z=a.feature(R.index);for(const B in this.binders){const $=this.binders[B];if(($ instanceof As||$ instanceof Ms||$ instanceof Sa)&&$.expression.isStateDependent===!0){const G=h.paint.get(B);$.expression=G.value,$.updatePaintArray(R.start,R.end,z,e[E],m,y),w=!0}}}}return w}defines(){const e=[];for(const n in this.binders){const a=this.binders[n];(a instanceof jc||a instanceof il)&&e.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof As||a instanceof Ms||a instanceof Sa)for(let h=0;h<a.paintVertexAttributes.length;h++)e.push(a.paintVertexAttributes[h].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof jc||a instanceof il||a instanceof Ms)for(const h of a.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof jc||h instanceof il||h instanceof Ms)for(const m of h.uniformNames)n.push({name:m,property:a,binding:h.getBinding(e,m)})}return n}setUniforms(e,n,a,h,m){for(const{name:y,property:w,binding:E}of a)this.binders[w].setUniform(e,E,m,h.get(w),y)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const n=this.binders[e];(n instanceof As||n instanceof Ms||n instanceof Sa)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const n in this.binders){const a=this.binders[n];(a instanceof As||a instanceof Ms||a instanceof Sa)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof As||n instanceof Ms||n instanceof Sa)&&n.destroy()}}}class Zl{constructor(e,n,a=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new ol(h,n,a);this.needsUpload=!1,this._featureMap=new Wl,this._bufferOffset=0}populatePaintArrays(e,n,a,h,m,y,w){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(e,n,h,m,y,w);n.id!==void 0&&this._featureMap.add(n.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,a,h,m){for(const y of a)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,n,y,h,m)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Jm={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Qm(t,e){return Jm[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const hp={"line-pattern":{source:Ze,composite:Ze},"fill-pattern":{source:Ze,composite:Ze},"fill-extrusion-pattern":{source:Ze,composite:Ze},"line-dasharray":{source:rt,composite:rt}},eg={color:{source:$o,composite:yt},number:{source:rr,composite:$o}};function dp(t,e,n){const a=hp[t];return a&&a[n]||eg[e][n]}Vt(jc,"ConstantBinder"),Vt(il,"PatternConstantBinder"),Vt(As,"SourceExpressionBinder"),Vt(Sa,"PatternCompositeBinder"),Vt(Ms,"CompositeExpressionBinder"),Vt(ol,"ProgramConfiguration",{omit:["_buffers"]}),Vt(Zl,"ProgramConfigurationSet");const fp="-transition";class Ks extends oo{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new ue(n.layout)),n.paint)){this._transitionablePaint=new W(n.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new he(n.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,a={}){n!=null&&this._validate(el,`layers.${this.id}.layout.${e}`,e,n,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return Bn(e,fp)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,a={}){if(n!=null&&this._validate(fo,`layers.${this.id}.paint.${e}`,e,n,a))return!1;if(Bn(e,fp))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const h=this._transitionablePaint._values[e],m=h.value.isDataDriven(),y=h.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const w=this._transitionablePaint._values[e].value,E=w.isDataDriven(),C=Bn(e,"pattern")||e==="line-dasharray";return E||m||C||this._handleOverridablePaintPropertyUpdate(e,y,w)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Fn(e,(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}_validate(e,n,a,h,m={}){return(!m||m.validate!==!1)&&Ki(this,e.call(Li,{key:n,layerType:this.type,objectKey:a,value:h,styleSpec:ot,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof le&&Xa(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Nl(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const tg=Fe([{name:"a_pos",components:2,type:"Int16"}],4),e_=Fe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ei{constructor(e=[]){this.segments=e}prepareSegment(e,n,a,h){let m=this.segments[this.segments.length-1];return e>ei.MAX_VERTEX_ARRAY_LENGTH&&Nn(`Max vertices per segment is ${ei.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>ei.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:n.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,a,h){return new ei([{vertexOffset:e,primitiveOffset:n,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}ei.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Vt(ei,"SegmentVector");var nn=8192;class sl{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof sn?new sn(e.lng,e.lat):sn.convert(e),this}setSouthWest(e){return this._sw=e instanceof sn?new sn(e.lng,e.lat):sn.convert(e),this}extend(e){const n=this._sw,a=this._ne;let h,m;if(e instanceof sn)h=e,m=e;else{if(!(e instanceof sl))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(sl.convert(e)):this.extend(sn.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(sn.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return n||a?(n.lng=Math.min(h.lng,n.lng),n.lat=Math.min(h.lat,n.lat),a.lng=Math.max(m.lng,a.lng),a.lat=Math.max(m.lat,a.lat)):(this._sw=new sn(h.lng,h.lat),this._ne=new sn(m.lng,m.lat)),this}getCenter(){return new sn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new sn(this.getWest(),this.getNorth())}getSouthEast(){return new sn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:a}=sn.convert(e);let h=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&h}static convert(e){return!e||e instanceof sl?e:new sl(e)}}var Zh=1e-6,Yi=typeof Float32Array<"u"?Float32Array:Array;function ng(){var t=new Yi(9);return Yi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function rg(t,e,n){var a=e[0],h=e[1],m=e[2],y=e[3],w=e[4],E=e[5],C=e[6],R=e[7],z=e[8],B=n[0],$=n[1],G=n[2],K=n[3],oe=n[4],fe=n[5],Te=n[6],pe=n[7],be=n[8];return t[0]=B*a+$*y+G*C,t[1]=B*h+$*w+G*R,t[2]=B*m+$*E+G*z,t[3]=K*a+oe*y+fe*C,t[4]=K*h+oe*w+fe*R,t[5]=K*m+oe*E+fe*z,t[6]=Te*a+pe*y+be*C,t[7]=Te*h+pe*w+be*R,t[8]=Te*m+pe*E+be*z,t}function Ys(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cs(t,e){var n=e[0],a=e[1],h=e[2],m=e[3],y=e[4],w=e[5],E=e[6],C=e[7],R=e[8],z=e[9],B=e[10],$=e[11],G=e[12],K=e[13],oe=e[14],fe=e[15],Te=n*w-a*y,pe=n*E-h*y,be=n*C-m*y,ke=a*E-h*w,Me=a*C-m*w,Ke=h*C-m*E,We=R*K-z*G,st=R*oe-B*G,bt=R*fe-$*G,Qe=z*oe-B*K,ut=z*fe-$*K,ct=B*fe-$*oe,_t=Te*ct-pe*ut+be*Qe+ke*bt-Me*st+Ke*We;return _t?(t[0]=(w*ct-E*ut+C*Qe)*(_t=1/_t),t[1]=(h*ut-a*ct-m*Qe)*_t,t[2]=(K*Ke-oe*Me+fe*ke)*_t,t[3]=(B*Me-z*Ke-$*ke)*_t,t[4]=(E*bt-y*ct-C*st)*_t,t[5]=(n*ct-h*bt+m*st)*_t,t[6]=(oe*be-G*Ke-fe*pe)*_t,t[7]=(R*Ke-B*be+$*pe)*_t,t[8]=(y*ut-w*bt+C*We)*_t,t[9]=(a*bt-n*ut-m*We)*_t,t[10]=(G*Me-K*be+fe*Te)*_t,t[11]=(z*be-R*Me-$*Te)*_t,t[12]=(w*st-y*Qe-E*We)*_t,t[13]=(n*Qe-a*st+h*We)*_t,t[14]=(K*pe-G*ke-oe*Te)*_t,t[15]=(R*ke-z*pe+B*Te)*_t,t):null}function al(t,e,n){var a=e[0],h=e[1],m=e[2],y=e[3],w=e[4],E=e[5],C=e[6],R=e[7],z=e[8],B=e[9],$=e[10],G=e[11],K=e[12],oe=e[13],fe=e[14],Te=e[15],pe=n[0],be=n[1],ke=n[2],Me=n[3];return t[0]=pe*a+be*w+ke*z+Me*K,t[1]=pe*h+be*E+ke*B+Me*oe,t[2]=pe*m+be*C+ke*$+Me*fe,t[3]=pe*y+be*R+ke*G+Me*Te,t[4]=(pe=n[4])*a+(be=n[5])*w+(ke=n[6])*z+(Me=n[7])*K,t[5]=pe*h+be*E+ke*B+Me*oe,t[6]=pe*m+be*C+ke*$+Me*fe,t[7]=pe*y+be*R+ke*G+Me*Te,t[8]=(pe=n[8])*a+(be=n[9])*w+(ke=n[10])*z+(Me=n[11])*K,t[9]=pe*h+be*E+ke*B+Me*oe,t[10]=pe*m+be*C+ke*$+Me*fe,t[11]=pe*y+be*R+ke*G+Me*Te,t[12]=(pe=n[12])*a+(be=n[13])*w+(ke=n[14])*z+(Me=n[15])*K,t[13]=pe*h+be*E+ke*B+Me*oe,t[14]=pe*m+be*C+ke*$+Me*fe,t[15]=pe*y+be*R+ke*G+Me*Te,t}function Hl(t,e,n){var a,h,m,y,w,E,C,R,z,B,$,G,K=n[0],oe=n[1],fe=n[2];return e===t?(t[12]=e[0]*K+e[4]*oe+e[8]*fe+e[12],t[13]=e[1]*K+e[5]*oe+e[9]*fe+e[13],t[14]=e[2]*K+e[6]*oe+e[10]*fe+e[14],t[15]=e[3]*K+e[7]*oe+e[11]*fe+e[15]):(h=e[1],m=e[2],y=e[3],w=e[4],E=e[5],C=e[6],R=e[7],z=e[8],B=e[9],$=e[10],G=e[11],t[0]=a=e[0],t[1]=h,t[2]=m,t[3]=y,t[4]=w,t[5]=E,t[6]=C,t[7]=R,t[8]=z,t[9]=B,t[10]=$,t[11]=G,t[12]=a*K+w*oe+z*fe+e[12],t[13]=h*K+E*oe+B*fe+e[13],t[14]=m*K+C*oe+$*fe+e[14],t[15]=y*K+R*oe+G*fe+e[15]),t}function Xl(t,e,n){var a=n[0],h=n[1],m=n[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*h,t[5]=e[5]*h,t[6]=e[6]*h,t[7]=e[7]*h,t[8]=e[8]*m,t[9]=e[9]*m,t[10]=e[10]*m,t[11]=e[11]*m,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Kd(t,e,n){var a=Math.sin(n),h=Math.cos(n),m=e[4],y=e[5],w=e[6],E=e[7],C=e[8],R=e[9],z=e[10],B=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=m*h+C*a,t[5]=y*h+R*a,t[6]=w*h+z*a,t[7]=E*h+B*a,t[8]=C*h-m*a,t[9]=R*h-y*a,t[10]=z*h-w*a,t[11]=B*h-E*a,t}function Hh(t,e,n){var a=Math.sin(n),h=Math.cos(n),m=e[0],y=e[1],w=e[2],E=e[3],C=e[8],R=e[9],z=e[10],B=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=m*h-C*a,t[1]=y*h-R*a,t[2]=w*h-z*a,t[3]=E*h-B*a,t[8]=m*a+C*h,t[9]=y*a+R*h,t[10]=w*a+z*h,t[11]=E*a+B*h,t}function Yd(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zu(t,e,n){var a,h,m,y=n[0],w=n[1],E=n[2],C=Math.hypot(y,w,E);return C<Zh?null:(y*=C=1/C,w*=C,E*=C,a=Math.sin(e),h=Math.cos(e),t[0]=y*y*(m=1-h)+h,t[1]=w*y*m+E*a,t[2]=E*y*m-w*a,t[3]=0,t[4]=y*w*m-E*a,t[5]=w*w*m+h,t[6]=E*w*m+y*a,t[7]=0,t[8]=y*E*m+w*a,t[9]=w*E*m-y*a,t[10]=E*E*m+h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var pp=al;function Xh(){var t=new Yi(3);return Yi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ig(t){var e=new Yi(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Vc(t){return Math.hypot(t[0],t[1],t[2])}function Hu(t,e,n){var a=new Yi(3);return a[0]=t,a[1]=e,a[2]=n,a}function Ca(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Jd(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function mp(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Kh(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function ji(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Lr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Uc(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t}function Ji(t,e){var n=e[0],a=e[1],h=e[2],m=n*n+a*a+h*h;return m>0&&(m=1/Math.sqrt(m)),t[0]=e[0]*m,t[1]=e[1]*m,t[2]=e[2]*m,t}function hs(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Qd(t,e,n){var a=e[0],h=e[1],m=e[2],y=n[0],w=n[1],E=n[2];return t[0]=h*E-m*w,t[1]=m*y-a*E,t[2]=a*w-h*y,t}function Ur(t,e,n){var a=e[0],h=e[1],m=e[2],y=n[3]*a+n[7]*h+n[11]*m+n[15];return t[0]=(n[0]*a+n[4]*h+n[8]*m+n[12])/(y=y||1),t[1]=(n[1]*a+n[5]*h+n[9]*m+n[13])/y,t[2]=(n[2]*a+n[6]*h+n[10]*m+n[14])/y,t}function ef(t,e,n){var a=n[0],h=n[1],m=n[2],y=e[0],w=e[1],E=e[2],C=h*E-m*w,R=m*y-a*E,z=a*w-h*y,B=h*z-m*R,$=m*C-a*z,G=a*R-h*C,K=2*n[3];return R*=K,z*=K,$*=2,G*=2,t[0]=y+(C*=K)+(B*=2),t[1]=w+R+$,t[2]=E+z+G,t}var $c,ds=Jd,og=mp,sg=Vc;function tf(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function nf(t,e){var n=e[0],a=e[1],h=e[2],m=e[3],y=n*n+a*a+h*h+m*m;return y>0&&(y=1/Math.sqrt(y)),t[0]=n*y,t[1]=a*y,t[2]=h*y,t[3]=m*y,t}function Kl(t,e,n){var a=e[0],h=e[1],m=e[2],y=e[3];return t[0]=n[0]*a+n[4]*h+n[8]*m+n[12]*y,t[1]=n[1]*a+n[5]*h+n[9]*m+n[13]*y,t[2]=n[2]*a+n[6]*h+n[10]*m+n[14]*y,t[3]=n[3]*a+n[7]*h+n[11]*m+n[15]*y,t}function rf(){var t=new Yi(4);return Yi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Yh(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ag(t,e,n){n*=.5;var a=e[0],h=e[1],m=e[2],y=e[3],w=Math.sin(n),E=Math.cos(n);return t[0]=a*E+y*w,t[1]=h*E+m*w,t[2]=m*E-h*w,t[3]=y*E-a*w,t}function gp(t,e,n){n*=.5;var a=e[0],h=e[1],m=e[2],y=e[3],w=Math.sin(n),E=Math.cos(n);return t[0]=a*E-m*w,t[1]=h*E+y*w,t[2]=m*E+a*w,t[3]=y*E-h*w,t}Xh(),$c=new Yi(4),Yi!=Float32Array&&($c[0]=0,$c[1]=0,$c[2]=0,$c[3]=0);var yp=nf;Xh(),Hu(1,0,0),Hu(0,1,0),rf(),rf(),ng();const lg=Fe([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Jh}=lg,Aa=Fe([{name:"a_pos_3",components:3,type:"Int16"}]);var Qh=Fe([{name:"a_pos",type:"Int16",components:2}]);class of{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,a){const h=hs(n,this.dir);if(Math.abs(h)<1e-6)return!1;const m=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/h;return a[0]=this.pos[0]+this.dir[0]*m,a[1]=this.pos[1]+this.dir[1]*m,a[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(e,n,a){if(function($,G){var K=$[0],oe=$[1],fe=$[2],Te=G[0],pe=G[1],be=G[2];return Math.abs(K-Te)<=Zh*Math.max(1,Math.abs(K),Math.abs(Te))&&Math.abs(oe-pe)<=Zh*Math.max(1,Math.abs(oe),Math.abs(pe))&&Math.abs(fe-be)<=Zh*Math.max(1,Math.abs(fe),Math.abs(be))}(this.pos,e)||n===0)return a[0]=a[1]=a[2]=0,!1;const[h,m,y]=this.dir,w=this.pos[0]-e[0],E=this.pos[1]-e[1],C=this.pos[2]-e[2],R=h*h+m*m+y*y,z=2*(w*h+E*m+C*y),B=z*z-4*R*(w*w+E*E+C*C-n*n);if(B<0){const $=Math.max(-z/2,0),G=w+h*$,K=E+m*$,oe=C+y*$,fe=Math.hypot(G,K,oe);return a[0]=G*n/fe,a[1]=K*n/fe,a[2]=oe*n/fe,!1}{const $=(-z-Math.sqrt(B))/(2*R);if($<0){const G=Math.hypot(w,E,C);return a[0]=w*n/G,a[1]=E*n/G,a[2]=C*n/G,!1}return a[0]=w+h*$,a[1]=E+m*$,a[2]=C+y*$,!0}}}class ed{constructor(e,n,a,h,m){this.TL=e,this.TR=n,this.BR=a,this.BL=h,this.horizon=m}static fromInvProjectionMatrix(e,n,a){const h=[-1,1,1],m=[1,1,1],y=[1,-1,1],w=[-1,-1,1],E=Ur(h,h,e),C=Ur(m,m,e),R=Ur(y,y,e),z=Ur(w,w,e);return new ed(E,C,R,z,n/a)}}class sf{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,a,h){const m=Math.pow(2,a),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const C=Kl([],E,e),R=1/C[3]/n*m;return function(z,B,$){return z[0]=B[0]*$[0],z[1]=B[1]*$[1],z[2]=B[2]*$[2],z[3]=B[3]*$[3],z}(C,C,[R,R,h?1/C[3]:R,R])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const C=Ji([],Qd([],ds([],y[E[0]],y[E[1]]),ds([],y[E[2]],y[E[1]]))),R=-hs(C,y[E[1]]);return C.concat(R)});return new sf(y,w)}}class Qi{static fromPoints(e){const n=[1/0,1/0,1/0],a=[-1/0,-1/0,-1/0];for(const h of e)Kh(n,n,h),ji(a,a,h);return new Qi(n,a)}static applyTransform(e,n){const a=e.getCorners();for(let h=0;h<a.length;++h)Ur(a[h],a[h],n);return Qi.fromPoints(a)}constructor(e,n){this.min=e,this.max=n,this.center=Lr([],Ca([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],a=ig(this.min),h=ig(this.max);for(let m=0;m<n.length;m++)a[m]=n[m]?this.min[m]:this.center[m],h[m]=n[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new Qi(a,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let a=!0;for(let h=0;h<e.planes.length;h++){const m=e.planes[h];let y=0;for(let w=0;w<n.length;w++)y+=hs(m,n[w])+m[3]>=0;if(y===0)return 0;y!==n.length&&(a=!1)}if(a)return 2;for(let h=0;h<3;h++){let m=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let w=0;w<e.points.length;w++){const E=e.points[w][h]-this.min[h];m=Math.min(m,E),y=Math.max(y,E)}if(y<0||m>this.max[h]-this.min[h])return 0}return 1}}const Xu=5,eo=6,Ma=nn/Math.PI/2,t_=16383,ka=64,Ei=[ka,32,16],ks=-Ma,Kt=Ma,Gc=[new Qi([ks,ks,ks],[Kt,Kt,Kt]),new Qi([ks,ks,ks],[0,0,Kt]),new Qi([0,ks,ks],[Kt,0,Kt]),new Qi([ks,0,ks],[0,Kt,Kt]),new Qi([0,0,ks],[Kt,Kt,Kt])];function qc(t){return t*Ma/Yl}function _p(t,e,n,a=!0){const h=Lr([],t._camera.position,t.worldSize),m=[e,n,1,1];Kl(m,m,t.pixelMatrixInverse),tf(m,m,1/m[3]);const y=Ji([],ds([],m,h)),w=t.globeMatrix,E=[w[12],w[13],w[14]],C=ds([],E,h),R=Vc(C),z=Ji([],C),B=t.worldSize/(2*Math.PI),$=hs(z,y),G=Math.asin(B/R);if(G<Math.acos($)){if(!a)return null;const bt=[],Qe=[];Lr(bt,y,R/$),Ji(Qe,ds(Qe,bt,C)),Ji(y,Ca(y,C,Lr(y,Qe,Math.tan(G)*R)))}const K=[];new of(h,y).closestPointOnSphere(E,B,K);const oe=Ji([],Ri(w,0)),fe=Ji([],Ri(w,1)),Te=Ji([],Ri(w,2)),pe=hs(oe,K),be=hs(fe,K),ke=hs(Te,K),Me=zt(Math.asin(-be/B));let Ke=zt(Math.atan2(pe,ke));Ke=t.center.lng+function(bt,Qe){const ut=(Qe-bt+180)%360-180;return ut<-180?ut+360:ut}(t.center.lng,Ke);const We=vr(Ke),st=Et(Br(Me),0,1);return new Jl(We,st)}class n_{constructor(e,n,a){this.a=ds([],e,a),this.b=ds([],n,a),this.center=a;const h=Ji([],this.a),m=Ji([],this.b);this.angle=Math.acos(hs(h,m))}}function Ku(t,e){if(t.angle===0)return null;let n;return n=t.a[e]===0?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(a,h,m,y){const w=Math.sin(m);return a*(Math.sin((1-y)*m)/w)+h*(Math.sin(y*m)/w)}(t.a[e],t.b[e],t.angle,Et(n,0,1))+t.center[e]}function fs(t){if(t.z<=1)return Gc[t.z+2*t.y+t.x];const e=td(Wc(t));return Qi.fromPoints(e)}function ll(t,e,n){return Lr(t,t,1-n),Uc(t,t,e,n)}function vp(t,e){const n=Zc(e.zoom);if(n===0)return fs(t);const a=Wc(t),h=td(a),m=vr(a.getWest())*e.worldSize,y=vr(a.getEast())*e.worldSize,w=Br(a.getNorth())*e.worldSize,E=Br(a.getSouth())*e.worldSize,C=[m,w,0],R=[y,w,0],z=[m,E,0],B=[y,E,0],$=cs([],e.globeMatrix);return Ur(C,C,$),Ur(R,R,$),Ur(z,z,$),Ur(B,B,$),h[0]=ll(h[0],z,n),h[1]=ll(h[1],B,n),h[2]=ll(h[2],R,n),h[3]=ll(h[3],C,n),Qi.fromPoints(h)}function xp(t,e,n){for(const a of t)Ur(a,a,e),Lr(a,a,n)}function ug(t,e,n){const a=e/t.worldSize,h=t.globeMatrix;if(n.z<=1){const We=fs(n).getCorners();return xp(We,h,a),Qi.fromPoints(We)}const m=Wc(n),y=td(m);xp(y,h,a);const w=Number.MAX_VALUE,E=[-w,-w,-w],C=[w,w,w];if(m.contains(t.center)){for(const bt of y)Kh(C,C,bt),ji(E,E,bt);E[2]=0;const We=t.point,st=[We.x*a,We.y*a,0];return Kh(C,C,st),ji(E,E,st),new Qi(C,E)}const R=[h[12]*a,h[13]*a,h[14]*a],z=m.getCenter(),B=Et(t.center.lat,-85.051129,to),$=Et(z.lat,-85.051129,to),G=vr(t.center.lng),K=Br(B);let oe=G-vr(z.lng);const fe=K-Br($);oe>.5?oe-=1:oe<-.5&&(oe+=1);let Te=0;Math.abs(oe)>Math.abs(fe)?Te=oe>=0?1:3:(Te=fe>=0?0:2,Uc(R,R,[h[4]*a,h[5]*a,h[6]*a],-Math.sin(lt(fe>=0?m.getSouth():m.getNorth()))*Ma));const pe=y[Te],be=y[(Te+1)%4],ke=new n_(pe,be,R),Me=[Ku(ke,0)||pe[0],Ku(ke,1)||pe[1],Ku(ke,2)||pe[2]],Ke=Zc(t.zoom);if(Ke>0){const We=function({x:bt,y:Qe,z:ut},ct,_t,At,it){const jt=1/(1<<ut);let Yt=bt*jt,Gt=Yt+jt,An=Qe*jt,Mt=An+jt,rn=0;const Mn=(Yt+Gt)/2-At;return Mn>.5?rn=-1:Mn<-.5&&(rn=1),Yt=((Yt+rn)*ct-(At*=ct))*_t+At,Gt=((Gt+rn)*ct-At)*_t+At,An=(An*ct-(it*=ct))*_t+it,Mt=(Mt*ct-it)*_t+it,[[Yt,Mt,0],[Gt,Mt,0],[Gt,An,0],[Yt,An,0]]}(n,e,t._pixelsPerMercatorPixel,G,K);for(let bt=0;bt<y.length;bt++)ll(y[bt],We[bt],Ke);const st=Ca([],We[Te],We[(Te+1)%4]);Lr(st,st,.5),ll(Me,st,Ke)}for(const We of y)Kh(C,C,We),ji(E,E,We);return C[2]=Math.min(pe[2],be[2]),Kh(C,C,Me),ji(E,E,Me),new Qi(C,E)}function Wc({x:t,y:e,z:n}){const a=1/(1<<n),h=new sn(Vi(t*a),ir((e+1)*a)),m=new sn(Vi((t+1)*a),ir(e*a));return new sl(h,m)}function td(t){const e=lt(t.getNorth()),n=lt(t.getSouth()),a=Math.cos(e),h=Math.cos(n),m=Math.sin(e),y=Math.sin(n),w=t.getWest(),E=t.getEast();return[oi(h,y,w),oi(h,y,E),oi(a,m,E),oi(a,m,w)]}function oi(t,e,n,a=Ma){return n=lt(n),[t*Math.sin(n)*a,-e*a,t*Math.cos(n)*a]}function po(t,e,n){return oi(Math.cos(lt(t)),Math.sin(lt(t)),e,n)}function Ps(t,e,n,a){const h=1<<n.z,m=(t/nn+n.x)/h;return po(ir((e/nn+n.y)/h),Vi(m),a)}function nd({min:t,max:e}){return t_/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const wp=new Float64Array(16);function Ao(t){const e=nd(t),n=Yd(wp,[e,e,e]);return Hl(n,n,((a=[])[0]=-(h=t.min)[0],a[1]=-h[1],a[2]=-h[2],a));var a,h}function af(t){const e=(a=t.min,(n=wp)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=a[0],n[13]=a[1],n[14]=a[2],n[15]=1,n);var n,a;const h=1/nd(t);return Xl(e,e,[h,h,h])}function Js(t,e,n,a,h){const m=function(E){const C=nn/(2*Math.PI);return E/(2*Math.PI)/C}(n),y=[t,e,-n/(2*Math.PI)],w=Ys(new Float64Array(16));return Hl(w,w,y),Xl(w,w,[m,m,m]),Kd(w,w,lt(-h)),Hh(w,w,lt(-a)),w}function Zc(t){return Le(Xu,eo,t)}function bp(t,e){const n=po(e.lat,e.lng),a=function(G){const K=po(G._center.lat,G._center.lng);let oe=Qd([],Hu(0,1,0),K);const fe=Zu([],-G.angle,K);oe=Ur(oe,oe,fe),Zu(fe,-G._pitch,oe);const Te=Ji([],K);return Lr(Te,Te,qc(G.cameraToCenterDistance/G.pixelsPerMeter)),Ur(Te,Te,fe),Ca([],K,Te)}(t);return y=(h=Jd([],a,n))[0],w=h[1],E=h[2],C=(m=n)[0],R=m[1],z=m[2],$=(B=Math.sqrt(y*y+w*w+E*E)*Math.sqrt(C*C+R*R+z*z))&&hs(h,m)/B,Math.acos(Math.min(Math.max($,-1),1));var h,m,y,w,E,C,R,z,B,$}function lf(t,e){return bp(t,e)>Math.PI/2*1.01}const Tp=lt(85),cg=Math.cos(Tp),r_=Math.sin(Tp),Yl=63710088e-1,uf=2*Math.PI*Yl;class zi{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new zi(te(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,a=this.lat*n,h=e.lat*n,m=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((e.lng-this.lng)*n);return Yl*Math.acos(Math.min(m,1))}toBounds(e=0){const n=360*e/40075017,a=n/Math.cos(Math.PI/180*this.lat);return new sl(new zi(this.lng-a,this.lat-n),new zi(this.lng+a,this.lat+n))}toEcef(e){const n=qc(e);return po(this.lat,this.lng,Ma+n)}static convert(e){if(e instanceof zi)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new zi(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new zi(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var sn=zi;function Si(t){return uf*Math.cos(t*Math.PI/180)}function vr(t){return(180+t)/360}function Br(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function ti(t,e){return t/Si(e)}function Vi(t){return 360*t-180}function ir(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Hc(t,e){return t*Si(ir(e))}const to=85.051129;function rd(t){return 1/Math.cos(t*Math.PI/180)}class Jl{constructor(e,n,a=0){this.x=+e,this.y=+n,this.z=+a}static fromLngLat(e,n=0){const a=sn.convert(e);return new Jl(vr(a.lng),Br(a.lat),ti(n,a.lat))}toLngLat(){return new sn(Vi(this.x),ir(this.y))}toAltitude(){return Hc(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/uf*rd(ir(this.y))}}function Yu(t,e,n,a,h,m,y,w,E){const C=(e+a)/2,R=(n+h)/2,z=new Y(C,R);w(z),function(B,$,G,K,oe,fe){const Te=G-oe,pe=K-fe;return Math.abs((K-$)*Te-(G-B)*pe)/Math.hypot(Te,pe)}(z.x,z.y,m.x,m.y,y.x,y.y)>=E?(Yu(t,e,n,C,R,m,z,w,E),Yu(t,C,R,a,h,z,y,w,E)):t.push(y)}function Mo(t,e,n){let a=t[0],h=a.x,m=a.y;e(a);const y=[a];for(let w=1;w<t.length;w++){const E=t[w],{x:C,y:R}=E;e(E),Yu(y,h,m,C,R,a,E,e,n),h=C,m=R,a=E}return y}function id(t,e,n,a){if(a(e,n)){const h=e.add(n)._mult(.5);id(t,e,h,a),id(t,h,n,a)}else t.push(n)}function Xc(t,e){let n=t[0];const a=[n];for(let h=1;h<t.length;h++){const m=t[h];id(a,n,m,e),n=m}return a}const Qs=Math.pow(2,14)-1,od=-Qs-1;function Ep(t,e){const n=Math.round(t.x*e),a=Math.round(t.y*e);return t.x=Et(n,od,Qs),t.y=Et(a,od,Qs),(n<t.x||n>t.x+1||a<t.y||a>t.y+1)&&Nn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function mo(t,e,n){const a=t.loadGeometry(),h=t.extent,m=nn/h;if(e&&n&&n.projection.isReprojectedInTileSpace){const y=1<<e.z,{scale:w,x:E,y:C,projection:R}=n,z=B=>{const $=Vi((e.x+B.x/h)/y),G=ir((e.y+B.y/h)/y),K=R.project($,G);B.x=(K.x*w-E)*h,B.y=(K.y*w-C)*h};for(let B=0;B<a.length;B++)if(t.type!==1)a[B]=Mo(a[B],z,1);else{const $=[];for(const G of a[B])G.x<0||G.x>=h||G.y<0||G.y>=h||(z(G),$.push(G));a[B]=$}}for(const y of a)for(const w of y)Ep(w,m);return a}function Pa(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?mo(t):[]}}function ea(t,e,n,a,h){t.emplaceBack(2*e+(a+1)/2,2*n+(h+1)/2)}function Ju(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class Qu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new vt,this.indexArray=new Qt,this.segments=new ei,this.programConfigurations=new Zl(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a,h){const m=this.layers[0],y=[];let w=null;m.type==="circle"&&(w=m.layout.get("circle-sort-key"));for(const{feature:C,id:R,index:z,sourceLayerIndex:B}of e){const $=this.layers[0]._featureFilter.needGeometry,G=Pa(C,$);if(!this.layers[0]._featureFilter.filter(new L(this.zoom),G,a))continue;const K=w?w.evaluate(G,{},a):void 0,oe={id:R,properties:C.properties,type:C.type,sourceLayerIndex:B,index:z,geometry:$?G.geometry:mo(C,a,h),patterns:{},sortKey:K};y.push(oe)}w&&y.sort((C,R)=>C.sortKey-R.sortKey);let E=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new mt,E=h.projection);for(const C of y){const{geometry:R,index:z,sourceLayerIndex:B}=C,$=e[z].feature;this.addFeature(C,R,z,n.availableImages,a,E),n.featureIndex.insert($,R,z,B,this.index)}}update(e,n,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tg.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,e_.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,a,h,m,y){for(const w of n)for(const E of w){const C=E.x,R=E.y;if(C<0||C>=nn||R<0||R>=nn)continue;if(y){const $=y.projectTilePoint(C,R,m),G=y.upVector(m,C,R),K=this.globeExtVertexArray;Ju(K,$,G),Ju(K,$,G),Ju(K,$,G),Ju(K,$,G)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),B=z.vertexLength;ea(this.layoutVertexArray,C,R,-1,-1),ea(this.layoutVertexArray,C,R,1,-1),ea(this.layoutVertexArray,C,R,1,1),ea(this.layoutVertexArray,C,R,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+2,B+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},h,m)}}function cf(t,e){for(let n=0;n<t.length;n++)if(ul(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(ul(t,e[n]))return!0;return!!Ia(t,e)}function hf(t,e,n){return!!ul(t,e)||!!go(e,t,n)}function sd(t,e){if(t.length===1)return df(e,t[0]);for(let n=0;n<e.length;n++){const a=e[n];for(let h=0;h<a.length;h++)if(ul(t,a[h]))return!0}for(let n=0;n<t.length;n++)if(df(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Ia(t,e[n]))return!0;return!1}function ko(t,e,n){if(t.length>1){if(Ia(t,e))return!0;for(let a=0;a<e.length;a++)if(go(e[a],t,n))return!0}for(let a=0;a<t.length;a++)if(go(t[a],e,n))return!0;return!1}function Ia(t,e){if(t.length===0||e.length===0)return!1;for(let n=0;n<t.length-1;n++){const a=t[n],h=t[n+1];for(let m=0;m<e.length-1;m++)if(ta(a,h,e[m],e[m+1]))return!0}return!1}function ta(t,e,n,a){return jn(t,n,a)!==jn(e,n,a)&&jn(t,e,n)!==jn(t,e,a)}function go(t,e,n){const a=n*n;if(e.length===1)return t.distSqr(e[0])<a;for(let h=1;h<e.length;h++)if(Sp(t,e[h-1],e[h])<a)return!0;return!1}function Sp(t,e,n){const a=e.distSqr(n);if(a===0)return t.distSqr(e);const h=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/a;return t.distSqr(h<0?e:h>1?n:n.sub(e)._mult(h)._add(e))}function df(t,e){let n,a,h,m=!1;for(let y=0;y<t.length;y++){n=t[y];for(let w=0,E=n.length-1;w<n.length;E=w++)a=n[w],h=n[E],a.y>e.y!=h.y>e.y&&e.x<(h.x-a.x)*(e.y-a.y)/(h.y-a.y)+a.x&&(m=!m)}return m}function ul(t,e){let n=!1;for(let a=0,h=t.length-1;a<t.length;h=a++){const m=t[a],y=t[h];m.y>e.y!=y.y>e.y&&e.x<(y.x-m.x)*(e.y-m.y)/(y.y-m.y)+m.x&&(n=!n)}return n}function hg(t,e,n,a,h){for(const y of t)if(e<=y.x&&n<=y.y&&a>=y.x&&h>=y.y)return!0;const m=[new Y(e,n),new Y(e,h),new Y(a,h),new Y(a,n)];if(t.length>2){for(const y of m)if(ul(t,y))return!0}for(let y=0;y<t.length-1;y++)if(Ql(t[y],t[y+1],m))return!0;return!1}function Ql(t,e,n){const a=n[0],h=n[2];if(t.x<a.x&&e.x<a.x||t.x>h.x&&e.x>h.x||t.y<a.y&&e.y<a.y||t.y>h.y&&e.y>h.y)return!1;const m=jn(t,e,n[0]);return m!==jn(t,e,n[1])||m!==jn(t,e,n[2])||m!==jn(t,e,n[3])}function ec(t,e,n){const a=e.paint.get(t).value;return a.kind==="constant"?a.value:n.programConfigurations.get(e.id).getMaxValue(t)}function Kc(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function eu(t,e,n,a,h){if(!e[0]&&!e[1])return t;const m=Y.convert(e)._mult(h);n==="viewport"&&m._rotate(-a);const y=[];for(let w=0;w<t.length;w++)y.push(t[w].sub(m));return y}function ff(t,e,n,a){const h=Y.convert(t)._mult(a);return e==="viewport"&&h._rotate(-n),h}Vt(Qu,"CircleBucket",{omit:["layers"]});const tc=new ve({"circle-sort-key":new se(ot.layout_circle["circle-sort-key"])});var dg={paint:new ve({"circle-radius":new se(ot.paint_circle["circle-radius"]),"circle-color":new se(ot.paint_circle["circle-color"]),"circle-blur":new se(ot.paint_circle["circle-blur"]),"circle-opacity":new se(ot.paint_circle["circle-opacity"]),"circle-translate":new X(ot.paint_circle["circle-translate"]),"circle-translate-anchor":new X(ot.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new X(ot.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new X(ot.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new se(ot.paint_circle["circle-stroke-width"]),"circle-stroke-color":new se(ot.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new se(ot.paint_circle["circle-stroke-opacity"])}),layout:tc};function Cp(t,e,n,a,h,m,y,w,E){if(m&&t.queryGeometry.isAboveHorizon)return!1;m&&(E*=t.pixelToTileUnitsFactor);const C=t.tileID.canonical,R=n.projection.upVectorScale(C,n.center.lat,n.worldSize).metersToTile;for(const z of e)for(const B of z){const $=B.add(w),G=h&&n.elevation?n.elevation.exaggeration()*h.getElevationAt($.x,$.y,!0):0,K=n.projection.projectTilePoint($.x,$.y,C);if(G>0){const pe=n.projection.upVector(C,$.x,$.y);K.x+=pe[0]*R*G,K.y+=pe[1]*R*G,K.z+=pe[2]*R*G}const oe=m?$:Ap(K.x,K.y,K.z,a),fe=m?t.tilespaceRays.map(pe=>o_(pe,G)):t.queryGeometry.screenGeometry,Te=Kl([],[K.x,K.y,K.z,1],a);if(!y&&m?E*=Te[3]/n.cameraToCenterDistance:y&&!m&&(E*=n.cameraToCenterDistance/Te[3]),m){const pe=ir((B.y/nn+C.y)/(1<<C.z));E/=n.projection.pixelsPerMeter(pe,1)/ti(1,pe)}if(hf(fe,oe,E))return!0}return!1}function Ap(t,e,n,a){const h=Kl([],[t,e,n,1],a);return new Y(h[0]/h[3],h[1]/h[3])}const ad=Hu(0,0,0),i_=Hu(0,0,1);function o_(t,e){const n=Xh();return ad[2]=e,t.intersectsPlane(ad,i_,n),new Y(n[0],n[1])}class Mp extends Qu{}function kp(t,{width:e,height:n},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*n*a)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*n*a);return t.width=e,t.height=n,t.data=h,t}function tu(t,e,n){const{width:a,height:h}=e;a===t.width&&h===t.height||(Pp(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,a),height:Math.min(t.height,h)},n),t.width=a,t.height=h,t.data=e.data)}function Pp(t,e,n,a,h,m){if(h.width===0||h.height===0)return e;if(h.width>t.width||h.height>t.height||n.x>t.width-h.width||n.y>t.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||a.x>e.width-h.width||a.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=t.data,w=e.data;for(let E=0;E<h.height;E++){const C=((n.y+E)*t.width+n.x)*m,R=((a.y+E)*e.width+a.x)*m;for(let z=0;z<h.width*m;z++)w[R+z]=y[C+z]}return e}Vt(Mp,"HeatmapBucket",{omit:["layers"]});class Zo{constructor(e,n){kp(this,e,1,n)}resize(e){tu(this,new Zo(e),1)}clone(){return new Zo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,a,h,m){Pp(e,n,a,h,m,1)}}class Po{constructor(e,n){kp(this,e,4,n)}resize(e){tu(this,new Po(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Po({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,a,h,m){Pp(e,n,a,h,m,4)}}Vt(Zo,"AlphaImage"),Vt(Po,"RGBAImage");var si={paint:new ve({"heatmap-radius":new se(ot.paint_heatmap["heatmap-radius"]),"heatmap-weight":new se(ot.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new X(ot.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ge(ot.paint_heatmap["heatmap-color"]),"heatmap-opacity":new X(ot.paint_heatmap["heatmap-opacity"])})};function Ip(t){const e={},n=t.resolution||256,a=t.clips?t.clips.length:1,h=t.image||new Po({width:n,height:a}),m=(y,w,E)=>{e[t.evaluationKey]=E;const C=t.expression.evaluate(e);h.data[y+w+0]=Math.floor(255*C.r/C.a),h.data[y+w+1]=Math.floor(255*C.g/C.a),h.data[y+w+2]=Math.floor(255*C.b/C.a),h.data[y+w+3]=Math.floor(255*C.a)};if(t.clips)for(let y=0,w=0;y<a;++y,w+=4*n)for(let E=0,C=0;E<n;E++,C+=4){const R=E/(n-1),{start:z,end:B}=t.clips[y];m(w,C,z*(1-R)+B*R)}else for(let y=0,w=0;y<n;y++,w+=4)m(0,w,y/(n-1));return h}var fg={paint:new ve({"hillshade-illumination-direction":new X(ot.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new X(ot.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new X(ot.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new X(ot.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new X(ot.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new X(ot.paint_hillshade["hillshade-accent-color"])})};const s_=Fe([{name:"a_pos",components:2,type:"Int16"}],4),{members:a_}=s_;var pf={exports:{}};function ld(t,e,n){n=n||2;var a,h,m,y,w,E,C,R=e&&e.length,z=R?e[0]*n:t.length,B=pg(t,0,z,n,!0),$=[];if(!B||B.next===B.prev)return $;if(R&&(B=function(K,oe,fe,Te){var pe,be,ke,Me=[];for(pe=0,be=oe.length;pe<be;pe++)(ke=pg(K,oe[pe]*Te,pe<be-1?oe[pe+1]*Te:K.length,Te,!1))===ke.next&&(ke.steiner=!0),Me.push(zp(ke));for(Me.sort(gf),pe=0;pe<Me.length;pe++)fe=Rp(Me[pe],fe);return fe}(t,e,B,n)),t.length>80*n){a=m=t[0],h=y=t[1];for(var G=n;G<z;G+=n)(w=t[G])<a&&(a=w),(E=t[G+1])<h&&(h=E),w>m&&(m=w),E>y&&(y=E);C=(C=Math.max(m-a,y-h))!==0?32767/C:0}return nc(B,$,n,a,h,C,0),$}function pg(t,e,n,a,h){var m,y;if(h===Qc(t,e,n,a)>0)for(m=e;m<n;m+=a)y=yf(m,t[m],t[m+1],y);else for(m=n-a;m>=e;m-=a)y=yf(m,t[m],t[m+1],y);return y&&ic(y,y.next)&&(ru(y),y=y.next),y}function Ui(t,e){if(!t)return t;e||(e=t);var n,a=t;do if(n=!1,a.steiner||!ic(a,a.next)&&Hr(a.prev,a,a.next)!==0)a=a.next;else{if(ru(a),(a=e=a.prev)===a.next)break;n=!0}while(n||a!==e);return e}function nc(t,e,n,a,h,m,y){if(t){!y&&m&&function(R,z,B,$){var G=R;do G.z===0&&(G.z=Dp(G.x,G.y,z,B,$)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==R);G.prevZ.nextZ=null,G.prevZ=null,function(K){var oe,fe,Te,pe,be,ke,Me,Ke,We=1;do{for(fe=K,K=null,be=null,ke=0;fe;){for(ke++,Te=fe,Me=0,oe=0;oe<We&&(Me++,Te=Te.nextZ);oe++);for(Ke=We;Me>0||Ke>0&&Te;)Me!==0&&(Ke===0||!Te||fe.z<=Te.z)?(pe=fe,fe=fe.nextZ,Me--):(pe=Te,Te=Te.nextZ,Ke--),be?be.nextZ=pe:K=pe,pe.prevZ=be,be=pe;fe=Te}be.nextZ=null,We*=2}while(ke>1)}(G)}(t,a,h,m);for(var w,E,C=t;t.prev!==t.next;)if(w=t.prev,E=t.next,m?nu(t,a,h,m):l_(t))e.push(w.i/n|0),e.push(t.i/n|0),e.push(E.i/n|0),ru(t),t=E.next,C=E.next;else if((t=E)===C){y?y===1?nc(t=mf(Ui(t),e,n),e,n,a,h,m,2):y===2&&rc(t,e,n,a,h,m):nc(Ui(t),e,n,a,h,m,1);break}}}function l_(t){var e=t.prev,n=t,a=t.next;if(Hr(e,n,a)>=0)return!1;for(var h=e.x,m=n.x,y=a.x,w=e.y,E=n.y,C=a.y,R=h<m?h<y?h:y:m<y?m:y,z=w<E?w<C?w:C:E<C?E:C,B=h>m?h>y?h:y:m>y?m:y,$=w>E?w>C?w:C:E>C?E:C,G=a.next;G!==e;){if(G.x>=R&&G.x<=B&&G.y>=z&&G.y<=$&&Yc(h,w,m,E,y,C,G.x,G.y)&&Hr(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function nu(t,e,n,a){var h=t.prev,m=t,y=t.next;if(Hr(h,m,y)>=0)return!1;for(var w=h.x,E=m.x,C=y.x,R=h.y,z=m.y,B=y.y,$=w<E?w<C?w:C:E<C?E:C,G=R<z?R<B?R:B:z<B?z:B,K=w>E?w>C?w:C:E>C?E:C,oe=R>z?R>B?R:B:z>B?z:B,fe=Dp($,G,e,n,a),Te=Dp(K,oe,e,n,a),pe=t.prevZ,be=t.nextZ;pe&&pe.z>=fe&&be&&be.z<=Te;){if(pe.x>=$&&pe.x<=K&&pe.y>=G&&pe.y<=oe&&pe!==h&&pe!==y&&Yc(w,R,E,z,C,B,pe.x,pe.y)&&Hr(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,be.x>=$&&be.x<=K&&be.y>=G&&be.y<=oe&&be!==h&&be!==y&&Yc(w,R,E,z,C,B,be.x,be.y)&&Hr(be.prev,be,be.next)>=0))return!1;be=be.nextZ}for(;pe&&pe.z>=fe;){if(pe.x>=$&&pe.x<=K&&pe.y>=G&&pe.y<=oe&&pe!==h&&pe!==y&&Yc(w,R,E,z,C,B,pe.x,pe.y)&&Hr(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;be&&be.z<=Te;){if(be.x>=$&&be.x<=K&&be.y>=G&&be.y<=oe&&be!==h&&be!==y&&Yc(w,R,E,z,C,B,be.x,be.y)&&Hr(be.prev,be,be.next)>=0)return!1;be=be.nextZ}return!0}function mf(t,e,n){var a=t;do{var h=a.prev,m=a.next.next;!ic(h,m)&&ud(h,a,a.next,m)&&hd(h,m)&&hd(m,h)&&(e.push(h.i/n|0),e.push(a.i/n|0),e.push(m.i/n|0),ru(a),ru(a.next),a=t=m),a=a.next}while(a!==t);return Ui(a)}function rc(t,e,n,a,h,m){var y=t;do{for(var w=y.next.next;w!==y.prev;){if(y.i!==w.i&&mg(y,w)){var E=Op(y,w);return y=Ui(y,y.next),E=Ui(E,E.next),nc(y,e,n,a,h,m,0),void nc(E,e,n,a,h,m,0)}w=w.next}y=y.next}while(y!==t)}function gf(t,e){return t.x-e.x}function Rp(t,e){var n=function(h,m){var y,w=m,E=h.x,C=h.y,R=-1/0;do{if(C<=w.y&&C>=w.next.y&&w.next.y!==w.y){var z=w.x+(C-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(z<=E&&z>R&&(R=z,y=w.x<w.next.x?w:w.next,z===E))return y}w=w.next}while(w!==m);if(!y)return null;var B,$=y,G=y.x,K=y.y,oe=1/0;w=y;do E>=w.x&&w.x>=G&&E!==w.x&&Yc(C<K?E:R,C,G,K,C<K?R:E,C,w.x,w.y)&&(B=Math.abs(C-w.y)/(E-w.x),hd(w,h)&&(B<oe||B===oe&&(w.x>y.x||w.x===y.x&&Lp(y,w)))&&(y=w,oe=B)),w=w.next;while(w!==$);return y}(t,e);if(!n)return e;var a=Op(n,t);return Ui(a,a.next),Ui(n,n.next)}function Lp(t,e){return Hr(t.prev,t,e.prev)<0&&Hr(e.next,t,t.next)<0}function Dp(t,e,n,a,h){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function zp(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Yc(t,e,n,a,h,m,y,w){return(h-y)*(e-w)>=(t-y)*(m-w)&&(t-y)*(a-w)>=(n-y)*(e-w)&&(n-y)*(m-w)>=(h-y)*(a-w)}function mg(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,a){var h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==a.i&&h.next.i!==a.i&&ud(h,h.next,n,a))return!0;h=h.next}while(h!==n);return!1}(t,e)&&(hd(t,e)&&hd(e,t)&&function(n,a){var h=n,m=!1,y=(n.x+a.x)/2,w=(n.y+a.y)/2;do h.y>w!=h.next.y>w&&h.next.y!==h.y&&y<(h.next.x-h.x)*(w-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==n);return m}(t,e)&&(Hr(t.prev,t,e.prev)||Hr(t,e.prev,e))||ic(t,e)&&Hr(t.prev,t,t.next)>0&&Hr(e.prev,e,e.next)>0)}function Hr(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ic(t,e){return t.x===e.x&&t.y===e.y}function ud(t,e,n,a){var h=Jc(Hr(t,e,n)),m=Jc(Hr(t,e,a)),y=Jc(Hr(n,a,t)),w=Jc(Hr(n,a,e));return h!==m&&y!==w||!(h!==0||!cd(t,n,e))||!(m!==0||!cd(t,a,e))||!(y!==0||!cd(n,t,a))||!(w!==0||!cd(n,e,a))}function cd(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Jc(t){return t>0?1:t<0?-1:0}function hd(t,e){return Hr(t.prev,t,t.next)<0?Hr(t,e,t.next)>=0&&Hr(t,t.prev,e)>=0:Hr(t,e,t.prev)<0||Hr(t,t.next,e)<0}function Op(t,e){var n=new dd(t.i,t.x,t.y),a=new dd(e.i,e.x,e.y),h=t.next,m=e.prev;return t.next=e,e.prev=t,n.next=h,h.prev=n,a.next=n,n.prev=a,m.next=a,a.prev=m,a}function yf(t,e,n,a){var h=new dd(t,e,n);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function ru(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function dd(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qc(t,e,n,a){for(var h=0,m=e,y=n-a;m<n;m+=a)h+=(t[y]-t[m])*(t[m+1]+t[y+1]),y=m;return h}pf.exports=ld,pf.exports.default=ld,ld.deviation=function(t,e,n,a){var h=e&&e.length,m=Math.abs(Qc(t,0,h?e[0]*n:t.length,n));if(h)for(var y=0,w=e.length;y<w;y++)m-=Math.abs(Qc(t,e[y]*n,y<w-1?e[y+1]*n:t.length,n));var E=0;for(y=0;y<a.length;y+=3){var C=a[y]*n,R=a[y+1]*n,z=a[y+2]*n;E+=Math.abs((t[C]-t[z])*(t[R+1]-t[C+1])-(t[C]-t[R])*(t[z+1]-t[C+1]))}return m===0&&E===0?0:Math.abs((E-m)/m)},ld.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},a=0,h=0;h<t.length;h++){for(var m=0;m<t[h].length;m++)for(var y=0;y<e;y++)n.vertices.push(t[h][m][y]);h>0&&n.holes.push(a+=t[h-1].length)}return n};var _f=me(pf.exports);function u_(t,e,n,a,h){fd(t,e,n,a||t.length-1,h||md)}function fd(t,e,n,a,h){for(;a>n;){if(a-n>600){var m=a-n+1,y=e-n+1,w=Math.log(m),E=.5*Math.exp(2*w/3),C=.5*Math.sqrt(w*E*(m-E)/m)*(y-m/2<0?-1:1);fd(t,e,Math.max(n,Math.floor(e-y*E/m+C)),Math.min(a,Math.floor(e+(m-y)*E/m+C)),h)}var R=t[e],z=n,B=a;for(pd(t,n,e),h(t[a],R)>0&&pd(t,n,a);z<B;){for(pd(t,z,B),z++,B--;h(t[z],R)<0;)z++;for(;h(t[B],R)>0;)B--}h(t[n],R)===0?pd(t,n,B):pd(t,++B,a),B<=e&&(n=B+1),e<=B&&(a=B-1)}}function pd(t,e,n){var a=t[e];t[e]=t[n],t[n]=a}function md(t,e){return t<e?-1:t>e?1:0}function Bp(t,e){const n=t.length;if(n<=1)return[t];const a=[];let h,m;for(let y=0;y<n;y++){const w=Kr(t[y]);w!==0&&(t[y].area=Math.abs(w),m===void 0&&(m=w<0),m===w<0?(h&&a.push(h),h=[t[y]]):h.push(t[y]))}if(h&&a.push(h),e>1)for(let y=0;y<a.length;y++)a[y].length<=e||(u_(a[y],e,1,a[y].length-1,vf),a[y]=a[y].slice(0,e));return a}function vf(t,e){return e.area-t.area}function l(t,e,n){const a=n.patternDependencies;let h=!1;for(const m of e){const y=m.paint.get(`${t}-pattern`);y.isConstant()||(h=!0);const w=y.constantOr(null);w&&(h=!0,a[w]=!0)}return h}function d(t,e,n,a,h){const m=h.patternDependencies;for(const y of e){const w=y.paint.get(`${t}-pattern`).value;if(w.kind!=="constant"){let E=w.evaluate({zoom:a},n,{},h.availableImages);E=E&&E.name?E.name:E,m[E]=!0,n.patterns[y.id]=E}}return n}class x{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new vt,this.indexArray=new Qt,this.indexArray2=new jr,this.programConfigurations=new Zl(e.layers,e.zoom),this.segments=new ei,this.segments2=new ei,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,a,h){this.hasPattern=l("fill",this.layers,n);const m=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:w,id:E,index:C,sourceLayerIndex:R}of e){const z=this.layers[0]._featureFilter.needGeometry,B=Pa(w,z);if(!this.layers[0]._featureFilter.filter(new L(this.zoom),B,a))continue;const $=m?m.evaluate(B,{},a,n.availableImages):void 0,G={id:E,properties:w.properties,type:w.type,sourceLayerIndex:R,index:C,geometry:z?B.geometry:mo(w,a,h),patterns:{},sortKey:$};y.push(G)}m&&y.sort((w,E)=>w.sortKey-E.sortKey);for(const w of y){const{geometry:E,index:C,sourceLayerIndex:R}=w;if(this.hasPattern){const z=d("fill",this.layers,w,this.zoom,n);this.patternFeatures.push(z)}else this.addFeature(w,E,C,a,{},n.availableImages);n.featureIndex.insert(e[C].feature,E,C,R,this.index)}}update(e,n,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,h)}addFeatures(e,n,a,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,n,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,a_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,a,h,m,y=[]){for(const w of Bp(n,500)){let E=0;for(const G of w)E+=G.length;const C=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),R=C.vertexLength,z=[],B=[];for(const G of w){if(G.length===0)continue;G!==w[0]&&B.push(z.length/2);const K=this.segments2.prepareSegment(G.length,this.layoutVertexArray,this.indexArray2),oe=K.vertexLength;this.layoutVertexArray.emplaceBack(G[0].x,G[0].y),this.indexArray2.emplaceBack(oe+G.length-1,oe),z.push(G[0].x),z.push(G[0].y);for(let fe=1;fe<G.length;fe++)this.layoutVertexArray.emplaceBack(G[fe].x,G[fe].y),this.indexArray2.emplaceBack(oe+fe-1,oe+fe),z.push(G[fe].x),z.push(G[fe].y);K.vertexLength+=G.length,K.primitiveLength+=G.length}const $=_f(z,B);for(let G=0;G<$.length;G+=3)this.indexArray.emplaceBack(R+$[G],R+$[G+1],R+$[G+2]);C.vertexLength+=E,C.primitiveLength+=$.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,y,h)}}Vt(x,"FillBucket",{omit:["layers","patternFeatures"]});const A=new ve({"fill-sort-key":new se(ot.layout_fill["fill-sort-key"])});var D={paint:new ve({"fill-antialias":new X(ot.paint_fill["fill-antialias"]),"fill-opacity":new se(ot.paint_fill["fill-opacity"]),"fill-color":new se(ot.paint_fill["fill-color"]),"fill-outline-color":new se(ot.paint_fill["fill-outline-color"]),"fill-translate":new X(ot.paint_fill["fill-translate"]),"fill-translate-anchor":new X(ot.paint_fill["fill-translate-anchor"]),"fill-pattern":new se(ot.paint_fill["fill-pattern"])}),layout:A};const U=Fe([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),re=Fe([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ce=Fe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Oe}=U;var tt={},Rt=$e,Ot=Ct;function Ct(t,e,n,a,h){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=a,this._values=h,t.readFields(tn,this,e)}function tn(t,e,n){t==1?e.id=n.readVarint():t==2?function(a,h){for(var m=a.readVarint()+a.pos;a.pos<m;){var y=h._keys[a.readVarint()],w=h._values[a.readVarint()];h.properties[y]=w}}(n,e):t==3?e.type=n.readVarint():t==4&&(e._geometry=n.pos)}function an(t){for(var e,n,a=0,h=0,m=t.length,y=m-1;h<m;y=h++)a+=((n=t[y]).x-(e=t[h]).x)*(e.y+n.y);return a}Ct.types=["Unknown","Point","LineString","Polygon"],Ct.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,a=1,h=0,m=0,y=0,w=[];t.pos<n;){if(h<=0){var E=t.readVarint();a=7&E,h=E>>3}if(h--,a===1||a===2)m+=t.readSVarint(),y+=t.readSVarint(),a===1&&(e&&w.push(e),e=[]),e.push(new Rt(m,y));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&w.push(e),w},Ct.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,a=0,h=0,m=0,y=1/0,w=-1/0,E=1/0,C=-1/0;t.pos<e;){if(a<=0){var R=t.readVarint();n=7&R,a=R>>3}if(a--,n===1||n===2)(h+=t.readSVarint())<y&&(y=h),h>w&&(w=h),(m+=t.readSVarint())<E&&(E=m),m>C&&(C=m);else if(n!==7)throw new Error("unknown command "+n)}return[y,E,w,C]},Ct.prototype.toGeoJSON=function(t,e,n){var a,h,m=this.extent*Math.pow(2,n),y=this.extent*t,w=this.extent*e,E=this.loadGeometry(),C=Ct.types[this.type];function R($){for(var G=0;G<$.length;G++){var K=$[G];$[G]=[360*(K.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(K.y+w)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(a=0;a<E.length;a++)z[a]=E[a][0];R(E=z);break;case 2:for(a=0;a<E.length;a++)R(E[a]);break;case 3:for(E=function($){var G=$.length;if(G<=1)return[$];for(var K,oe,fe=[],Te=0;Te<G;Te++){var pe=an($[Te]);pe!==0&&(oe===void 0&&(oe=pe<0),oe===pe<0?(K&&fe.push(K),K=[$[Te]]):K.push($[Te]))}return K&&fe.push(K),fe}(E),a=0;a<E.length;a++)for(h=0;h<E[a].length;h++)R(E[a][h])}E.length===1?E=E[0]:C="Multi"+C;var B={type:"Feature",geometry:{type:C,coordinates:E},properties:this.properties};return"id"in this&&(B.id=this.id),B};var cn=Ot,ai=Ye;function Ye(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(je,this,e),this.length=this._features.length}function je(t,e,n){t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(function(a){for(var h=null,m=a.readVarint()+a.pos;a.pos<m;){var y=a.readVarint()>>3;h=y===1?a.readString():y===2?a.readFloat():y===3?a.readDouble():y===4?a.readVarint64():y===5?a.readVarint():y===6?a.readSVarint():y===7?a.readBoolean():null}return h}(n))}Ye.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new cn(this._pbf,e,this.extent,this._keys,this._values)};var et=ai;function Ut(t,e,n){if(t===3){var a=new et(n,n.readVarint()+n.pos);a.length&&(e[a.name]=a)}}var hn=tt.VectorTile=function(t,e){this.layers=t.readFields(Ut,{},e)},_n=tt.VectorTileFeature=Ot;function vn(t,e,n,a){const h=[],m=a===0?(y,w,E,C,R,z)=>{y.push(new Y(z,E+(z-w)/(C-w)*(R-E)))}:(y,w,E,C,R,z)=>{y.push(new Y(w+(z-E)/(R-E)*(C-w),z))};for(const y of t){const w=[];for(const E of y){if(E.length<=2)continue;const C=[];for(let B=0;B<E.length-1;B++){const $=E[B].x,G=E[B].y,K=E[B+1].x,oe=E[B+1].y,fe=a===0?$:G,Te=a===0?K:oe;fe<e?Te>e&&m(C,$,G,K,oe,e):fe>n?Te<n&&m(C,$,G,K,oe,n):C.push(E[B]),Te<e&&fe>=e&&m(C,$,G,K,oe,e),Te>n&&fe<=n&&m(C,$,G,K,oe,n)}let R=E[E.length-1];const z=a===0?R.x:R.y;z>=e&&z<=n&&C.push(R),C.length&&(R=C[C.length-1],C[0].x===R.x&&C[0].y===R.y||C.push(C[0]),w.push(C))}w.length&&h.push(w)}return h}tt.VectorTileLayer=ai;const zn=_n.types,$i=Math.pow(2,13);function or(t,e,n,a,h,m,y,w){t.emplaceBack((e<<1)+y,(n<<1)+m,(Math.floor(a*$i)<<1)+h,Math.round(w))}function Is(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class gg{constructor(){this.acc=new Y(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Y(e.x,e.y),this.max=new Y(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);const a=this.min,h=this.max;e.x<a.x?a.x=e.x:e.x>h.x&&(h.x=e.x),e.y<a.y?a.y=e.y:e.y>h.y&&(h.y=e.y),((e.x===0||e.x===nn)&&e.x===n.x)!=((e.y===0||e.y===nn)&&e.y===n.y)&&this.processBorderOverlap(e,n),n.x<0!=e.x<0&&this.addBorderIntersection(0,Zn(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>nn!=e.x>nn&&this.addBorderIntersection(1,Zn(n.y,e.y,(nn-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,Zn(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>nn!=e.y>nn&&this.addBorderIntersection(3,Zn(n.x,e.x,(nn-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];n<a[0]&&(a[0]=n),n>a[1]&&(a[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const a=e.x===0?0:1;this.addBorderIntersection(a,n.y),this.addBorderIntersection(a,e.y)}else{const a=e.y===0?2:3;this.addBorderIntersection(a,n.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((n,a)=>n+a.edges,0);return e!==0?this.acc.div(e)._round():new Y(0,0)}span(){return new Y(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class Fp{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new nt,this.centroidVertexArray=new Go,this.indexArray=new Qt,this.programConfigurations=new Zl(e.layers,e.zoom),this.segments=new ei,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,a,h){this.features=[],this.hasPattern=l("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(m){const y=Math.exp(Math.PI*(1-m.y/(1<<m.z)*2));return 80150034*y/(y*y+1)/nn/(1<<m.z)}(a),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:m,id:y,index:w,sourceLayerIndex:E}of e){const C=this.layers[0]._featureFilter.needGeometry,R=Pa(m,C);if(!this.layers[0]._featureFilter.filter(new L(this.zoom),R,a))continue;const z={id:y,sourceLayerIndex:E,index:w,geometry:C?R.geometry:mo(m,a,h),properties:m.properties,type:m.type,patterns:{}},B=this.layoutVertexArray.length;this.hasPattern?this.features.push(d("fill-extrusion",this.layers,z,this.zoom,n)):this.addFeature(z,z.geometry,w,a,{},n.availableImages,h),n.featureIndex.insert(m,z.geometry,w,E,this.index,B)}this.sortBorders()}addFeatures(e,n,a,h,m){for(const y of this.features){const{geometry:w}=y;this.addFeature(y,w,y.index,n,a,h,m)}this.sortBorders()}update(e,n,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Oe),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Ce.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,re.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,a,h,m,y,w){const E=[new Y(0,0),new Y(nn,nn)],C=w.projection,R=C.name==="globe",z=this.enableTerrain&&!R?new gg:null,B=zn[e.type]==="Polygon";R&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new mt);const $=Bp(n,500);for(let fe=$.length-1;fe>=0;fe--){const Te=$[fe];(Te.length===0||(G=Te[0]).every(pe=>pe.x<=0)||G.every(pe=>pe.x>=nn)||G.every(pe=>pe.y<=0)||G.every(pe=>pe.y>=nn))&&$.splice(fe,1)}var G;let K;if(R)K=Bx($,E,h);else{K=[];for(const fe of $)K.push({polygon:fe,bounds:E})}const oe=B?this.edgeRadius:0;for(const{polygon:fe,bounds:Te}of K){let pe=0,be=0;for(const Me of fe)B&&!Me[0].equals(Me[Me.length-1])&&Me.push(Me[0]),be+=B?Me.length-1:Me.length;const ke=this.segments.prepareSegment((B?5:4)*be,this.layoutVertexArray,this.indexArray);if(B){const Me=[],Ke=[];pe=ke.vertexLength;for(const st of fe){let bt,Qe;st.length&&st!==fe[0]&&Ke.push(Me.length/2),bt=st[1].sub(st[0])._perp()._unit();for(let ut=1;ut<st.length;ut++){const ct=st[ut],_t=st[ut===st.length-1?1:ut+1];let{x:At,y:it}=ct;if(oe){Qe=_t.sub(ct)._perp()._unit();const jt=bt.add(Qe)._unit(),Yt=oe*Math.min(4,1/(bt.x*jt.x+bt.y*jt.y));At+=Yt*jt.x,it+=Yt*jt.y,bt=Qe}or(this.layoutVertexArray,At,it,0,0,1,1,0),ke.vertexLength++,Me.push(ct.x,ct.y),R&&Is(this.layoutVertexExtArray,C.projectTilePoint(At,it,h),C.upVector(h,At,it))}}const We=_f(Me,Ke);for(let st=0;st<We.length;st+=3)this.indexArray.emplaceBack(pe+We[st],pe+We[st+2],pe+We[st+1]),ke.primitiveLength++}for(const Me of fe){z&&Me.length&&z.startRing(Me[0]);let Ke,We,st,bt=Me.length>4&&Dx(Me[Me.length-2],Me[0],Me[1]),Qe=oe?fA(Me[Me.length-2],Me[0],Me[1],oe):0;We=Me[1].sub(Me[0])._perp()._unit();let ut=!0;for(let ct=1,_t=0;ct<Me.length;ct++){let At=Me[ct-1],it=Me[ct];const jt=Me[ct===Me.length-1?1:ct+1];if(z&&B&&z.currentPolyCount.top++,Lx(it,At,Te)){oe&&(We=jt.sub(it)._perp()._unit(),ut=!ut);continue}z&&z.append(it,At);const Yt=it.sub(At)._perp(),Gt=Yt.x/(Math.abs(Yt.x)+Math.abs(Yt.y)),An=Yt.y>0?1:0,Mt=At.dist(it);if(_t+Mt>32768&&(_t=0),oe){st=jt.sub(it)._perp()._unit();let kn=Rx(At,it,jt,Ix(We,st),oe);isNaN(kn)&&(kn=0);const gn=it.sub(At)._unit();At=At.add(gn.mult(Qe))._round(),it=it.add(gn.mult(-kn))._round(),Qe=kn,We=st}const rn=ke.vertexLength,Mn=Me.length>4&&Dx(At,it,jt);let sr=zx(_t,bt,ut);if(or(this.layoutVertexArray,At.x,At.y,Gt,An,0,0,sr),or(this.layoutVertexArray,At.x,At.y,Gt,An,0,1,sr),_t+=Mt,sr=zx(_t,Mn,!ut),bt=Mn,or(this.layoutVertexArray,it.x,it.y,Gt,An,0,0,sr),or(this.layoutVertexArray,it.x,it.y,Gt,An,0,1,sr),ke.vertexLength+=4,this.indexArray.emplaceBack(rn+0,rn+1,rn+2),this.indexArray.emplaceBack(rn+1,rn+3,rn+2),ke.primitiveLength+=2,oe){const kn=pe+(ct===1?Me.length-2:ct-2),gn=ct===1?pe:kn+1;if(this.indexArray.emplaceBack(rn+1,kn,rn+3),this.indexArray.emplaceBack(kn,gn,rn+3),ke.primitiveLength+=2,Ke===void 0&&(Ke=rn),!Lx(jt,Me[ct],Te)){const kr=ct===Me.length-1?Ke:ke.vertexLength;this.indexArray.emplaceBack(rn+2,rn+3,kr),this.indexArray.emplaceBack(rn+3,kr+1,kr),this.indexArray.emplaceBack(rn+3,gn,kr+1),ke.primitiveLength+=3}ut=!ut}if(R){const kn=this.layoutVertexExtArray,gn=C.projectTilePoint(At.x,At.y,h),kr=C.projectTilePoint(it.x,it.y,h),In=C.upVector(h,At.x,At.y),Rn=C.upVector(h,it.x,it.y);Is(kn,gn,In),Is(kn,gn,In),Is(kn,kr,Rn),Is(kn,kr,Rn)}}B&&(pe+=Me.length-1)}}if(z&&z.polyCount.length>0){if(z.borders){z.vertexArrayOffset=this.centroidVertexArray.length;const fe=z.borders,Te=this.featuresOnBorder.push(z)-1;for(let pe=0;pe<4;pe++)fe[pe][0]!==Number.MAX_VALUE&&this.borders[pe].push(Te)}this.encodeCentroid(z.borders?void 0:z.centroid(),z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,y,h)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,a)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,n,a=!0){let h,m;if(e)if(e.y!==0){const w=n.span()._mult(this.tileToMeter);h=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(w.x/10)),m=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else h=Math.ceil(7*(e.x+450)),m=0;else h=0,m=+a;let y=a?this.centroidVertexArray.length:n.vertexArrayOffset;for(const w of n.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let E=0;E<w.top;E++)this.centroidVertexArray.emplace(y++,h,m);for(let E=0;E<2*w.edges;E++)this.centroidVertexArray.emplace(y++,0,m),this.centroidVertexArray.emplace(y++,h,m)}}}function Ix(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function fA(t,e,n,a){const h=e.sub(t)._perp()._unit(),m=n.sub(e)._perp()._unit();return Rx(t,e,n,Ix(h,m),a)}function Rx(t,e,n,a,h){const m=Math.sqrt(1-a*a);return Math.min(t.dist(e)/3,e.dist(n)/3,h*m/a)}function Lx(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function Dx(t,e,n){if(t.x<0||t.x>=nn||e.x<0||e.x>=nn||n.x<0||n.x>=nn)return!1;const a=n.sub(e),h=a.perp(),m=t.sub(e);return(a.x*m.x+a.y*m.y)/Math.sqrt((a.x*a.x+a.y*a.y)*(m.x*m.x+m.y*m.y))>-.866&&h.x*m.x+h.y*m.y<0}function zx(t,e,n){const a=e?2|t:-3&t;return n?1|a:-2&a}function Ox(){const t=Math.PI/32,e=Math.tan(t),n=Yl;return n*Math.sqrt(1+2*e*e)-n}function Bx(t,e,n){const a=1<<n.z,h=Vi(n.x/a),m=Vi((n.x+1)/a),y=ir(n.y/a),w=ir((n.y+1)/a);return function(E,C,R,z,B=0,$){const G=[];if(!E.length||!R||!z)return G;const K=(Me,Ke)=>{for(const We of Me)G.push({polygon:We,bounds:Ke})},oe=Math.ceil(Math.log2(R)),fe=Math.ceil(Math.log2(z)),Te=oe-fe,pe=[];for(let Me=0;Me<Math.abs(Te);Me++)pe.push(Te>0?0:1);for(let Me=0;Me<Math.min(oe,fe);Me++)pe.push(0),pe.push(1);let be=E;if(be=vn(be,C[0].y-B,C[1].y+B,1),be=vn(be,C[0].x-B,C[1].x+B,0),!be.length)return G;const ke=[];for(pe.length?ke.push({polygons:be,bounds:C,depth:0}):K(be,C);ke.length;){const Me=ke.pop(),Ke=Me.depth,We=pe[Ke],st=Me.bounds[0],bt=Me.bounds[1],Qe=We===0?st.x:st.y,ut=We===0?bt.x:bt.y,ct=$?$(We,Qe,ut):.5*(Qe+ut),_t=vn(Me.polygons,Qe-B,ct+B,We),At=vn(Me.polygons,ct-B,ut+B,We);if(_t.length){const it=[st,new Y(We===0?ct:bt.x,We===1?ct:bt.y)];pe.length>Ke+1?ke.push({polygons:_t,bounds:it,depth:Ke+1}):K(_t,it)}if(At.length){const it=[new Y(We===0?ct:st.x,We===1?ct:st.y),bt];pe.length>Ke+1?ke.push({polygons:At,bounds:it,depth:Ke+1}):K(At,it)}}return G}(t,e,Math.ceil((m-h)/11.25),Math.ceil((y-w)/11.25),1,(E,C,R)=>{if(E===0)return .5*(C+R);{const z=ir((n.y+C/nn)/a);return(Br(.5*(ir((n.y+R/nn)/a)+z))*a-n.y)*nn}})}Vt(Fp,"FillExtrusionBucket",{omit:["layers","features"]}),Vt(gg,"PartMetadata");const pA=new ve({"fill-extrusion-edge-radius":new X(ot["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var mA={paint:new ve({"fill-extrusion-opacity":new X(ot["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new se(ot["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new X(ot["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new X(ot["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new se(ot["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new se(ot["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new se(ot["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new X(ot["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new X(ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new X(ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new X(ot["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:pA};function Fx(t,e,n){var a=2*Math.PI*6378137/256/Math.pow(2,n);return[t*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class yg{constructor(e,n,a){this.z=e,this.x=n,this.y=a,this.key=Np(0,e,e,n,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const a=function(m,y,w){var E=Fx(256*m,256*(y=Math.pow(2,w)-y-1),w),C=Fx(256*(m+1),256*(y+1),w);return E[0]+","+E[1]+","+C[0]+","+C[1]}(this.x,this.y,this.z),h=function(m,y,w){let E,C="";for(let R=m;R>0;R--)E=1<<R-1,C+=(y&E?1:0)+(w&E?2:0);return C}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Nx{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Np(e,n.z,n.z,n.x,n.y)}}class Ho{constructor(e,n,a,h,m){this.overscaledZ=e,this.wrap=n,this.canonical=new yg(a,+h,+m),this.key=n===0&&e===a?this.canonical.key:Np(n,e,a,h,m)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new Ho(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ho(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return Np(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return Np(this.wrap*+n,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Ho(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new Ho(n,this.wrap,n,a,h),new Ho(n,this.wrap,n,a+1,h),new Ho(n,this.wrap,n,a,h+1),new Ho(n,this.wrap,n,a+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ho(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ho(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Nx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Np(t,e,n,a,h){const m=1<<Math.min(n,22);let y=m*(h%m)+a%m;return t&&n<22&&(y+=m*m*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*y+n)+(e-n)}Vt(yg,"CanonicalTileID"),Vt(Ho,"OverscaledTileID",{omit:["projMatrix"]});class xf extends Y{constructor(e,n,a){super(e,n),this.z=a}}function jp(t,e){return t.x*e.x+t.y*e.y}function jx(t,e){if(t.length===1){let n=0;const a=e[n++];let h;for(;!h||a.equals(h);)if(h=e[n++],!h)return 1/0;for(;n<e.length;n++){const m=e[n],y=t[0],w=h.sub(a),E=m.sub(a),C=y.sub(a),R=jp(w,w),z=jp(w,E),B=jp(E,E),$=jp(C,w),G=jp(C,E),K=R*B-z*z,oe=(B*$-z*G)/K,fe=(R*G-z*$)/K,Te=a.z*(1-oe-fe)+h.z*oe+m.z*fe;if(isFinite(Te))return Te}return 1/0}{let n=1/0;for(const a of e)n=Math.min(n,a.z);return n}}function Vx(t,e,n,a,h,m,y,w){const E=y*h.getElevationAt(t,e,!0,!0),C=m[0]!==0,R=C?m[1]===0?y*(m[0]/7-450):y*function(z,B,$){const G=Math.floor(B[0]/8),K=Math.floor(B[1]/8),oe=10*(B[0]-8*G),fe=10*(B[1]-8*K),Te=z.getElevationAt(G,K,!0,!0),pe=z.getMeterToDEM($),be=Math.floor(.5*(oe*pe-1)),ke=Math.floor(.5*(fe*pe-1)),Me=z.tileCoordToPixel(G,K),Ke=2*be+1,We=2*ke+1,st=function(At,it,jt,Yt,Gt){return[At.getElevationAtPixel(it,jt,!0),At.getElevationAtPixel(it+Gt,jt,!0),At.getElevationAtPixel(it,jt+Gt,!0),At.getElevationAtPixel(it+Yt,jt+Gt,!0)]}(z,Me.x-be,Me.y-ke,Ke,We),bt=Math.abs(st[0]-st[1]),Qe=Math.abs(st[2]-st[3]),ut=Math.abs(st[0]-st[2])+Math.abs(st[1]-st[3]),ct=Math.min(.25,.5*pe*(bt+Qe)/Ke),_t=Math.min(.25,.5*pe*ut/We);return Te+Math.max(ct*oe,_t*fe)}(h,m,w):E;return{base:E+(n===0)?-1:n,top:C?Math.max(R+a,E+n+2):E+a}}const gA=Fe([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:yA}=gA,_A=Fe([{name:"a_packed",components:4,type:"Float32"}]),{members:vA}=_A,xA=_n.types,wA=Math.cos(Math.PI/180*37.5);class _g{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Xe,this.layoutVertexArray2=new yt,this.indexArray=new Qt,this.programConfigurations=new Zl(e.layers,e.zoom),this.segments=new ei,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a,h){this.hasPattern=l("line",this.layers,n);const m=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:R,id:z,index:B,sourceLayerIndex:$}of e){const G=this.layers[0]._featureFilter.needGeometry,K=Pa(R,G);if(!this.layers[0]._featureFilter.filter(new L(this.zoom),K,a))continue;const oe=m?m.evaluate(K,{},a):void 0,fe={id:z,properties:R.properties,type:R.type,sourceLayerIndex:$,index:B,geometry:G?K.geometry:mo(R,a,h),patterns:{},sortKey:oe};y.push(fe)}m&&y.sort((R,z)=>R.sortKey-z.sortKey);const{lineAtlas:w,featureIndex:E}=n,C=this.addConstantDashes(w);for(const R of y){const{geometry:z,index:B,sourceLayerIndex:$}=R;if(C&&this.addFeatureDashes(R,w),this.hasPattern){const G=d("line",this.layers,R,this.zoom,n);this.patternFeatures.push(G)}else this.addFeature(R,z,B,a,w.positions,n.availableImages);E.insert(e[B].feature,z,B,$,this.index)}}addConstantDashes(e){let n=!1;for(const a of this.layers){const h=a.paint.get("line-dasharray").value,m=a.layout.get("line-cap").value;if(h.kind!=="constant"||m.kind!=="constant")n=!0;else{const y=m.value,w=h.value;if(!w)continue;e.addDash(w,y)}}return n}addFeatureDashes(e,n){const a=this.zoom;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,y=h.layout.get("line-cap").value;if(m.kind==="constant"&&y.kind==="constant")continue;let w,E;if(m.kind==="constant"){if(w=m.value,!w)continue}else w=m.evaluate({zoom:a},e);E=y.kind==="constant"?y.value:y.evaluate({zoom:a},e),n.addDash(w,E),e.patterns[h.id]=n.getKey(w,E)}}update(e,n,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,h)}addFeatures(e,n,a,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,n,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,vA)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,yA),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,a,h,m,y){const w=this.layers[0].layout,E=w.get("line-join").evaluate(e,{}),C=w.get("line-cap").evaluate(e,{}),R=w.get("line-miter-limit"),z=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const B of n)this.addLine(B,e,E,C,R,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,y,h)}addLine(e,n,a,h,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let fe=0;fe<e.length-1;fe++)this.totalDistance+=e[fe].dist(e[fe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=xA[n.type]==="Polygon";let E=e.length;for(;E>=2&&e[E-1].equals(e[E-2]);)E--;let C=0;for(;C<E-1&&e[C].equals(e[C+1]);)C++;if(E<(w?3:2))return;a==="bevel"&&(m=1.05);const R=this.overscaling<=16?15*nn/(512*this.overscaling):0,z=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let B,$,G,K,oe;this.e1=this.e2=-1,w&&(B=e[E-2],oe=e[C].sub(B)._unit()._perp());for(let fe=C;fe<E;fe++){if(G=fe===E-1?w?e[C+1]:void 0:e[fe+1],G&&e[fe].equals(G))continue;oe&&(K=oe),B&&($=B),B=e[fe],oe=G?G.sub(B)._unit()._perp():K,K=K||oe;let Te=K.add(oe);Te.x===0&&Te.y===0||Te._unit();const pe=K.x*oe.x+K.y*oe.y,be=Te.x*oe.x+Te.y*oe.y,ke=be!==0?1/be:1/0,Me=2*Math.sqrt(2-2*be),Ke=be<wA&&$&&G,We=K.x*oe.y-K.y*oe.x>0;if(Ke&&fe>C){const Qe=B.dist($);if(Qe>2*R){const ut=B.sub(B.sub($)._mult(R/Qe)._round());this.updateDistance($,ut),this.addCurrentVertex(ut,K,0,0,z),$=ut}}const st=$&&G;let bt=st?a:w?"butt":h;if(st&&bt==="round"&&(ke<y?bt="miter":ke<=2&&(bt="fakeround")),bt==="miter"&&ke>m&&(bt="bevel"),bt==="bevel"&&(ke>2&&(bt="flipbevel"),ke<m&&(bt="miter")),$&&this.updateDistance($,B),bt==="miter")Te._mult(ke),this.addCurrentVertex(B,Te,0,0,z);else if(bt==="flipbevel"){if(ke>100)Te=oe.mult(-1);else{const Qe=ke*K.add(oe).mag()/K.sub(oe).mag();Te._perp()._mult(Qe*(We?-1:1))}this.addCurrentVertex(B,Te,0,0,z),this.addCurrentVertex(B,Te.mult(-1),0,0,z)}else if(bt==="bevel"||bt==="fakeround"){const Qe=-Math.sqrt(ke*ke-1),ut=We?Qe:0,ct=We?0:Qe;if($&&this.addCurrentVertex(B,K,ut,ct,z),bt==="fakeround"){const _t=Math.round(180*Me/Math.PI/20);for(let At=1;At<_t;At++){let it=At/_t;if(it!==.5){const Yt=it-.5;it+=it*Yt*(it-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*Yt*Yt+(.848013+pe*(.215638*pe-1.06021)))}const jt=oe.sub(K)._mult(it)._add(K)._unit()._mult(We?-1:1);this.addHalfVertex(B,jt.x,jt.y,!1,We,0,z)}}G&&this.addCurrentVertex(B,oe,-ut,-ct,z)}else if(bt==="butt")this.addCurrentVertex(B,Te,0,0,z);else if(bt==="square"){const Qe=$?1:-1;$||this.addCurrentVertex(B,Te,Qe,Qe,z),this.addCurrentVertex(B,Te,0,0,z),$&&this.addCurrentVertex(B,Te,Qe,Qe,z)}else bt==="round"&&($&&(this.addCurrentVertex(B,K,0,0,z),this.addCurrentVertex(B,K,1,1,z,!0)),G&&(this.addCurrentVertex(B,oe,-1,-1,z,!0),this.addCurrentVertex(B,oe,0,0,z)));if(Ke&&fe<E-1){const Qe=B.dist(G);if(Qe>2*R){const ut=B.add(G.sub(B)._mult(R/Qe)._round());this.updateDistance(B,ut),this.addCurrentVertex(ut,oe,0,0,z),B=ut}}}}addCurrentVertex(e,n,a,h,m,y=!1){const w=n.y*h-n.x,E=-n.y-n.x*h;this.addHalfVertex(e,n.x+n.y*a,n.y-n.x*a,y,!1,a,m),this.addHalfVertex(e,w,E,y,!0,-h,m)}addHalfVertex({x:e,y:n},a,h,m,y,w,E){this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(n<<1)+(y?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(w===0?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const C=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),E.primitiveLength++),y?this.e2=C:this.e1=C}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}Vt(_g,"LineBucket",{omit:["layers","patternFeatures"]});const bA=new ve({"line-cap":new se(ot.layout_line["line-cap"]),"line-join":new se(ot.layout_line["line-join"]),"line-miter-limit":new X(ot.layout_line["line-miter-limit"]),"line-round-limit":new X(ot.layout_line["line-round-limit"]),"line-sort-key":new se(ot.layout_line["line-sort-key"])});var Ux={paint:new ve({"line-opacity":new se(ot.paint_line["line-opacity"]),"line-color":new se(ot.paint_line["line-color"]),"line-translate":new X(ot.paint_line["line-translate"]),"line-translate-anchor":new X(ot.paint_line["line-translate-anchor"]),"line-width":new se(ot.paint_line["line-width"]),"line-gap-width":new se(ot.paint_line["line-gap-width"]),"line-offset":new se(ot.paint_line["line-offset"]),"line-blur":new se(ot.paint_line["line-blur"]),"line-dasharray":new se(ot.paint_line["line-dasharray"]),"line-pattern":new se(ot.paint_line["line-pattern"]),"line-gradient":new ge(ot.paint_line["line-gradient"]),"line-trim-offset":new X(ot.paint_line["line-trim-offset"])}),layout:bA};const $x=new class extends se{possiblyEvaluate(t,e){return e=new L(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,a){return e=kt({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,a)}}(Ux.paint.properties["line-width"].specification);function Gx(t,e){return e>0?e+2*t:t}$x.useIntegerZoom=!0;const TA=Fe([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),EA=Fe([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),SA=Fe([{name:"a_projected_pos",components:4,type:"Float32"}],4);Fe([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const CA=Fe([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),AA=Fe([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Fe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const qx=Fe([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),MA=Fe([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Fe([{name:"triangle",components:3,type:"Uint16"}]),Fe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Fe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Fe([{type:"Float32",name:"offsetX"}]),Fe([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var no=24;const cl=128;function c_(t,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new L(t+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=n;let m=0;for(;m<a.length&&a[m]<=t;)m++;m=Math.max(0,m-1);let y=m;for(;y<a.length&&a[y]<t+1;)y++;y=Math.min(a.length-1,y);const w=a[m],E=a[y];return n.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:E,interpolationType:h}:{kind:"camera",minZoom:w,maxZoom:E,minSize:n.evaluate(new L(w)),maxSize:n.evaluate(new L(E)),interpolationType:h}}}function vg(t,{uSize:e,uSizeT:n},{lowerSize:a,upperSize:h}){return t.kind==="source"?a/cl:t.kind==="composite"?Zn(a/cl,h/cl,n):e}function wf(t,e){let n=0,a=0;if(t.kind==="constant")a=t.layoutSize;else if(t.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:y}=t,w=h?Et(ao.interpolationFactor(h,e,m,y),0,1):0;t.kind==="camera"?a=Zn(t.minSize,t.maxSize,w):n=w}return{uSizeT:n,uSize:a}}var kA=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:cl,evaluateSizeForFeature:vg,evaluateSizeForZoom:wf,getSizeData:c_});function PA(t,e,n){return t.sections.forEach(a=>{a.text=function(h,m,y){const w=m.layout.get("text-transform").evaluate(y,{});return w==="uppercase"?h=h.toLocaleUpperCase():w==="lowercase"&&(h=h.toLocaleLowerCase()),P.applyArabicShaping&&(h=P.applyArabicShaping(h)),h}(a.text,e,n)}),t}const Vp={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function IA(t){return t==="︶"||t==="﹈"||t==="︸"||t==="﹄"||t==="﹂"||t==="︾"||t==="︼"||t==="︺"||t==="︘"||t==="﹀"||t==="︐"||t==="︓"||t==="︔"||t==="｀"||t==="￣"||t==="︑"||t==="︒"}function RA(t){return t==="︵"||t==="﹇"||t==="︷"||t==="﹃"||t==="﹁"||t==="︽"||t==="︻"||t==="︹"||t==="︗"||t==="︿"}var Wx=xr,Zx=function(t,e,n,a,h){var m,y,w=8*h-a-1,E=(1<<w)-1,C=E>>1,R=-7,z=h-1,B=-1,$=t[e+z];for(z+=B,m=$&(1<<-R)-1,$>>=-R,R+=w;R>0;m=256*m+t[e+z],z+=B,R-=8);for(y=m&(1<<-R)-1,m>>=-R,R+=a;R>0;y=256*y+t[e+z],z+=B,R-=8);if(m===0)m=1-C;else{if(m===E)return y?NaN:1/0*($?-1:1);y+=Math.pow(2,a),m-=C}return($?-1:1)*y*Math.pow(2,m-a)},Hx=function(t,e,n,a,h,m){var y,w,E,C=8*m-h-1,R=(1<<C)-1,z=R>>1,B=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=0,G=1,K=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(w=isNaN(e)?1:0,y=R):(y=Math.floor(Math.log(e)/Math.LN2),e*(E=Math.pow(2,-y))<1&&(y--,E*=2),(e+=y+z>=1?B/E:B*Math.pow(2,1-z))*E>=2&&(y++,E/=2),y+z>=R?(w=0,y=R):y+z>=1?(w=(e*E-1)*Math.pow(2,h),y+=z):(w=e*Math.pow(2,z-1)*Math.pow(2,h),y=0));h>=8;t[n+$]=255&w,$+=G,w/=256,h-=8);for(y=y<<h|w,C+=h;C>0;t[n+$]=255&y,$+=G,y/=256,C-=8);t[n+$-G]|=128*K};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function xr(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}xr.Varint=0,xr.Fixed64=1,xr.Bytes=2,xr.Fixed32=5;var h_=4294967296,Xx=1/h_,Kx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function oc(t){return t.type===xr.Bytes?t.readVarint()+t.pos:t.pos+1}function bf(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Yx(t,e,n){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(a);for(var h=n.pos-1;h>=t;h--)n.buf[h+a]=n.buf[h]}function LA(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function DA(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function zA(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function OA(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function BA(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function FA(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function NA(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function jA(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function VA(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function xg(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Tf(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Jx(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}xr.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var a=this.readVarint(),h=a>>3,m=this.pos;this.type=7&a,t(h,e,this),this.pos===m&&this.skip(a)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=xg(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Jx(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=xg(this.buf,this.pos)+xg(this.buf,this.pos+4)*h_;return this.pos+=8,t},readSFixed64:function(){var t=xg(this.buf,this.pos)+Jx(this.buf,this.pos+4)*h_;return this.pos+=8,t},readFloat:function(){var t=Zx(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Zx(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,a=this.buf;return e=127&(n=a[this.pos++]),n<128?e:(e|=(127&(n=a[this.pos++]))<<7,n<128?e:(e|=(127&(n=a[this.pos++]))<<14,n<128?e:(e|=(127&(n=a[this.pos++]))<<21,n<128?e:function(h,m,y){var w,E,C=y.buf;if(w=(112&(E=C[y.pos++]))>>4,E<128||(w|=(127&(E=C[y.pos++]))<<3,E<128)||(w|=(127&(E=C[y.pos++]))<<10,E<128)||(w|=(127&(E=C[y.pos++]))<<17,E<128)||(w|=(127&(E=C[y.pos++]))<<24,E<128)||(w|=(1&(E=C[y.pos++]))<<31,E<128))return bf(h,w,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=a[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Kx?function(n,a,h){return Kx.decode(n.subarray(a,h))}(this.buf,e,t):function(n,a,h){for(var m="",y=a;y<h;){var w,E,C,R=n[y],z=null,B=R>239?4:R>223?3:R>191?2:1;if(y+B>h)break;B===1?R<128&&(z=R):B===2?(192&(w=n[y+1]))==128&&(z=(31&R)<<6|63&w)<=127&&(z=null):B===3?(E=n[y+2],(192&(w=n[y+1]))==128&&(192&E)==128&&((z=(15&R)<<12|(63&w)<<6|63&E)<=2047||z>=55296&&z<=57343)&&(z=null)):B===4&&(E=n[y+2],C=n[y+3],(192&(w=n[y+1]))==128&&(192&E)==128&&(192&C)==128&&((z=(15&R)<<18|(63&w)<<12|(63&E)<<6|63&C)<=65535||z>=1114112)&&(z=null)),z===null?(z=65533,B=1):z>65535&&(z-=65536,m+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),m+=String.fromCharCode(z),y+=B}return m}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==xr.Bytes)return t.push(this.readVarint(e));var n=oc(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==xr.Bytes)return t.push(this.readSVarint());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==xr.Bytes)return t.push(this.readBoolean());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==xr.Bytes)return t.push(this.readFloat());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==xr.Bytes)return t.push(this.readDouble());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==xr.Bytes)return t.push(this.readFixed32());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==xr.Bytes)return t.push(this.readSFixed32());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==xr.Bytes)return t.push(this.readFixed64());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==xr.Bytes)return t.push(this.readSFixed64());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===xr.Varint)for(;this.buf[this.pos++]>127;);else if(e===xr.Bytes)this.pos=this.readVarint()+this.pos;else if(e===xr.Fixed32)this.pos+=4;else{if(e!==xr.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Tf(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Tf(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Tf(this.buf,-1&t,this.pos),Tf(this.buf,Math.floor(t*Xx),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Tf(this.buf,-1&t,this.pos),Tf(this.buf,Math.floor(t*Xx),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var a,h;if(e>=0?(a=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(m,y,w){w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,w.buf[w.pos]=127&(m>>>=7)}(a,0,n),function(m,y){var w=(7&m)<<4;y.buf[y.pos++]|=w|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(h,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(a,h,m){for(var y,w,E=0;E<h.length;E++){if((y=h.charCodeAt(E))>55295&&y<57344){if(!w){y>56319||E+1===h.length?(a[m++]=239,a[m++]=191,a[m++]=189):w=y;continue}if(y<56320){a[m++]=239,a[m++]=191,a[m++]=189,w=y;continue}y=w-55296<<10|y-56320|65536,w=null}else w&&(a[m++]=239,a[m++]=191,a[m++]=189,w=null);y<128?a[m++]=y:(y<2048?a[m++]=y>>6|192:(y<65536?a[m++]=y>>12|224:(a[m++]=y>>18|240,a[m++]=y>>12&63|128),a[m++]=y>>6&63|128),a[m++]=63&y|128)}return m}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Yx(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Hx(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Hx(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var a=this.pos-n;a>=128&&Yx(n,a,this),this.pos=n-1,this.writeVarint(a),this.pos+=a},writeMessage:function(t,e,n){this.writeTag(t,xr.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,LA,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,DA,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,BA,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,zA,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,OA,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,FA,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,NA,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,jA,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,VA,e)},writeBytesField:function(t,e){this.writeTag(t,xr.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,xr.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,xr.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,xr.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,xr.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,xr.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,xr.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,xr.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,xr.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,xr.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var wg=me(Wx);const d_=3;function UA(t,e,n){e.glyphs=[],t===1&&n.readMessage($A,e)}function $A(t,e,n){if(t===3){const{id:a,bitmap:h,width:m,height:y,left:w,top:E,advance:C}=n.readMessage(GA,{});e.glyphs.push({id:a,bitmap:new Zo({width:m+2*d_,height:y+2*d_},h),metrics:{width:m,height:y,left:w,top:E,advance:C}})}else t===4?e.ascender=n.readSVarint():t===5&&(e.descender=n.readSVarint())}function GA(t,e,n){t===1?e.id=n.readVarint():t===2?e.bitmap=n.readBytes():t===3?e.width=n.readVarint():t===4?e.height=n.readVarint():t===5?e.left=n.readSVarint():t===6?e.top=n.readSVarint():t===7&&(e.advance=n.readVarint())}const qA=d_;function f_(t){let e=0,n=0;for(const y of t)e+=y.w*y.h,n=Math.max(n,y.w);t.sort((y,w)=>w.h-y.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let h=0,m=0;for(const y of t)for(let w=a.length-1;w>=0;w--){const E=a[w];if(!(y.w>E.w||y.h>E.h)){if(y.x=E.x,y.y=E.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===E.w&&y.h===E.h){const C=a.pop();w<a.length&&(a[w]=C)}else y.h===E.h?(E.x+=y.w,E.w-=y.w):y.w===E.w?(E.y+=y.h,E.h-=y.h):(a.push({x:E.x+y.w,y:E.y,w:E.w-y.w,h:y.h}),E.y+=y.h,E.h-=y.h);break}}return{w:h,h:m,fill:e/(h*m)||0}}const ps=1;class p_{constructor(e,{pixelRatio:n,version:a,stretchX:h,stretchY:m,content:y}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=h,this.stretchY=m,this.content=y,this.version=a}get tl(){return[this.paddedRect.x+ps,this.paddedRect.y+ps]}get br(){return[this.paddedRect.x+this.paddedRect.w-ps,this.paddedRect.y+this.paddedRect.h-ps]}get displaySize(){return[(this.paddedRect.w-2*ps)/this.pixelRatio,(this.paddedRect.h-2*ps)/this.pixelRatio]}}class Qx{constructor(e,n){const a={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,a,m),this.addImages(n,h,m);const{w:y,h:w}=f_(m),E=new Po({width:y||1,height:w||1});for(const C in e){const R=e[C],z=a[C].paddedRect;Po.copy(R.data,E,{x:0,y:0},{x:z.x+ps,y:z.y+ps},R.data)}for(const C in n){const R=n[C],z=h[C].paddedRect,B=z.x+ps,$=z.y+ps,G=R.data.width,K=R.data.height;Po.copy(R.data,E,{x:0,y:0},{x:B,y:$},R.data),Po.copy(R.data,E,{x:0,y:K-1},{x:B,y:$-1},{width:G,height:1}),Po.copy(R.data,E,{x:0,y:0},{x:B,y:$+K},{width:G,height:1}),Po.copy(R.data,E,{x:G-1,y:0},{x:B-1,y:$},{width:1,height:K}),Po.copy(R.data,E,{x:0,y:0},{x:B+G,y:$},{width:1,height:K})}this.image=E,this.iconPositions=a,this.patternPositions=h}addImages(e,n,a){for(const h in e){const m=e[h],y={x:0,y:0,w:m.data.width+2*ps,h:m.data.height+2*ps};a.push(y),n[h]=new p_(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),n),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),n)}patchUpdatedImage(e,n,a){if(!e||!n||e.version===n.version)return;e.version=n.version;const[h,m]=e.tl;a.update(n.data,void 0,{x:h,y:m})}}Vt(p_,"ImagePosition"),Vt(Qx,"ImageAtlas");const na={horizontal:1,vertical:2,horizontalOnly:3},e1=-17;class Up{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const a=new Up;return a.scale=e||1,a.fontStack=n,a}static forImage(e){const n=new Up;return n.imageName=e,n}}class Ef{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const a=new Ef;for(let h=0;h<e.sections.length;h++){const m=e.sections[h];m.image?a.addImageSection(m):a.addTextSection(m,n)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,a){let h="";for(let m=0;m<n.length;m++){const y=n.charCodeAt(m+1)||null,w=n.charCodeAt(m-1)||null;h+=!a&&(y&&Eo(y)&&!Vp[n[m+1]]||w&&Eo(w)&&!Vp[n[m-1]])||!Vp[n[m]]?n[m]:Vp[n[m]]}return h}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&bg[this.text.charCodeAt(a)];a++)e++;let n=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&bg[this.text.charCodeAt(a)];a--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const a=new Ef;return a.text=this.text.substring(e,n),a.sectionIndex=this.sectionIndex.slice(e,n),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Up.forText(e.scale,e.fontStack||n));const a=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(a)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void Nn("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Up.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Nn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function m_(t,e,n,a,h,m,y,w,E,C,R,z,B,$,G){const K=Ef.fromFeature(t,h);z===na.vertical&&K.verticalizePunctuation(B);let oe=[];const fe=function(Me,Ke,We,st,bt,Qe){if(!Me)return[];const ut=[],ct=function(jt,Yt,Gt,An,Mt,rn){let Mn=0;for(let sr=0;sr<jt.length();sr++){const kn=jt.getSection(sr);Mn+=t1(jt.getCharCode(sr),kn,An,Mt,Yt,rn)}return Mn/Math.max(1,Math.ceil(Mn/Gt))}(Me,Ke,We,st,bt,Qe),_t=Me.text.indexOf("​")>=0;let At=0;for(let jt=0;jt<Me.length();jt++){const Yt=Me.getSection(jt),Gt=Me.getCharCode(jt);if(bg[Gt]||(At+=t1(Gt,Yt,st,bt,Ke,Qe)),jt<Me.length()-1){const An=!((it=Gt)<11904||!(Bt["Bopomofo Extended"](it)||Bt.Bopomofo(it)||Bt["CJK Compatibility Forms"](it)||Bt["CJK Compatibility Ideographs"](it)||Bt["CJK Compatibility"](it)||Bt["CJK Radicals Supplement"](it)||Bt["CJK Strokes"](it)||Bt["CJK Symbols and Punctuation"](it)||Bt["CJK Unified Ideographs Extension A"](it)||Bt["CJK Unified Ideographs"](it)||Bt["Enclosed CJK Letters and Months"](it)||Bt["Halfwidth and Fullwidth Forms"](it)||Bt.Hiragana(it)||Bt["Ideographic Description Characters"](it)||Bt["Kangxi Radicals"](it)||Bt["Katakana Phonetic Extensions"](it)||Bt.Katakana(it)||Bt["Vertical Forms"](it)||Bt["Yi Radicals"](it)||Bt["Yi Syllables"](it)));(WA[Gt]||An||Yt.imageName)&&ut.push(r1(jt+1,At,ct,ut,ZA(Gt,Me.getCharCode(jt+1),An&&_t),!1))}}var it;return i1(r1(Me.length(),At,ct,ut,0,!0))}(K,C,m,e,a,$),{processBidirectionalText:Te,processStyledBidirectionalText:pe}=P;if(Te&&K.sections.length===1){const Me=Te(K.toString(),fe);for(const Ke of Me){const We=new Ef;We.text=Ke,We.sections=K.sections;for(let st=0;st<Ke.length;st++)We.sectionIndex.push(0);oe.push(We)}}else if(pe){const Me=pe(K.text,K.sectionIndex,fe);for(const Ke of Me){const We=new Ef;We.text=Ke[0],We.sectionIndex=Ke[1],We.sections=K.sections,oe.push(We)}}else oe=function(Me,Ke){const We=[],st=Me.text;let bt=0;for(const Qe of Ke)We.push(Me.substring(bt,Qe)),bt=Qe;return bt<st.length&&We.push(Me.substring(bt,st.length)),We}(K,fe);const be=[],ke={positionedLines:be,text:K.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Me,Ke,We,st,bt,Qe,ut,ct,_t,At,it,jt){let Yt=0,Gt=0,An=0;const Mt=ct==="right"?1:ct==="left"?0:.5;let rn=!1;for(const In of bt){const Rn=In.getSections();for(const mr of Rn){if(mr.imageName)continue;const wr=Ke[mr.fontStack];if(wr&&(rn=wr.ascender!==void 0&&wr.descender!==void 0,!rn))break}if(!rn)break}let Mn=0;for(const In of bt){In.trim();const Rn=In.getMaxScale(),mr=(Rn-1)*no,wr={positionedGlyphs:[],lineOffset:0};Me.positionedLines[Mn]=wr;const br=wr.positionedGlyphs;let gr=0;if(!In.length()){Gt+=Qe,++Mn;continue}let $r=0,ni=0;for(let yr=0;yr<In.length();yr++){const Ci=In.getSection(yr),di=In.getSectionIndex(yr),Xr=In.getCharCode(yr);let cr=Ci.scale,fi=null,Tr=null,Xo=null,pi=no,ro=0;const Gi=!(_t===na.horizontal||!it&&!ql(Xr)||it&&(bg[Xr]||(sr=Xr,Bt.Arabic(sr)||Bt["Arabic Supplement"](sr)||Bt["Arabic Extended-A"](sr)||Bt["Arabic Presentation Forms-A"](sr)||Bt["Arabic Presentation Forms-B"](sr))));if(Ci.imageName){const Ko=st[Ci.imageName];if(!Ko)continue;Xo=Ci.imageName,Me.iconsInText=Me.iconsInText||!0,Tr=Ko.paddedRect;const qi=Ko.displaySize;cr=cr*no/jt,fi={width:qi[0],height:qi[1],left:ps,top:-3,advance:Gi?qi[1]:qi[0],localGlyph:!1},ro=rn?-fi.height*cr:e1+Rn*no-qi[1]*cr,pi=fi.advance;const fl=(Gi?qi[0]:qi[1])*cr-no*Rn;fl>0&&fl>gr&&(gr=fl)}else{const Ko=We[Ci.fontStack];if(!Ko)continue;Ko[Xr]&&(Tr=Ko[Xr]);const qi=Ke[Ci.fontStack];if(!qi)continue;const fl=qi.glyphs[Xr];if(!fl)continue;if(fi=fl.metrics,pi=Xr!==8203?no:0,rn){const Pf=qi.ascender!==void 0?Math.abs(qi.ascender):0,Jp=qi.descender!==void 0?Math.abs(qi.descender):0,Qp=(Pf+Jp)*cr;$r<Qp&&($r=Qp,ni=(Pf-Jp)/2*cr),ro=-Pf*cr}else ro=e1+(Rn-cr)*no}Gi?(Me.verticalizable=!0,br.push({glyph:Xr,imageName:Xo,x:Yt,y:Gt+ro,vertical:Gi,scale:cr,localGlyph:fi.localGlyph,fontStack:Ci.fontStack,sectionIndex:di,metrics:fi,rect:Tr}),Yt+=pi*cr+At):(br.push({glyph:Xr,imageName:Xo,x:Yt,y:Gt+ro,vertical:Gi,scale:cr,localGlyph:fi.localGlyph,fontStack:Ci.fontStack,sectionIndex:di,metrics:fi,rect:Tr}),Yt+=fi.advance*cr+At)}br.length!==0&&(An=Math.max(Yt-At,An),rn?o1(br,Mt,gr,ni,Qe*Rn/2):o1(br,Mt,gr,0,Qe/2)),Yt=0;const hi=Qe*Rn+gr;wr.lineOffset=Math.max(gr,mr),Gt+=hi,++Mn}var sr;const kn=Gt,{horizontalAlign:gn,verticalAlign:kr}=g_(ut);(function(In,Rn,mr,wr,br,gr){const $r=(Rn-mr)*br,ni=-gr*wr;for(const hi of In)for(const yr of hi.positionedGlyphs)yr.x+=$r,yr.y+=ni})(Me.positionedLines,Mt,gn,kr,An,kn),Me.top+=-kr*kn,Me.bottom=Me.top+kn,Me.left+=-gn*An,Me.right=Me.left+An,Me.hasBaseline=rn}(ke,e,n,a,oe,y,w,E,z,C,B,G),!function(Me){for(const Ke of Me)if(Ke.positionedGlyphs.length!==0)return!1;return!0}(be)&&ke}const bg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},WA={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function t1(t,e,n,a,h,m){if(e.imageName){const y=a[e.imageName];return y?y.displaySize[0]*e.scale*no/m+h:0}{const y=n[e.fontStack],w=y&&y.glyphs[t];return w?w.metrics.advance*e.scale+h:0}}function n1(t,e,n,a){const h=Math.pow(t-e,2);return a?t<e?h/2:2*h:h+Math.abs(n)*n}function ZA(t,e,n){let a=0;return t===10&&(a-=1e4),n&&(a+=150),t!==40&&t!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function r1(t,e,n,a,h,m){let y=null,w=n1(e,n,h,m);for(const E of a){const C=n1(e-E.x,n,h,m)+E.badness;C<=w&&(y=E,w=C)}return{index:t,x:e,priorBreak:y,badness:w}}function i1(t){return t?i1(t.priorBreak).concat(t.index):[]}function g_(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function o1(t,e,n,a,h){if(!(e||n||a||h))return;const m=t.length-1,y=t[m],w=(y.x+y.metrics.advance*y.scale)*e;for(let E=0;E<=m;E++)t[E].x-=w,t[E].y+=n+a+h}function HA(t,e,n){const{horizontalAlign:a,verticalAlign:h}=g_(n),m=e[0]-t.displaySize[0]*a,y=e[1]-t.displaySize[1]*h;return{image:t,top:y,bottom:y+t.displaySize[1],left:m,right:m+t.displaySize[0]}}function s1(t,e,n,a,h,m){const y=t.image;let w;if(y.content){const oe=y.content,fe=y.pixelRatio||1;w=[oe[0]/fe,oe[1]/fe,y.displaySize[0]-oe[2]/fe,y.displaySize[1]-oe[3]/fe]}const E=e.left*m,C=e.right*m;let R,z,B,$;n==="width"||n==="both"?($=h[0]+E-a[3],z=h[0]+C+a[1]):($=h[0]+(E+C-y.displaySize[0])/2,z=$+y.displaySize[0]);const G=e.top*m,K=e.bottom*m;return n==="height"||n==="both"?(R=h[1]+G-a[0],B=h[1]+K+a[2]):(R=h[1]+(G+K-y.displaySize[1])/2,B=R+y.displaySize[1]),{image:y,top:R,right:z,bottom:B,left:$,collisionPadding:w}}class sc extends Y{constructor(e,n,a,h,m){super(e,n),this.angle=h,this.z=a,m!==void 0&&(this.segment=m)}clone(){return new sc(this.x,this.y,this.z,this.angle,this.segment)}}function a1(t,e,n,a,h){if(e.segment===void 0)return!0;let m=e,y=e.segment+1,w=0;for(;w>-n/2;){if(y--,y<0)return!1;w-=t[y].dist(m),m=t[y]}w+=t[y].dist(t[y+1]),y++;const E=[];let C=0;for(;w<n/2;){const R=t[y],z=t[y+1];if(!z)return!1;let B=t[y-1].angleTo(R)-R.angleTo(z);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:w,angleDelta:B}),C+=B;w-E[0].distance>a;)C-=E.shift().angleDelta;if(C>h)return!1;y++,w+=R.dist(z)}return!0}function l1(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function u1(t,e,n){return t?.6*e*n:0}function c1(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function XA(t,e,n,a,h,m){const y=u1(n,h,m),w=c1(n,a)*m;let E=0;const C=l1(t)/2;for(let R=0;R<t.length-1;R++){const z=t[R],B=t[R+1],$=z.dist(B);if(E+$>C){const G=(C-E)/$,K=Zn(z.x,B.x,G),oe=Zn(z.y,B.y,G),fe=new sc(K,oe,0,B.angleTo(z),R);return!y||a1(t,fe,w,y,e)?fe:void 0}E+=$}}function KA(t,e,n,a,h,m,y,w,E){const C=u1(a,m,y),R=c1(a,h),z=R*y,B=t[0].x===0||t[0].x===E||t[0].y===0||t[0].y===E;return e-z<e/4&&(e=z+e/4),h1(t,B?e/2*w%e:(R/2+2*m)*y*w%e,e,C,n,z,B,!1,E)}function h1(t,e,n,a,h,m,y,w,E){const C=m/2,R=l1(t);let z=0,B=e-n,$=[];for(let G=0;G<t.length-1;G++){const K=t[G],oe=t[G+1],fe=K.dist(oe),Te=oe.angleTo(K);for(;B+n<z+fe;){B+=n;const pe=(B-z)/fe,be=Zn(K.x,oe.x,pe),ke=Zn(K.y,oe.y,pe);if(be>=0&&be<E&&ke>=0&&ke<E&&B-C>=0&&B+C<=R){const Me=new sc(be,ke,0,Te,G);Me._round(),a&&!a1(t,Me,m,a,h)||$.push(Me)}}z+=fe}return w||$.length||y||($=h1(t,z/2,n,a,h,m,y,!0,E)),$}function d1(t,e,n,a,h){const m=[];for(let y=0;y<t.length;y++){const w=t[y];let E;for(let C=0;C<w.length-1;C++){let R=w[C],z=w[C+1];R.x<e&&z.x<e||(R.x<e?R=new Y(e,R.y+(e-R.x)/(z.x-R.x)*(z.y-R.y))._round():z.x<e&&(z=new Y(e,R.y+(e-R.x)/(z.x-R.x)*(z.y-R.y))._round()),R.y<n&&z.y<n||(R.y<n?R=new Y(R.x+(n-R.y)/(z.y-R.y)*(z.x-R.x),n)._round():z.y<n&&(z=new Y(R.x+(n-R.y)/(z.y-R.y)*(z.x-R.x),n)._round()),R.x>=a&&z.x>=a||(R.x>=a?R=new Y(a,R.y+(a-R.x)/(z.x-R.x)*(z.y-R.y))._round():z.x>=a&&(z=new Y(a,R.y+(a-R.x)/(z.x-R.x)*(z.y-R.y))._round()),R.y>=h&&z.y>=h||(R.y>=h?R=new Y(R.x+(h-R.y)/(z.y-R.y)*(z.x-R.x),h)._round():z.y>=h&&(z=new Y(R.x+(h-R.y)/(z.y-R.y)*(z.x-R.x),h)._round()),E&&R.equals(E[E.length-1])||(E=[R],m.push(E)),E.push(z)))))}}return m}Vt(sc,"Anchor");const Tg=1e20;function f1(t,e,n,a,h,m,y,w,E){for(let C=e;C<e+a;C++)p1(t,n*m+C,m,h,y,w,E);for(let C=n;C<n+h;C++)p1(t,C*m+e,1,a,y,w,E)}function p1(t,e,n,a,h,m,y){m[0]=0,y[0]=-1e20,y[1]=Tg,h[0]=t[e];for(let w=1,E=0,C=0;w<a;w++){h[w]=t[e+w*n];const R=w*w;do{const z=m[E];C=(h[w]-h[z]+R-z*z)/(w-z)/2}while(C<=y[E]&&--E>-1);E++,m[E]=w,y[E]=C,y[E+1]=Tg}for(let w=0,E=0;w<a;w++){for(;y[E+1]<w;)E++;const C=m[E],R=w-C;t[e+w*n]=h[C]+R*R}}const hl=2,y_={none:0,ideographs:1,all:2};class Sf{constructor(e,n,a){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const a=[];for(const h in e)for(const m of e[h])a.push({stack:h,id:m});Ue(a,({stack:h,id:m},y)=>{let w=this.entries[h];w||(w=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=w.glyphs[m];if(E!==void 0)return void y(null,{stack:h,id:m,glyph:E});if(E=this._tinySDF(w,h,m),E)return w.glyphs[m]=E,void y(null,{stack:h,id:m,glyph:E});const C=Math.floor(m/256);if(256*C>65535)return void y(new Error("glyphs > 65535 not supported"));if(w.ranges[C])return void y(null,{stack:h,id:m,glyph:E});let R=w.requests[C];R||(R=w.requests[C]=[],Sf.loadGlyphRange(h,C,this.url,this.requestManager,(z,B)=>{if(B){w.ascender=B.ascender,w.descender=B.descender;for(const $ in B.glyphs)this._doesCharSupportLocalGlyph(+$)||(w.glyphs[+$]=B.glyphs[+$]);w.ranges[C]=!0}for(const $ of R)$(z,B);delete w.requests[C]})),R.push((z,B)=>{z?y(z):B&&y(null,{stack:h,id:m,glyph:B.glyphs[m]||null})})},(h,m)=>{if(h)n(h);else if(m){const y={};for(const{stack:w,id:E,glyph:C}of m)y[w]===void 0&&(y[w]={}),y[w].glyphs===void 0&&(y[w].glyphs={}),y[w].glyphs[E]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},y[w].ascender=this.entries[w].ascender,y[w].descender=this.entries[w].descender;n(null,y)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==y_.none&&(this.localGlyphMode===y_.all?!!this.localFontFamily:!!this.localFontFamily&&(Bt["CJK Unified Ideographs"](e)||Bt["Hangul Syllables"](e)||Bt.Hiragana(e)||Bt.Katakana(e)||Bt["CJK Symbols and Punctuation"](e)))}_tinySDF(e,n,a){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(a))return;let m=e.tinySDF;if(!m){let K="400";/bold/i.test(n)?K="900":/medium/i.test(n)?K="500":/light/i.test(n)&&(K="200"),m=e.tinySDF=new Sf.TinySDF({fontFamily:h,fontWeight:K,fontSize:24*hl,buffer:3*hl,radius:8*hl}),m.fontWeight=K}if(this.localGlyphs[m.fontWeight][a])return this.localGlyphs[m.fontWeight][a];const y=String.fromCharCode(a),{data:w,width:E,height:C,glyphWidth:R,glyphHeight:z,glyphLeft:B,glyphTop:$,glyphAdvance:G}=m.draw(y);return this.localGlyphs[m.fontWeight][a]={id:a,bitmap:new Zo({width:E,height:C},w),metrics:{width:R/hl,height:z/hl,left:B/hl,top:$/hl-27,advance:G/hl,localGlyph:!0}}}}Sf.loadGlyphRange=function(t,e,n,a,h){const m=256*e,y=m+255,w=a.transformRequest(a.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${m}-${y}`),Yr.Glyphs);gs(w,(E,C)=>{if(E)h(E);else if(C){const R={},z=function(B){return new wg(B).readFields(UA,{})}(C);for(const B of z.glyphs)R[B.id]=B;h(null,{glyphs:R,ascender:z.ascender,descender:z.descender})}})},Sf.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:a=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=a,this.radius=n;const w=this.size=t+4*e,E=this._createCanvas(w),C=this.ctx=E.getContext("2d",{willReadFrequently:!0});C.font=`${y} ${m} ${t}px ${h}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:a,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(t),y=Math.ceil(n),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),E=Math.min(this.size-this.buffer,y+Math.ceil(a)),C=w+2*this.buffer,R=E+2*this.buffer,z=Math.max(C*R,0),B=new Uint8ClampedArray(z),$={data:B,width:C,height:R,glyphWidth:w,glyphHeight:E,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(w===0||E===0)return $;const{ctx:G,buffer:K,gridInner:oe,gridOuter:fe}=this;G.clearRect(K,K,w,E),G.fillText(t,K,K+y);const Te=G.getImageData(K,K,w,E);fe.fill(Tg,0,z),oe.fill(0,0,z);for(let pe=0;pe<E;pe++)for(let be=0;be<w;be++){const ke=Te.data[4*(pe*w+be)+3]/255;if(ke===0)continue;const Me=(pe+K)*C+be+K;if(ke===1)fe[Me]=0,oe[Me]=Tg;else{const Ke=.5-ke;fe[Me]=Ke>0?Ke*Ke:0,oe[Me]=Ke<0?Ke*Ke:0}}f1(fe,0,0,C,R,C,this.f,this.v,this.z),f1(oe,K,K,w,E,C,this.f,this.v,this.z);for(let pe=0;pe<z;pe++){const be=Math.sqrt(fe[pe])-Math.sqrt(oe[pe]);B[pe]=Math.round(255-255*(be/this.radius+this.cutoff))}return $}};const $p=ps;function m1(t,e,n,a){const h=[],m=t.image,y=m.pixelRatio,w=m.paddedRect.w-2*$p,E=m.paddedRect.h-2*$p,C=t.right-t.left,R=t.bottom-t.top,z=m.stretchX||[[0,w]],B=m.stretchY||[[0,E]],$=(Qe,ut)=>Qe+ut[1]-ut[0],G=z.reduce($,0),K=B.reduce($,0),oe=w-G,fe=E-K;let Te=0,pe=G,be=0,ke=K,Me=0,Ke=oe,We=0,st=fe;if(m.content&&a){const Qe=m.content;Te=Eg(z,0,Qe[0]),be=Eg(B,0,Qe[1]),pe=Eg(z,Qe[0],Qe[2]),ke=Eg(B,Qe[1],Qe[3]),Me=Qe[0]-Te,We=Qe[1]-be,Ke=Qe[2]-Qe[0]-pe,st=Qe[3]-Qe[1]-ke}const bt=(Qe,ut,ct,_t)=>{const At=Sg(Qe.stretch-Te,pe,C,t.left),it=Cg(Qe.fixed-Me,Ke,Qe.stretch,G),jt=Sg(ut.stretch-be,ke,R,t.top),Yt=Cg(ut.fixed-We,st,ut.stretch,K),Gt=Sg(ct.stretch-Te,pe,C,t.left),An=Cg(ct.fixed-Me,Ke,ct.stretch,G),Mt=Sg(_t.stretch-be,ke,R,t.top),rn=Cg(_t.fixed-We,st,_t.stretch,K),Mn=new Y(At,jt),sr=new Y(Gt,jt),kn=new Y(Gt,Mt),gn=new Y(At,Mt),kr=new Y(it/y,Yt/y),In=new Y(An/y,rn/y),Rn=e*Math.PI/180;if(Rn){const br=Math.sin(Rn),gr=Math.cos(Rn),$r=[gr,-br,br,gr];Mn._matMult($r),sr._matMult($r),gn._matMult($r),kn._matMult($r)}const mr=Qe.stretch+Qe.fixed,wr=ut.stretch+ut.fixed;return{tl:Mn,tr:sr,bl:gn,br:kn,tex:{x:m.paddedRect.x+$p+mr,y:m.paddedRect.y+$p+wr,w:ct.stretch+ct.fixed-mr,h:_t.stretch+_t.fixed-wr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:kr,pixelOffsetBR:In,minFontScaleX:Ke/y/C,minFontScaleY:st/y/R,isSDF:n}};if(a&&(m.stretchX||m.stretchY)){const Qe=g1(z,oe,G),ut=g1(B,fe,K);for(let ct=0;ct<Qe.length-1;ct++){const _t=Qe[ct],At=Qe[ct+1];for(let it=0;it<ut.length-1;it++)h.push(bt(_t,ut[it],At,ut[it+1]))}}else h.push(bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:E+1}));return h}function Eg(t,e,n){let a=0;for(const h of t)a+=Math.max(e,Math.min(n,h[1]))-Math.max(e,Math.min(n,h[0]));return a}function g1(t,e,n){const a=[{fixed:-1,stretch:0}];for(const[h,m]of t){const y=a[a.length-1];a.push({fixed:h-y.stretch,stretch:y.stretch}),a.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return a.push({fixed:e+$p,stretch:n}),a}function Sg(t,e,n,a){return t/e*n+a}function Cg(t,e,n,a){return t-e*n/a}function YA(t,e,n,a){const h=e+t.positionedLines[a].lineOffset;return a===0?n+h/2:n+(h+(e+t.positionedLines[a-1].lineOffset))/2}class JA{constructor(e=[],n=QA){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:a}=this,h=n[e];for(;e>0;){const m=e-1>>1,y=n[m];if(a(h,y)>=0)break;n[e]=y,e=m}n[e]=h}_down(e){const{data:n,compare:a}=this,h=this.length>>1,m=n[e];for(;e<h;){let y=1+(e<<1),w=n[y];const E=y+1;if(E<this.length&&a(n[E],w)<0&&(y=E,w=n[E]),a(w,m)>=0)break;n[e]=w,e=y}n[e]=m}}function QA(t,e){return t<e?-1:t>e?1:0}function eM(t,e=1,n=!1){let a=1/0,h=1/0,m=-1/0,y=-1/0;const w=t[0];for(let $=0;$<w.length;$++){const G=w[$];(!$||G.x<a)&&(a=G.x),(!$||G.y<h)&&(h=G.y),(!$||G.x>m)&&(m=G.x),(!$||G.y>y)&&(y=G.y)}const E=Math.min(m-a,y-h);let C=E/2;const R=new JA([],tM);if(E===0)return new Y(a,h);for(let $=a;$<m;$+=E)for(let G=h;G<y;G+=E)R.push(new Cf($+C,G+C,C,t));let z=function($){let G=0,K=0,oe=0;const fe=$[0];for(let Te=0,pe=fe.length,be=pe-1;Te<pe;be=Te++){const ke=fe[Te],Me=fe[be],Ke=ke.x*Me.y-Me.x*ke.y;K+=(ke.x+Me.x)*Ke,oe+=(ke.y+Me.y)*Ke,G+=3*Ke}return new Cf(K/G,oe/G,0,$)}(t),B=R.length;for(;R.length;){const $=R.pop();($.d>z.d||!z.d)&&(z=$,n&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,B)),$.max-z.d<=e||(C=$.h/2,R.push(new Cf($.p.x-C,$.p.y-C,C,t)),R.push(new Cf($.p.x+C,$.p.y-C,C,t)),R.push(new Cf($.p.x-C,$.p.y+C,C,t)),R.push(new Cf($.p.x+C,$.p.y+C,C,t)),B+=4)}return n&&(console.log(`num probes: ${B}`),console.log(`best distance: ${z.d}`)),z.p}function tM(t,e){return e.max-t.max}class Cf{constructor(e,n,a,h){this.p=new Y(e,n),this.h=a,this.d=function(m,y){let w=!1,E=1/0;for(let C=0;C<y.length;C++){const R=y[C];for(let z=0,B=R.length,$=B-1;z<B;$=z++){const G=R[z],K=R[$];G.y>m.y!=K.y>m.y&&m.x<(K.x-G.x)*(m.y-G.y)/(K.y-G.y)+G.x&&(w=!w),E=Math.min(E,Sp(m,G,K))}}return(w?1:-1)*Math.sqrt(E)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}}const Af=7,__=Number.POSITIVE_INFINITY,nM=Math.sqrt(2);function y1(t,[e,n]){let a=0,h=0;if(n===__){e<0&&(e=0);const m=e/nM;switch(t){case"top-right":case"top-left":h=m-Af;break;case"bottom-right":case"bottom-left":h=-m+Af;break;case"bottom":h=-e+Af;break;case"top":h=e-Af}switch(t){case"top-right":case"bottom-right":a=-m;break;case"top-left":case"bottom-left":a=m;break;case"left":a=e;break;case"right":a=-e}}else{switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":h=n-Af;break;case"bottom-right":case"bottom-left":case"bottom":h=-n+Af}switch(t){case"top-right":case"bottom-right":case"right":a=-e;break;case"top-left":case"bottom-left":case"left":a=e}}return[a,h]}function rM(t,e,n,a,h,m,y,w,E,C){t.createArrays(),t.tilePixelRatio=nn/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const R=t.layers[0].layout,z=t.layers[0]._unevaluatedLayout._values,B={};if(t.textSizeData.kind==="composite"){const{minZoom:K,maxZoom:oe}=t.textSizeData;B.compositeTextSizes=[z["text-size"].possiblyEvaluate(new L(K),w),z["text-size"].possiblyEvaluate(new L(oe),w)]}if(t.iconSizeData.kind==="composite"){const{minZoom:K,maxZoom:oe}=t.iconSizeData;B.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new L(K),w),z["icon-size"].possiblyEvaluate(new L(oe),w)]}B.layoutTextSize=z["text-size"].possiblyEvaluate(new L(E+1),w),B.layoutIconSize=z["icon-size"].possiblyEvaluate(new L(E+1),w),B.textMaxSize=z["text-size"].possiblyEvaluate(new L(18),w);const $=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",G=R.get("text-size");for(const K of t.features){const oe=R.get("text-font").evaluate(K,{},w).join(","),fe=G.evaluate(K,{},w),Te=B.layoutTextSize.evaluate(K,{},w),pe=(B.layoutIconSize.evaluate(K,{},w),{horizontal:{},vertical:void 0}),be=K.text;let ke,Me=[0,0];if(be){const st=be.toString(),bt=R.get("text-letter-spacing").evaluate(K,{},w)*no,Qe=R.get("text-line-height").evaluate(K,{},w)*no,ut=Gl(st)?bt:0,ct=R.get("text-anchor").evaluate(K,{},w),_t=R.get("text-variable-anchor");if(!_t){const Gt=R.get("text-radial-offset").evaluate(K,{},w);Me=Gt?y1(ct,[Gt*no,__]):R.get("text-offset").evaluate(K,{},w).map(An=>An*no)}let At=$?"center":R.get("text-justify").evaluate(K,{},w);const it=R.get("symbol-placement")==="point",jt=it?R.get("text-max-width").evaluate(K,{},w)*no:1/0,Yt=Gt=>{t.allowVerticalPlacement&&wa(st)&&(pe.vertical=m_(be,e,n,h,oe,jt,Qe,ct,Gt,ut,Me,na.vertical,!0,Te,fe))};if(!$&&_t){const Gt=At==="auto"?_t.map(Mt=>v_(Mt)):[At];let An=!1;for(let Mt=0;Mt<Gt.length;Mt++){const rn=Gt[Mt];if(!pe.horizontal[rn])if(An)pe.horizontal[rn]=pe.horizontal[0];else{const Mn=m_(be,e,n,h,oe,jt,Qe,"center",rn,ut,Me,na.horizontal,!1,Te,fe);Mn&&(pe.horizontal[rn]=Mn,An=Mn.positionedLines.length===1)}}Yt("left")}else{if(At==="auto"&&(At=v_(ct)),it||R.get("text-writing-mode").indexOf("horizontal")>=0||!wa(st)){const Gt=m_(be,e,n,h,oe,jt,Qe,ct,At,ut,Me,na.horizontal,!1,Te,fe);Gt&&(pe.horizontal[At]=Gt)}Yt(it?"left":At)}}let Ke=!1;if(K.icon&&K.icon.name){const st=a[K.icon.name];st&&(ke=HA(h[K.icon.name],R.get("icon-offset").evaluate(K,{},w),R.get("icon-anchor").evaluate(K,{},w)),Ke=st.sdf,t.sdfIcons===void 0?t.sdfIcons=st.sdf:t.sdfIcons!==st.sdf&&Nn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(st.pixelRatio!==t.pixelRatio||R.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}const We=v1(pe.horizontal)||pe.vertical;t.iconsInText||(t.iconsInText=!!We&&We.iconsInText),(We||ke)&&iM(t,K,pe,ke,a,B,Te,0,Me,Ke,y,w,C)}m&&t.generateCollisionDebugBuffers(E,t.collisionBoxArray)}function v_(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function iM(t,e,n,a,h,m,y,w,E,C,R,z,B){let $=m.textMaxSize.evaluate(e,{},z);$===void 0&&($=y);const G=t.layers[0].layout,K=G.get("icon-offset").evaluate(e,{},z),oe=v1(n.horizontal)||n.vertical,fe=B.name==="globe",Te=no,pe=y/Te,be=t.tilePixelRatio*$/Te,ke=(ct=t.overscaling,t.zoom>18&&ct>2&&(ct>>=1),Math.max(nn/(512*ct),1)*G.get("symbol-spacing")),Me=G.get("text-padding")*t.tilePixelRatio,Ke=G.get("icon-padding")*t.tilePixelRatio,We=lt(G.get("text-max-angle")),st=G.get("text-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",bt=G.get("icon-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",Qe=G.get("symbol-placement"),ut=ke/2;var ct;const _t=G.get("icon-text-fit");let At;a&&_t!=="none"&&(t.allowVerticalPlacement&&n.vertical&&(At=s1(a,n.vertical,_t,G.get("icon-text-fit-padding"),K,pe)),oe&&(a=s1(a,oe,_t,G.get("icon-text-fit-padding"),K,pe)));const it=(jt,Yt,Gt)=>{if(Yt.x<0||Yt.x>=nn||Yt.y<0||Yt.y>=nn)return;let An=null;if(fe){const{x:Mt,y:rn,z:Mn}=B.projectTilePoint(Yt.x,Yt.y,Gt);An={anchor:new sc(Mt,rn,Mn,0,void 0),up:B.upVector(Gt,Yt.x,Yt.y)}}(function(Mt,rn,Mn,sr,kn,gn,kr,In,Rn,mr,wr,br,gr,$r,ni,hi,yr,Ci,di,Xr,cr,fi,Tr,Xo,pi){const ro=Mt.addToLineVertexArray(rn,sr);let Gi,Ko,qi,fl,Pf,Jp,Qp,J1=0,Q1=0,ew=0,tw=0,D_=-1,z_=-1;const au={};let nw=Wo("");const _d=Mn?Mn.anchor:rn;let O_=0,B_=0;if(Rn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[O_,B_]=Rn.layout.get("text-offset").evaluate(cr,{},pi).map(Rs=>Rs*no):(O_=Rn.layout.get("text-radial-offset").evaluate(cr,{},pi)*no,B_=__),Mt.allowVerticalPlacement&&kn.vertical){const Rs=kn.vertical;if(ni)Jp=x_(Rs),In&&(Qp=x_(In));else{const Ls=Rn.layout.get("text-rotate").evaluate(cr,{},pi)+90;qi=Ag(mr,_d,rn,wr,br,gr,Rs,$r,Ls,hi),In&&(fl=Ag(mr,_d,rn,wr,br,gr,In,Ci,Ls))}}if(gn){const Rs=Rn.layout.get("icon-rotate").evaluate(cr,{},pi),Ls=Rn.layout.get("icon-text-fit")!=="none",em=m1(gn,Rs,Tr,Ls),N_=In?m1(In,Rs,Tr,Ls):void 0;Ko=Ag(mr,_d,rn,wr,br,gr,gn,Ci,Rs),J1=4*em.length;const rw=Mt.iconSizeData;let vd=null;rw.kind==="source"?(vd=[cl*Rn.layout.get("icon-size").evaluate(cr,{},pi)],vd[0]>eh&&Nn(`${Mt.layerIds[0]}: Value for "icon-size" is >= ${Gp}. Reduce your "icon-size".`)):rw.kind==="composite"&&(vd=[cl*fi.compositeIconSizes[0].evaluate(cr,{},pi),cl*fi.compositeIconSizes[1].evaluate(cr,{},pi)],(vd[0]>eh||vd[1]>eh)&&Nn(`${Mt.layerIds[0]}: Value for "icon-size" is >= ${Gp}. Reduce your "icon-size".`)),Mt.addSymbols(Mt.icon,em,vd,Xr,di,cr,!1,Mn,rn,ro.lineStartIndex,ro.lineLength,-1,Xo,pi),D_=Mt.icon.placedSymbolArray.length-1,N_&&(Q1=4*N_.length,Mt.addSymbols(Mt.icon,N_,vd,Xr,di,cr,na.vertical,Mn,rn,ro.lineStartIndex,ro.lineLength,-1,Xo,pi),z_=Mt.icon.placedSymbolArray.length-1)}for(const Rs in kn.horizontal){const Ls=kn.horizontal[Rs];Gi||(nw=Wo(Ls.text),ni?Pf=x_(Ls):Gi=Ag(mr,_d,rn,wr,br,gr,Ls,$r,Rn.layout.get("text-rotate").evaluate(cr,{},pi),hi));const em=Ls.positionedLines.length===1;if(ew+=_1(Mt,Mn,rn,Ls,kr,Rn,ni,cr,hi,ro,kn.vertical?na.horizontal:na.horizontalOnly,em?Object.keys(kn.horizontal):[Rs],au,D_,fi,Xo,pi),em)break}kn.vertical&&(tw+=_1(Mt,Mn,rn,kn.vertical,kr,Rn,ni,cr,hi,ro,na.vertical,["vertical"],au,z_,fi,Xo,pi));let sh=-1;const F_=(Rs,Ls)=>Rs?Math.max(Rs,Ls):Ls;sh=F_(Pf,sh),sh=F_(Jp,sh),sh=F_(Qp,sh);const RM=sh>-1?1:0;Mt.glyphOffsetArray.length>=nh.MAX_GLYPHS&&Nn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),cr.sortKey!==void 0&&Mt.addToSortKeyRanges(Mt.symbolInstances.length,cr.sortKey),Mt.symbolInstances.emplaceBack(_d.x,_d.y,_d.z,rn.x,rn.y,au.right>=0?au.right:-1,au.center>=0?au.center:-1,au.left>=0?au.left:-1,au.vertical>=0?au.vertical:-1,D_,z_,nw,Gi!==void 0?Gi:Mt.collisionBoxArray.length,Gi!==void 0?Gi+1:Mt.collisionBoxArray.length,qi!==void 0?qi:Mt.collisionBoxArray.length,qi!==void 0?qi+1:Mt.collisionBoxArray.length,Ko!==void 0?Ko:Mt.collisionBoxArray.length,Ko!==void 0?Ko+1:Mt.collisionBoxArray.length,fl||Mt.collisionBoxArray.length,fl?fl+1:Mt.collisionBoxArray.length,wr,ew,tw,J1,Q1,RM,0,O_,B_,sh)})(t,Yt,An,jt,n,a,h,At,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,Me,st,E,0,Ke,bt,K,e,m,C,R,z)};if(Qe==="line")for(const jt of d1(e.geometry,0,0,nn,nn)){const Yt=KA(jt,ke,We,n.vertical||oe,a,Te,be,t.overscaling,nn);for(const Gt of Yt)oe&&oM(t,oe.text,ut,Gt)||it(jt,Gt,z)}else if(Qe==="line-center"){for(const jt of e.geometry)if(jt.length>1){const Yt=XA(jt,We,n.vertical||oe,a,Te,be);Yt&&it(jt,Yt,z)}}else if(e.type==="Polygon")for(const jt of Bp(e.geometry,0)){const Yt=eM(jt,16);it(jt[0],new sc(Yt.x,Yt.y,0,0,void 0),z)}else if(e.type==="LineString")for(const jt of e.geometry)it(jt,new sc(jt[0].x,jt[0].y,0,0,void 0),z);else if(e.type==="Point")for(const jt of e.geometry)for(const Yt of jt)it([Yt],new sc(Yt.x,Yt.y,0,0,void 0),z)}const Gp=255,eh=Gp*cl;function _1(t,e,n,a,h,m,y,w,E,C,R,z,B,$,G,K,oe){const fe=function(be,ke,Me,Ke,We,st,bt,Qe){const ut=[];if(ke.positionedLines.length===0)return ut;const ct=Ke.layout.get("text-rotate").evaluate(st,{})*Math.PI/180,_t=function(Gt){const An=Gt[0],Mt=Gt[1],rn=An*Mt;return rn>0?[An,-Mt]:rn<0?[-An,Mt]:An===0?[Mt,An]:[Mt,-An]}(Me);let At=Math.abs(ke.top-ke.bottom);for(const Gt of ke.positionedLines)At-=Gt.lineOffset;const it=ke.positionedLines.length,jt=At/it;let Yt=ke.top-Me[1];for(let Gt=0;Gt<it;++Gt){const An=ke.positionedLines[Gt];Yt=YA(ke,jt,Yt,Gt);for(const Mt of An.positionedGlyphs){if(!Mt.rect)continue;const rn=Mt.rect||{};let Mn=qA+1,sr=!0,kn=1,gn=0;if(Mt.imageName){const Tr=bt[Mt.imageName];if(!Tr)continue;if(Tr.sdf){Nn("SDF images are not supported in formatted text and will be ignored.");continue}sr=!1,kn=Tr.pixelRatio,Mn=ps/kn}const kr=(We||Qe)&&Mt.vertical,In=Mt.metrics.advance*Mt.scale/2,Rn=Mt.metrics,mr=Mt.rect;if(mr===null)continue;Qe&&ke.verticalizable&&(gn=Mt.imageName?In-Mt.metrics.width*Mt.scale/2:0);const wr=We?[Mt.x+In,Mt.y]:[0,0];let br=[0,0],gr=[0,0],$r=!1;We||(kr?(gr=[Mt.x+In+_t[0],Mt.y+_t[1]-gn],$r=!0):br=[Mt.x+In+Me[0],Mt.y+Me[1]-gn]);const ni=mr.w*Mt.scale/(kn*(Mt.localGlyph?hl:1)),hi=mr.h*Mt.scale/(kn*(Mt.localGlyph?hl:1));let yr,Ci,di,Xr;if(kr){const Tr=Mt.y-Yt,Xo=new Y(-In,In-Tr),pi=-Math.PI/2,ro=new Y(...gr);yr=new Y(-In+br[0],br[1]),yr._rotateAround(pi,Xo)._add(ro),yr.x+=-Tr+In,yr.y-=(Rn.left-Mn)*Mt.scale;const Gi=Mt.imageName?Rn.advance*Mt.scale:no*Mt.scale,Ko=String.fromCharCode(Mt.glyph);IA(Ko)?yr.x+=(1-Mn)*Mt.scale:RA(Ko)?yr.x+=Gi-Rn.height*Mt.scale+(-Mn-1)*Mt.scale:yr.x+=Mt.imageName||Rn.width+2*Mn===mr.w&&Rn.height+2*Mn===mr.h?(Gi-hi)/2:(Gi-(Rn.height+2*Mn)*Mt.scale)/2,Ci=new Y(yr.x,yr.y-ni),di=new Y(yr.x+hi,yr.y),Xr=new Y(yr.x+hi,yr.y-ni)}else{const Tr=(Rn.left-Mn)*Mt.scale-In+br[0],Xo=(-Rn.top-Mn)*Mt.scale+br[1],pi=Tr+ni,ro=Xo+hi;yr=new Y(Tr,Xo),Ci=new Y(pi,Xo),di=new Y(Tr,ro),Xr=new Y(pi,ro)}if(ct){let Tr;Tr=We?new Y(0,0):$r?new Y(_t[0],_t[1]):new Y(Me[0],Me[1]),yr._rotateAround(ct,Tr),Ci._rotateAround(ct,Tr),di._rotateAround(ct,Tr),Xr._rotateAround(ct,Tr)}const cr=new Y(0,0),fi=new Y(0,0);ut.push({tl:yr,tr:Ci,bl:di,br:Xr,tex:rn,writingMode:ke.writingMode,glyphOffset:wr,sectionIndex:Mt.sectionIndex,isSDF:sr,pixelOffsetTL:cr,pixelOffsetBR:fi,minFontScaleX:0,minFontScaleY:0})}}return ut}(0,a,E,m,y,w,h,t.allowVerticalPlacement),Te=t.textSizeData;let pe=null;Te.kind==="source"?(pe=[cl*m.layout.get("text-size").evaluate(w,{},oe)],pe[0]>eh&&Nn(`${t.layerIds[0]}: Value for "text-size" is >= ${Gp}. Reduce your "text-size".`)):Te.kind==="composite"&&(pe=[cl*G.compositeTextSizes[0].evaluate(w,{},oe),cl*G.compositeTextSizes[1].evaluate(w,{},oe)],(pe[0]>eh||pe[1]>eh)&&Nn(`${t.layerIds[0]}: Value for "text-size" is >= ${Gp}. Reduce your "text-size".`)),t.addSymbols(t.text,fe,pe,E,y,w,R,e,n,C.lineStartIndex,C.lineLength,$,K,oe);for(const be of z)B[be]=t.text.placedSymbolArray.length-1;return 4*fe.length}function v1(t){for(const e in t)return t[e];return null}function Ag(t,e,n,a,h,m,y,w,E,C){let R=y.top,z=y.bottom,B=y.left,$=y.right;const G=y.collisionPadding;if(G&&(B-=G[0],R-=G[1],$+=G[2],z+=G[3]),E){const K=new Y(B,R),oe=new Y($,R),fe=new Y(B,z),Te=new Y($,z),pe=lt(E);let be=new Y(0,0);C&&(be=new Y(C[0],C[1])),K._rotateAround(pe,be),oe._rotateAround(pe,be),fe._rotateAround(pe,be),Te._rotateAround(pe,be),B=Math.min(K.x,oe.x,fe.x,Te.x),$=Math.max(K.x,oe.x,fe.x,Te.x),R=Math.min(K.y,oe.y,fe.y,Te.y),z=Math.max(K.y,oe.y,fe.y,Te.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,B,R,$,z,w,a,h,m),t.length-1}function x_(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function oM(t,e,n,a){const h=t.compareText;if(e in h){const m=h[e];for(let y=m.length-1;y>=0;y--)if(a.dist(m[y])<n)return!0}else h[e]=[];return h[e].push(a),!1}function x1(t,e){const n=t.fovAboveCenter,a=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,h=(t._camera.position[2]*t.worldSize-a)/Math.cos(t._pitch),m=Math.sin(n)*h/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),y=Math.sin(t._pitch)*m+h;return Math.min(1.01*y,h*(1/t._horizonShift))}function gd(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),a=t.x*n,h=(t.x+1)*n,m=t.y*n,y=(t.y+1)*n,w=Vi(a),E=Vi(h),C=ir(m),R=ir(y),z=e.project(w,C),B=e.project(E,C),$=e.project(E,R),G=e.project(w,R);let K=Math.min(z.x,B.x,$.x,G.x),oe=Math.min(z.y,B.y,$.y,G.y),fe=Math.max(z.x,B.x,$.x,G.x),Te=Math.max(z.y,B.y,$.y,G.y);const pe=n/16;function be(Me,Ke,We,st,bt,Qe){const ut=(We+bt)/2,ct=(st+Qe)/2,_t=e.project(Vi(ut),ir(ct)),At=Math.max(0,K-_t.x,oe-_t.y,_t.x-fe,_t.y-Te);K=Math.min(K,_t.x),fe=Math.max(fe,_t.x),oe=Math.min(oe,_t.y),Te=Math.max(Te,_t.y),At>pe&&(be(Me,_t,We,st,ut,ct),be(_t,Ke,ut,ct,bt,Qe))}be(z,B,a,m,h,m),be(B,$,h,m,h,y),be($,G,h,y,a,y),be(G,z,a,y,a,m),K-=pe,oe-=pe,fe+=pe,Te+=pe;const ke=1/Math.max(fe-K,Te-oe);return{scale:ke,x:K*ke,y:oe*ke,x2:fe*ke,y2:Te*ke,projection:e}}const sM=Ys(new Float32Array(16));class th{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new sn(0,0)}projectTilePoint(e,n,a){return{x:e,y:n,z:0}}locationPoint(e,n,a=!0){return e._coordinatePoint(e.locationCoordinate(n),a)}pixelsPerMeter(e,n){return ti(1,e)*n}pixelSpaceConversion(e,n,a){return 1}farthestPixelDistance(e){return x1(e,e.pixelsPerMeter)}pointCoordinate(e,n,a,h){const m=e.horizonLineFromTop(!1),y=new Y(n,Math.max(m,a));return e.rayIntersectionCoordinate(e.pointRayIntersection(y,h))}pointCoordinate3D(e,n,a){const h=new Y(n,a);if(e.elevation)return e.elevation.pointCoordinate(h);{const m=this.pointCoordinate(e,h.x,h.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(e,n){if(e.elevation)return!this.pointCoordinate3D(e,n.x,n.y);const a=e.horizonLineFromTop();return n.y<a}createInversionMatrix(e,n){return sM}createTileMatrix(e,n,a){let h,m,y;const w=a.canonical,E=Ys(new Float64Array(16));if(this.isReprojectedInTileSpace){const C=gd(w,this);h=1,m=C.x+a.wrap*C.scale,y=C.y,Xl(E,E,[h/C.scale,h/C.scale,e.pixelsPerMeter/n])}else h=n/e.zoomScale(w.z),m=(w.x+Math.pow(2,w.z)*a.wrap)*h,y=w.y*h;return Hl(E,E,[m,y,0]),Xl(E,E,[h/nn,h/nn,1]),E}upVector(e,n,a){return[0,0,1]}upVectorScale(e,n,a){return{metersToTile:1}}}class aM extends th{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,a]=this.parallels=e.parallels||[29.5,45.5],h=Math.sin(lt(n));this.n=(h+Math.sin(lt(a)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:a,c:h,r0:m}=this,y=lt(e-this.center[0]),w=lt(n),E=Math.sqrt(h-2*a*Math.sin(w))/a;return{x:E*Math.sin(y*a),y:E*Math.cos(y*a)-m,z:0}}unproject(e,n){const{n:a,c:h,r0:m}=this,y=m+n;let w=Math.atan2(e,Math.abs(y))*Math.sign(y);y*a<0&&(w-=Math.PI*Math.sign(e)*Math.sign(y));const E=lt(this.center[0])*a;w=te(w,-Math.PI-E,Math.PI-E);const C=Et(zt(w/a)+this.center[0],-180,180),R=Math.asin(Et((h-(e*e+y*y)*a*a)/(2*a),-1,1)),z=Et(zt(R),-85.051129,to);return new sn(C,z)}}const qp=1.340264,Wp=-.081106,Zp=893e-6,Hp=.003796,Mg=Math.sqrt(3)/2;class lM extends th{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const a=Math.asin(Mg*Math.sin(n)),h=a*a,m=h*h*h;return{x:.5*(e*Math.cos(a)/(Mg*(qp+3*Wp*h+m*(7*Zp+9*Hp*h)))/Math.PI+.5),y:1-.5*(a*(qp+Wp*h+m*(Zp+Hp*h))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let a=n=(2*(1-n)-1)*Math.PI,h=a*a,m=h*h*h;for(let R,z,B,$=0;$<12&&(z=a*(qp+Wp*h+m*(Zp+Hp*h))-n,B=qp+3*Wp*h+m*(7*Zp+9*Hp*h),R=z/B,a=Et(a-R,-Math.PI/3,Math.PI/3),h=a*a,m=h*h*h,!(Math.abs(R)<1e-12));++$);const y=Mg*e*(qp+3*Wp*h+m*(7*Zp+9*Hp*h))/Math.cos(a),w=Math.asin(Math.sin(a)/Mg),E=Et(180*y/Math.PI,-180,180),C=Et(180*w/Math.PI,-85.051129,to);return new sn(E,C)}}class uM extends th{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const a=360*(e-.5),h=Et(360*(.5-n),-85.051129,to);return new sn(a,h)}}const Mf=Math.PI/2;function kg(t){return Math.tan((Mf+t)/2)}class cM extends th{constructor(e){super(e),this.center=e.center||[0,30];const[n,a]=this.parallels=e.parallels||[30,30];let h=lt(n),m=lt(a);this.southernCenter=h+m<0,this.southernCenter&&(h=-h,m=-m);const y=Math.cos(h),w=kg(h);this.n=h===m?Math.sin(h):Math.log(y/Math.cos(m))/Math.log(kg(m)/w),this.f=y*Math.pow(kg(h),this.n)/this.n}project(e,n){n=lt(n),this.southernCenter&&(n=-n),e=lt(e-this.center[0]);const a=1e-6,{n:h,f:m}=this;m>0?n<-Mf+a&&(n=-Mf+a):n>Mf-a&&(n=Mf-a);const y=m/Math.pow(kg(n),h);let w=y*Math.sin(h*e),E=m-y*Math.cos(h*e);return w=.5*(w/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:w,y:this.southernCenter?E:1-E,z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;const{n:a,f:h}=this,m=h-n,y=Math.sign(m),w=Math.sign(a)*Math.sqrt(e*e+m*m);let E=Math.atan2(e,Math.abs(m))*y;m*a<0&&(E-=Math.PI*Math.sign(e)*y);const C=Et(zt(E/a)+this.center[0],-180,180),R=Et(zt(2*Math.atan(Math.pow(h/w,1/a))-Mf),-85.051129,to);return new sn(C,this.southernCenter?-R:R)}}class w1 extends th{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:vr(e),y:Br(n),z:0}}unproject(e,n){const a=Vi(e),h=ir(n);return new sn(a,h)}}const b1=lt(to);class hM extends th{project(e,n){const a=(n=lt(n))*n,h=a*a;return{x:.5*((e=lt(e))*(.8707-.131979*a+h*(h*(.003971*a-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+a*(.015085+h*(.028874*a-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let a=n=(2*(1-n)-1)*Math.PI,h=25,m=0,y=a*a;do{y=a*a;const C=y*y;m=(a*(1.007226+y*(.015085+C*(.028874*y-.044475-.005916*C)))-n)/(1.007226+y*(.045255+C*(.259866*y-.311325-.005916*11*C))),a=Et(a-m,-b1,b1)}while(Math.abs(m)>1e-6&&--h>0);y=a*a;const w=Et(zt(e/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),E=zt(a);return new sn(w,E)}}const T1=lt(to);class dM extends th{project(e,n){n=lt(n),e=lt(e);const a=Math.cos(n),h=2/Math.PI,m=Math.acos(a*Math.cos(e/2)),y=Math.sin(m)/m,w=.5*(e*h+2*a*Math.sin(e/2)/y)||0,E=.5*(n+Math.sin(n)/y)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(e,n){let a=e=(2*e-.5)*Math.PI,h=n=(2*(1-n)-1)*Math.PI,m=25;const y=1e-6;let w=0,E=0;do{const C=Math.cos(h),R=Math.sin(h),z=2*R*C,B=R*R,$=C*C,G=Math.cos(a/2),K=Math.sin(a/2),oe=2*G*K,fe=K*K,Te=1-$*G*G,pe=Te?1/Te:0,be=Te?Math.acos(C*G)*Math.sqrt(1/Te):0,ke=.5*(2*be*C*K+2*a/Math.PI)-e,Me=.5*(be*R+h)-n,Ke=.5*pe*($*fe+be*C*G*B)+1/Math.PI,We=pe*(oe*z/4-be*R*K),st=.125*pe*(z*K-be*R*$*oe),bt=.5*pe*(B*G+be*fe*C)+.5,Qe=We*st-bt*Ke;w=(Me*We-ke*bt)/Qe,E=(ke*st-Me*Ke)/Qe,a=Et(a-w,-Math.PI,Math.PI),h=Et(h-E,-T1,T1)}while((Math.abs(w)>y||Math.abs(E)>y)&&--m>0);return new sn(zt(a),zt(h))}}class E1 extends th{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(lt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:a,cosPhi:h}=this;return{x:lt(e)*h*a+.5,y:-Math.sin(lt(n))/h*a+.5,z:0}}unproject(e,n){const{scale:a,cosPhi:h}=this,m=-(n-.5)/a,y=Et(zt((e-.5)/a)/h,-180,180),w=Math.asin(Et(m*h,-1,1)),E=Et(zt(w),-85.051129,to);return new sn(y,E)}}class fM extends w1{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,n,a){const h=Ps(e,n,a);return Ur(h,h,Ao(fs(a))),{x:h[0],y:h[1],z:h[2]}}locationPoint(e,n){const a=po(n.lat,n.lng),h=Ji([],a),m=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude;Uc(a,a,h,ti(1,0)*nn*m);const y=Ys(new Float64Array(16));return al(y,e.pixelMatrix,e.globeMatrix),Ur(a,a,y),new Y(a[0],a[1])}pixelsPerMeter(e,n){return ti(1,0)*n}pixelSpaceConversion(e,n,a){const h=ti(1,e)*n,m=Zn(ti(1,45)*n,h,a);return this.pixelsPerMeter(e,n)/m}createTileMatrix(e,n,a){const h=af(fs(a.canonical));return al(new Float64Array(16),e.globeMatrix,h)}createInversionMatrix(e,n){const{center:a}=e,h=Ao(fs(n));return Hh(h,h,lt(a.lng)),Kd(h,h,lt(a.lat)),Xl(h,h,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(e,n,a,h){return _p(e,n,a,!0)||new Jl(0,0)}pointCoordinate3D(e,n,a){const h=this.pointCoordinate(e,n,a,0);return[h.x,h.y,h.z]}isPointAboveHorizon(e,n){return!_p(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(h,m){const y=h.cameraToCenterDistance,w=h._centerAltitude*m,E=h._camera,C=h._camera.forward(),R=Ca([],Lr([],C,-y),[0,0,w]),z=h.worldSize/(2*Math.PI),B=[0,0,-z],$=h.width/h.height,G=Math.tan(h.fovAboveCenter),K=Lr([],E.up(),G),oe=Lr([],E.right(),G*$),fe=Ji([],Ca([],Ca([],C,K),oe)),Te=[];let pe;if(new of(R,fe).closestPointOnSphere(B,z,Te)){const be=Ca([],Te,B),ke=ds([],be,R);pe=Math.cos(h.fovAboveCenter)*Vc(ke)}else{const be=ds([],R,B),ke=ds([],B,R);Ji(ke,ke);const Me=Vc(be)-z;pe=Math.sqrt(Me*(Me+2*z));const Ke=Math.acos(pe/(z+Me))-Math.acos(hs(C,ke));pe*=Math.cos(Ke)}return 1.01*pe}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),a=Zc(e.zoom);if(a>0){const h=x1(e,ti(1,e.center.lat)*e.worldSize),m=e.worldSize/(2*Math.PI),y=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Zn(n,h+m*(1-Math.cos(y)),Math.pow(a,10))}return n}upVector(e,n,a){return Ps(n,a,e,1)}upVectorScale(e){return{metersToTile:qc(nd(fs(e)))}}}function S1(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new w1(t);case"equirectangular":return new uM(t);case"naturalEarth":return new hM(t);case"equalEarth":return new lM(t);case"winkelTripel":return new dM(t);case"albers":return n?new E1(t):new aM(t);case"lambertConformalConic":return n?new E1(t):new cM(t);case"globe":return new fM(t)}throw new Error(`Invalid projection name: ${t.name}`)}const pM=_n.types,mM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Pg(t,e,n,a,h,m,y,w,E,C,R,z,B){const $=w?Math.min(eh,Math.round(w[0])):0,G=w?Math.min(eh,Math.round(w[1])):0;t.emplaceBack(e,n,Math.round(32*a),Math.round(32*h),m,y,($<<1)+(E?1:0),G,16*C,16*R,256*z,256*B)}function Ig(t,e,n,a,h,m,y){t.emplaceBack(e,n,a,h,m,y)}function Rg(t,e,n,a,h){t.emplaceBack(e,n,a,h),t.emplaceBack(e,n,a,h),t.emplaceBack(e,n,a,h),t.emplaceBack(e,n,a,h)}function gM(t){for(const e of t.sections)if(Hs(e.text))return!0;return!1}class w_{constructor(e){this.layoutVertexArray=new ht,this.indexArray=new Qt,this.programConfigurations=e,this.segments=new ei,this.dynamicLayoutVertexArray=new yt,this.opacityVertexArray=new Jt,this.placedSymbolArray=new Vr,this.globeExtVertexArray=new wt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,TA.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,SA.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,mM,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,EA.members,!0)),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Vt(w_,"SymbolBuffers");class b_{constructor(e,n,a){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new a,this.segments=new ei,this.collisionVertexArray=new Pn,this.collisionVertexArrayExt=new Dn}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,CA.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,AA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Vt(b_,"CollisionBuffers");class nh{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ys([]),this.placementViewportMatrix=Ys([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=c_(this.zoom,n["text-size"]),this.iconSizeData=c_(this.zoom,n["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(y=>na[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new w_(new Zl(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new w_(new Zl(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new ri,this.lineVertexArray=new Mr,this.symbolInstances=new fr}calculateGlyphDependencies(e,n,a,h,m){for(let y=0;y<e.length;y++)if(n[e.charCodeAt(y)]=!0,h&&m){const w=Vp[e.charAt(y)];w&&(n[w.charCodeAt(0)]=!0)}}populate(e,n,a,h){const m=this.layers[0],y=m.layout,w=this.projection.name==="globe",E=y.get("text-font"),C=y.get("text-field"),R=y.get("icon-image"),z=(C.value.kind!=="constant"||C.value.value instanceof xi&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),B=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,$=y.get("symbol-sort-key");if(this.features=[],!z&&!B)return;const G=n.iconDependencies,K=n.glyphDependencies,oe=n.availableImages,fe=new L(this.zoom);for(const{feature:Te,id:pe,index:be,sourceLayerIndex:ke}of e){const Me=m._featureFilter.needGeometry,Ke=Pa(Te,Me);if(!m._featureFilter.filter(fe,Ke,a))continue;if(Me||(Ke.geometry=mo(Te,a,h)),w&&Te.type!==1&&a.z<=5){const Qe=Ke.geometry,ut=.98078528056,ct=(_t,At)=>hs(Ps(_t.x,_t.y,a,1),Ps(At.x,At.y,a,1))<ut;for(let _t=0;_t<Qe.length;_t++)Qe[_t]=Xc(Qe[_t],ct)}let We,st;if(z){const Qe=m.getValueAndResolveTokens("text-field",Ke,a,oe),ut=xi.factory(Qe);gM(ut)&&(this.hasRTLText=!0),(!this.hasRTLText||b()==="unavailable"||this.hasRTLText&&P.isParsed())&&(We=PA(ut,m,Ke))}if(B){const Qe=m.getValueAndResolveTokens("icon-image",Ke,a,oe);st=Qe instanceof Bo?Qe:Bo.fromString(Qe)}if(!We&&!st)continue;const bt=this.sortFeaturesByKey?$.evaluate(Ke,{},a):void 0;if(this.features.push({id:pe,text:We,icon:st,index:be,sourceLayerIndex:ke,geometry:Ke.geometry,properties:Te.properties,type:pM[Te.type],sortKey:bt}),st&&(G[st.name]=!0),We){const Qe=E.evaluate(Ke,{},a).join(","),ut=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(na.vertical)>=0;for(const ct of We.sections)if(ct.image)G[ct.image.name]=!0;else{const _t=wa(We.toString()),At=ct.fontStack||Qe,it=K[At]=K[At]||{};this.calculateGlyphDependencies(ct.text,it,ut,this.allowVerticalPlacement,_t)}}}y.get("symbol-placement")==="line"&&(this.features=function(Te){const pe={},be={},ke=[];let Me=0;function Ke(Qe){ke.push(Te[Qe]),Me++}function We(Qe,ut,ct){const _t=be[Qe];return delete be[Qe],be[ut]=_t,ke[_t].geometry[0].pop(),ke[_t].geometry[0]=ke[_t].geometry[0].concat(ct[0]),_t}function st(Qe,ut,ct){const _t=pe[ut];return delete pe[ut],pe[Qe]=_t,ke[_t].geometry[0].shift(),ke[_t].geometry[0]=ct[0].concat(ke[_t].geometry[0]),_t}function bt(Qe,ut,ct){const _t=ct?ut[0][ut[0].length-1]:ut[0][0];return`${Qe}:${_t.x}:${_t.y}`}for(let Qe=0;Qe<Te.length;Qe++){const ut=Te[Qe],ct=ut.geometry,_t=ut.text?ut.text.toString():null;if(!_t){Ke(Qe);continue}const At=bt(_t,ct),it=bt(_t,ct,!0);if(At in be&&it in pe&&be[At]!==pe[it]){const jt=st(At,it,ct),Yt=We(At,it,ke[jt].geometry);delete pe[At],delete be[it],be[bt(_t,ke[Yt].geometry,!0)]=Yt,ke[jt].geometry=null}else At in be?We(At,it,ct):it in pe?st(At,it,ct):(Ke(Qe),pe[At]=Me-1,be[it]=Me-1)}return ke.filter(Qe=>Qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Te,pe)=>Te.sortKey-pe.sortKey)}update(e,n,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,a,h),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,a,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=S1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const a=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:h,y:m}of n)this.lineVertexArray.emplaceBack(h,m);return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,n,a,h,m,y,w,E,C,R,z,B,$,G){const K=e.indexArray,oe=e.layoutVertexArray,fe=e.globeExtVertexArray,Te=e.segments.prepareSegment(4*n.length,oe,K,this.canOverlap?y.sortKey:void 0),pe=this.glyphOffsetArray.length,be=Te.vertexLength,ke=this.allowVerticalPlacement&&w===na.vertical?Math.PI/2:0,Me=y.text&&y.text.sections;for(let We=0;We<n.length;We++){const{tl:st,tr:bt,bl:Qe,br:ut,tex:ct,pixelOffsetTL:_t,pixelOffsetBR:At,minFontScaleX:it,minFontScaleY:jt,glyphOffset:Yt,isSDF:Gt,sectionIndex:An}=n[We],Mt=Te.vertexLength,rn=Yt[1];if(Pg(oe,C.x,C.y,st.x,rn+st.y,ct.x,ct.y,a,Gt,_t.x,_t.y,it,jt),Pg(oe,C.x,C.y,bt.x,rn+bt.y,ct.x+ct.w,ct.y,a,Gt,At.x,_t.y,it,jt),Pg(oe,C.x,C.y,Qe.x,rn+Qe.y,ct.x,ct.y+ct.h,a,Gt,_t.x,At.y,it,jt),Pg(oe,C.x,C.y,ut.x,rn+ut.y,ct.x+ct.w,ct.y+ct.h,a,Gt,At.x,At.y,it,jt),E){const{x:Mn,y:sr,z:kn}=E.anchor,[gn,kr,In]=E.up;Ig(fe,Mn,sr,kn,gn,kr,In),Ig(fe,Mn,sr,kn,gn,kr,In),Ig(fe,Mn,sr,kn,gn,kr,In),Ig(fe,Mn,sr,kn,gn,kr,In),Rg(e.dynamicLayoutVertexArray,Mn,sr,kn,ke)}else Rg(e.dynamicLayoutVertexArray,C.x,C.y,C.z,ke);K.emplaceBack(Mt,Mt+1,Mt+2),K.emplaceBack(Mt+1,Mt+2,Mt+3),Te.vertexLength+=4,Te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Yt[0]),We!==n.length-1&&An===n[We+1].sectionIndex||e.programConfigurations.populatePaintArrays(oe.length,y,y.index,{},$,G,Me&&Me[An])}const Ke=E?E.anchor:C;e.placedSymbolArray.emplaceBack(Ke.x,Ke.y,Ke.z,C.x,C.y,pe,this.glyphOffsetArray.length-pe,be,R,z,C.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],w,0,!1,0,B,0)}_commitLayoutVertex(e,n,a,h,m,y,w){e.emplaceBack(n,a,h,m,y,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(e,n,a,h,m,y,w){const E=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),C=E.vertexLength,R=w.tileAnchorX,z=w.tileAnchorY;for(let $=0;$<4;$++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,R,z,new Y(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,R,z,new Y(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,R,z,new Y(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,h,m,y,R,z,new Y(e.x1,e.y2)),E.vertexLength+=4;const B=a.indexArray;B.emplaceBack(C,C+1),B.emplaceBack(C+1,C+2),B.emplaceBack(C+2,C+3),B.emplaceBack(C+3,C),E.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,a,h,m,y){for(let w=h;w<m;w++){const E=a.get(w),C=this.getSymbolInstanceTextSize(e,y,n,w);this._addCollisionDebugVertices(E,C,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(e,n,a,h,m,y){for(let w=h;w<m;w++){const E=a.get(w),C=this.getSymbolInstanceIconSize(e,n,y.placedIconSymbolIndex);this._addCollisionDebugVertices(E,C,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new b_(Zt,qx.members,jr),this.iconCollisionBox=new b_(Zt,qx.members,jr);const a=wf(this.iconSizeData,e),h=wf(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._addTextDebugCollisionBoxes(h,e,n,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(h,e,n,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(a,e,n,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(a,e,n,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(e,n,a,h){const m=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:h),y=vg(this.textSizeData,e,m)/no;return this.tilePixelRatio*y}getSymbolInstanceIconSize(e,n,a){const h=this.icon.placedSymbolArray.get(a),m=vg(this.iconSizeData,e,h);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(e,n,a){e.emplaceBack(n,-a,-a),e.emplaceBack(n,a,-a),e.emplaceBack(n,a,a),e.emplaceBack(n,-a,a)}_updateTextDebugCollisionBoxes(e,n,a,h,m,y){for(let w=h;w<m;w++){const E=a.get(w),C=this.getSymbolInstanceTextSize(e,y,n,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,E.padding)}}_updateIconDebugCollisionBoxes(e,n,a,h,m,y){for(let w=h;w<m;w++){const E=a.get(w),C=this.getSymbolInstanceIconSize(e,n,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,C,E.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=wf(this.iconSizeData,e),h=wf(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._updateTextDebugCollisionBoxes(h,e,n,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(h,e,n,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(a,e,n,y.iconBoxStartIndex,y.iconBoxEndIndex,y.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(a,e,n,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,a,h,m,y,w,E,C){const R={};if(n<a){const{x1:z,y1:B,x2:$,y2:G,padding:K,projectedAnchorX:oe,projectedAnchorY:fe,projectedAnchorZ:Te,tileAnchorX:pe,tileAnchorY:be,featureIndex:ke}=e.get(n);R.textBox={x1:z,y1:B,x2:$,y2:G,padding:K,projectedAnchorX:oe,projectedAnchorY:fe,projectedAnchorZ:Te,tileAnchorX:pe,tileAnchorY:be},R.textFeatureIndex=ke}if(h<m){const{x1:z,y1:B,x2:$,y2:G,padding:K,projectedAnchorX:oe,projectedAnchorY:fe,projectedAnchorZ:Te,tileAnchorX:pe,tileAnchorY:be,featureIndex:ke}=e.get(h);R.verticalTextBox={x1:z,y1:B,x2:$,y2:G,padding:K,projectedAnchorX:oe,projectedAnchorY:fe,projectedAnchorZ:Te,tileAnchorX:pe,tileAnchorY:be},R.verticalTextFeatureIndex=ke}if(y<w){const{x1:z,y1:B,x2:$,y2:G,padding:K,projectedAnchorX:oe,projectedAnchorY:fe,projectedAnchorZ:Te,tileAnchorX:pe,tileAnchorY:be,featureIndex:ke}=e.get(y);R.iconBox={x1:z,y1:B,x2:$,y2:G,padding:K,projectedAnchorX:oe,projectedAnchorY:fe,projectedAnchorZ:Te,tileAnchorX:pe,tileAnchorY:be},R.iconFeatureIndex=ke}if(E<C){const{x1:z,y1:B,x2:$,y2:G,padding:K,projectedAnchorX:oe,projectedAnchorY:fe,projectedAnchorZ:Te,tileAnchorX:pe,tileAnchorY:be,featureIndex:ke}=e.get(E);R.verticalIconBox={x1:z,y1:B,x2:$,y2:G,padding:K,projectedAnchorX:oe,projectedAnchorY:fe,projectedAnchorZ:Te,tileAnchorX:pe,tileAnchorY:be},R.verticalIconFeatureIndex=ke}return R}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const a=e.placedSymbolArray.get(n),h=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<h;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),a=Math.cos(e),h=[],m=[],y=[];for(let w=0;w<this.symbolInstances.length;++w){y.push(w);const E=this.symbolInstances.get(w);h.push(0|Math.round(n*E.tileAnchorX+a*E.tileAnchorY)),m.push(E.featureIndex)}return y.sort((w,E)=>h[w]-h[E]||m[E]-m[w]),y}addToSortKeyRanges(e,n){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===n?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const a=this.symbolInstances.get(n);this.featureSortOrder.push(a.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:w,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:C}=a;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),m>=0&&m!==h&&this.addIndicesForPlacedSymbol(this.text,m),y>=0&&y!==m&&y!==h&&this.addIndicesForPlacedSymbol(this.text,y),w>=0&&this.addIndicesForPlacedSymbol(this.text,w),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Vt(nh,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),nh.MAX_GLYPHS=65535,nh.addDynamicAttributes=Rg;const yM=new ve({"symbol-placement":new X(ot.layout_symbol["symbol-placement"]),"symbol-spacing":new X(ot.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new X(ot.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new se(ot.layout_symbol["symbol-sort-key"]),"symbol-z-order":new X(ot.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new X(ot.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new X(ot.layout_symbol["icon-ignore-placement"]),"icon-optional":new X(ot.layout_symbol["icon-optional"]),"icon-rotation-alignment":new X(ot.layout_symbol["icon-rotation-alignment"]),"icon-size":new se(ot.layout_symbol["icon-size"]),"icon-text-fit":new X(ot.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new X(ot.layout_symbol["icon-text-fit-padding"]),"icon-image":new se(ot.layout_symbol["icon-image"]),"icon-rotate":new se(ot.layout_symbol["icon-rotate"]),"icon-padding":new X(ot.layout_symbol["icon-padding"]),"icon-keep-upright":new X(ot.layout_symbol["icon-keep-upright"]),"icon-offset":new se(ot.layout_symbol["icon-offset"]),"icon-anchor":new se(ot.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new X(ot.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new X(ot.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new X(ot.layout_symbol["text-rotation-alignment"]),"text-field":new se(ot.layout_symbol["text-field"]),"text-font":new se(ot.layout_symbol["text-font"]),"text-size":new se(ot.layout_symbol["text-size"]),"text-max-width":new se(ot.layout_symbol["text-max-width"]),"text-line-height":new se(ot.layout_symbol["text-line-height"]),"text-letter-spacing":new se(ot.layout_symbol["text-letter-spacing"]),"text-justify":new se(ot.layout_symbol["text-justify"]),"text-radial-offset":new se(ot.layout_symbol["text-radial-offset"]),"text-variable-anchor":new X(ot.layout_symbol["text-variable-anchor"]),"text-anchor":new se(ot.layout_symbol["text-anchor"]),"text-max-angle":new X(ot.layout_symbol["text-max-angle"]),"text-writing-mode":new X(ot.layout_symbol["text-writing-mode"]),"text-rotate":new se(ot.layout_symbol["text-rotate"]),"text-padding":new X(ot.layout_symbol["text-padding"]),"text-keep-upright":new X(ot.layout_symbol["text-keep-upright"]),"text-transform":new se(ot.layout_symbol["text-transform"]),"text-offset":new se(ot.layout_symbol["text-offset"]),"text-allow-overlap":new X(ot.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new X(ot.layout_symbol["text-ignore-placement"]),"text-optional":new X(ot.layout_symbol["text-optional"])});var T_={paint:new ve({"icon-opacity":new se(ot.paint_symbol["icon-opacity"]),"icon-color":new se(ot.paint_symbol["icon-color"]),"icon-halo-color":new se(ot.paint_symbol["icon-halo-color"]),"icon-halo-width":new se(ot.paint_symbol["icon-halo-width"]),"icon-halo-blur":new se(ot.paint_symbol["icon-halo-blur"]),"icon-translate":new X(ot.paint_symbol["icon-translate"]),"icon-translate-anchor":new X(ot.paint_symbol["icon-translate-anchor"]),"text-opacity":new se(ot.paint_symbol["text-opacity"]),"text-color":new se(ot.paint_symbol["text-color"],{runtimeType:so,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new se(ot.paint_symbol["text-halo-color"]),"text-halo-width":new se(ot.paint_symbol["text-halo-width"]),"text-halo-blur":new se(ot.paint_symbol["text-halo-blur"]),"text-translate":new X(ot.paint_symbol["text-translate"]),"text-translate-anchor":new X(ot.paint_symbol["text-translate-anchor"])}),layout:yM};class C1{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Ns,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Vt(C1,"FormatSectionOverride",{omit:["defaultValue"]});class Lg extends Ks{constructor(e){super(e,T_)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const m of a)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,a,h){const m=this.layout.get(e).evaluate(n,{},a,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Ka(y.value)||!m?m:function(w,E){return E.replace(/{([^{}]+)}/g,(C,R)=>R in w?String(w[R]):"")}(n.properties,m)}createBucket(e){return new nh(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of T_.paint.overridableProperties){if(!Lg.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),a=new C1(n),h=new Bu(a,n.property.specification);let m=null;m=n.value.kind==="constant"||n.value.kind==="source"?new Fu("source",h):new ya("composite",h,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new le(n.property,m,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven())&&Lg.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const a=e.get("text-field"),h=T_.paint.properties[n];let m=!1;const y=w=>{for(const E of w)if(h.overrides&&h.overrides.hasOverride(E))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof xi)y(a.value.value.sections);else if(a.value.kind==="source"){const w=C=>{m||(C instanceof is&&Or(C.value)===Va?y(C.value.sections):C instanceof ws?y(C.sections):C.eachChild(w))},E=a.value;E._styleExpression&&w(E._styleExpression.expression)}return m}getProgramConfiguration(e){return new ol(this,e)}}var _M={paint:new ve({"background-color":new X(ot.paint_background["background-color"]),"background-pattern":new X(ot.paint_background["background-pattern"]),"background-opacity":new X(ot.paint_background["background-opacity"])})},vM={paint:new ve({"raster-opacity":new X(ot.paint_raster["raster-opacity"]),"raster-hue-rotate":new X(ot.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new X(ot.paint_raster["raster-brightness-min"]),"raster-brightness-max":new X(ot.paint_raster["raster-brightness-max"]),"raster-saturation":new X(ot.paint_raster["raster-saturation"]),"raster-contrast":new X(ot.paint_raster["raster-contrast"]),"raster-resampling":new X(ot.paint_raster["raster-resampling"]),"raster-fade-duration":new X(ot.paint_raster["raster-fade-duration"])})};class xM extends Ks{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var wM={paint:new ve({"sky-type":new X(ot.paint_sky["sky-type"]),"sky-atmosphere-sun":new X(ot.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new X(ot.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new X(ot.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new X(ot.paint_sky["sky-gradient-radius"]),"sky-gradient":new ge(ot.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new X(ot.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new X(ot.paint_sky["sky-atmosphere-color"]),"sky-opacity":new X(ot.paint_sky["sky-opacity"])})};function E_(t,e,n){const a=[0,0,1],h=Yh([]);return gp(h,h,n?-lt(t)+Math.PI:lt(t)),ag(h,h,-lt(e)),ef(a,a,h),Ji(a,a)}const bM={circle:class extends Ks{constructor(t){super(t,dg)}createBucket(t){return new Qu(t)}queryRadius(t){const e=t;return ec("circle-radius",this,e)+ec("circle-stroke-width",this,e)+Kc(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,a,h,m,y,w){const E=ff(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,t.pixelToTileUnitsFactor),C=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return Cp(t,a,m,y,w,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",E,C)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new ol(this,t)}},heatmap:class extends Ks{createBucket(t){return new Mp(t)}constructor(t){super(t,si),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ip({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return ec("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,a,h,m,y,w){const E=this.paint.get("heatmap-radius").evaluate(e,n);return Cp(t,a,m,y,w,!0,!0,new Y(0,0),E)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new ol(this,t)}},hillshade:class extends Ks{constructor(t){super(t,fg)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ks{constructor(t){super(t,D)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new ol(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new x(t)}queryRadius(){return Kc(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,a,h,m){return!t.queryGeometry.isAboveHorizon&&sd(eu(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,t.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends Ks{constructor(t){super(t,mA)}createBucket(t){return new Fp(t)}queryRadius(){return Kc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new ol(this,t)}queryIntersectsFeature(t,e,n,a,h,m,y,w,E){const C=ff(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,t.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(e,n),z=this.paint.get("fill-extrusion-base").evaluate(e,n),B=[0,0],$=w&&m.elevation,G=m.elevation?m.elevation.exaggeration():1,K=t.tile.getBucket(this);if($&&K instanceof Fp){const be=K.centroidVertexArray,ke=E+1;ke<be.length&&(B[0]=be.geta_centroid_pos0(ke),B[1]=be.geta_centroid_pos1(ke))}if(B[0]===0&&B[1]===1)return!1;m.projection.name==="globe"&&(a=Bx([a],[new Y(0,0),new Y(nn,nn)],t.tileID.canonical).map(be=>be.polygon).flat());const oe=$?w:null,[fe,Te]=function(be,ke,Me,Ke,We,st,bt,Qe,ut,ct,_t){return be.projection.name==="globe"?function(At,it,jt,Yt,Gt,An,Mt,rn,Mn,sr,kn){const gn=[],kr=[],In=At.projection.upVectorScale(kn,At.center.lat,At.worldSize).metersToTile,Rn=[0,0,0,1],mr=[0,0,0,1],wr=(gr,$r,ni,hi)=>{gr[0]=$r,gr[1]=ni,gr[2]=hi,gr[3]=1},br=Ox();jt>0&&(jt+=br),Yt+=br;for(const gr of it){const $r=[],ni=[];for(const hi of gr){const yr=hi.x+Gt.x,Ci=hi.y+Gt.y,di=At.projection.projectTilePoint(yr,Ci,kn),Xr=At.projection.upVector(kn,hi.x,hi.y);let cr=jt,fi=Yt;if(Mt){const Tr=Vx(yr,Ci,jt,Yt,Mt,rn,Mn,sr);cr+=Tr.base,fi+=Tr.top}jt!==0?wr(Rn,di.x+Xr[0]*In*cr,di.y+Xr[1]*In*cr,di.z+Xr[2]*In*cr):wr(Rn,di.x,di.y,di.z),wr(mr,di.x+Xr[0]*In*fi,di.y+Xr[1]*In*fi,di.z+Xr[2]*In*fi),Ur(Rn,Rn,An),Ur(mr,mr,An),$r.push(new xf(Rn[0],Rn[1],Rn[2])),ni.push(new xf(mr[0],mr[1],mr[2]))}gn.push($r),kr.push(ni)}return[gn,kr]}(be,ke,Me,Ke,We,st,bt,Qe,ut,ct,_t):bt?function(At,it,jt,Yt,Gt,An,Mt,rn,Mn){const sr=[],kn=[],gn=[0,0,0,1];for(const kr of At){const In=[],Rn=[];for(const mr of kr){const wr=mr.x+Yt.x,br=mr.y+Yt.y,gr=Vx(wr,br,it,jt,An,Mt,rn,Mn);gn[0]=wr,gn[1]=br,gn[2]=gr.base,gn[3]=1,Kl(gn,gn,Gt),gn[3]=Math.max(gn[3],1e-5);const $r=new xf(gn[0]/gn[3],gn[1]/gn[3],gn[2]/gn[3]);gn[0]=wr,gn[1]=br,gn[2]=gr.top,gn[3]=1,Kl(gn,gn,Gt),gn[3]=Math.max(gn[3],1e-5);const ni=new xf(gn[0]/gn[3],gn[1]/gn[3],gn[2]/gn[3]);In.push($r),Rn.push(ni)}sr.push(In),kn.push(Rn)}return[sr,kn]}(ke,Me,Ke,We,st,bt,Qe,ut,ct):function(At,it,jt,Yt,Gt){const An=[],Mt=[],rn=Gt[8]*it,Mn=Gt[9]*it,sr=Gt[10]*it,kn=Gt[11]*it,gn=Gt[8]*jt,kr=Gt[9]*jt,In=Gt[10]*jt,Rn=Gt[11]*jt;for(const mr of At){const wr=[],br=[];for(const gr of mr){const $r=gr.x+Yt.x,ni=gr.y+Yt.y,hi=Gt[0]*$r+Gt[4]*ni+Gt[12],yr=Gt[1]*$r+Gt[5]*ni+Gt[13],Ci=Gt[2]*$r+Gt[6]*ni+Gt[14],di=Gt[3]*$r+Gt[7]*ni+Gt[15],Xr=hi+rn,cr=yr+Mn,fi=Ci+sr,Tr=Math.max(di+kn,1e-5),Xo=hi+gn,pi=yr+kr,ro=Ci+In,Gi=Math.max(di+Rn,1e-5);wr.push(new xf(Xr/Tr,cr/Tr,fi/Tr)),br.push(new xf(Xo/Gi,pi/Gi,ro/Gi))}An.push(wr),Mt.push(br)}return[An,Mt]}(ke,Me,Ke,We,st)}(m,a,z,R,C,y,oe,B,G,m.center.lat,t.tileID.canonical),pe=t.queryGeometry;return function(be,ke,Me){let Ke=1/0;sd(Me,ke)&&(Ke=jx(Me,ke[0]));for(let We=0;We<ke.length;We++){const st=ke[We],bt=be[We];for(let Qe=0;Qe<st.length-1;Qe++){const ut=st[Qe],ct=[ut,st[Qe+1],bt[Qe+1],bt[Qe],ut];cf(Me,ct)&&(Ke=Math.min(Ke,jx(Me,ct)))}}return Ke!==1/0&&Ke}(fe,Te,pe.isPointQuery()?pe.screenBounds:pe.screenGeometry)}},line:class extends Ks{constructor(t){super(t,Ux),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ch,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=$x.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new _g(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new ol(this,t)}queryRadius(t){const e=t,n=Gx(ec("line-width",this,e),ec("line-gap-width",this,e)),a=ec("line-offset",this,e);return n/2+Math.abs(a)+Kc(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,a,h,m){if(t.queryGeometry.isAboveHorizon)return!1;const y=eu(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,t.pixelToTileUnitsFactor),w=t.pixelToTileUnitsFactor/2*Gx(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),E=this.paint.get("line-offset").evaluate(e,n);return E&&(a=function(C,R){const z=[],B=new Y(0,0);for(let $=0;$<C.length;$++){const G=C[$],K=[];for(let oe=0;oe<G.length;oe++){const fe=G[oe],Te=G[oe+1],pe=oe===0?B:fe.sub(G[oe-1])._unit()._perp(),be=oe===G.length-1?B:Te.sub(fe)._unit()._perp(),ke=pe._add(be)._unit();ke._mult(1/(ke.x*be.x+ke.y*be.y)),K.push(ke._mult(R)._add(fe))}z.push(K)}return z}(a,E*t.pixelToTileUnitsFactor)),function(C,R,z){for(let B=0;B<R.length;B++){const $=R[B];if(C.length>=3){for(let G=0;G<$.length;G++)if(ul(C,$[G]))return!0}if(ko(C,$,z))return!0}return!1}(y,a,w)}isTileClipped(){return!0}},symbol:Lg,background:class extends Ks{constructor(t){super(t,_M)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ks{constructor(t){super(t,vM)}getProgramIds(){return["raster"]}},sky:class extends Ks{constructor(t){super(t,wM),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ip({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if(this.paint.get("sky-type")==="atmosphere"){const a=this.paint.get("sky-atmosphere-sun"),h=!a,m=t.style.light,y=m.properties.get("position");return h&&m.properties.get("anchor")==="viewport"&&Nn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?E_(y.azimuthal,90-y.polar,e):E_(a[0],90-a[1],e)}const n=this.paint.get("sky-gradient-center");return E_(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}}};class Xp{constructor(e,n,a,h){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(n,h)}update(e,n,a){const{width:h,height:m}=e,{context:y}=this,{gl:w}=y,{HTMLImageElement:E,HTMLCanvasElement:C,HTMLVideoElement:R,ImageData:z,ImageBitmap:B}=I;if(w.bindTexture(w.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!n||n.premultiply!==!1)),a||this.size&&this.size[0]===h&&this.size[1]===m){const{x:$,y:G}=a||{x:0,y:0};e instanceof E||e instanceof C||e instanceof R||e instanceof z||B&&e instanceof B?w.texSubImage2D(w.TEXTURE_2D,0,$,G,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,$,G,h,m,w.RGBA,w.UNSIGNED_BYTE,e.data)}else this.size=[h,m],e instanceof E||e instanceof C||e instanceof R||e instanceof z||B&&e instanceof B?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,h,m,0,this.format,w.UNSIGNED_BYTE,e.data);this.useMipmap=!!(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(e,n){const{context:a}=this,{gl:h}=a;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class TM{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class EM{constructor(){this.tasks={},this.taskQueue=[],yn(["process"],this),this.invoker=new TM(this.process),this.nextId=0}add(e,n){const a=this.nextId++,h=function({type:m,isSymbolTile:y,zoom:w}){return w=w||0,m==="message"?0:m!=="maybePrepare"||y?m!=="parseTile"||y?m==="parseTile"&&y?300-w:m==="maybePrepare"&&y?400-w:500:200-w:100-w}(n);if(h===0){Dr();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:n,priority:h,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){Dr();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let h=0;h<this.taskQueue.length;h++){const m=this.tasks[this.taskQueue[h]];m.priority<n&&(n=m.priority,e=h)}if(e===null)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}class A1{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const a=e[n];this._stringToNumber[a]=n,this._numberToString[n]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const SM=["tile","layer","source","sourceLayer","state"];class M1{constructor(e,n,a,h,m){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=a,this._y=h,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const n of SM)this[n]!==void 0&&(e[n]=this[n]);return e}}const Ra=32,iu=33,rh=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,a=0,h=0,m=0,y=0,w=0;for(1&e?h=m=y=Ra:n=a=w=Ra;(e>>=1)>1;){const C=n+h>>1,R=a+m>>1;1&e?(h=n,m=a,n=y,a=w):(n=h,a=m,h=y,m=w),y=C,w=R}const E=4*t;rh[E+0]=n,rh[E+1]=a,rh[E+2]=h,rh[E+3]=m}const ou=new Uint16Array(2178),ih=new Uint8Array(1089),Dg=new Uint16Array(1089);function k1(t){return t===0?-.03125:t===32?.03125:0}var P1=Fe([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const I1={type:2,extent:nn,loadGeometry:()=>[[new Y(0,0),new Y(nn+1,0),new Y(nn+1,nn+1),new Y(0,nn+1),new Y(0,0)]]};class S_{constructor(e,n,a,h,m){this.tileID=e,this.uid=Wt(),this.uses=0,this.tileSize=n,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=m,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<_s.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=gd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){const y={};if(!m)return y;for(const w of h){const E=w.layerIds.map(C=>m.getLayer(C)).filter(Boolean);if(E.length!==0){w.layers=E,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(C=>E.filter(R=>R.id===C)[0]));for(const C of E)y[C.id]=w}}return y}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof nh){if(this.hasSymbolBuckets=!0,!a)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof nh&&m.hasRTLText){this.hasRTLText=!0,P.isLoading()||P.isLoaded()||b()!=="deferred"||M();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new ur}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const h=this.buckets[a];h.uploadPending()&&h.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Xp(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Xp(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Xp(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,a,h,m,y,w,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:w,transform:y,params:m,tileTransform:this.tileTransform},e,n,a):{}}querySourceFeatures(e,n){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const h=a.loadVTLayers(),m=n?n.sourceLayer:"",y=h._geojsonTileLayer||h[m];if(!y)return;const w=Nl(n&&n.filter),{z:E,x:C,y:R}=this.tileID.canonical,z={z:E,x:C,y:R};for(let B=0;B<y.length;B++){const $=y.feature(B);if(w.needGeometry){const oe=Pa($,!0);if(!w.filter(new L(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!w.filter(new L(this.tileID.overscaledZ),$))continue;const G=a.getId($,m),K=new M1($,E,C,R,G);K.tile=z,e.push(K)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const a=lr(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let h=!1;if(this.expirationTime>a)h=!1;else if(n)if(this.expirationTime<n)h=!0;else{const m=this.expirationTime-n;m?this.expirationTime=a+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!n)return;const a=this.latestFeatureIndex.loadVTLayers(),h=n.style.listImages();for(const m in this.buckets){if(!n.style.hasLayer(m))continue;const y=this.buckets[m],w=y.layers[0].sourceLayer||"_geojsonTileLayer",E=a[w],C=e[w];if(!E||!C||Object.keys(C).length===0)continue;if(y.update(C,E,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof _g||y instanceof x){const z=n.style._getSourceCache(y.layers[0].source);n._terrain&&n._terrain.enabled&&z&&y.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(z.id,this.tileID)}const R=n&&n.style&&n.style.getLayer(m);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_s.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=_s.now()+e}setTexture(e,n){const a=n.context,h=a.gl;this.texture=this.texture||n.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Xp(a,e,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE))}setDependencies(e,n){const a={};for(const h of n)a[h]=!0;this.dependencies[e]=a}hasDependency(e,n){for(const a of e){const h=this.dependencies[a];if(h){for(const m of n)if(h[m])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const a=mo(I1,this.tileID.canonical,this.tileTransform)[0],h=new vt,m=new Co;for(let y=0;y<a.length;y++){const{x:w,y:E}=a[y];h.emplaceBack(w,E),m.emplaceBack(y)}m.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(m),this._tileDebugBuffer=e.createVertexBuffer(h,Qh.members),this._tileDebugSegments=ei.simpleSegment(0,0,h.length,m.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const a=mo(I1,this.tileID.canonical,this.tileTransform)[0];let h,m;if(this.isRaster){const y=function(w,E){const C=gd(w,E),R=Math.pow(2,w.z);for(let oe=0;oe<iu;oe++)for(let fe=0;fe<iu;fe++){const Te=Vi((w.x+(fe+k1(fe))/Ra)/R),pe=ir((w.y+(oe+k1(oe))/Ra)/R),be=E.project(Te,pe),ke=oe*iu+fe;ou[2*ke+0]=Math.round((be.x*C.scale-C.x)*nn),ou[2*ke+1]=Math.round((be.y*C.scale-C.y)*nn)}ih.fill(0),Dg.fill(0);for(let oe=2045;oe>=0;oe--){const fe=4*oe,Te=rh[fe+0],pe=rh[fe+1],be=rh[fe+2],ke=rh[fe+3],Me=Te+be>>1,Ke=pe+ke>>1,We=Me+Ke-pe,st=Ke+Te-Me,bt=pe*iu+Te,Qe=ke*iu+be,ut=Ke*iu+Me,ct=Math.hypot((ou[2*bt+0]+ou[2*Qe+0])/2-ou[2*ut+0],(ou[2*bt+1]+ou[2*Qe+1])/2-ou[2*ut+1])>=16;ih[ut]=ih[ut]||(ct?1:0),oe<1022&&(ih[ut]=ih[ut]||ih[(pe+st>>1)*iu+(Te+We>>1)]||ih[(ke+st>>1)*iu+(be+We>>1)])}const z=new nt,B=new Qt;let $=0;function G(oe,fe){const Te=fe*iu+oe;return Dg[Te]===0&&(z.emplaceBack(ou[2*Te+0],ou[2*Te+1],oe*nn/Ra,fe*nn/Ra),Dg[Te]=++$),Dg[Te]-1}function K(oe,fe,Te,pe,be,ke){const Me=oe+Te>>1,Ke=fe+pe>>1;if(Math.abs(oe-be)+Math.abs(fe-ke)>1&&ih[Ke*iu+Me])K(be,ke,oe,fe,Me,Ke),K(Te,pe,be,ke,Me,Ke);else{const We=G(oe,fe),st=G(Te,pe),bt=G(be,ke);B.emplaceBack(We,st,bt)}}return K(0,0,Ra,Ra,Ra,0),K(Ra,Ra,0,0,0,Ra),{vertices:z,indices:B}}(this.tileID.canonical,n);h=y.vertices,m=y.indices}else{h=new nt,m=new Qt;for(const{x:w,y:E}of a)h.emplaceBack(w,E,0,0);const y=_f(h.int16,void 0,4);for(let w=0;w<y.length;w+=3)m.emplaceBack(y[w],y[w+1],y[w+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,P1.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(m),this._tileBoundsSegments=ei.simpleSegment(0,0,h.length,m.length)}_makeGlobeTileDebugBuffers(e,n){const a=n.projection;if(!a||a.name!=="globe"||n.freezeTileCoverage)return;const h=this.tileID.canonical,m=Ao(vp(h,n)),y=Zc(n.zoom);let w;y>0&&(w=cs(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,h,n,m,w,y),this._makeGlobeTileDebugTextBuffer(e,h,n,m,w,y)}_globePoint(e,n,a,h,m,y,w){let E=Ps(e,n,a);if(y){const C=1<<a.z,R=vr(h.center.lng),z=Br(h.center.lat),B=(a.x+.5)/C-R;let $=0;B>.5?$=-1:B<-.5&&($=1);let G=(e/nn+a.x)/C+$,K=(n/nn+a.y)/C;G=(G-R)*h._pixelsPerMercatorPixel+R,K=(K-z)*h._pixelsPerMercatorPixel+z;const oe=[G*h.worldSize,K*h.worldSize,0];Ur(oe,oe,y),E=ll(E,oe,w)}return Ur(E,E,m)}_makeGlobeTileDebugBorderBuffer(e,n,a,h,m,y){const w=new vt,E=new Co,C=new qe,R=(B,$,G,K,oe)=>{const fe=(G-B)/(oe-1),Te=(K-$)/(oe-1),pe=w.length;for(let be=0;be<oe;be++){const ke=B+be*fe,Me=$+be*Te;w.emplaceBack(ke,Me);const Ke=this._globePoint(ke,Me,n,a,h,m,y);C.emplaceBack(Ke[0],Ke[1],Ke[2]),E.emplaceBack(pe+be)}},z=nn;R(0,0,z,0,16),R(z,0,z,z,16),R(z,z,0,z,16),R(0,z,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(E),this._tileDebugBuffer=e.createVertexBuffer(w,Qh.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(C,Aa.members),this._tileDebugSegments=ei.simpleSegment(0,0,w.length,E.length)}_makeGlobeTileDebugTextBuffer(e,n,a,h,m,y){const w=nn/4,E=new vt,C=new Qt,R=new qe,z=25;C.reserve(32),E.reserve(z),R.reserve(z);const B=($,G)=>z*$+G;for(let $=0;$<z;$++){const G=$*w;for(let K=0;K<z;K++){const oe=K*w;E.emplaceBack(oe,G);const fe=this._globePoint(oe,G,n,a,h,m,y);R.emplaceBack(fe[0],fe[1],fe[2])}}for(let $=0;$<4;$++)for(let G=0;G<4;G++){const K=B($,G),oe=B($,G+1),fe=B($+1,G),Te=B($+1,G+1);C.emplaceBack(K,oe,fe),C.emplaceBack(fe,oe,Te)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(C),this._tileDebugTextBuffer=e.createVertexBuffer(E,Qh.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(R,Aa.members),this._tileDebugTextSegments=ei.simpleSegment(0,0,z,32)}}class CM{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,a){const h=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},kt(this.stateChanges[e][h],a),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const m in this.state[e][h])a[m]||(this.deletedStates[e][h][m]=null)}else for(const m in a)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][m]===null&&delete this.deletedStates[e][h][m]}removeFeatureState(e,n,a){if(this.deletedStates[e]===null)return;const h=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&n!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][a]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(a in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][a]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,n){const a=String(n),h=kt({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][n];if(m===null)return{};for(const y in m)delete h[y]}return h}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const a={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const y in this.stateChanges[h])this.state[h][y]||(this.state[h][y]={}),kt(this.state[h][y],this.stateChanges[h][y]),m[y]=this.state[h][y];a[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const y in this.state[h])m[y]={},this.state[h][y]={};else for(const y in this.deletedStates[h]){if(this.deletedStates[h][y]===null)this.state[h][y]={};else if(this.state[h][y])for(const w of Object.keys(this.deletedStates[h][y]))delete this.state[h][y][w];m[y]=this.state[h][y]}a[h]=a[h]||{},kt(a[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(a).length!==0)for(const h in e)e[h].setFeatureState(a,n)}}class R1{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const a=this.toIdx(e,n);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function L1(t,e,n,a){let h=0,m=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(a[y])<1e-15){if(n[y]<t[y]||n[y]>e[y])return null}else{const w=1/a[y];let E=(t[y]-n[y])*w,C=(e[y]-n[y])*w;if(E>C){const R=E;E=C,C=R}if(E>h&&(h=E),C<m&&(m=C),h>m)return null}return h}function D1(t,e,n,a,h,m,y,w,E,C,R){const z=a-t,B=h-e,$=m-n,G=y-t,K=w-e,oe=E-n,fe=R[1]*oe-R[2]*K,Te=R[2]*G-R[0]*oe,pe=R[0]*K-R[1]*G,be=z*fe+B*Te+$*pe;if(Math.abs(be)<1e-15)return null;const ke=1/be,Me=C[0]-t,Ke=C[1]-e,We=C[2]-n,st=(Me*fe+Ke*Te+We*pe)*ke;if(st<0||st>1)return null;const bt=Ke*$-We*B,Qe=We*z-Me*$,ut=Me*B-Ke*z,ct=(R[0]*bt+R[1]*Qe+R[2]*ut)*ke;return ct<0||st+ct>1?null:(G*bt+K*Qe+oe*ut)*ke}function z1(t,e,n){return(t-e)/(n-e)}function O1(t,e,n,a,h,m,y,w,E){const C=1<<n,R=m-a,z=y-h,B=(t+1)/C*R+a,$=(e+0)/C*z+h,G=(e+1)/C*z+h;w[0]=(t+0)/C*R+a,w[1]=$,E[0]=B,E[1]=G}class B1{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(m){const y=Math.ceil(Math.log2(m.dim/8)),w=[];let E=Math.ceil(Math.pow(2,y));const C=1/E,R=($,G,K,oe,fe)=>{const Te=oe?1:0,pe=($+1)*K-Te,be=G*K,ke=(G+1)*K-Te;fe[0]=$*K,fe[1]=be,fe[2]=pe,fe[3]=ke};let z=new R1(E);const B=[];for(let $=0;$<E*E;$++){R($%E,Math.floor($/E),C,!1,B);const G=oh(B[0],B[1],m),K=oh(B[2],B[1],m),oe=oh(B[2],B[3],m),fe=oh(B[0],B[3],m);z.minimums.push(Math.min(G,K,oe,fe)),z.maximums.push(Math.max(G,K,oe,fe)),z.leaves.push(1)}for(w.push(z),E/=2;E>=1;E/=2){const $=w[w.length-1];z=new R1(E);for(let G=0;G<E*E;G++){R(G%E,Math.floor(G/E),2,!0,B);const K=$.getElevation(B[0],B[1]),oe=$.getElevation(B[2],B[1]),fe=$.getElevation(B[2],B[3]),Te=$.getElevation(B[0],B[3]),pe=$.isLeaf(B[0],B[1]),be=$.isLeaf(B[2],B[1]),ke=$.isLeaf(B[2],B[3]),Me=$.isLeaf(B[0],B[3]),Ke=Math.min(K.min,oe.min,fe.min,Te.min),We=Math.max(K.max,oe.max,fe.max,Te.max),st=pe&&be&&ke&&Me;z.maximums.push(We),z.minimums.push(Ke),z.leaves.push(We-Ke<=5&&st?1:0)}w.push(z)}return w}(this.dem),a=n.length-1,h=n[a];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(n,0,0,a,0)}raycastRoot(e,n,a,h,m,y,w=1){return L1([e,n,-100],[a,h,this.maximums[0]*w],m,y)}raycast(e,n,a,h,m,y,w=1){if(!this.nodeCount)return null;const E=this.raycastRoot(e,n,a,h,m,y,w);if(E==null)return null;const C=[],R=[],z=[],B=[],$=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;$.length>0;){const{idx:G,t:K,nodex:oe,nodey:fe,depth:Te}=$.pop();if(this.leaves[G]){O1(oe,fe,Te,e,n,a,h,z,B);const be=1<<Te,ke=(oe+0)/be,Me=(oe+1)/be,Ke=(fe+0)/be,We=(fe+1)/be,st=oh(ke,Ke,this.dem)*w,bt=oh(Me,Ke,this.dem)*w,Qe=oh(Me,We,this.dem)*w,ut=oh(ke,We,this.dem)*w,ct=D1(z[0],z[1],st,B[0],z[1],bt,B[0],B[1],Qe,m,y),_t=D1(B[0],B[1],Qe,z[0],B[1],ut,z[0],z[1],st,m,y),At=Math.min(ct!==null?ct:Number.MAX_VALUE,_t!==null?_t:Number.MAX_VALUE);if(At!==Number.MAX_VALUE)return At;{const it=Uc([],m,y,K);if(F1(st,bt,ut,Qe,z1(it[0],z[0],B[0]),z1(it[1],z[1],B[1]))>=it[2])return K}continue}let pe=0;for(let be=0;be<this._siblingOffset.length;be++){O1((oe<<1)+this._siblingOffset[be][0],(fe<<1)+this._siblingOffset[be][1],Te+1,e,n,a,h,z,B),z[2]=-100,B[2]=this.maximums[this.childOffsets[G]+be]*w;const ke=L1(z,B,m,y);if(ke!=null){const Me=ke;C[be]=Me;let Ke=!1;for(let We=0;We<pe&&!Ke;We++)Me>=C[R[We]]&&(R.splice(We,0,be),Ke=!0);Ke||(R[pe]=be),pe++}}for(let be=0;be<pe;be++){const ke=R[be];$.push({idx:this.childOffsets[G]+ke,t:C[ke],nodex:(oe<<1)+this._siblingOffset[ke][0],nodey:(fe<<1)+this._siblingOffset[ke][1],depth:Te+1})}}return null}_addNode(e,n,a){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,a,h,m){if(e[h].isLeaf(n,a)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const y=h-1,w=e[y];let E=0,C=0;for(let R=0;R<this._siblingOffset.length;R++){const z=2*n+this._siblingOffset[R][0],B=2*a+this._siblingOffset[R][1],$=w.getElevation(z,B),G=w.isLeaf(z,B),K=this._addNode($.min,$.max,G);G&&(E|=1<<R),C||(C=K)}for(let R=0;R<this._siblingOffset.length;R++)E&1<<R||this._construct(e,2*n+this._siblingOffset[R][0],2*a+this._siblingOffset[R][1],y,C+R)}}function F1(t,e,n,a,h,m){return Zn(Zn(t,n,m),Zn(e,a,m),h)}function oh(t,e,n){const a=n.dim,h=Et(t*a-.5,0,a-1),m=Et(e*a-.5,0,a-1),y=Math.floor(h),w=Math.floor(m),E=Math.min(y+1,a-1),C=Math.min(w+1,a-1);return F1(n.get(y,w),n.get(E,w),n.get(y,C),n.get(E,C),h-y,m-w)}const N1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function AM(t,e,n){return(256*t*256+256*e+n)/10-1e4}function MM(t,e,n){return 256*t+e+n/256-32768}class zg{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,a,h=!1,m=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return Nn(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const y=this.dim=n.height-2,w=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=a||"mapbox",this.borderReady=h,!h){for(let E=0;E<y;E++)w[this._idx(-1,E)]=w[this._idx(0,E)],w[this._idx(y,E)]=w[this._idx(y-1,E)],w[this._idx(E,-1)]=w[this._idx(E,0)],w[this._idx(E,y)]=w[this._idx(E,y-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(y,-1)]=w[this._idx(y-1,0)],w[this._idx(-1,y)]=w[this._idx(0,y-1)],w[this._idx(y,y)]=w[this._idx(y-1,y-1)],m&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new B1(this)}get(e,n,a=!1){a&&(e=Et(e,-1,this.dim),n=Et(n,-1,this.dim));const h=4*this._idx(e,n);return(this.encoding==="terrarium"?MM:AM)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(e){return N1[e]}get unpackVector(){return N1[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}static pack(e,n){const a=[0,0,0,0],h=zg.getUnpackVector(n);let m=Math.floor((e+h[3])/h[2]);return a[2]=m%256,m=Math.floor(m/256),a[1]=m%256,m=Math.floor(m/256),a[0]=m,a}getPixels(){return new Po({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,m=n*this.dim+this.dim,y=a*this.dim,w=a*this.dim+this.dim;switch(n){case-1:h=m-1;break;case 1:m=h+1}switch(a){case-1:y=w-1;break;case 1:w=y+1}const E=-n*this.dim,C=-a*this.dim;for(let R=y;R<w;R++)for(let z=h;z<m;z++){const B=4*this._idx(z,R),$=4*this._idx(z+E,R+C);this.pixels[B+0]=e.pixels[$+0],this.pixels[B+1]=e.pixels[$+1],this.pixels[B+2]=e.pixels[$+2],this.pixels[B+3]=e.pixels[$+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Vt(zg,"DEMData"),Vt(B1,"DemMinMaxQuadTree",{omit:["dem"]});class kM{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,a){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:n,timeout:void 0};if(a!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},a)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const a=e.wrapped().key,h=n===void 0?0:this.data[a].indexOf(n),m=this.data[a][h];return this.data[a].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[a].length===0&&delete this.data[a],this.onRemove(m.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const a in this.data)for(const h of this.data[a])e(h.value)||n.push(h);for(const a of n)this.remove(a.value.tileID,a)}}class kf{constructor(e,n,a){this.func=e,this.mask=n,this.range=a}}kf.ReadOnly=!1,kf.ReadWrite=!0,kf.disabled=new kf(519,kf.ReadOnly,[0,1]);const C_=7680;class A_{constructor(e,n,a,h,m,y){this.test=e,this.ref=n,this.mask=a,this.fail=h,this.depthFail=m,this.pass=y}}A_.disabled=new A_({func:519,mask:0},0,0,C_,C_,C_);class su{constructor(e,n,a){this.blendFunction=e,this.blendColor=n,this.mask=a}}su.Replace=[1,0],su.disabled=new su(su.Replace,dr.transparent,[!1,!1,!1,!1]),su.unblended=new su(su.Replace,dr.transparent,[!0,!0,!0,!0]),su.alphaBlended=new su([1,771],dr.transparent,[!0,!0,!0,!0]);const M_=1029,k_=2305;class dl{constructor(e,n,a){this.enable=e,this.mode=n,this.frontFace=a}}dl.disabled=new dl(!1,M_,k_),dl.backCCW=new dl(!0,M_,k_),dl.backCW=new dl(!0,M_,2304),dl.frontCW=new dl(!0,1028,2304),dl.frontCCW=new dl(!0,1028,k_);class yd extends oo{constructor(e,n,a){super(),this.id=e,this._onlySymbols=a,n.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new kM(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new CM,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const a=this._tiles[n];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return Pt(this._tiles).map(e=>e.tileID).sort(j1).map(e=>e.key)}getRenderableIds(e){const n=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&n.push(this._tiles[a]);return e?n.sort((a,h)=>{const m=a.tileID,y=h.tileID,w=new Y(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),E=new Y(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-y.overscaledZ||E.y-w.y||E.x-w.x}).map(a=>a.tileID.key):n.map(a=>a.tileID).sort(j1).map(a=>a.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const a=this._tiles[e];a&&(a.state!=="loading"&&(a.state=n),this._loadTile(a,this._tileLoaded.bind(this,a,e,n)))}_tileLoaded(e,n,a,h){if(h)if(e.state="errored",h.status!==404)this._source.fire(new Do(h,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const m=this.map.painter.terrain;this.update(this.transform,m.getScaledDemTileSize(),!0),m.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=_s.now(),a==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new la("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let h=0;h<n.length;h++){const m=n[h];if(e.neighboringTiles&&e.neighboringTiles[m]){const y=this.getTileByID(m);a(e,y),a(y,e)}}function a(h,m){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let y=m.tileID.canonical.x-h.tileID.canonical.x;const w=m.tileID.canonical.y-h.tileID.canonical.y,E=Math.pow(2,h.tileID.canonical.z),C=m.tileID.key;y===0&&w===0||Math.abs(w)>1||(Math.abs(y)>1&&(Math.abs(y+E)===1?y+=E:Math.abs(y-E)===1&&(y-=E)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,y,w),h.neighboringTiles&&h.neighboringTiles[C]&&(h.neighboringTiles[C].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,a,h){for(const m in this._tiles){let y=this._tiles[m];if(h[m]||!y.hasData()||y.tileID.overscaledZ<=n||y.tileID.overscaledZ>a)continue;let w=y.tileID;for(;y&&y.tileID.overscaledZ>n+1;){const C=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[C.key],y&&y.hasData()&&(w=C)}let E=w;for(;E.overscaledZ>n;)if(E=E.scaledTo(E.overscaledZ-1),e[E.key]){h[w.key]=w;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=n?a:null}for(let a=e.overscaledZ-1;a>=n;a--){const h=e.scaledTo(a),m=this._getLoadedTile(h);if(m)return m}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const a=Math.ceil(e.width/n)+1,h=Math.ceil(e.height/n)+1,m=Math.floor(a*h*5),y=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,m):m,w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(w)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const a={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+n),a[m.tileID.key]=m}this._tiles=a;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,n,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let h;this.updateCacheSize(e,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new Ho(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(h=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(w=>this._source.hasTile(w)))):h=[];const m=this._updateRetainedTiles(h);if(V1(this._source.type)&&h.length!==0){const w={},E={},C=Object.keys(m);for(const z of C){const B=m[z],$=this._tiles[z];if(!$||$.fadeEndTime&&$.fadeEndTime<=_s.now())continue;const G=this.findLoadedParent(B,Math.max(B.overscaledZ-yd.maxOverzooming,this._source.minzoom));G&&(this._addTile(G.tileID),w[G.tileID.key]=G.tileID),E[z]=B}const R=h[h.length-1].overscaledZ;for(const z in this._tiles){const B=this._tiles[z];if(m[z]||!B.hasData())continue;let $=B.tileID;for(;$.overscaledZ>R;){$=$.scaledTo($.overscaledZ-1);const G=this._tiles[$.key];if(G&&G.hasData()&&E[$.key]){m[z]=B.tileID;break}}}for(const z in w)m[z]||(this._coveredTiles[z]=!0,m[z]=w[z])}for(const w in m)this._tiles[w].clearFadeHold();const y=function(w,E){const C=[];for(const R in w)R in E||C.push(R);return C}(this._tiles,m);for(const w of y){const E=this._tiles[w];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(e.length===0)return n;const a={},h=e.reduce((C,R)=>Math.min(C,R.overscaledZ),1/0),m=e[0].overscaledZ,y=Math.max(m-yd.maxOverzooming,this._source.minzoom),w=Math.max(m+yd.maxUnderzooming,this._source.minzoom),E={};for(const C of e){const R=this._addTile(C);n[C.key]=C,R.hasData()||h<this._source.maxzoom&&(E[C.key]=C)}this._retainLoadedChildren(E,h,w,n);for(const C of e){let R=this._tiles[C.key];if(R.hasData())continue;if(C.canonical.z>=this._source.maxzoom){const B=C.children(this._source.maxzoom)[0],$=this.getTile(B);if($&&$.hasData()){n[B.key]=B;continue}}else{const B=C.children(this._source.maxzoom);if(n[B[0].key]&&n[B[1].key]&&n[B[2].key]&&n[B[3].key])continue}let z=R.wasRequested();for(let B=C.overscaledZ-1;B>=y;--B){const $=C.scaledTo(B);if(a[$.key]||(a[$.key]=!0,R=this.getTile($),!R&&z&&(R=this._addTile($)),R&&(n[$.key]=$,z=R.wasRequested(),R.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let a,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){a=this._loadedParentTiles[h.key];break}n.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(a=this._getLoadedTile(m),a)break;h=m}for(const m of n)this._loadedParentTiles[m]=a}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const a=!!n;if(!a){const h=this.map?this.map.painter:null;n=new S_(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,a||this._source.fire(new la("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=n.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,a){const h=[],m=this.transform;if(!m)return h;const y=m.projection.name==="globe",w=vr(m.center.lng);for(const E in this._tiles){const C=this._tiles[E];if(a&&C.clearQueryDebugViz(),C.holdingForFade())continue;let R;if(y){const z=C.tileID.canonical;if(z.z===0){const B=[Math.abs(Et(w,...Kp(z,-1))-w),Math.abs(Et(w,...Kp(z,1))-w)];R=[0,2*B.indexOf(Math.min(...B))-1]}else{const B=[Math.abs(Et(w,...Kp(z,-1))-w),Math.abs(Et(w,...Kp(z,0))-w),Math.abs(Et(w,...Kp(z,1))-w)];R=[B.indexOf(Math.min(...B))-1]}}else R=[0];for(const z of R){const B=e.containsTile(C,m,n,z);B&&h.push(B)}}return h}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of n)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(V1(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=_s.now())return!0}return!1}setFeatureState(e,n,a){this._state.updateState(e=e||"_geojsonTileLayer",n,a)}removeFeatureState(e,n,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,a)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,a){const h=this._tiles[e];h&&h.setDependencies(n,a)}reloadTilesForDependencies(e,n){for(const a in this._tiles)this._tiles[a].hasDependency(e,n)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,n))}_preloadTiles(e,n){if(!this._sourceLoaded){const w=()=>{this._sourceLoaded&&(this._source.off("data",w),this._preloadTiles(e,n))};return void this._source.on("data",w)}const a=new Map,h=Array.isArray(e)?e:[e],m=this.map.painter.terrain,y=this.usedForTerrain&&m?m.getScaledDemTileSize():this._source.tileSize;for(const w of h){const E=w.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const C of E)a.set(C.key,C);this.usedForTerrain&&w.updateElevation(!1)}Ue(Array.from(a.values()),(w,E)=>{const C=new S_(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(C,R=>{this._source.type==="raster-dem"&&C.dem&&this._backfillDEM(C),E(R,C)})},n)}}function j1(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||a-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function V1(t){return t==="raster"||t==="image"||t==="video"||t==="custom"}function Kp(t,e){const n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}yd.maxOverzooming=10,yd.maxUnderzooming=3;class Og{constructor(e,n,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=a}static create(e,n,a){const h=a||e.findDEMTileFor(n);if(!h||!h.dem)return;const m=h.dem,y=h.tileID,w=1<<n.canonical.z-y.canonical.z;return new Og(h,h.tileSize/nn/w,[(n.canonical.x/w-y.canonical.x)*m.dim,(n.canonical.y/w-y.canonical.y)*m.dim])}tileCoordToPixel(e,n){const a=n*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),m=Math.floor(a);return new Y(h,m)}getElevationAt(e,n,a,h){const m=e*this._scale+this._offset[0],y=n*this._scale+this._offset[1],w=Math.floor(m),E=Math.floor(y),C=this._dem;return h=!!h,a?Zn(Zn(C.get(w,E,h),C.get(w,E+1,h),y-E),Zn(C.get(w+1,E,h),C.get(w+1,E+1,h),y-E),m-w):C.get(w,E,h)}getElevationAtPixel(e,n,a){return this._dem.get(e,n,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*ti(1,e)*this._dem.stride}}class U1{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Cs(nn,16,0),this.featureIndexArray=new Zr,this.promoteId=n}insert(e,n,a,h,m,y=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,m,y);const E=this.grid;for(let C=0;C<n.length;C++){const R=n[C],z=[1/0,1/0,-1/0,-1/0];for(let B=0;B<R.length;B++){const $=R[B];z[0]=Math.min(z[0],$.x),z[1]=Math.min(z[1],$.y),z[2]=Math.max(z[2],$.x),z[3]=Math.max(z[3],$.y)}z[0]<nn&&z[1]<nn&&z[2]>=0&&z[3]>=0&&E.insert(w,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new hn(new wg(this.rawTileData)).layers,this.sourceLayerCoder=new A1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,a,h){this.loadVTLayers();const m=e.params||{},y=Nl(m.filter),w=e.tileResult,E=e.transform,C=w.bufferedTilespaceBounds,R=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(G,K,oe,fe)=>hg(w.bufferedTilespaceGeometry,G,K,oe,fe));R.sort(PM);let z=null;E.elevation&&R.length>0&&(z=Og.create(E.elevation,this.tileID));const B={};let $;for(let G=0;G<R.length;G++){const K=R[G];if(K===$)continue;$=K;const oe=this.featureIndexArray.get(K);let fe=null;this.loadMatchingFeature(B,oe,y,m.layers,m.availableImages,n,a,h,(Te,pe,be,ke=0)=>(fe||(fe=mo(Te,this.tileID.canonical,e.tileTransform)),pe.queryIntersectsFeature(w,Te,be,fe,this.z,e.transform,e.pixelPosMatrix,z,ke)))}return B}loadMatchingFeature(e,n,a,h,m,y,w,E,C){const{featureIndex:R,bucketIndex:z,sourceLayerIndex:B,layoutVertexArrayOffset:$}=n,G=this.bucketLayerIDs[z];if(h&&!function(Te,pe){for(let be=0;be<Te.length;be++)if(pe.indexOf(Te[be])>=0)return!0;return!1}(h,G))return;const K=this.sourceLayerCoder.decode(B),oe=this.vtLayers[K].feature(R);if(a.needGeometry){const Te=Pa(oe,!0);if(!a.filter(new L(this.tileID.overscaledZ),Te,this.tileID.canonical))return}else if(!a.filter(new L(this.tileID.overscaledZ),oe))return;const fe=this.getId(oe,K);for(let Te=0;Te<G.length;Te++){const pe=G[Te];if(h&&h.indexOf(pe)<0)continue;const be=y[pe];if(!be)continue;let ke={};fe!==void 0&&E&&(ke=E.getState(be.sourceLayer||"_geojsonTileLayer",fe));const Me=kt({},w[pe]);Me.paint=$1(Me.paint,be.paint,oe,ke,m),Me.layout=$1(Me.layout,be.layout,oe,ke,m);const Ke=!C||C(oe,be,ke,$);if(!Ke)continue;const We=new M1(oe,this.z,this.x,this.y,fe);We.layer=Me;let st=e[pe];st===void 0&&(st=e[pe]=[]),st.push({featureIndex:R,feature:We,intersectionZ:Ke})}}lookupSymbolFeatures(e,n,a,h,m,y,w,E){const C={};this.loadVTLayers();const R=Nl(m);for(const z of e)this.loadMatchingFeature(C,{bucketIndex:a,sourceLayerIndex:h,featureIndex:z,layoutVertexArrayOffset:0},R,y,w,E,n);return C}loadFeature(e){const{featureIndex:n,sourceLayerIndex:a}=e;this.loadVTLayers();const h=this.sourceLayerCoder.decode(a),m=this.vtFeatures[h];if(m[n])return m[n];const y=this.vtLayers[h].feature(n);return m[n]=y,y}hasLayer(e){for(const n of this.bucketLayerIDs)for(const a of n)if(e===a)return!0;return!1}getId(e,n){let a=e.id;if(this.promoteId){const h=typeof this.promoteId=="string"?this.promoteId:this.promoteId[n];h!=null&&(a=e.properties[h]),typeof a=="boolean"&&(a=Number(a))}return a}}function $1(t,e,n,a,h){return Xt(t,(m,y)=>{const w=e instanceof he?e.get(y):null;return w&&w.evaluate?w.evaluate(n,a,h):w})}function PM(t,e){return e-t}Vt(U1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class G1{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new Zo({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const a=this.getKey(e,n);return this.positions[a]}trim(){const e=this.width,n=this.height=Ft(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,a){const h=[];let m=e.length%2==1?-e[e.length-1]*a:0,y=e[0]*a,w=!0;h.push({left:m,right:y,isDash:w,zeroLength:e[0]===0});let E=e[0];for(let C=1;C<e.length;C++){w=!w;const R=e[C];m=E*a,E+=R,y=E*a,h.push({left:m,right:y,isDash:w,zeroLength:R===0})}return h}addRoundDash(e,n,a){const h=n/2;for(let m=-a;m<=a;m++){const y=this.width*(this.nextRow+a+m);let w=0,E=e[w];for(let C=0;C<this.width;C++){C/E.right>1&&(E=e[++w]);const R=Math.abs(C-E.left),z=Math.abs(C-E.right),B=Math.min(R,z);let $;const G=m/a*(h+1);if(E.isDash){const K=h-Math.abs(G);$=Math.sqrt(B*B+K*K)}else $=h-Math.sqrt(B*B+G*G);this.image.data[y+C]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(e,n){for(let E=e.length-1;E>=0;--E){const C=e[E],R=e[E+1];C.zeroLength?e.splice(E,1):R&&R.isDash===C.isDash&&(R.left=C.left,e.splice(E,1))}const a=e[0],h=e[e.length-1];a.isDash===h.isDash&&(a.left=h.left-this.width,h.right=a.right+this.width);const m=this.width*this.nextRow;let y=0,w=e[y];for(let E=0;E<this.width;E++){E/w.right>1&&(w=e[++y]);const C=Math.abs(E-w.left),R=Math.abs(E-w.right),z=Math.min(C,R);this.image.data[m+E]=Math.max(0,Math.min(255,(w.isDash?z:-z)+n+128))}}addDash(e,n){const a=this.getKey(e,n);if(this.positions[a])return this.positions[a];const h=n==="round",m=h?7:0,y=2*m+1;if(this.nextRow+y>this.height)return Nn("LineAtlas out of space"),null;e.length===0&&e.push(1);let w=0;for(let R=0;R<e.length;R++)e[R]<0&&(Nn("Negative value is found in line dasharray, replacing values with 0"),e[R]=0),w+=e[R];if(w!==0){const R=this.width/w,z=this.getDashRanges(e,this.width,R);h?this.addRoundDash(z,R,m):this.addRegularDash(z,n==="square"?.5*R:0)}const E=this.nextRow+m;this.nextRow+=y;const C={tl:[E,m],br:[w,0]};return this.positions[a]=C,C}}Vt(G1,"LineAtlas");const q1=1*hl;class W1{constructor(e){const n={},a=[];for(const w in e){const E=e[w],C=n[w]={};for(const R in E.glyphs){const z=E.glyphs[+R];if(!z||z.bitmap.width===0||z.bitmap.height===0)continue;const B=z.metrics.localGlyph?q1:1,$={x:0,y:0,w:z.bitmap.width+2*B,h:z.bitmap.height+2*B};a.push($),C[R]=$}}const{w:h,h:m}=f_(a),y=new Zo({width:h||1,height:m||1});for(const w in e){const E=e[w];for(const C in E.glyphs){const R=E.glyphs[+C];if(!R||R.bitmap.width===0||R.bitmap.height===0)continue;const z=n[w][C],B=R.metrics.localGlyph?q1:1;Zo.copy(R.bitmap,y,{x:0,y:0},{x:z.x+B,y:z.y+B},R.bitmap)}}this.image=y,this.positions=n}}Vt(W1,"GlyphAtlas");class IM{constructor(e){this.tileID=new Ho(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=gd(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,a,h,m){this.status="parsing",this.data=e,this.collisionBoxArray=new ur;const y=new A1(Object.keys(e.layers).sort()),w=new U1(this.tileID,this.promoteId);w.bucketLayerIDs=[];const E={},C=new G1(256,256),R={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:C,availableImages:a},z=n.familiesBySource[this.source];for(const ke in z){const Me=e.layers[ke];if(!Me)continue;let Ke=!1,We=!1;for(const Qe of z[ke])Qe[0].type==="symbol"?Ke=!0:We=!0;if(this.isSymbolTile===!0&&!Ke||this.isSymbolTile===!1&&!We)continue;Me.version===1&&Nn(`Vector tile source "${this.source}" layer "${ke}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const st=y.encode(ke),bt=[];for(let Qe=0;Qe<Me.length;Qe++){const ut=Me.feature(Qe),ct=w.getId(ut,ke);bt.push({feature:ut,id:ct,index:Qe,sourceLayerIndex:st})}for(const Qe of z[ke]){const ut=Qe[0];this.isSymbolTile!==void 0&&ut.type==="symbol"!==this.isSymbolTile||ut.minzoom&&this.zoom<Math.floor(ut.minzoom)||ut.maxzoom&&this.zoom>=ut.maxzoom||ut.visibility!=="none"&&(P_(Qe,this.zoom,a),(E[ut.id]=ut.createBucket({index:w.bucketLayerIDs.length,layers:Qe,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:st,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:a})).populate(bt,R,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(Qe.map(ct=>ct.id)))}}let B,$,G,K;C.trim();const oe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},fe=()=>{if(B)return m(B);if($&&G&&K){const ke=new W1($),Me=new Qx(G,K);for(const Ke in E){const We=E[Ke];We instanceof nh?(P_(We.layers,this.zoom,a),rM(We,$,ke.positions,G,Me.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection)):We.hasPattern&&(We instanceof _g||We instanceof x||We instanceof Fp)&&(P_(We.layers,this.zoom,a),We.addFeatures(R,this.tileID.canonical,Me.patternPositions,a,this.tileTransform))}this.status="done",m(null,{buckets:Pt(E).filter(Ke=>!Ke.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ke.image,lineAtlas:C,imageAtlas:Me,glyphMap:this.returnDependencies?$:null,iconMap:this.returnDependencies?G:null,glyphPositions:this.returnDependencies?ke.positions:null})}},Te=Xt(R.glyphDependencies,ke=>Object.keys(ke).map(Number));Object.keys(Te).length?h.send("getGlyphs",{uid:this.uid,stacks:Te},(ke,Me)=>{B||(B=ke,$=Me,fe())},void 0,!1,oe):$={};const pe=Object.keys(R.iconDependencies);pe.length?h.send("getImages",{icons:pe,source:this.source,tileID:this.tileID,type:"icons"},(ke,Me)=>{B||(B=ke,G=Me,fe())},void 0,!1,oe):G={};const be=Object.keys(R.patternDependencies);be.length?h.send("getImages",{icons:be,source:this.source,tileID:this.tileID,type:"patterns"},(ke,Me)=>{B||(B=ke,K=Me,fe())},void 0,!1,oe):K={},fe()}}function P_(t,e,n){const a=new L(e);for(const h of t)h.recalculate(a,n)}class Z1{constructor(e){this.entries={},this.scheduler=e}request(e,n,a,h){const m=this.entries[e]=this.entries[e]||{callbacks:[]};if(m.result){const[y,w]=m.result;return this.scheduler?this.scheduler.add(()=>{h(y,w)},n):h(y,w),()=>{}}return m.callbacks.push(h),m.cancel||(m.cancel=a((y,w)=>{m.result=[y,w];for(const E of m.callbacks)this.scheduler?this.scheduler.add(()=>{E(y,w)},n):E(y,w);setTimeout(()=>delete this.entries[e],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(y=>y!==h),m.callbacks.length||(m.cancel(),delete this.entries[e]))}}}function H1(t,e,n){const a=JSON.stringify(t.request);return t.data&&(this.deduped.entries[a]={result:[null,t.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},h=>{const m=gs(t.request,(y,w,E,C)=>{y?h(y):w&&h(null,{vectorTile:n?void 0:new hn(new wg(w)),rawData:w,cacheControl:E,expires:C})});return()=>{m.cancel(),h()}},e)}const X1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class I_{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,a]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=X1[15&a];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[w]=new Uint32Array(e,4,1);return new I_(w,y,m,e)}constructor(e,n=64,a=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const m=X1.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,w=e*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-w%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+E,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+w+E),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+E,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=n,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return R_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:w}=this,E=[0,m.length-1,0],C=[];for(;E.length;){const R=E.pop()||0,z=E.pop()||0,B=E.pop()||0;if(z-B<=w){for(let oe=B;oe<=z;oe++){const fe=y[2*oe],Te=y[2*oe+1];fe>=e&&fe<=a&&Te>=n&&Te<=h&&C.push(m[oe])}continue}const $=B+z>>1,G=y[2*$],K=y[2*$+1];G>=e&&G<=a&&K>=n&&K<=h&&C.push(m[$]),(R===0?e<=G:n<=K)&&(E.push(B),E.push($-1),E.push(1-R)),(R===0?a>=G:h>=K)&&(E.push($+1),E.push(z),E.push(1-R))}return C}within(e,n,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:y}=this,w=[0,h.length-1,0],E=[],C=a*a;for(;w.length;){const R=w.pop()||0,z=w.pop()||0,B=w.pop()||0;if(z-B<=y){for(let oe=B;oe<=z;oe++)Y1(m[2*oe],m[2*oe+1],e,n)<=C&&E.push(h[oe]);continue}const $=B+z>>1,G=m[2*$],K=m[2*$+1];Y1(G,K,e,n)<=C&&E.push(h[$]),(R===0?e-a<=G:n-a<=K)&&(w.push(B),w.push($-1),w.push(1-R)),(R===0?e+a>=G:n+a>=K)&&(w.push($+1),w.push(z),w.push(1-R))}return E}}function R_(t,e,n,a,h,m){if(h-a<=n)return;const y=a+h>>1;K1(t,e,y,a,h,m),R_(t,e,n,a,y-1,1-m),R_(t,e,n,y+1,h,1-m)}function K1(t,e,n,a,h,m){for(;h>a;){if(h-a>600){const C=h-a+1,R=n-a+1,z=Math.log(C),B=.5*Math.exp(2*z/3),$=.5*Math.sqrt(z*B*(C-B)/C)*(R-C/2<0?-1:1);K1(t,e,n,Math.max(a,Math.floor(n-R*B/C+$)),Math.min(h,Math.floor(n+(C-R)*B/C+$)),m)}const y=e[2*n+m];let w=a,E=h;for(Yp(t,e,a,n),e[2*h+m]>y&&Yp(t,e,a,h);w<E;){for(Yp(t,e,w,E),w++,E--;e[2*w+m]<y;)w++;for(;e[2*E+m]>y;)E--}e[2*a+m]===y?Yp(t,e,a,E):(E++,Yp(t,e,E,h)),E<=n&&(a=E+1),n<=E&&(h=E-1)}}function Yp(t,e,n,a){L_(t,n,a),L_(e,2*n,2*a),L_(e,2*n+1,2*a+1)}function L_(t,e,n){const a=t[e];t[e]=t[n],t[n]=a}function Y1(t,e,n,a){const h=t-n,m=e-a;return h*h+m*m}o.ARRAY_TYPE=Yi,o.AUTH_ERR_MSG=Ae,o.Aabb=Qi,o.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},yn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Dr()?t:I,this.scheduler=new EM}send(t,e,n,a,h=!1,m){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=m,this.callbacks[y]=n);const w=Zi(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:t,hasCallback:!!n,targetMapId:a,mustQueue:h,sourceMapId:this.mapId,data:tl(e,w)},w),{cancel:()=>{n&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const a=this.cancelCallbacks[n];delete this.cancelCallbacks[n],a&&a.cancel()}else if(e.mustQueue||Dr()){const a=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),a&&a.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if(e.type==="<response>"){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(nl(e.error)):n(null,nl(e.data)))}else{const n=Zi(this.globalScope)?void 0:[],a=e.hasCallback?(m,y)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:m?tl(m):null,data:tl(y,n)},n)}:m=>{},h=nl(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,h,a);else if(this.parent.getWorkerSource){const m=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,m[0],h.source)[m[1]](h,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=yg,o.Color=dr,o.ColorMode=su,o.CullFaceMode=dl,o.DEMData=zg,o.DataConstantProperty=X,o.DedupedRequest=Z1,o.DepthMode=kf,o.EXTENT=nn,o.Elevation=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const n=e.getSource().maxzoom,a=1<<n,h=Math.floor(t.x),m=Math.floor((t.x-h)*a),y=Math.floor(t.y*a),w=this.findDEMTileFor(new Ho(n,h,n,m,y));return!(!w||!w.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const a=this._source();if(!a||t.y<0||t.y>1)return e;const h=a.getSource().maxzoom,m=1<<h,y=Math.floor(t.x),w=t.x-y,E=new Ho(h,y,h,Math.floor(w*m),Math.floor(t.y*m)),C=this.findDEMTileFor(E);if(!C||!C.dem)return e;const R=C.dem,z=1<<C.tileID.canonical.z,B=(w*z-C.tileID.canonical.x)*R.dim,$=(t.y*z-C.tileID.canonical.y)*R.dim,G=Math.floor(B),K=Math.floor($);return(n?this.exaggeration():1)*Zn(Zn(R.get(G,K),R.get(G,K+1),$-K),Zn(R.get(G+1,K),R.get(G+1,K+1),$-K),B-G)}getAtTileOffset(t,e,n){const a=1<<t.canonical.z;return this.getAtPointOrZero(new Jl(t.wrap+(t.canonical.x+e/nn)/a,(t.canonical.y+n/nn)/a))}getAtTileOffsetFunc(t,e,n,a){return h=>{const m=this.getAtTileOffset(t,h.x,h.y),y=a.upVector(t.canonical,h.x,h.y);return Lr(y,y,m*a.upVectorScale(t.canonical,e,n).metersToTile),y}}getForTilePoints(t,e,n,a){if(this.isUsingMockSource())return!1;const h=Og.create(this,t,a);return!!h&&(e.forEach(m=>{m[2]=this.exaggeration()*h.getElevationAt(m[0],m[1],n)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,a=e.tileID,h=1<<t.canonical.z-a.canonical.z;let m=t.canonical.x/h-a.canonical.x,y=t.canonical.y/h-a.canonical.y,w=0;for(let E=0;E<t.canonical.z-a.canonical.z&&!n.leaves[w];E++){m*=2,y*=2;const C=2*Math.floor(y)+Math.floor(m);w=n.childOffsets[w]+C,m%=1,y%=1}return{min:this.exaggeration()*n.minimums[w],max:this.exaggeration()*n.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=Do,o.EvaluationParameters=L,o.Event=la,o.Evented=oo,o.FillExtrusionBucket=Fp,o.Frustum=sf,o.FrustumCorners=ed,o.GLOBE_RADIUS=Ma,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=eo,o.GLOBE_ZOOM_THRESHOLD_MIN=Xu,o.GlobeSharedBuffers=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const t of this._wireframeSegments)t.destroy()}}_fillGridMeshWithLods(t,e){const n=new vt,a=new Qt,h=[],m=t+1+2,y=e[0]+1,w=e[0]+1+(1+e.length),E=(C,R,z)=>{let B=C===m-1?C-2:C===0?C:C-1;return B+=z?24575:0,[B,R]};for(let C=0;C<m;++C)n.emplaceBack(...E(C,0,!0));for(let C=0;C<y;++C)for(let R=0;R<m;++R)n.emplaceBack(...E(R,C,(R===0||R===m-1)&&!0));for(let C=0;C<e.length;++C){const R=e[C];for(let z=0;z<m;++z)n.emplaceBack(...E(z,R,!0))}for(let C=0;C<e.length;++C){const R=a.length,z=e[C]+1+2,B=new Qt;for(let K=0;K<z-1;K++){const oe=K===z-2,fe=oe?m*(w-e.length+C-K):m;for(let Te=0;Te<m-1;Te++){const pe=K*m+Te;K===0||oe||Te===0||Te===m-2?(B.emplaceBack(pe+1,pe,pe+fe),B.emplaceBack(pe+fe,pe+fe+1,pe+1)):(a.emplaceBack(pe+1,pe,pe+fe),a.emplaceBack(pe+fe,pe+fe+1,pe+1))}}const $=ei.simpleSegment(0,R,n.length,a.length-R);for(let K=0;K<B.uint16.length;K+=3)a.emplaceBack(B.uint16[K],B.uint16[K+1],B.uint16[K+2]);const G=ei.simpleSegment(0,R,n.length,a.length-R);h.push({withoutSkirts:$,withSkirts:G})}return{vertices:n,indices:a,segments:h}}_createGrid(t){const e=this._fillGridMeshWithLods(ka,Ei);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Qh.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new Qt;for(let h=0;h<=ka;h++)e.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const n=new Jn,a=new Jn;this._poleSegments=[];for(let h=0,m=0;h<Xu;h++){const y=360/(1<<h);n.emplaceBack(0,-Ma,0,.5,0),a.emplaceBack(0,-Ma,0,.5,1);for(let w=0;w<=ka;w++){const E=w/ka,C=Zn(0,y,E),[R,z,B]=oi(cg,r_,C,Ma);n.emplaceBack(R,z,B,E,0),a.emplaceBack(R,z,B,E,1)}this._poleSegments.push(ei.simpleSegment(m,0,66,64)),m+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,Jh,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(a,Jh,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}getWirefameBuffers(t,e){if(!this._wireframeSegments){const n=new jr,a=ka,h=a+1+2,m=1;this._wireframeSegments=[];for(let y=0,w=0;y<Ei.length;y++){const E=Ei[y];for(let R=m;R<E+m;R++)for(let z=m;z<a+m;z++){const B=R*h+z;n.emplaceBack(B,B+1),n.emplaceBack(B,B+h),n.emplaceBack(B,B+h+1)}const C=E*a*3;this._wireframeSegments.push(ei.simpleSegment(0,w,(E+1)*h,C)),w+=C}this._wireframeIndexBuffer=t.createIndexBuffer(n)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},o.GlyphManager=Sf,o.ImagePosition=p_,o.KDBush=I_,o.LivePerformanceUtils=Id,o.LngLat=sn,o.LngLatBounds=sl,o.LocalGlyphMode=y_,o.MAX_MERCATOR_LATITUDE=to,o.MercatorCoordinate=Jl,o.ONE_EM=no,o.OverscaledTileID=Ho,o.PerformanceMarkers=ja,o.Point=Y,o.Properties=ve,o.RGBAImage=Po,o.Ray=of,o.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ce,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!De(t))return t;const n=Dt(t);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!De(t))return t;const n=Dt(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,a){if(!De(t))return t;const h=Dt(t);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),n&&h.params.push(`language=${n}`),a&&h.params.push(`worldview=${a}`),this._makeAPIURL(h,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,a){const h=Dt(t);return De(t)?(h.path=`/styles/v1${h.path}/sprite${e}${n}`,this._makeAPIURL(h,this._customAccessToken||a)):(h.path+=`${e}${n}`,xt(h))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!De(t))return t;const a=Dt(t);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&a.authority!=="raster"&&n===512?"@2x":""}${ee.supported?".webp":"$1"}`),a.authority==="raster"?a.path=`/${q.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${q.TILE_URL_VERSION}${a.path}`);const h=this._customAccessToken||function(m){for(const y of m){const w=y.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(a.params)||q.ACCESS_TOKEN;return q.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,h)}canonicalizeTileURL(t,e){const n=Dt(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let a="mapbox://";n.path.match(/^\/raster\/v1\//)?a+=`raster/${n.path.replace(`/${q.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${n.path.replace(`/${q.TILE_URL_VERSION}/`,"")}`;let h=n.params;return e&&(h=h.filter(m=>!m.match(/^access_token=/))),h.length&&(a+=`?${h.join("&")}`),a}canonicalizeTileset(t,e){const n=!!e&&De(e),a=[];for(const h of t.tiles||[])Ve(h)?a.push(this.canonicalizeTileURL(h,n)):a.push(h);return a}_makeAPIURL(t,e){const n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",a=Dt(q.API_URL);if(t.protocol=a.protocol,t.authority=a.authority,t.protocol==="http"){const h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if(a.path!=="/"&&(t.path=`${a.path}${t.path}`),!q.REQUIRE_ACCESS_TOKEN)return xt(t);if(e=e||q.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(h=>h.indexOf("access_token")===-1),t.params.push(`access_token=${e||""}`),xt(t)}},o.ResourceType=Yr,o.SegmentVector=ei,o.SourceCache=yd,o.StencilMode=A_,o.StructArrayLayout1ui2=Co,o.StructArrayLayout2f1f2i16=on,o.StructArrayLayout2i4=vt,o.StructArrayLayout2ui4=jr,o.StructArrayLayout3f12=Dn,o.StructArrayLayout3ui6=Qt,o.StructArrayLayout4i8=nt,o.StructArrayLayout5f20=Jn,o.Texture=Xp,o.Tile=S_,o.Transitionable=W,o.Uniform1f=Wh,o.Uniform1i=class extends Ea{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},o.Uniform2f=class extends Ea{constructor(t){super(t),this.current=[0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},o.Uniform3f=class extends Ea{constructor(t){super(t),this.current=[0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},o.Uniform4f=up,o.UniformColor=cp,o.UniformMatrix2f=class extends Ea{constructor(t){super(t),this.current=Ym}set(t,e,n){if(this.fetchUniformLocation(t,e)){for(let a=0;a<4;a++)if(n[a]!==this.current[a]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}}},o.UniformMatrix3f=class extends Ea{constructor(t){super(t),this.current=Km}set(t,e,n){if(this.fetchUniformLocation(t,e)){for(let a=0;a<9;a++)if(n[a]!==this.current[a]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}}},o.UniformMatrix4f=class extends Ea{constructor(t){super(t),this.current=Xm}set(t,e,n){if(this.fetchUniformLocation(t,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let a=1;a<16;a++)if(n[a]!==this.current[a]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},o.UnwrappedTileID=Nx,o.ValidationError=Nt,o.VectorTileFeature=_n,o.VectorTileWorkerSource=class extends oo{constructor(t,e,n,a,h){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=h||H1,this.loading={},this.loaded={},this.deduped=new Z1(t.scheduler),this.isSpriteLoaded=a,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,a=t&&t.request,h=a&&a.collectResourceTiming,m=this.loading[n]=new IM(t);m.abort=this.loadVectorData(t,(y,w)=>{const E=!this.loading[n];if(delete this.loading[n],E||y||!w)return m.status="done",E||(this.loaded[n]=m),e(y);const C=w.rawData,R={};w.expires&&(R.expires=w.expires),w.cacheControl&&(R.cacheControl=w.cacheControl),m.vectorTile=w.vectorTile||new hn(new wg(C));const z=()=>{m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,(B,$)=>{if(B||!$)return e(B);const G={};if(h){const K=gh(a);K.length>0&&(G.resourceTiming=JSON.parse(JSON.stringify(K)))}e(null,kt({rawTileData:C.slice(0)},$,R,G))})};this.isSpriteLoaded?z():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(z,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):z()}),this.loaded=this.loaded||{},this.loaded[n]=m})}reloadTile(t,e){const n=this.loaded,a=t.uid,h=this;if(n&&n[a]){const m=n[a];m.showCollisionBoxes=t.showCollisionBoxes,m.enableTerrain=!!t.enableTerrain,m.projection=t.projection,m.tileTransform=gd(t.tileID.canonical,t.projection);const y=(w,E)=>{const C=m.reloadCallback;C&&(delete m.reloadCallback,m.parse(m.vectorTile,h.layerIndex,this.availableImages,h.actor,C)),e(w,E)};m.status==="parsing"?m.reloadCallback=y:m.status==="done"&&(m.vectorTile?m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(t,e){const n=t.uid,a=this.loading[n];a&&(a.abort&&a.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,a=t.uid;n&&n[a]&&delete n[a],e()}},o.WritingMode=na,o.ZoomDependentExpression=ya,o.add=Ca,o.addDynamicAttributes=Rg,o.adjoint=function(t,e){var n=e[0],a=e[1],h=e[2],m=e[3],y=e[4],w=e[5],E=e[6],C=e[7],R=e[8];return t[0]=y*R-w*C,t[1]=h*C-a*R,t[2]=a*w-h*y,t[3]=w*E-m*R,t[4]=n*R-h*E,t[5]=h*m-n*w,t[6]=m*C-y*E,t[7]=a*E-n*C,t[8]=n*y-a*m,t},o.asyncAll=Ue,o.bezier=fn,o.bindAll=yn,o.boundsAttributes=P1,o.bufferConvexPolygon=function(t,e){const n=[];for(let a=0;a<t.length;a++){const h=te(a-1,-1,t.length-1),m=te(a+1,-1,t.length-1),y=t[a],w=t[m],E=t[h].sub(y).unit(),C=w.sub(y).unit(),R=C.angleWithSep(E.x,E.y),z=E.add(C).unit().mult(-1*e/Math.sin(R/2));n.push(y.add(z))}return n},o.cacheEntryPossiblyAdded=function(t){pr++,pr>mn&&(t.getActor().send("enforceCacheSizeLimit",Ht),pr=0)},o.calculateGlobeLabelMatrix=function(t,e){const{x:n,y:a}=t.point,h=Js(n,a,t.worldSize/t._pixelsPerMercatorPixel,0,0);return al(h,h,af(fs(e)))},o.calculateGlobeMatrix=function(t){const{x:e,y:n}=t.point,{lng:a,lat:h}=t._center;return Js(e,n,t.worldSize,a,h)},o.calculateGlobeMercatorMatrix=function(t){const e=t.pixelsPerMeter,n=e/ti(1,t.center.lat),a=Ys(new Float64Array(16));return Hl(a,a,[t.point.x,t.point.y,0]),Xl(a,a,[n,n,e]),Float32Array.from(a)},o.circumferenceAtLatitude=Si,o.clamp=Et,o.clearTileCache=function(t){if(!un())return;const e=I.caches.delete(It);t&&e.catch(t).then(()=>t())},o.clipLine=d1,o.clone=function(t){var e=new Yi(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},o.clone$1=pn,o.collisionCircleLayout=MA,o.config=q,o.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},o.create=function(){var t=new Yi(16);return Yi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},o.create$1=ng,o.createExpression=hr,o.createLayout=Fe,o.createStyleLayer=function(t){return t.type==="custom"?new xM(t):new bM[t.type](t)},o.cross=Qd,o.degToRad=lt,o.distance=function(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},o.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},o.dot=hs,o.earthRadius=Yl,o.ease=gt,o.easeCubicInOut=ln,o.ecefToLatLng=function([t,e,n]){const a=Math.hypot(t,e,n),h=Math.atan2(t,n),m=.5*Math.PI-Math.acos(-e/a);return new sn(zt(h),zt(m))},o.emitValidationErrors=Ki,o.endsWith=Bn,o.enforceCacheSizeLimit=function(t){tr(),xn&&xn.then(e=>{e.keys().then(n=>{for(let a=0;a<n.length-t;a++)e.delete(n[a])})})},o.evaluateSizeForFeature=vg,o.evaluateSizeForZoom=wf,o.evaluateVariableOffset=y1,o.evented=v,o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},o.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},o.exported=_s,o.exported$1=ee,o.extend=kt,o.extend$1=ci,o.fillExtrusionHeightLift=Ox,o.filterObject=Fn,o.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},o.fromQuat=function(t,e){var n=e[0],a=e[1],h=e[2],m=e[3],y=n+n,w=a+a,E=h+h,C=n*y,R=a*y,z=a*w,B=h*y,$=h*w,G=h*E,K=m*y,oe=m*w,fe=m*E;return t[0]=1-z-G,t[1]=R+fe,t[2]=B-oe,t[3]=0,t[4]=R-fe,t[5]=1-C-G,t[6]=$+K,t[7]=0,t[8]=B+oe,t[9]=$-K,t[10]=1-C-z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=-n,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.fromScaling=Yd,o.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return $n[e]},o.getAABBPointSquareDist=function(t,e,n){let a=0;for(let h=0;h<2;++h){const m=n?n[h]:0;t[h]>m&&(a+=(t[h]-m)*(t[h]-m)),e[h]<m&&(a+=(m-e[h])*(m-e[h]))}return a},o.getAnchorAlignment=g_,o.getAnchorJustification=v_,o.getBounds=function(t){let e=1/0,n=1/0,a=-1/0,h=-1/0;for(const m of t)e=Math.min(e,m.x),n=Math.min(n,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return{min:new Y(e,n),max:new Y(a,h)}},o.getColumn=Ri,o.getDefaultExportFromCjs=me,o.getGridMatrix=function(t,e,n,a){const h=e.getNorth(),m=e.getSouth(),y=e.getWest(),w=e.getEast(),E=1<<t.z,C=w-y,R=h-m,z=C/ka,B=-R/Ei[n],$=[0,z,0,B,0,0,h,y,0];if(t.z>0){const G=180/a;rg($,$,[G/C+1,0,0,0,G/R+1,0,-.5*G/z,.5*G/B,1])}return $[2]=E,$[5]=t.x,$[8]=t.y,$},o.getImage=ye,o.getJSON=function(t,e){return yo(kt(t,{type:"json"}),e)},o.getLatitudinalLod=function(t){const e=to-5;t=Et(t,-80.051129,e)/e*90;const n=Math.pow(Math.abs(Math.sin(lt(t))),3);return Math.round(n*(Ei.length-1))},o.getMapSessionAPI=ui,o.getPerformanceMeasurement=gh,o.getProjection=S1,o.getRTLTextPluginStatus=b,o.getReferrer=ts,o.getTilePoint=function(t,{x:e,y:n},a=0){return new Y(((e-a)*t.scale-t.x)*nn,(n*t.scale-t.y)*nn)},o.getTileVec3=function(t,e,n=0){return Hu(((e.x-n)*t.scale-t.x)*nn,(e.y*t.scale-t.y)*nn,Hc(e.z,e.y))},o.getVideo=function(t,e){const n=I.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let a=0;a<t.length;a++){const h=I.document.createElement("source");ys(t[a])||(n.crossOrigin="Anonymous"),h.src=t[a],n.appendChild(h)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(t){const e=[0,0,0],n=Ys(new Float64Array(16));return al(n,t.pixelMatrix,t.globeMatrix),Ur(e,e,n),new Y(e[0],e[1])},o.globeDenormalizeECEF=af,o.globeECEFOrigin=function(t,e){const n=[0,0,0];return Ur(n,n,Ao(fs(e.canonical))),Ur(n,n,t),n},o.globeMetersToEcef=qc,o.globeNormalizeECEF=Ao,o.globePixelsToTileUnits=function(t,e){return nn/(512*Math.pow(2,t))*nd(fs(e))},o.globePoleMatrixForTile=function(t,e,n){const a=Ys(new Float64Array(16)),h=(e/(1<<t)-.5)*Math.PI*2;return Hh(a,n.globeMatrix,h),Float32Array.from(a)},o.globeTileBounds=fs,o.globeTiltAtLngLat=bp,o.globeToMercatorTransition=Zc,o.globeUseCustomAntiAliasing=function(t,e,n){const a=Zc(n.zoom),h=t.style.map._antialias,m=!!e.extStandardDerivatives,y=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return a===0&&!h&&!y&&m},o.identity=Ys,o.identity$1=Yh,o.invert=cs,o.isFullscreen=function(){return!!I.document.fullscreenElement||!!I.document.webkitFullscreenElement},o.isLngLatBehindGlobe=lf,o.isMapAuthenticated=function(t){return Xi.has(t)},o.isMapboxURL=De,o.isSafariWithAntialiasingBug=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!Zi(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=ir,o.latLngToECEF=po,o.len=sg,o.length=Vc,o.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},o.lngFromMercatorX=Vi,o.loadVectorTile=H1,o.makeRequest=yo,o.mapValue=function(t,e,n,a,h){return Et((t-e)/(n-e)*(h-a)+a,a,h)},o.mercatorScale=rd,o.mercatorXfromLng=vr,o.mercatorYfromLat=Br,o.mercatorZfromAltitude=ti,o.mul=pp,o.mul$1=og,o.multiply=al,o.multiply$1=rg,o.multiply$2=mp,o.nextPowerOfTwo=Ft,o.normalize=Ji,o.normalize$1=yp,o.normalize$2=nf,o.number=Zn,o.ortho=function(t,e,n,a,h,m,y){var w=1/(e-n),E=1/(a-h),C=1/(m-y);return t[0]=-2*w,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*E,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*C,t[11]=0,t[12]=(e+n)*w,t[13]=(h+a)*E,t[14]=(y+m)*C,t[15]=1,t},o.pbf=Wx,o.perspective=function(t,e,n,a,h){var m,y=1/Math.tan(e/2);return t[0]=y/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,h!=null&&h!==1/0?(t[10]=(h+a)*(m=1/(a-h)),t[14]=2*h*a*m):(t[10]=-1,t[14]=-2*a),t},o.pick=function(t,e){const n={};for(let a=0;a<e.length;a++){const h=e[a];h in t&&(n[h]=t[h])}return n},o.plugin=P,o.pointGeometry=$e,o.polesInViewport=function(t){const e=Ys(new Float64Array(16));al(e,t.pixelMatrix,t.globeMatrix);const n=[0,ks,0],a=[0,Kt,0];return Ur(n,n,e),Ur(a,a,e),[n[0]>0&&n[0]<=t.width&&n[1]>0&&n[1]<=t.height&&!lf(t,new sn(t.center.lat,90)),a[0]>0&&a[0]<=t.width&&a[1]>0&&a[1]<=t.height&&!lf(t,new sn(t.center.lat,-90))]},o.polygonContainsPoint=ul,o.polygonIntersectsBox=hg,o.polygonIntersectsPolygon=cf,o.polygonizeBounds=function(t,e,n=0,a=!0){const h=new Y(n,n),m=t.sub(h),y=e.add(h),w=[m,new Y(y.x,m.y),y,new Y(m.x,y.y)];return a&&w.push(m.clone()),w},o.posAttributes=Qh,o.postMapLoadEvent=Jr,o.postPerformanceEvent=Cr,o.postTurnstileEvent=Vn,o.potpack=f_,o.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},o.radToDeg=zt,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(t){return t({pluginStatus:f,pluginURL:r}),v.on("pluginStateChange",t),t},o.removeAuthState=function(t){Xi.delete(t)},o.renderColorRamp=Ip,o.resample=Mo,o.rotateX=Kd,o.rotateX$1=ag,o.rotateY=Hh,o.rotateY$1=gp,o.rotateZ=function(t,e,n){var a=Math.sin(n),h=Math.cos(n),m=e[0],y=e[1],w=e[2],E=e[3],C=e[4],R=e[5],z=e[6],B=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=m*h+C*a,t[1]=y*h+R*a,t[2]=w*h+z*a,t[3]=E*h+B*a,t[4]=C*h-m*a,t[5]=R*h-y*a,t[6]=z*h-w*a,t[7]=B*h-E*a,t},o.rotateZ$1=function(t,e,n){n*=.5;var a=e[0],h=e[1],m=e[2],y=e[3],w=Math.sin(n),E=Math.cos(n);return t[0]=a*E+h*w,t[1]=h*E-a*w,t[2]=m*E+y*w,t[3]=y*E-m*w,t},o.scale=Xl,o.scale$1=tf,o.scale$2=Lr,o.scaleAndAdd=Uc,o.set=function(t,e,n,a){return t[0]=e,t[1]=n,t[2]=a,t},o.setCacheLimits=function(t,e){Ht=t,mn=e},o.setColumn=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},o.setRTLTextPlugin=function(t,e,n=!1){if(f===ls||f===Xs||f===Fc)throw new Error("setRTLTextPlugin cannot be called multiple times.");r=_s.resolveURL(t),f=ls,ba=e,g(),n||M()},o.smoothstep=Le,o.spec=ot,o.squaredLength=function(t){var e=t[0],n=t[1],a=t[2];return e*e+n*n+a*a},o.storeAuthState=function(t,e){e?Xi.add(t):Xi.delete(t)},o.sub=ds,o.subtract=Jd,o.symbolSize=kA,o.tileAABB=function(t,e,n,a,h,m,y,w,E){if(E.name==="globe")return ug(t,e,new yg(n,a,h));const C=gd({z:n,x:a,y:h},E);return new Qi([(m+C.x/C.scale)*e,e*(C.y/C.scale),y],[(m+C.x2/C.scale)*e,e*(C.y2/C.scale),w])},o.tileCornersToBounds=Wc,o.tileTransform=gd,o.transformMat3=function(t,e,n){var a=e[0],h=e[1],m=e[2];return t[0]=a*n[0]+h*n[3]+m*n[6],t[1]=a*n[1]+h*n[4]+m*n[7],t[2]=a*n[2]+h*n[5]+m*n[8],t},o.transformMat4=Ur,o.transformMat4$1=Kl,o.transformQuat=ef,o.transitionTileAABBinECEF=vp,o.translate=Hl,o.transpose=function(t,e){if(t===e){var n=e[1],a=e[2],h=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=a,t[7]=h}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},o.triggerPluginCompletionEvent=u,o.uniqueId=Wt,o.updateGlobeVertexNormal=function(t,e,n,a,h){const m=5*e+2;t.float32[m+0]=n,t.float32[m+1]=a,t.float32[m+2]=h},o.validateCustomStyleLayer=function(t){const e=[],n=t.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),t.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},o.validateFilter=t=>Di(co(t)),o.validateFog=t=>Di(Zs(t)),o.validateLayer=t=>Di(Wd(t)),o.validateLight=t=>Di(Oc(t)),o.validateSource=t=>Di(Qa(t)),o.validateStyle=Li,o.validateTerrain=t=>Di(va(t)),o.values=Pt,o.vectorTile=tt,o.version=O,o.warnOnce=Nn,o.window=I,o.wrap=te}),S(["./shared"],function(o){function I(we){if(typeof we=="number"||typeof we=="boolean"||typeof we=="string"||we==null)return JSON.stringify(we);if(Array.isArray(we)){let Q="[";for(const ye of we)Q+=`${I(ye)},`;return`${Q}]`}let J="{";for(const Q of Object.keys(we).sort())J+=`${Q}:${I(we[Q])},`;return`${J}}`}function O(we){let J="";for(const Q of o.refProperties)J+=`/${I(we[Q])}`;return J}class V{constructor(J){this.keyCache={},J&&this.replace(J)}replace(J){this._layerConfigs={},this._layers={},this.update(J,[])}update(J,Q){for(const Ae of J)this._layerConfigs[Ae.id]=Ae,(this._layers[Ae.id]=o.createStyleLayer(Ae)).compileFilter(),this.keyCache[Ae.id]&&delete this.keyCache[Ae.id];for(const Ae of Q)delete this.keyCache[Ae],delete this._layerConfigs[Ae],delete this._layers[Ae];this.familiesBySource={};const ye=function(Ae,De){const Ve={};for(let ze=0;ze<Ae.length;ze++){const Je=De&&De[Ae[ze].id]||O(Ae[ze]);De&&(De[Ae[ze].id]=Je);let Tt=Ve[Je];Tt||(Tt=Ve[Je]=[]),Tt.push(Ae[ze])}const Ge=[];for(const ze in Ve)Ge.push(Ve[ze]);return Ge}(o.values(this._layerConfigs),this.keyCache);for(const Ae of ye){const De=Ae.map(Dt=>this._layers[Dt.id]),Ve=De[0];if(Ve.visibility==="none")continue;const Ge=Ve.source||"";let ze=this.familiesBySource[Ge];ze||(ze=this.familiesBySource[Ge]={});const Je=Ve.sourceLayer||"_geojsonTileLayer";let Tt=ze[Je];Tt||(Tt=ze[Je]=[]),Tt.push(De)}}}class q{loadTile(J,Q){const{uid:ye,encoding:Ae,rawImageData:De,padding:Ve,buildQuadTree:Ge}=J,ze=o.window.ImageBitmap&&De instanceof o.window.ImageBitmap?this.getImageData(De,Ve):De;Q(null,new o.DEMData(ye,ze,Ae,Ve<1,Ge))}getImageData(J,Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(J.width,J.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=J.width,this.offscreenCanvas.height=J.height,this.offscreenCanvasContext.drawImage(J,0,0,J.width,J.height);const ye=this.offscreenCanvasContext.getImageData(-Q,-Q,J.width+2*Q,J.height+2*Q);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ye}}function ee(we,J){if(we.length!==0){H(we[0],J);for(var Q=1;Q<we.length;Q++)H(we[Q],!J)}}function H(we,J){for(var Q=0,ye=0,Ae=0,De=we.length,Ve=De-1;Ae<De;Ve=Ae++){var Ge=(we[Ae][0]-we[Ve][0])*(we[Ve][1]+we[Ae][1]),ze=Q+Ge;ye+=Math.abs(Q)>=Math.abs(Ge)?Q-ze+Ge:Ge-ze+Q,Q=ze}Q+ye>=0!=!!J&&we.reverse()}var j=o.getDefaultExportFromCjs(function we(J,Q){var ye,Ae=J&&J.type;if(Ae==="FeatureCollection")for(ye=0;ye<J.features.length;ye++)we(J.features[ye],Q);else if(Ae==="GeometryCollection")for(ye=0;ye<J.geometries.length;ye++)we(J.geometries[ye],Q);else if(Ae==="Feature")we(J.geometry,Q);else if(Ae==="Polygon")ee(J.coordinates,Q);else if(Ae==="MultiPolygon")for(ye=0;ye<J.coordinates.length;ye++)ee(J.coordinates[ye],Q);return J});const Z=o.VectorTileFeature.prototype.toGeoJSON;var ne={exports:{}},xe=o.pointGeometry,ce=o.vectorTile.VectorTileFeature,me=de;function de(we,J){this.options=J||{},this.features=we,this.length=we.length}function _e(we,J){this.id=typeof we.id=="number"?we.id:void 0,this.type=we.type,this.rawGeometry=we.type===1?[we.geometry]:we.geometry,this.properties=we.tags,this.extent=J||4096}de.prototype.feature=function(we){return new _e(this.features[we],this.options.extent)},_e.prototype.loadGeometry=function(){var we=this.rawGeometry;this.geometry=[];for(var J=0;J<we.length;J++){for(var Q=we[J],ye=[],Ae=0;Ae<Q.length;Ae++)ye.push(new xe(Q[Ae][0],Q[Ae][1]));this.geometry.push(ye)}return this.geometry},_e.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var we=this.geometry,J=1/0,Q=-1/0,ye=1/0,Ae=-1/0,De=0;De<we.length;De++)for(var Ve=we[De],Ge=0;Ge<Ve.length;Ge++){var ze=Ve[Ge];J=Math.min(J,ze.x),Q=Math.max(Q,ze.x),ye=Math.min(ye,ze.y),Ae=Math.max(Ae,ze.y)}return[J,ye,Q,Ae]},_e.prototype.toGeoJSON=ce.prototype.toGeoJSON;var Se=o.pbf,$e=me;function dt(we){var J=new Se;return function(Q,ye){for(var Ae in Q.layers)ye.writeMessage(3,Y,Q.layers[Ae])}(we,J),J.finish()}function Y(we,J){var Q;J.writeVarintField(15,we.version||1),J.writeStringField(1,we.name||""),J.writeVarintField(5,we.extent||4096);var ye={keys:[],values:[],keycache:{},valuecache:{}};for(Q=0;Q<we.length;Q++)ye.feature=we.feature(Q),J.writeMessage(2,pt,ye);var Ae=ye.keys;for(Q=0;Q<Ae.length;Q++)J.writeStringField(3,Ae[Q]);var De=ye.values;for(Q=0;Q<De.length;Q++)J.writeMessage(4,ln,De[Q])}function pt(we,J){var Q=we.feature;Q.id!==void 0&&J.writeVarintField(1,Q.id),J.writeMessage(2,Lt,we),J.writeVarintField(3,Q.type),J.writeMessage(4,$n,Q)}function Lt(we,J){var Q=we.feature,ye=we.keys,Ae=we.values,De=we.keycache,Ve=we.valuecache;for(var Ge in Q.properties){var ze=Q.properties[Ge],Je=De[Ge];if(ze!==null){Je===void 0&&(ye.push(Ge),De[Ge]=Je=ye.length-1),J.writeVarint(Je);var Tt=typeof ze;Tt!=="string"&&Tt!=="boolean"&&Tt!=="number"&&(ze=JSON.stringify(ze));var Dt=Tt+":"+ze,xt=Ve[Dt];xt===void 0&&(Ae.push(ze),Ve[Dt]=xt=Ae.length-1),J.writeVarint(xt)}}}function lt(we,J){return(J<<3)+(7&we)}function zt(we){return we<<1^we>>31}function $n(we,J){for(var Q=we.loadGeometry(),ye=we.type,Ae=0,De=0,Ve=Q.length,Ge=0;Ge<Ve;Ge++){var ze=Q[Ge],Je=1;ye===1&&(Je=ze.length),J.writeVarint(lt(1,Je));for(var Tt=ye===3?ze.length-1:ze.length,Dt=0;Dt<Tt;Dt++){Dt===1&&ye!==1&&J.writeVarint(lt(2,Tt-1));var xt=ze[Dt].x-Ae,bn=ze[Dt].y-De;J.writeVarint(zt(xt)),J.writeVarint(zt(bn)),Ae+=xt,De+=bn}ye===3&&J.writeVarint(lt(7,1))}}function ln(we,J){var Q=typeof we;Q==="string"?J.writeStringField(1,we):Q==="boolean"?J.writeBooleanField(7,we):Q==="number"&&(we%1!=0?J.writeDoubleField(3,we):we<0?J.writeSVarintField(6,we):J.writeVarintField(5,we))}ne.exports=dt,ne.exports.fromVectorTileJs=dt,ne.exports.fromGeojsonVt=function(we,J){J=J||{};var Q={};for(var ye in we)Q[ye]=new $e(we[ye].features,J),Q[ye].name=ye,Q[ye].version=J.version,Q[ye].extent=J.extent;return dt({layers:Q})},ne.exports.GeoJSONWrapper=$e;var fn=o.getDefaultExportFromCjs(ne.exports);const gt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:we=>we},Et=Math.fround||(Le=new Float32Array(1),we=>(Le[0]=+we,Le[0]));var Le;const te=3,Ue=5,Pt=6;class kt{constructor(J){this.options=Object.assign(Object.create(gt),J),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(J){const{log:Q,minZoom:ye,maxZoom:Ae}=this.options;Q&&console.time("total time");const De=`prepare ${J.length} points`;Q&&console.time(De),this.points=J;const Ve=[];for(let ze=0;ze<J.length;ze++){const Je=J[ze];if(!Je.geometry)continue;const[Tt,Dt]=Je.geometry.coordinates,xt=Et(St(Tt)),bn=Et(Ft(Dt));Ve.push(xt,bn,1/0,ze,-1,1),this.options.reduce&&Ve.push(0)}let Ge=this.trees[Ae+1]=this._createTree(Ve);Q&&console.timeEnd(De);for(let ze=Ae;ze>=ye;ze--){const Je=+Date.now();Ge=this.trees[ze]=this._createTree(this._cluster(Ge,ze)),Q&&console.log("z%d: %d clusters in %dms",ze,Ge.numItems,+Date.now()-Je)}return Q&&console.timeEnd("total time"),this}getClusters(J,Q){let ye=((J[0]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,J[1]));let De=J[2]===180?180:((J[2]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,J[3]));if(J[2]-J[0]>=360)ye=-180,De=180;else if(ye>De){const Dt=this.getClusters([ye,Ae,180,Ve],Q),xt=this.getClusters([-180,Ae,De,Ve],Q);return Dt.concat(xt)}const Ge=this.trees[this._limitZoom(Q)],ze=Ge.range(St(ye),Ft(Ve),St(De),Ft(Ae)),Je=Ge.data,Tt=[];for(const Dt of ze){const xt=this.stride*Dt;Tt.push(Je[xt+Ue]>1?qt(Je,xt,this.clusterProps):this.points[Je[xt+te]])}return Tt}getChildren(J){const Q=this._getOriginId(J),ye=this._getOriginZoom(J),Ae="No cluster with the specified id.",De=this.trees[ye];if(!De)throw new Error(Ae);const Ve=De.data;if(Q*this.stride>=Ve.length)throw new Error(Ae);const Ge=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),ze=De.within(Ve[Q*this.stride],Ve[Q*this.stride+1],Ge),Je=[];for(const Tt of ze){const Dt=Tt*this.stride;Ve[Dt+4]===J&&Je.push(Ve[Dt+Ue]>1?qt(Ve,Dt,this.clusterProps):this.points[Ve[Dt+te]])}if(Je.length===0)throw new Error(Ae);return Je}getLeaves(J,Q,ye){const Ae=[];return this._appendLeaves(Ae,J,Q=Q||10,ye=ye||0,0),Ae}getTile(J,Q,ye){const Ae=this.trees[this._limitZoom(J)],De=Math.pow(2,J),{extent:Ve,radius:Ge}=this.options,ze=Ge/Ve,Je=(ye-ze)/De,Tt=(ye+1+ze)/De,Dt={features:[]};return this._addTileFeatures(Ae.range((Q-ze)/De,Je,(Q+1+ze)/De,Tt),Ae.data,Q,ye,De,Dt),Q===0&&this._addTileFeatures(Ae.range(1-ze/De,Je,1,Tt),Ae.data,De,ye,De,Dt),Q===De-1&&this._addTileFeatures(Ae.range(0,Je,ze/De,Tt),Ae.data,-1,ye,De,Dt),Dt.features.length?Dt:null}getClusterExpansionZoom(J){let Q=this._getOriginZoom(J)-1;for(;Q<=this.options.maxZoom;){const ye=this.getChildren(J);if(Q++,ye.length!==1)break;J=ye[0].properties.cluster_id}return Q}_appendLeaves(J,Q,ye,Ae,De){const Ve=this.getChildren(Q);for(const Ge of Ve){const ze=Ge.properties;if(ze&&ze.cluster?De+ze.point_count<=Ae?De+=ze.point_count:De=this._appendLeaves(J,ze.cluster_id,ye,Ae,De):De<Ae?De++:J.push(Ge),J.length===ye)break}return De}_createTree(J){const Q=new o.KDBush(J.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<J.length;ye+=this.stride)Q.add(J[ye],J[ye+1]);return Q.finish(),Q.data=J,Q}_addTileFeatures(J,Q,ye,Ae,De,Ve){for(const Ge of J){const ze=Ge*this.stride,Je=Q[ze+Ue]>1;let Tt,Dt,xt;if(Je)Tt=Wt(Q,ze,this.clusterProps),Dt=Q[ze],xt=Q[ze+1];else{const wn=this.points[Q[ze+te]];Tt=wn.properties;const[Sn,Vn]=wn.geometry.coordinates;Dt=St(Sn),xt=Ft(Vn)}const bn={type:1,geometry:[[Math.round(this.options.extent*(Dt*De-ye)),Math.round(this.options.extent*(xt*De-Ae))]],tags:Tt};let Tn;Tn=Je||this.options.generateId?Q[ze+te]:this.points[Q[ze+te]].id,Tn!==void 0&&(bn.id=Tn),Ve.features.push(bn)}}_limitZoom(J){return Math.max(this.options.minZoom,Math.min(Math.floor(+J),this.options.maxZoom+1))}_cluster(J,Q){const{radius:ye,extent:Ae,reduce:De,minPoints:Ve}=this.options,Ge=ye/(Ae*Math.pow(2,Q)),ze=J.data,Je=[],Tt=this.stride;for(let Dt=0;Dt<ze.length;Dt+=Tt){if(ze[Dt+2]<=Q)continue;ze[Dt+2]=Q;const xt=ze[Dt],bn=ze[Dt+1],Tn=J.within(ze[Dt],ze[Dt+1],Ge),wn=ze[Dt+Ue];let Sn=wn;for(const Vn of Tn){const Ir=Vn*Tt;ze[Ir+2]>Q&&(Sn+=ze[Ir+Ue])}if(Sn>wn&&Sn>=Ve){let Vn,Ir=xt*wn,Jr=bn*wn,Fi=-1;const Cr=((Dt/Tt|0)<<5)+(Q+1)+this.points.length;for(const ns of Tn){const ui=ns*Tt;if(ze[ui+2]<=Q)continue;ze[ui+2]=Q;const Xi=ze[ui+Ue];Ir+=ze[ui]*Xi,Jr+=ze[ui+1]*Xi,ze[ui+4]=Cr,De&&(Vn||(Vn=this._map(ze,Dt,!0),Fi=this.clusterProps.length,this.clusterProps.push(Vn)),De(Vn,this._map(ze,ui)))}ze[Dt+4]=Cr,Je.push(Ir/Sn,Jr/Sn,1/0,Cr,-1,Sn),De&&Je.push(Fi)}else{for(let Vn=0;Vn<Tt;Vn++)Je.push(ze[Dt+Vn]);if(Sn>1)for(const Vn of Tn){const Ir=Vn*Tt;if(!(ze[Ir+2]<=Q)){ze[Ir+2]=Q;for(let Jr=0;Jr<Tt;Jr++)Je.push(ze[Ir+Jr])}}}}return Je}_getOriginId(J){return J-this.points.length>>5}_getOriginZoom(J){return(J-this.points.length)%32}_map(J,Q,ye){if(J[Q+Ue]>1){const Ve=this.clusterProps[J[Q+Pt]];return ye?Object.assign({},Ve):Ve}const Ae=this.points[J[Q+te]].properties,De=this.options.map(Ae);return ye&&De===Ae?Object.assign({},De):De}}function qt(we,J,Q){return{type:"Feature",id:we[J+te],properties:Wt(we,J,Q),geometry:{type:"Point",coordinates:[(ye=we[J],360*(ye-.5)),en(we[J+1])]}};var ye}function Wt(we,J,Q){const ye=we[J+Ue],Ae=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,De=we[J+Pt],Ve=De===-1?{}:Object.assign({},Q[De]);return Object.assign(Ve,{cluster:!0,cluster_id:we[J+te],point_count:ye,point_count_abbreviated:Ae})}function St(we){return we/360+.5}function Ft(we){const J=Math.sin(we*Math.PI/180),Q=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return Q<0?0:Q>1?1:Q}function en(we){const J=(180-360*we)*Math.PI/180;return 360*Math.atan(Math.exp(J))/Math.PI-90}function yn(we,J,Q,ye){for(var Ae,De=ye,Ve=Q-J>>1,Ge=Q-J,ze=we[J],Je=we[J+1],Tt=we[Q],Dt=we[Q+1],xt=J+3;xt<Q;xt+=3){var bn=Bn(we[xt],we[xt+1],ze,Je,Tt,Dt);if(bn>De)Ae=xt,De=bn;else if(bn===De){var Tn=Math.abs(xt-Ve);Tn<Ge&&(Ae=xt,Ge=Tn)}}De>ye&&(Ae-J>3&&yn(we,J,Ae,ye),we[Ae+2]=De,Q-Ae>3&&yn(we,Ae,Q,ye))}function Bn(we,J,Q,ye,Ae,De){var Ve=Ae-Q,Ge=De-ye;if(Ve!==0||Ge!==0){var ze=((we-Q)*Ve+(J-ye)*Ge)/(Ve*Ve+Ge*Ge);ze>1?(Q=Ae,ye=De):ze>0&&(Q+=Ve*ze,ye+=Ge*ze)}return(Ve=we-Q)*Ve+(Ge=J-ye)*Ge}function Xt(we,J,Q,ye){var Ae={id:we===void 0?null:we,type:J,geometry:Q,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(De){var Ve=De.geometry,Ge=De.type;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")Fn(De,Ve);else if(Ge==="Polygon"||Ge==="MultiLineString")for(var ze=0;ze<Ve.length;ze++)Fn(De,Ve[ze]);else if(Ge==="MultiPolygon")for(ze=0;ze<Ve.length;ze++)for(var Je=0;Je<Ve[ze].length;Je++)Fn(De,Ve[ze][Je])}(Ae),Ae}function Fn(we,J){for(var Q=0;Q<J.length;Q+=3)we.minX=Math.min(we.minX,J[Q]),we.minY=Math.min(we.minY,J[Q+1]),we.maxX=Math.max(we.maxX,J[Q]),we.maxY=Math.max(we.maxY,J[Q+1])}function pn(we,J,Q,ye){if(J.geometry){var Ae=J.geometry.coordinates,De=J.geometry.type,Ve=Math.pow(Q.tolerance/((1<<Q.maxZoom)*Q.extent),2),Ge=[],ze=J.id;if(Q.promoteId?ze=J.properties[Q.promoteId]:Q.generateId&&(ze=ye||0),De==="Point")Pr(Ae,Ge);else if(De==="MultiPoint")for(var Je=0;Je<Ae.length;Je++)Pr(Ae[Je],Ge);else if(De==="LineString")Nn(Ae,Ge,Ve,!1);else if(De==="MultiLineString"){if(Q.lineMetrics){for(Je=0;Je<Ae.length;Je++)Nn(Ae[Je],Ge=[],Ve,!1),we.push(Xt(ze,"LineString",Ge,J.properties));return}jn(Ae,Ge,Ve,!1)}else if(De==="Polygon")jn(Ae,Ge,Ve,!0);else{if(De!=="MultiPolygon"){if(De==="GeometryCollection"){for(Je=0;Je<J.geometry.geometries.length;Je++)pn(we,{id:ze,geometry:J.geometry.geometries[Je],properties:J.properties},Q,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Je=0;Je<Ae.length;Je++){var Tt=[];jn(Ae[Je],Tt,Ve,!0),Ge.push(Tt)}}we.push(Xt(ze,De,Ge,J.properties))}}function Pr(we,J){J.push(Kr(we[0])),J.push(Dr(we[1])),J.push(0)}function Nn(we,J,Q,ye){for(var Ae,De,Ve=0,Ge=0;Ge<we.length;Ge++){var ze=Kr(we[Ge][0]),Je=Dr(we[Ge][1]);J.push(ze),J.push(Je),J.push(0),Ge>0&&(Ve+=ye?(Ae*Je-ze*De)/2:Math.sqrt(Math.pow(ze-Ae,2)+Math.pow(Je-De,2))),Ae=ze,De=Je}var Tt=J.length-3;J[2]=1,yn(J,0,Tt,Q),J[Tt+2]=1,J.size=Math.abs(Ve),J.start=0,J.end=J.size}function jn(we,J,Q,ye){for(var Ae=0;Ae<we.length;Ae++){var De=[];Nn(we[Ae],De,Q,ye),J.push(De)}}function Kr(we){return we/360+.5}function Dr(we){var J=Math.sin(we*Math.PI/180),Q=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return Q<0?0:Q>1?1:Q}function lr(we,J,Q,ye,Ae,De,Ve,Ge){if(ye/=J,De>=(Q/=J)&&Ve<ye)return we;if(Ve<Q||De>=ye)return null;for(var ze=[],Je=0;Je<we.length;Je++){var Tt=we[Je],Dt=Tt.geometry,xt=Tt.type,bn=Ae===0?Tt.minX:Tt.minY,Tn=Ae===0?Tt.maxX:Tt.maxY;if(bn>=Q&&Tn<ye)ze.push(Tt);else if(!(Tn<Q||bn>=ye)){var wn=[];if(xt==="Point"||xt==="MultiPoint")Ii(Dt,wn,Q,ye,Ae);else if(xt==="LineString")Zi(Dt,wn,Q,ye,Ae,!1,Ge.lineMetrics);else if(xt==="MultiLineString")Ri(Dt,wn,Q,ye,Ae,!1);else if(xt==="Polygon")Ri(Dt,wn,Q,ye,Ae,!0);else if(xt==="MultiPolygon")for(var Sn=0;Sn<Dt.length;Sn++){var Vn=[];Ri(Dt[Sn],Vn,Q,ye,Ae,!0),Vn.length&&wn.push(Vn)}if(wn.length){if(Ge.lineMetrics&&xt==="LineString"){for(Sn=0;Sn<wn.length;Sn++)ze.push(Xt(Tt.id,xt,wn[Sn],Tt.tags));continue}xt!=="LineString"&&xt!=="MultiLineString"||(wn.length===1?(xt="LineString",wn=wn[0]):xt="MultiLineString"),xt!=="Point"&&xt!=="MultiPoint"||(xt=wn.length===3?"Point":"MultiPoint"),ze.push(Xt(Tt.id,xt,wn,Tt.tags))}}}return ze.length?ze:null}function Ii(we,J,Q,ye,Ae){for(var De=0;De<we.length;De+=3){var Ve=we[De+Ae];Ve>=Q&&Ve<=ye&&(J.push(we[De]),J.push(we[De+1]),J.push(we[De+2]))}}function Zi(we,J,Q,ye,Ae,De,Ve){for(var Ge,ze,Je=Hi(we),Tt=Ae===0?Ht:mn,Dt=we.start,xt=0;xt<we.length-3;xt+=3){var bn=we[xt],Tn=we[xt+1],wn=we[xt+2],Sn=we[xt+3],Vn=we[xt+4],Ir=Ae===0?bn:Tn,Jr=Ae===0?Sn:Vn,Fi=!1;Ve&&(Ge=Math.sqrt(Math.pow(bn-Sn,2)+Math.pow(Tn-Vn,2))),Ir<Q?Jr>Q&&(ze=Tt(Je,bn,Tn,Sn,Vn,Q),Ve&&(Je.start=Dt+Ge*ze)):Ir>ye?Jr<ye&&(ze=Tt(Je,bn,Tn,Sn,Vn,ye),Ve&&(Je.start=Dt+Ge*ze)):It(Je,bn,Tn,wn),Jr<Q&&Ir>=Q&&(ze=Tt(Je,bn,Tn,Sn,Vn,Q),Fi=!0),Jr>ye&&Ir<=ye&&(ze=Tt(Je,bn,Tn,Sn,Vn,ye),Fi=!0),!De&&Fi&&(Ve&&(Je.end=Dt+Ge*ze),J.push(Je),Je=Hi(we)),Ve&&(Dt+=Ge)}var Cr=we.length-3;bn=we[Cr],Tn=we[Cr+1],wn=we[Cr+2],(Ir=Ae===0?bn:Tn)>=Q&&Ir<=ye&&It(Je,bn,Tn,wn),Cr=Je.length-3,De&&Cr>=3&&(Je[Cr]!==Je[0]||Je[Cr+1]!==Je[1])&&It(Je,Je[0],Je[1],Je[2]),Je.length&&J.push(Je)}function Hi(we){var J=[];return J.size=we.size,J.start=we.start,J.end=we.end,J}function Ri(we,J,Q,ye,Ae,De){for(var Ve=0;Ve<we.length;Ve++)Zi(we[Ve],J,Q,ye,Ae,De,!1)}function It(we,J,Q,ye){we.push(J),we.push(Q),we.push(ye)}function Ht(we,J,Q,ye,Ae,De){var Ve=(De-J)/(ye-J);return we.push(De),we.push(Q+(Ae-Q)*Ve),we.push(1),Ve}function mn(we,J,Q,ye,Ae,De){var Ve=(De-Q)/(Ae-Q);return we.push(J+(ye-J)*Ve),we.push(De),we.push(1),Ve}function xn(we,J){for(var Q=[],ye=0;ye<we.length;ye++){var Ae,De=we[ye],Ve=De.type;if(Ve==="Point"||Ve==="MultiPoint"||Ve==="LineString")Ae=Wn(De.geometry,J);else if(Ve==="MultiLineString"||Ve==="Polygon"){Ae=[];for(var Ge=0;Ge<De.geometry.length;Ge++)Ae.push(Wn(De.geometry[Ge],J))}else if(Ve==="MultiPolygon")for(Ae=[],Ge=0;Ge<De.geometry.length;Ge++){for(var ze=[],Je=0;Je<De.geometry[Ge].length;Je++)ze.push(Wn(De.geometry[Ge][Je],J));Ae.push(ze)}Q.push(Xt(De.id,Ve,Ae,De.tags))}return Q}function Wn(we,J){var Q=[];Q.size=we.size,we.start!==void 0&&(Q.start=we.start,Q.end=we.end);for(var ye=0;ye<we.length;ye+=3)Q.push(we[ye]+J,we[ye+1],we[ye+2]);return Q}function un(we,J){if(we.transformed)return we;var Q,ye,Ae,De=1<<we.z,Ve=we.x,Ge=we.y;for(Q=0;Q<we.features.length;Q++){var ze=we.features[Q],Je=ze.geometry,Tt=ze.type;if(ze.geometry=[],Tt===1)for(ye=0;ye<Je.length;ye+=2)ze.geometry.push(tr(Je[ye],Je[ye+1],J,De,Ve,Ge));else for(ye=0;ye<Je.length;ye++){var Dt=[];for(Ae=0;Ae<Je[ye].length;Ae+=2)Dt.push(tr(Je[ye][Ae],Je[ye][Ae+1],J,De,Ve,Ge));ze.geometry.push(Dt)}}return we.transformed=!0,we}function tr(we,J,Q,ye,Ae,De){return[Math.round(Q*(we*ye-Ae)),Math.round(Q*(J*ye-De))]}function zr(we,J,Q,ye,Ae){for(var De=J===Ae.maxZoom?0:Ae.tolerance/((1<<J)*Ae.extent),Ve={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Q,y:ye,z:J,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ge=0;Ge<we.length;Ge++){Ve.numFeatures++,pr(Ve,we[Ge],De,Ae);var ze=we[Ge].minX,Je=we[Ge].minY,Tt=we[Ge].maxX,Dt=we[Ge].maxY;ze<Ve.minX&&(Ve.minX=ze),Je<Ve.minY&&(Ve.minY=Je),Tt>Ve.maxX&&(Ve.maxX=Tt),Dt>Ve.maxY&&(Ve.maxY=Dt)}return Ve}function pr(we,J,Q,ye){var Ae=J.geometry,De=J.type,Ve=[];if(De==="Point"||De==="MultiPoint")for(var Ge=0;Ge<Ae.length;Ge+=3)Ve.push(Ae[Ge]),Ve.push(Ae[Ge+1]),we.numPoints++,we.numSimplified++;else if(De==="LineString")Yr(Ve,Ae,we,Q,!1,!1);else if(De==="MultiLineString"||De==="Polygon")for(Ge=0;Ge<Ae.length;Ge++)Yr(Ve,Ae[Ge],we,Q,De==="Polygon",Ge===0);else if(De==="MultiPolygon")for(var ze=0;ze<Ae.length;ze++){var Je=Ae[ze];for(Ge=0;Ge<Je.length;Ge++)Yr(Ve,Je[Ge],we,Q,!0,Ge===0)}if(Ve.length){var Tt=J.tags||null;if(De==="LineString"&&ye.lineMetrics){for(var Dt in Tt={},J.tags)Tt[Dt]=J.tags[Dt];Tt.mapbox_clip_start=Ae.start/Ae.size,Tt.mapbox_clip_end=Ae.end/Ae.size}var xt={geometry:Ve,type:De==="Polygon"||De==="MultiPolygon"?3:De==="LineString"||De==="MultiLineString"?2:1,tags:Tt};J.id!==null&&(xt.id=J.id),we.features.push(xt)}}function Yr(we,J,Q,ye,Ae,De){var Ve=ye*ye;if(ye>0&&J.size<(Ae?Ve:ye))Q.numPoints+=J.length/3;else{for(var Ge=[],ze=0;ze<J.length;ze+=3)(ye===0||J[ze+2]>Ve)&&(Q.numSimplified++,Ge.push(J[ze]),Ge.push(J[ze+1])),Q.numPoints++;Ae&&function(Je,Tt){for(var Dt=0,xt=0,bn=Je.length,Tn=bn-2;xt<bn;Tn=xt,xt+=2)Dt+=(Je[xt]-Je[Tn])*(Je[xt+1]+Je[Tn+1]);if(Dt>0===Tt)for(xt=0,bn=Je.length;xt<bn/2;xt+=2){var wn=Je[xt],Sn=Je[xt+1];Je[xt]=Je[bn-2-xt],Je[xt+1]=Je[bn-1-xt],Je[bn-2-xt]=wn,Je[bn-1-xt]=Sn}}(Ge,De),we.push(Ge)}}function io(we,J){var Q=(J=this.options=function(Ae,De){for(var Ve in De)Ae[Ve]=De[Ve];return Ae}(Object.create(this.options),J)).debug;if(Q&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");var ye=function(Ae,De){var Ve=[];if(Ae.type==="FeatureCollection")for(var Ge=0;Ge<Ae.features.length;Ge++)pn(Ve,Ae.features[Ge],De,Ge);else pn(Ve,Ae.type==="Feature"?Ae:{geometry:Ae},De);return Ve}(we,J);this.tiles={},this.tileCoords=[],Q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ye=function(Ae,De){var Ve=De.buffer/De.extent,Ge=Ae,ze=lr(Ae,1,-1-Ve,Ve,0,-1,2,De),Je=lr(Ae,1,1-Ve,2+Ve,0,-1,2,De);return(ze||Je)&&(Ge=lr(Ae,1,-Ve,1+Ve,0,-1,2,De)||[],ze&&(Ge=xn(ze,1).concat(Ge)),Je&&(Ge=Ge.concat(xn(Je,-1)))),Ge}(ye,J),ye.length&&this.splitTile(ye,0,0,0),Q&&(ye.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ts(we,J,Q){return 32*((1<<we)*Q+J)+we}function yo(we,J){const Q=we.tileID.canonical;if(!this._geoJSONIndex)return J(null,null);const ye=this._geoJSONIndex.getTile(Q.z,Q.x,Q.y);if(!ye)return J(null,null);const Ae=new class{constructor(Ve){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=Ve.length,this._features=Ve}feature(Ve){return new class{constructor(Ge){this._feature=Ge,this.extent=o.EXTENT,this.type=Ge.type,this.properties=Ge.tags,"id"in Ge&&!isNaN(Ge.id)&&(this.id=parseInt(Ge.id,10))}loadGeometry(){if(this._feature.type===1){const Ge=[];for(const ze of this._feature.geometry)Ge.push([new o.Point(ze[0],ze[1])]);return Ge}{const Ge=[];for(const ze of this._feature.geometry){const Je=[];for(const Tt of ze)Je.push(new o.Point(Tt[0],Tt[1]));Ge.push(Je)}return Ge}}toGeoJSON(Ge,ze,Je){return Z.call(this,Ge,ze,Je)}}(this._features[Ve])}}(ye.features);let De=fn(Ae);De.byteOffset===0&&De.byteLength===De.buffer.byteLength||(De=new Uint8Array(De)),J(null,{vectorTile:Ae,rawData:De.buffer})}io.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},io.prototype.splitTile=function(we,J,Q,ye,Ae,De,Ve){for(var Ge=[we,J,Q,ye],ze=this.options,Je=ze.debug;Ge.length;){ye=Ge.pop(),Q=Ge.pop(),J=Ge.pop(),we=Ge.pop();var Tt=1<<J,Dt=ts(J,Q,ye),xt=this.tiles[Dt];if(!xt&&(Je>1&&console.time("creation"),xt=this.tiles[Dt]=zr(we,J,Q,ye,ze),this.tileCoords.push({z:J,x:Q,y:ye}),Je)){Je>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,Q,ye,xt.numFeatures,xt.numPoints,xt.numSimplified),console.timeEnd("creation"));var bn="z"+J;this.stats[bn]=(this.stats[bn]||0)+1,this.total++}if(xt.source=we,Ae){if(J===ze.maxZoom||J===Ae)continue;var Tn=1<<Ae-J;if(Q!==Math.floor(De/Tn)||ye!==Math.floor(Ve/Tn))continue}else if(J===ze.indexMaxZoom||xt.numPoints<=ze.indexMaxPoints)continue;if(xt.source=null,we.length!==0){Je>1&&console.time("clipping");var wn,Sn,Vn,Ir,Jr,Fi,Cr=.5*ze.buffer/ze.extent,ns=.5-Cr,ui=.5+Cr,Xi=1+Cr;wn=Sn=Vn=Ir=null,Jr=lr(we,Tt,Q-Cr,Q+ui,0,xt.minX,xt.maxX,ze),Fi=lr(we,Tt,Q+ns,Q+Xi,0,xt.minX,xt.maxX,ze),we=null,Jr&&(wn=lr(Jr,Tt,ye-Cr,ye+ui,1,xt.minY,xt.maxY,ze),Sn=lr(Jr,Tt,ye+ns,ye+Xi,1,xt.minY,xt.maxY,ze),Jr=null),Fi&&(Vn=lr(Fi,Tt,ye-Cr,ye+ui,1,xt.minY,xt.maxY,ze),Ir=lr(Fi,Tt,ye+ns,ye+Xi,1,xt.minY,xt.maxY,ze),Fi=null),Je>1&&console.timeEnd("clipping"),Ge.push(wn||[],J+1,2*Q,2*ye),Ge.push(Sn||[],J+1,2*Q,2*ye+1),Ge.push(Vn||[],J+1,2*Q+1,2*ye),Ge.push(Ir||[],J+1,2*Q+1,2*ye+1)}}},io.prototype.getTile=function(we,J,Q){var ye=this.options,Ae=ye.extent,De=ye.debug;if(we<0||we>24)return null;var Ve=1<<we,Ge=ts(we,J=(J%Ve+Ve)%Ve,Q);if(this.tiles[Ge])return un(this.tiles[Ge],Ae);De>1&&console.log("drilling down to z%d-%d-%d",we,J,Q);for(var ze,Je=we,Tt=J,Dt=Q;!ze&&Je>0;)Je--,Tt=Math.floor(Tt/2),Dt=Math.floor(Dt/2),ze=this.tiles[ts(Je,Tt,Dt)];return ze&&ze.source?(De>1&&console.log("found parent tile z%d-%d-%d",Je,Tt,Dt),De>1&&console.time("drilling down"),this.splitTile(ze.source,Je,Tt,Dt,we,J,Q),De>1&&console.timeEnd("drilling down"),this.tiles[Ge]?un(this.tiles[Ge],Ae):null):null};class gs extends o.VectorTileWorkerSource{constructor(J,Q,ye,Ae,De){super(J,Q,ye,Ae,yo),De&&(this.loadGeoJSON=De)}loadData(J,Q){const ye=J&&J.request,Ae=ye&&ye.collectResourceTiming;this.loadGeoJSON(J,(De,Ve)=>{if(De||!Ve)return Q(De);if(typeof Ve!="object")return Q(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`));{j(Ve,!0);try{if(J.filter){const ze=o.createExpression(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ze.result==="error")throw new Error(ze.value.map(Tt=>`${Tt.key}: ${Tt.message}`).join(", "));Ve={type:"FeatureCollection",features:Ve.features.filter(Tt=>ze.value.evaluate({zoom:0},Tt))}}this._geoJSONIndex=J.cluster?new kt(function({superclusterOptions:ze,clusterProperties:Je}){if(!Je||!ze)return ze;const Tt={},Dt={},xt={accumulated:null,zoom:0},bn={properties:null},Tn=Object.keys(Je);for(const wn of Tn){const[Sn,Vn]=Je[wn],Ir=o.createExpression(Vn),Jr=o.createExpression(typeof Sn=="string"?[Sn,["accumulated"],["get",wn]]:Sn);Tt[wn]=Ir.value,Dt[wn]=Jr.value}return ze.map=wn=>{bn.properties=wn;const Sn={};for(const Vn of Tn)Sn[Vn]=Tt[Vn].evaluate(xt,bn);return Sn},ze.reduce=(wn,Sn)=>{bn.properties=Sn;for(const Vn of Tn)xt.accumulated=wn[Vn],wn[Vn]=Dt[Vn].evaluate(xt,bn)},ze}(J)).load(Ve.features):function(ze,Je){return new io(ze,Je)}(Ve,J.geojsonVtOptions)}catch(ze){return Q(ze)}this.loaded={};const Ge={};if(Ae){const ze=o.getPerformanceMeasurement(ye);ze&&(Ge.resourceTiming={},Ge.resourceTiming[J.source]=JSON.parse(JSON.stringify(ze)))}Q(null,Ge)}})}reloadTile(J,Q){const ye=this.loaded;return ye&&ye[J.uid]?super.reloadTile(J,Q):this.loadTile(J,Q)}loadGeoJSON(J,Q){if(J.request)o.getJSON(J.request,Q);else{if(typeof J.data!="string")return Q(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`));try{return Q(null,JSON.parse(J.data))}catch{return Q(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(J,Q){try{Q(null,this._geoJSONIndex.getClusterExpansionZoom(J.clusterId))}catch(ye){Q(ye)}}getClusterChildren(J,Q){try{Q(null,this._geoJSONIndex.getChildren(J.clusterId))}catch(ye){Q(ye)}}getClusterLeaves(J,Q){try{Q(null,this._geoJSONIndex.getLeaves(J.clusterId,J.limit,J.offset))}catch(ye){Q(ye)}}}class ys{constructor(J){this.self=J,this.actor=new o.Actor(J,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:gs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Q,ye)=>{if(this.workerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.workerSourceTypes[Q]=ye},this.self.registerRTLTextPlugin=Q=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=Q.applyArabicShaping,o.plugin.processBidirectionalText=Q.processBidirectionalText,o.plugin.processStyledBidirectionalText=Q.processStyledBidirectionalText}}clearCaches(J,Q,ye){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J],ye()}checkIfReady(J,Q,ye){ye()}setReferrer(J,Q){this.referrer=Q}spriteLoaded(J,Q){this.isSpriteLoaded[J]=Q;for(const ye in this.workerSources[J]){const Ae=this.workerSources[J][ye];for(const De in Ae)Ae[De]instanceof o.VectorTileWorkerSource&&(Ae[De].isSpriteLoaded=Q,Ae[De].fire(new o.Event("isSpriteLoaded")))}}setImages(J,Q,ye){this.availableImages[J]=Q;for(const Ae in this.workerSources[J]){const De=this.workerSources[J][Ae];for(const Ve in De)De[Ve].availableImages=Q}ye()}enableTerrain(J,Q,ye){this.terrain=Q,ye()}setProjection(J,Q){this.projections[J]=o.getProjection(Q)}setLayers(J,Q,ye){this.getLayerIndex(J).replace(Q),ye()}updateLayers(J,Q,ye){this.getLayerIndex(J).update(Q.layers,Q.removedIds),ye()}loadTile(J,Q,ye){const Ae=this.enableTerrain?o.extend({enableTerrain:this.terrain},Q):Q;Ae.projection=this.projections[J]||this.defaultProjection,this.getWorkerSource(J,Q.type,Q.source).loadTile(Ae,ye)}loadDEMTile(J,Q,ye){const Ae=this.enableTerrain?o.extend({buildQuadTree:this.terrain},Q):Q;this.getDEMWorkerSource(J,Q.source).loadTile(Ae,ye)}reloadTile(J,Q,ye){const Ae=this.enableTerrain?o.extend({enableTerrain:this.terrain},Q):Q;Ae.projection=this.projections[J]||this.defaultProjection,this.getWorkerSource(J,Q.type,Q.source).reloadTile(Ae,ye)}abortTile(J,Q,ye){this.getWorkerSource(J,Q.type,Q.source).abortTile(Q,ye)}removeTile(J,Q,ye){this.getWorkerSource(J,Q.type,Q.source).removeTile(Q,ye)}removeSource(J,Q,ye){if(!this.workerSources[J]||!this.workerSources[J][Q.type]||!this.workerSources[J][Q.type][Q.source])return;const Ae=this.workerSources[J][Q.type][Q.source];delete this.workerSources[J][Q.type][Q.source],Ae.removeSource!==void 0?Ae.removeSource(Q,ye):ye()}loadWorkerSource(J,Q,ye){try{this.self.importScripts(Q.url),ye()}catch(Ae){ye(Ae.toString())}}syncRTLPluginState(J,Q,ye){try{o.plugin.setState(Q);const Ae=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&Ae!=null){this.self.importScripts(Ae);const De=o.plugin.isParsed();ye(De?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ae}`),De)}}catch(Ae){ye(Ae.toString())}}getAvailableImages(J){let Q=this.availableImages[J];return Q||(Q=[]),Q}getLayerIndex(J){let Q=this.layerIndexes[J];return Q||(Q=this.layerIndexes[J]=new V),Q}getWorkerSource(J,Q,ye){if(this.workerSources[J]||(this.workerSources[J]={}),this.workerSources[J][Q]||(this.workerSources[J][Q]={}),!this.workerSources[J][Q][ye]){const Ae={send:(De,Ve,Ge,ze,Je,Tt)=>{this.actor.send(De,Ve,Ge,J,Je,Tt)},scheduler:this.actor.scheduler};this.workerSources[J][Q][ye]=new this.workerSourceTypes[Q](Ae,this.getLayerIndex(J),this.getAvailableImages(J),this.isSpriteLoaded[J])}return this.workerSources[J][Q][ye]}getDEMWorkerSource(J,Q){return this.demWorkerSources[J]||(this.demWorkerSources[J]={}),this.demWorkerSources[J][Q]||(this.demWorkerSources[J][Q]=new q),this.demWorkerSources[J][Q]}enforceCacheSizeLimit(J,Q){o.enforceCacheSizeLimit(Q)}getWorkerPerformanceMetrics(J,Q,ye){ye(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ys(self)),ys}),S(["./shared"],function(o){function I(f,r){if(Array.isArray(f)){if(!Array.isArray(r)||f.length!==r.length)return!1;for(let u=0;u<f.length;u++)if(!I(f[u],r[u]))return!1;return!0}if(typeof f=="object"&&f!==null&&r!==null){if(typeof r!="object"||Object.keys(f).length!==Object.keys(r).length)return!1;for(const u in f)if(!I(f[u],r[u]))return!1;return!0}return f===r}var O=V;function V(f){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,v,b=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(b);try{v=new Worker(M),g=!0}catch{g=!1}return v&&v.terminate(),URL.revokeObjectURL(M),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var v=g.getContext("2d");if(!v)return!1;var b=v.getImageData(0,0,1,1);return b&&b.width===g.width}()?(q[u=r&&r.failIfMajorPerformanceCaveat]===void 0&&(q[u]=function(g){var v,b=function(M){var P=document.createElement("canvas"),L=Object.create(V.webGLContextAttributes);return L.failIfMajorPerformanceCaveat=M,P.getContext("webgl",L)||P.getContext("experimental-webgl",L)}(g);if(!b)return!1;try{v=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!v||b.isContextLost())&&(b.shaderSource(v,"void main() {}"),b.compileShader(v),b.getShaderParameter(v,b.COMPILE_STATUS)===!0)}(u)),q[u]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var u}(f)}var q={};function ee(f,r,u){const g=o.window.document.createElement(f);return r!==void 0&&(g.className=r),u&&u.appendChild(g),g}function H(f,r,u){const g=o.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const v of Object.keys(r))g.setAttributeNS(null,v,r[v]);return u&&u.appendChild(g),g}V.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const j=o.window.document&&o.window.document.documentElement.style,Z=j&&j.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ne;function xe(){j&&Z&&(ne=j[Z],j[Z]="none")}function ce(){j&&Z&&(j[Z]=ne)}function me(f){f.preventDefault(),f.stopPropagation(),o.window.removeEventListener("click",me,!0)}function de(){o.window.addEventListener("click",me,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",me,!0)},0)}function _e(f,r){const u=f.getBoundingClientRect();return dt(f,u,r)}function Se(f,r){const u=f.getBoundingClientRect(),g=[];for(let v=0;v<r.length;v++)g.push(dt(f,u,r[v]));return g}function $e(f){return o.window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function dt(f,r,u){const g=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new o.Point((u.clientX-r.left)*g,(u.clientY-r.top)*g)}function Y(f,r){var u=r[0],g=r[1],v=r[2],b=r[3],M=u*b-v*g;return M?(f[0]=b*(M=1/M),f[1]=-g*M,f[2]=-v*M,f[3]=u*M,f):null}function pt(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class Lt extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:u,callback:g}of this.requestors)this._notify(u,g);this.requestors=[]}}hasImage(r){return!!this.getImage(r)}getImage(r){return this.images[r]}addImage(r,u){this._validate(r,u)&&(this.images[r]=u)}_validate(r,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),g=!1),g}_validateStretch(r,u){if(!r)return!0;let g=0;for(const v of r){if(v[0]<g||v[1]<v[0]||u<v[1])return!1;g=v[1]}return!0}_validateContent(r,u){return!(r&&(r.length!==4||r[0]<0||u.data.width<r[0]||r[1]<0||u.data.height<r[1]||r[2]<0||u.data.width<r[2]||r[3]<0||u.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,u){u.version=this.images[r].version+1,this.images[r]=u,this.updatedImages[r]=!0}removeImage(r){const u=this.images[r];delete this.images[r],delete this.patterns[r],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,u){let g=!0;if(!this.isLoaded())for(const v of r)this.images[v]||(g=!1);this.isLoaded()||g?this._notify(r,u):this.requestors.push({ids:r,callback:u})}_notify(r,u){const g={};for(const v of r){this.images[v]||this.fire(new o.Event("styleimagemissing",{id:v}));const b=this.images[v];b?g[v]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:o.warnOnce(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,g)}getPixelSize(){const{width:r,height:u}=this.atlasImage;return{width:r,height:u}}getPattern(r){const u=this.patterns[r],g=this.getImage(r);if(!g)return null;if(u&&u.position.version===g.version)return u.position;if(u)u.position.version=g.version;else{const v={w:g.data.width+2,h:g.data.height+2,x:0,y:0},b=new o.ImagePosition(v,g);this.patterns[r]={bin:v,position:b}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const u=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(r,this.atlasImage,u.RGBA),this.atlasTexture&&this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const b in this.patterns)r.push(this.patterns[b].bin);const{w:u,h:g}=o.potpack(r),v=this.atlasImage;v.resize({width:u||1,height:g||1});for(const b in this.patterns){const{bin:M}=this.patterns[b],P=M.x+1,L=M.y+1,N=this.images[b].data,F=N.width,W=N.height;o.RGBAImage.copy(N,v,{x:0,y:0},{x:P,y:L},{width:F,height:W}),o.RGBAImage.copy(N,v,{x:0,y:W-1},{x:P,y:L-1},{width:F,height:1}),o.RGBAImage.copy(N,v,{x:0,y:0},{x:P,y:L+W},{width:F,height:1}),o.RGBAImage.copy(N,v,{x:F-1,y:0},{x:P-1,y:L},{width:1,height:W}),o.RGBAImage.copy(N,v,{x:0,y:0},{x:P+F,y:L},{width:1,height:W})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const u of r){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const g=this.images[u];pt(g)&&this.updateImage(u,g)}}}const lt=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(f,r){return function([u,g,v]){const b=o.degToRad(g+90),M=o.degToRad(v);return{x:u*Math.cos(b)*Math.sin(M),y:u*Math.sin(b)*Math.sin(M),z:u*Math.cos(M),azimuthal:g,polar:v}}(f.expression.evaluate(r))}interpolate(f,r,u){return{x:o.number(f.x,r.x,u),y:o.number(f.y,r.y,u),z:o.number(f.z,r.z,u),azimuthal:o.number(f.azimuthal,r.azimuthal,u),polar:o.number(f.polar,r.polar,u)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)});class zt extends o.Evented{constructor(r){super(),this._transitionable=new o.Transitionable(lt),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,u={}){if(!this._validate(o.validateLight,r,u))for(const g in r){const v=r[g];o.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),v):this._transitionable.setValue(g,v)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,g){return(!g||g.validate!==!1)&&o.emitValidationErrors(this,r.call(o.validateStyle,o.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const $n=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)});let ln=class extends o.Evented{constructor(f,r){super(),this._transitionable=new o.Transitionable($n),this.set(f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(f){for(const r in f){const u=f[r];o.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-11),u):this._transitionable.setValue(r,u)}}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}};function fn(f,r,u,g){const v=o.smoothstep(45,65,u),[b,M]=gt(f,g),P=o.length(r);let L=1-Math.min(1,Math.exp((P-b)/(M-b)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*v*f.alpha}function gt(f,r){const u=.5/Math.tan(.5*r);return[f.range[0]+u,f.range[1]+u]}const Et=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])});class Le extends o.Evented{constructor(r,u){super(),this._transitionable=new o.Transitionable(Et),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){const r=this._transform,u=r.projection.name==="globe",g=o.globeToMercatorTransition(r.zoom),v=this.properties.get("range"),b=[.5,3];return{range:u?[o.number(b[0],v[0],g),o.number(b[1],v[1],g)]:v,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,u={}){if(!this._validate(o.validateFog,r,u)){for(const g of Object.keys(o.spec.fog))r&&r[g]===void 0&&(r[g]=o.spec.fog[g].default);for(const g in r){const v=r[g];o.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),v):this._transitionable.setValue(g,v)}}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,r))*u.a}getOpacityAtLatLng(r,u){return this._transform.projection.supportsFog?function(g,v,b){const M=o.MercatorCoordinate.fromLngLat(v),P=b.elevation?b.elevation.getAtPointOrZero(M):0,L=[M.x,M.y,P];return o.transformMat4(L,L,b.mercatorFogMatrix),fn(g,L,b.pitch,b._fov)}(this.state,r,u):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?gt(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,g){return(!g||g.validate!==!1)&&o.emitValidationErrors(this,r.call(o.validateStyle,o.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class te{constructor(r,u){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const g=this.workerPool.acquire(this.id);for(let v=0;v<g.length;v++){const b=new te.Actor(g[v],u,this.id);b.name=`Worker ${v}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,u,g){o.asyncAll(this.actors,(v,b)=>{v.send(r,u,b)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ue(f,r,u){return r*(o.EXTENT/(f.tileSize*Math.pow(2,u-f.tileID.overscaledZ)))}te.Actor=o.Actor;class Pt{constructor(r,u,g,v){this.screenBounds=r,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,v)}static createFromScreenPoints(r,u){let g,v;if(r instanceof o.Point||typeof r[0]=="number"){const b=o.Point.convert(r);g=[b],v=u.isPointAboveHorizon(b)}else{const b=o.Point.convert(r[0]),M=o.Point.convert(r[1]);g=[b,M],v=o.polygonizeBounds(b,M).every(P=>u.isPointAboveHorizon(P))}return new Pt(g,u.getCameraPoint(),v,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],v=o.polygonizeBounds(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?v[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(v[3]=this.cameraPoint)),o.bufferConvexPolygon(v,r)}bufferedCameraGeometryGlobe(r){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],v=o.polygonizeBounds(u,g,r),b=this.cameraPoint.clone();switch(3*((b.y>u.y)+(b.y>g.y))+((b.x>u.x)+(b.x>g.x))){case 0:v[0]=b,v[4]=b.clone();break;case 1:v.splice(1,0,b);break;case 2:v[1]=b;break;case 3:v.splice(4,0,b);break;case 5:v.splice(2,0,b);break;case 6:v[3]=b;break;case 7:v.splice(3,0,b);break;case 8:v[2]=b}return v}containsTile(r,u,g,v=0){const b=r.queryPadding/u._pixelsPerMercatorPixel+1,M=g?this._bufferedCameraMercator(b,u):this._bufferedScreenMercator(b,u);let P=r.tileID.wrap+(M.unwrapped?v:0);const L=M.polygon.map(he=>o.getTilePoint(r.tileTransform,he,P));if(!o.polygonIntersectsBox(L,0,0,o.EXTENT,o.EXTENT))return;P=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?v:0);const N=this.screenGeometryMercator.polygon.map(he=>o.getTileVec3(r.tileTransform,he,P)),F=N.map(he=>new o.Point(he[0],he[1])),W=u.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),ie=o.getTileVec3(r.tileTransform,W,P),ae=N.map(he=>{const X=o.sub(he,he,ie);return o.normalize(X,X),new o.Ray(ie,X)}),ue=Ue(r,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:F,tilespaceRays:ae,bufferedTilespaceGeometry:L,bufferedTilespaceBounds:(le=o.getBounds(L),le.min.x=o.clamp(le.min.x,0,o.EXTENT),le.min.y=o.clamp(le.min.y,0,o.EXTENT),le.max.x=o.clamp(le.max.x,0,o.EXTENT),le.max.y=o.clamp(le.max.y,0,o.EXTENT),le),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:ue};var le}_bufferedScreenMercator(r,u){const g=Wt(r);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let v;return v=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),u):{polygon:this.bufferedScreenGeometry(r).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[g]=v,v}}_bufferedCameraMercator(r,u){const g=Wt(r);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let v;return v=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),u):{polygon:this.bufferedCameraGeometry(r).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[g]=v,v}}_projectAndResample(r,u){const g=function(b,M){const P=o.multiply([],M.pixelMatrix,M.globeMatrix),L=[0,-o.GLOBE_RADIUS,0,1],N=[0,o.GLOBE_RADIUS,0,1],F=[0,0,0,1];o.transformMat4$1(L,L,P),o.transformMat4$1(N,N,P),o.transformMat4$1(F,F,P);const W=new o.Point(L[0]/L[3],L[1]/L[3]),ie=new o.Point(N[0]/N[3],N[1]/N[3]),ae=o.polygonContainsPoint(b,W)&&L[3]<F[3],ue=o.polygonContainsPoint(b,ie)&&N[3]<F[3];if(!ae&&!ue)return null;const le=function(Ie,Ne,Fe){for(let He=1;He<Ie.length;He++){const vt=qt(Ne.pointCoordinate3D(Ie[He-1]).x),qe=qt(Ne.pointCoordinate3D(Ie[He]).x);if(Fe<0){if(vt<qe)return{idx:He,t:-vt/(qe-1-vt)}}else if(qe<vt)return{idx:He,t:(1-vt)/(qe+1-vt)}}return null}(b,M,ae?-1:1);if(!le)return null;const{idx:he,t:X}=le;let se=he>1?kt(b.slice(0,he),M):[],ge=he<b.length?kt(b.slice(he),M):[];se=se.map(Ie=>new o.Point(qt(Ie.x),Ie.y)),ge=ge.map(Ie=>new o.Point(qt(Ie.x),Ie.y));const ve=[...se];ve.length===0&&ve.push(ge[ge.length-1]);const Pe=o.number(ve[ve.length-1].y,(ge.length===0?se[0]:ge[0]).y,X);let Re;return Re=ae?[new o.Point(0,Pe),new o.Point(0,0),new o.Point(1,0),new o.Point(1,Pe)]:[new o.Point(1,Pe),new o.Point(1,1),new o.Point(0,1),new o.Point(0,Pe)],ve.push(...Re),ge.length===0?ve.push(se[0]):ve.push(...ge),{polygon:ve.map(Ie=>new o.MercatorCoordinate(Ie.x,Ie.y)),unwrapped:!1}}(r,u);if(g)return g;const v=function(b,M){let P=!1,L=-1/0,N=0;for(let W=0;W<b.length-1;W++)b[W].x>L&&(L=b[W].x,N=W);for(let W=0;W<b.length-1;W++){const ie=(N+W)%(b.length-1),ae=b[ie],ue=b[ie+1];Math.abs(ae.x-ue.x)>.5&&(ae.x<ue.x?(ae.x+=1,ie===0&&(b[b.length-1].x+=1)):(ue.x+=1,ie+1===b.length-1&&(b[0].x+=1)),P=!0)}const F=o.mercatorXfromLng(M.center.lng);return P&&F<Math.abs(F-1)&&b.forEach(W=>{W.x-=1}),{polygon:b,unwrapped:P}}(kt(r,u).map(b=>new o.Point(qt(b.x),b.y)),u);return{polygon:v.polygon.map(b=>new o.MercatorCoordinate(b.x,b.y)),unwrapped:v.unwrapped}}}function kt(f,r){return o.resample(f,u=>{const g=r.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function qt(f){return f<0?1+f%1:f%1}function Wt(f){return 100*f|0}function St(f,r,u,g,v){const b=function(M,P){if(M)return v(M);if(P){f.url&&P.tiles&&f.tiles&&delete f.tiles;const L=o.pick(o.extend(P,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);P.vector_layers&&(L.vectorLayers=P.vector_layers,L.vectorLayerIds=L.vectorLayers.map(N=>N.id)),L.tiles=r.canonicalizeTileset(L,f.url),v(null,L)}};return f.url?o.getJSON(r.transformRequest(r.normalizeSourceURL(f.url,null,u,g),o.ResourceType.Source),b):o.exported.frame(()=>b(null,f))}class Ft{constructor(r,u,g){this.bounds=o.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=u||0,this.maxzoom=g||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const u=Math.pow(2,r.z),g=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*u),v=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*u),b=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*u),M=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*u);return r.x>=g&&r.x<b&&r.y>=v&&r.y<M}}class en{constructor(r,u,g){this.context=r;const v=r.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const yn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Bn{constructor(r,u,g,v){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=v,this.context=r;const b=r.gl;this.buffer=b.createBuffer(),r.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,u){for(let g=0;g<this.attributes.length;g++){const v=u.attributes[this.attributes[g].name];v!==void 0&&r.enableVertexAttribArray(v)}}setVertexAttribPointers(r,u,g){for(let v=0;v<this.attributes.length;v++){const b=this.attributes[v],M=u.attributes[b.name];M!==void 0&&r.vertexAttribPointer(M,b.components,r[yn[b.type]],!1,this.itemSize,b.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Xt{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Fn extends Xt{getDefault(){return o.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class pn extends Xt{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Pr extends Xt{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Nn extends Xt{getDefault(){return[!0,!0,!0,!0]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class jn extends Xt{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Kr extends Xt{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Dr extends Xt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const u=this.current;(r.func!==u.func||r.ref!==u.ref||r.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class lr extends Xt{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Ii extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=r,this.dirty=!1}}class Zi extends Xt{getDefault(){return[0,1]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Hi extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=r,this.dirty=!1}}class Ri extends Xt{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class It extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.BLEND):u.disable(u.BLEND),this.current=r,this.dirty=!1}}class Ht extends Xt{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class mn extends Xt{getDefault(){return o.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class xn extends Xt{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Wn extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=r,this.dirty=!1}}class un extends Xt{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class tr extends Xt{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let zr,pr=class extends Xt{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class Yr extends Xt{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class io extends Xt{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ts extends Xt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class yo extends Xt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class gs extends Xt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class ys extends Xt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class we extends Xt{getDefault(){return null}set(r){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class J extends Xt{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class Q extends Xt{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class ye extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Ae extends Xt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class De extends Xt{constructor(r,u){super(r),this.context=r,this.parent=u}getDefault(){return null}}class Ve extends De{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Ge extends De{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ze extends Ge{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Je{constructor(r,u,g,v){this.context=r,this.width=u,this.height=g;const b=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new Ve(r,b),v&&(this.depthAttachment=new Ge(r,b))}destroy(){const r=this.context.gl,u=this.colorAttachment.get();if(u&&r.deleteTexture(u),this.depthAttachment){const g=this.depthAttachment.get();g&&r.deleteRenderbuffer(g)}r.deleteFramebuffer(this.framebuffer)}}class Tt{constructor(r,u=!1){if(this.gl=r,this.isWebGL2=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),u){const g=r;this.extVertexArrayObject={createVertexArrayOES:g.createVertexArray.bind(r),deleteVertexArrayOES:g.deleteVertexArray.bind(r),bindVertexArrayOES:g.bindVertexArray.bind(r)}}this.clearColor=new Fn(this),this.clearDepth=new pn(this),this.clearStencil=new Pr(this),this.colorMask=new Nn(this),this.depthMask=new jn(this),this.stencilMask=new Kr(this),this.stencilFunc=new Dr(this),this.stencilOp=new lr(this),this.stencilTest=new Ii(this),this.depthRange=new Zi(this),this.depthTest=new Hi(this),this.depthFunc=new Ri(this),this.blend=new It(this),this.blendFunc=new Ht(this),this.blendColor=new mn(this),this.blendEquation=new xn(this),this.cullFace=new Wn(this),this.cullFaceSide=new un(this),this.frontFace=new tr(this),this.program=new pr(this),this.activeTexture=new Yr(this),this.viewport=new io(this),this.bindFramebuffer=new ts(this),this.bindRenderbuffer=new yo(this),this.bindTexture=new gs(this),this.bindVertexBuffer=new ys(this),this.bindElementBuffer=new we(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new J(this),this.pixelStoreUnpack=new Q(this),this.pixelStoreUnpackPremultiplyAlpha=new ye(this),this.pixelStoreUnpackFlipY=new Ae(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),u||(this.extTextureHalfFloat=r.getExtension("OES_texture_half_float")),(u||this.extTextureHalfFloat&&r.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=u||r.getExtension("OES_standard_derivatives"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,u){return new en(this,r,u)}createVertexBuffer(r,u,g){return new Bn(this,r,u,g)}createRenderbuffer(r,u,g){const v=this.gl,b=v.createRenderbuffer();return this.bindRenderbuffer.set(b),v.renderbufferStorage(v.RENDERBUFFER,r,u,g),this.bindRenderbuffer.set(null),b}createFramebuffer(r,u,g){return new Je(this,r,u,g)}clear({color:r,depth:u,stencil:g}){const v=this.gl;let b=0;r&&(b|=v.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(b|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(b|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),v.clear(b)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){I(r.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Dt extends o.Evented{constructor(r,u,g,v){if(super(),this.id=r,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(u,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(r){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=St(this._options,this.map._requestManager,u,g,(v,b)=>{this._tileJSONRequest=null,this._loaded=!0,v?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&g.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new o.ErrorEvent(v))):b&&(o.extend(this,b),b.bounds&&(this.tileBounds=new Ft(b.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(b.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(v)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}loadTile(r,u){const g=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),v={request:this.map._requestManager.transformRequest(g,o.ResourceType.Tile),data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile};if(v.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=u:r.request=r.actor.send("reloadTile",v,b.bind(this));else if(r.actor=this._tileWorkers[g]=this._tileWorkers[g]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",v,b.bind(this),void 0,!0);else{const M=o.loadVectorTile.call({deduped:this._deduped},v,(P,L)=>{P||!L?b.call(this,P):(v.data={cacheControl:L.cacheControl,expires:L.expires,rawData:L.rawData.slice(0)},r.actor&&r.actor.send("loadTile",v,b.bind(this),void 0,!0))},!0);r.request={cancel:M}}function b(M,P){return delete r.request,r.aborted?u(null):M&&M.status!==404?u(M):(P&&P.resourceTiming&&(r.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&r.setExpiryData(P),r.loadVectorData(P,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id})}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class xt extends o.Evented{constructor(r,u,g,v){super(),this.id=r,this.dispatcher=g,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},u),o.extend(this,o.pick(u,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=St(this._options,this.map._requestManager,null,null,(u,g)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new o.ErrorEvent(u)):g&&(o.extend(this,g),g.bounds&&(this.tileBounds=new Ft(g.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(g.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(u)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,u){const g=o.exported.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);r.request=o.getImage(this.map._requestManager.transformRequest(v,o.ResourceType.Tile),(b,M,P,L)=>(delete r.request,r.aborted?(r.state="unloaded",u(null)):b?(r.state="errored",u(b)):M?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:P,expires:L}),r.setTexture(M,this.map.painter),r.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void u(null)):u(null)))}static loadTileData(r,u,g){r.setTexture(u,g)}static unloadTileData(r,u){r.texture&&u.saveTileTexture(r.texture)}abortTile(r,u){r.request&&(r.request.cancel(),delete r.request),u()}unloadTile(r,u){r.texture&&this.map.painter.saveTileTexture(r.texture),u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function bn(f,r,u,g,v,b,M,P){const L=[f,u,v,r,g,b,1,1,1],N=[M,P,1],F=o.adjoint([],L),[W,ie,ae]=o.transformMat3(N,N,o.transpose(F,F));return o.multiply$1(L,[W,0,0,0,ie,0,0,0,ae],L)}class Tn extends o.Evented{constructor(r,u,g,v){super(),this.id=r,this.dispatcher=g,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=u,this._dirty=!1}load(r,u){this._loaded=u||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(g,v)=>{if(this._imageRequest=null,this._loaded=!0,g)this.fire(new o.ErrorEvent(g));else if(v){const{HTMLImageElement:b}=o.window;this.image=v instanceof b?o.exported.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading()}})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(r){this.coordinates=r,this._boundsArray=void 0;const u=r.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(g){let v=1/0,b=1/0,M=-1/0,P=-1/0;for(const W of g)v=Math.min(v,W.x),b=Math.min(b,W.y),M=Math.max(M,W.x),P=Math.max(P,W.y);const L=Math.max(M-v,P-b),N=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),F=Math.pow(2,N);return new o.CanonicalTileID(N,Math.floor((v+M)/2*F),Math.floor((b+P)/2*F))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(r){for(const L in this.tiles){const N=this.tiles[L];N.state!=="loaded"&&(N.state="loaded",N.texture=this.texture)}if(this._boundsArray)return;const u=o.tileTransform(this.tileID,this.map.transform.projection),[g,v,b,M]=this.coordinates.map(L=>{const N=u.projection.project(L[0],L[1]);return o.getTilePoint(u,N)._round()});this.perspectiveTransform=function(L,N,F,W,ie,ae,ue,le,he,X){const se=bn(0,0,L,0,0,N,L,N),ge=bn(F,W,ie,ae,ue,le,he,X);return o.multiply$1(ge,o.adjoint(se,se),ge),[ge[6]/ge[8]*L/o.EXTENT,ge[7]/ge[8]*N/o.EXTENT]}(this.width,this.height,g.x,g.y,v.x,v.y,M.x,M.y,b.x,b.y);const P=this._boundsArray=new o.StructArrayLayout4i8;P.emplaceBack(g.x,g.y,0,0),P.emplaceBack(v.x,v.y,o.EXTENT,0),P.emplaceBack(M.x,M.y,0,o.EXTENT),P.emplaceBack(b.x,b.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=r.createVertexBuffer(P,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,u=r.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new o.Texture(r,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(r)}loadTile(r,u){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},u(null)):(r.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const wn={vector:Dt,raster:xt,"raster-dem":class extends xt{constructor(f,r,u,g){super(f,r,u,g),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const u=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(v,b){v&&(f.state="errored",r(v)),b&&(f.dem=b,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=o.getImage(this.map._requestManager.transformRequest(u,o.ResourceType.Tile),(function(v,b,M,P){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(v)f.state="errored",r(v);else if(b){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:M,expires:P});const L=o.window.ImageBitmap&&b instanceof o.window.ImageBitmap&&(zr==null&&(zr=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),zr),N=1-(b.width-o.prevPowerOfTwo(b.width))/2;N<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const F=L?b:o.exported.getImageData(b,N),W={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:F,encoding:this.encoding,padding:N};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",W,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const r=f.canonical,u=Math.pow(2,r.z),g=(r.x-1+u)%u,v=r.x===0?f.wrap-1:f.wrap,b=(r.x+1+u)%u,M=r.x+1===u?f.wrap+1:f.wrap,P={};return P[new o.OverscaledTileID(f.overscaledZ,v,r.z,g,r.y).key]={backfilled:!1},P[new o.OverscaledTileID(f.overscaledZ,M,r.z,b,r.y).key]={backfilled:!1},r.y>0&&(P[new o.OverscaledTileID(f.overscaledZ,v,r.z,g,r.y-1).key]={backfilled:!1},P[new o.OverscaledTileID(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},P[new o.OverscaledTileID(f.overscaledZ,M,r.z,b,r.y-1).key]={backfilled:!1}),r.y+1<u&&(P[new o.OverscaledTileID(f.overscaledZ,v,r.z,g,r.y+1).key]={backfilled:!1},P[new o.OverscaledTileID(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},P[new o.OverscaledTileID(f.overscaledZ,M,r.z,b,r.y+1).key]={backfilled:!1}),P}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends o.Evented{constructor(f,r,u,g){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=r.data,this._options=o.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const v=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*v,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*v,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*v,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},r),this}getClusterLeaves(f,r,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:r,offset:u},g),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=o.extend({},this.workerOptions),r=this._data;typeof r=="string"?(f.request=this.map._requestManager.transformRequest(o.exported.resolveURL(r),o.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(u,g)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new o.ErrorEvent(u));else{const v={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(v.resourceTiming=g.resourceTiming[this.id]),this.fire(new o.Event("data",v)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,r){const u=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(u,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(g,v)=>(delete f.request,f.unloadVectorData(),f.aborted?r(null):g?r(g):(f.loadVectorData(v,this.map.painter,u==="reloadTile"),r(null))),void 0,u==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Tn{constructor(f,r,u,g){super(f,r,u,g),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,o.ResourceType.Source).url);o.getVideo(this.urls,(r,u)=>{this._loaded=!0,r?this.fire(new o.ErrorEvent(r)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(f,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Tn,canvas:class extends Tn{constructor(f,r,u,g){super(f,r,u,g),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(b=>typeof b!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends o.Evented{constructor(f,r,u,g){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=r,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ft(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:u,z:g}=f.canonical;return this._implementation.hasTile({x:r,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:u,y:g,z:v}=f.tileID.canonical,b=new o.window.AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:u,y:g,z:v},{signal:b.signal})).then((function(M){return delete f.request,f.aborted?(f.state="unloaded",r(null)):M===void 0?(f.state="errored",r(null)):M===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(P){return P instanceof o.window.ImageData||P instanceof o.window.HTMLCanvasElement||P instanceof o.window.ImageBitmap||P instanceof o.window.HTMLImageElement}(M)?(this.loadTileData(f,M),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(M=>{M.code!==20&&(f.state="errored",r(M))}),f.request.cancel=()=>b.abort()}loadTileData(f,r){xt.loadTileData(f,r,this._map.painter)}unloadTileData(f){xt.unloadTileData(f,this._map.painter)}unloadTile(f,r){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:u,y:g,z:v}=f.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:v})}r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Sn=function(f,r,u,g){const v=new wn[r.type](f,r,u,g);if(v.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${v.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],v),v};function Vn(f,r){const u=o.identity([]);return o.scale(u,u,[.5*f.width,.5*-f.height,1]),o.translate(u,u,[1,-1,0]),o.multiply(u,u,f.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(u)}function Ir(f,r,u,g,v,b,M,P=!1){const L=f.tilesIn(g,M,P);L.sort(Fi);const N=[];for(const W of L)N.push({wrappedTileID:W.tile.tileID.wrapped().key,queryResults:W.tile.queryRenderedFeatures(r,u,f._state,W,v,b,Vn(f.transform,W.tile.tileID),P)});const F=function(W){const ie={},ae={};for(const ue of W){const le=ue.queryResults,he=ue.wrappedTileID,X=ae[he]=ae[he]||{};for(const se in le){const ge=le[se],ve=X[se]=X[se]||{},Pe=ie[se]=ie[se]||[];for(const Re of ge)ve[Re.featureIndex]||(ve[Re.featureIndex]=!0,Pe.push(Re))}}return ie}(N);for(const W in F)F[W].forEach(ie=>{const ae=ie.feature,ue=ae.layer;ue&&ue.type!=="background"&&ue.type!=="sky"&&(ae.source=ue.source,ue["source-layer"]&&(ae.sourceLayer=ue["source-layer"]),ae.state=ae.id!==void 0?f.getFeatureState(ue["source-layer"],ae.id):{})});return F}function Jr(f,r){const u=f.getRenderableIds().map(b=>f.getTileByID(b)),g=[],v={};for(let b=0;b<u.length;b++){const M=u[b],P=M.tileID.canonical.key;v[P]||(v[P]=!0,M.querySourceFeatures(g,r))}return g}function Fi(f,r){const u=f.tileID,g=r.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function Cr(){return ba.workerClass!=null?new ba.workerClass:new o.window.Worker(ba.workerUrl)}const ns="mapboxgl_preloaded_worker_pool";class ui{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<ui.workerCount;)this.workers.push(new Cr);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ns]}numActive(){return Object.keys(this.active).length}}let Xi;function ja(){return Xi||(Xi=new ui),Xi}function Id(f,r){const u={};for(const g in f)g!=="ref"&&(u[g]=f[g]);return o.refProperties.forEach(g=>{g in r&&(u[g]=r[g])}),u}function mh(f){f=f.slice();const r=Object.create(null);for(let u=0;u<f.length;u++)r[f[u].id]=f[u];for(let u=0;u<f.length;u++)"ref"in f[u]&&(f[u]=Id(f[u],r[f[u].ref]));return f}ui.workerCount=2;const Qn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function gh(f,r,u){u.push({command:Qn.addSource,args:[f,r[f]]})}function vu(f,r,u){r.push({command:Qn.removeSource,args:[f]}),u[f]=!0}function Nr(f,r,u,g){vu(f,u,g),gh(f,r,u)}function gc(f,r,u){let g;for(g in f[u])if(f[u].hasOwnProperty(g)&&g!=="data"&&!I(f[u][g],r[u][g]))return!1;for(g in r[u])if(r[u].hasOwnProperty(g)&&g!=="data"&&!I(f[u][g],r[u][g]))return!1;return!0}function Lo(f,r,u,g,v,b){let M;for(M in r=r||{},f=f||{})f.hasOwnProperty(M)&&(I(f[M],r[M])||u.push({command:b,args:[g,M,r[M],v]}));for(M in r)r.hasOwnProperty(M)&&!f.hasOwnProperty(M)&&(I(f[M],r[M])||u.push({command:b,args:[g,M,r[M],v]}))}function _s(f){return f.id}function yl(f,r){return f[r.id]=r,f}class yh{constructor(r,u){this.reset(r,u)}reset(r,u){this.points=r||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.clamp(r,0,1);let u=1,g=this._distances[u];const v=r*this.paddedLength+this.padding;for(;g<v&&u<this._distances.length;)g=this._distances[++u];const b=u-1,M=this._distances[b],P=g-M,L=P>0?(v-M)/P:0;return this.points[b].mult(1-L).add(this.points[u].mult(L))}}class la{constructor(r,u,g){const v=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(r/g),this.yCellCount=Math.ceil(u/g);for(let M=0;M<this.xCellCount*this.yCellCount;M++)v.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=u,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,u,g,v,b){this._forEachCell(u,g,v,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(v),this.bboxes.push(b)}insertCircle(r,u,g,v){this._forEachCell(u-v,g-v,u+v,g+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(u),this.circles.push(g),this.circles.push(v)}_insertBoxCell(r,u,g,v,b,M){this.boxCells[b].push(M)}_insertCircleCell(r,u,g,v,b,M){this.circleCells[b].push(M)}_query(r,u,g,v,b,M){if(g<0||r>this.width||v<0||u>this.height)return!b&&[];const P=[];if(r<=0&&u<=0&&this.width<=g&&this.height<=v){if(b)return!0;for(let L=0;L<this.boxKeys.length;L++)P.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const N=this.circles[3*L],F=this.circles[3*L+1],W=this.circles[3*L+2];P.push({key:this.circleKeys[L],x1:N-W,y1:F-W,x2:N+W,y2:F+W})}return M?P.filter(M):P}return this._forEachCell(r,u,g,v,this._queryCell,P,{hitTest:b,seenUids:{box:{},circle:{}}},M),b?P.length>0:P}_queryCircle(r,u,g,v,b){const M=r-g,P=r+g,L=u-g,N=u+g;if(P<0||M>this.width||N<0||L>this.height)return!v&&[];const F=[];return this._forEachCell(M,L,P,N,this._queryCellCircle,F,{hitTest:v,circle:{x:r,y:u,radius:g},seenUids:{box:{},circle:{}}},b),v?F.length>0:F}query(r,u,g,v,b){return this._query(r,u,g,v,!1,b)}hitTest(r,u,g,v,b){return this._query(r,u,g,v,!0,b)}hitTestCircle(r,u,g,v){return this._queryCircle(r,u,g,!0,v)}_queryCell(r,u,g,v,b,M,P,L){const N=P.seenUids,F=this.boxCells[b];if(F!==null){const ie=this.bboxes;for(const ae of F)if(!N.box[ae]){N.box[ae]=!0;const ue=4*ae;if(r<=ie[ue+2]&&u<=ie[ue+3]&&g>=ie[ue+0]&&v>=ie[ue+1]&&(!L||L(this.boxKeys[ae]))){if(P.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[ae],x1:ie[ue],y1:ie[ue+1],x2:ie[ue+2],y2:ie[ue+3]})}}}const W=this.circleCells[b];if(W!==null){const ie=this.circles;for(const ae of W)if(!N.circle[ae]){N.circle[ae]=!0;const ue=3*ae;if(this._circleAndRectCollide(ie[ue],ie[ue+1],ie[ue+2],r,u,g,v)&&(!L||L(this.circleKeys[ae]))){if(P.hitTest)return M.push(!0),!0;{const le=ie[ue],he=ie[ue+1],X=ie[ue+2];M.push({key:this.circleKeys[ae],x1:le-X,y1:he-X,x2:le+X,y2:he+X})}}}}}_queryCellCircle(r,u,g,v,b,M,P,L){const N=P.circle,F=P.seenUids,W=this.boxCells[b];if(W!==null){const ae=this.bboxes;for(const ue of W)if(!F.box[ue]){F.box[ue]=!0;const le=4*ue;if(this._circleAndRectCollide(N.x,N.y,N.radius,ae[le+0],ae[le+1],ae[le+2],ae[le+3])&&(!L||L(this.boxKeys[ue])))return M.push(!0),!0}}const ie=this.circleCells[b];if(ie!==null){const ae=this.circles;for(const ue of ie)if(!F.circle[ue]){F.circle[ue]=!0;const le=3*ue;if(this._circlesCollide(ae[le],ae[le+1],ae[le+2],N.x,N.y,N.radius)&&(!L||L(this.circleKeys[ue])))return M.push(!0),!0}}}_forEachCell(r,u,g,v,b,M,P,L){const N=this._convertToXCellCoord(r),F=this._convertToYCellCoord(u),W=this._convertToXCellCoord(g),ie=this._convertToYCellCoord(v);for(let ae=N;ae<=W;ae++)for(let ue=F;ue<=ie;ue++)if(b.call(this,r,u,g,v,this.xCellCount*ue+ae,M,P,L))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,u,g,v,b,M){const P=v-r,L=b-u,N=g+M;return N*N>P*P+L*L}_circleAndRectCollide(r,u,g,v,b,M,P){const L=(M-v)/2,N=Math.abs(r-(v+L));if(N>L+g)return!1;const F=(P-b)/2,W=Math.abs(u-(b+F));if(W>F+g)return!1;if(N<=L||W<=F)return!0;const ie=N-L,ae=W-F;return ie*ie+ae*ae<=g*g}}const Do={unknown:0,flipRequired:1,flipNotRequired:2},oo=Math.tan(85*Math.PI/180);function ot(f,r,u,g,v,b,M){const P=o.create();if(u)if(b.name==="globe"){const L=o.calculateGlobeLabelMatrix(v,r);o.multiply(P,P,L)}else{const L=Y([],M);P[0]=L[0],P[1]=L[1],P[4]=L[2],P[5]=L[3],g||o.rotateZ(P,P,v.angle)}else o.multiply(P,v.labelPlaneMatrix,f);return P}function ci(f,r,u,g,v,b,M){const P=ot(f,r,u,g,v,b,M);return b.name==="globe"&&u||(P[2]=P[6]=P[10]=P[14]=0),P}function Qr(f,r,u,g,v,b,M){if(u){if(b.name==="globe"){const P=ot(f,r,u,g,v,b,M);return o.invert(P,P),o.multiply(P,f,P),P}{const P=o.clone(f),L=o.identity([]);return L[0]=M[0],L[1]=M[1],L[4]=M[2],L[5]=M[3],o.multiply(P,P,L),g||o.rotateZ(P,P,-v.angle),P}}return v.glCoordMatrix}function _i(f,r,u,g){const v=[f,r,u,1];u?o.transformMat4$1(v,v,g):Cn(v,v,g);const b=v[3];return v[0]/=b,v[1]/=b,v[2]/=b,v}function Rd(f,r){return Math.min(.5+f/r*.5,1.5)}function _o(f,r){const u=f[0]/f[3],g=f[1]/f[3];return u>=-r[0]&&u<=r[0]&&g>=-r[1]&&g<=r[1]}function _l(f,r,u,g,v,b,M,P,L,N){const F=u.transform,W=g?f.textSizeData:f.iconSizeData,ie=o.evaluateSizeForZoom(W,u.transform.zoom),ae=F.projection.name==="globe",ue=[256/u.width*2+1,256/u.height*2+1],le=g?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;le.clear();let he=null;ae&&(he=g?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const X=f.lineVertexArray,se=g?f.text.placedSymbolArray:f.icon.placedSymbolArray,ge=u.transform.width/u.transform.height;let ve,Pe=!1;for(let Re=0;Re<se.length;Re++){const Ie=se.get(Re),{numGlyphs:Ne,writingMode:Fe}=Ie;if(Fe!==o.WritingMode.vertical||Pe||ve===o.WritingMode.horizontal||(Pe=!0),ve=Fe,(Ie.hidden||Fe===o.WritingMode.vertical)&&!Pe){vo(Ne,le);continue}Pe=!1;const He=new o.Point(Ie.tileAnchorX,Ie.tileAnchorY);let{x:vt,y:qe,z:nt}=F.projection.projectTilePoint(He.x,He.y,N.canonical);if(L){const[dn,Zt,on]=L(He);vt+=dn,qe+=Zt,nt+=on}const Xe=[vt,qe,nt,1];if(o.transformMat4$1(Xe,Xe,r),!_o(Xe,ue)){vo(Ne,le);continue}const yt=Rd(u.transform.cameraToCenterDistance,Xe[3]),Ze=o.evaluateSizeForFeature(W,ie,Ie),rt=M?Ze/yt:Ze*yt,mt=_i(vt,qe,nt,v);if(mt[3]<=0){vo(Ne,le);continue}let ht={};const wt=M?null:L,Jt=$t(Ie,rt,!1,P,r,v,b,f.glyphOffsetArray,X,le,he,mt,He,ht,ge,wt,F.projection,N,M);Pe=Jt.useVertical,wt&&Jt.needsFlipping&&(ht={}),(Jt.notEnoughRoom||Pe||Jt.needsFlipping&&$t(Ie,rt,!0,P,r,v,b,f.glyphOffsetArray,X,le,he,mt,He,ht,ge,wt,F.projection,N,M).notEnoughRoom)&&vo(Ne,le)}g?(f.text.dynamicLayoutVertexBuffer.updateData(le),he&&f.text.globeExtVertexBuffer.updateData(he)):(f.icon.dynamicLayoutVertexBuffer.updateData(le),he&&f.icon.globeExtVertexBuffer.updateData(he))}function vl(f,r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue,le){const{lineStartIndex:he,glyphStartIndex:X,segment:se}=P,ge=X+P.numGlyphs,ve=he+P.lineLength,Pe=r.getoffsetX(X),Re=r.getoffsetX(ge-1),Ie=so(f*Pe,u,g,v,b,M,se,he,ve,L,N,F,W,ie,!0,ae,ue,le);if(!Ie)return null;const Ne=so(f*Re,u,g,v,b,M,se,he,ve,L,N,F,W,ie,!0,ae,ue,le);return Ne?{first:Ie,last:Ne}:null}function Ns(f,r,u,g){return f===o.WritingMode.horizontal&&Math.abs(g)>Math.abs(u)?{useVertical:!0}:f===o.WritingMode.vertical?g>0?{needsFlipping:!0}:null:r!==Do.unknown&&function(v,b){return v===0||Math.abs(b/v)>oo}(u,g)?r===Do.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function $t(f,r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue,le,he,X,se){const ge=r/24,ve=f.lineOffsetX*ge,Pe=f.lineOffsetY*ge,{lineStartIndex:Re,glyphStartIndex:Ie,numGlyphs:Ne,segment:Fe,writingMode:He,flipState:vt}=f,qe=Re+f.lineLength,nt=Xe=>{if(F){const[mt,ht,wt]=Xe.up,Jt=N.length;o.updateGlobeVertexNormal(F,Jt+0,mt,ht,wt),o.updateGlobeVertexNormal(F,Jt+1,mt,ht,wt),o.updateGlobeVertexNormal(F,Jt+2,mt,ht,wt),o.updateGlobeVertexNormal(F,Jt+3,mt,ht,wt)}const[yt,Ze,rt]=Xe.point;o.addDynamicAttributes(N,yt,Ze,rt,Xe.angle)};if(Ne>1){const Xe=vl(ge,P,ve,Pe,u,W,ie,f,L,b,ae,le,!1,he,X,se);if(!Xe)return{notEnoughRoom:!0};if(g&&!u){let[yt,Ze,rt]=Xe.first.point,[mt,ht,wt]=Xe.last.point;[yt,Ze]=_i(yt,Ze,rt,M),[mt,ht]=_i(mt,ht,wt,M);const Jt=Ns(He,vt,(mt-yt)*ue,ht-Ze);if(f.flipState=Jt&&Jt.needsFlipping?Do.flipRequired:Do.flipNotRequired,Jt)return Jt}nt(Xe.first);for(let yt=Ie+1;yt<Ie+Ne-1;yt++){const Ze=so(ge*P.getoffsetX(yt),ve,Pe,u,W,ie,Fe,Re,qe,L,b,ae,le,!1,!1,he,X,se);if(!Ze)return N.length-=4*(yt-Ie),{notEnoughRoom:!0};nt(Ze)}nt(Xe.last)}else{if(g&&!u){const yt=_i(ie.x,ie.y,0,v),Ze=Re+Fe+1,rt=new o.Point(L.getx(Ze),L.gety(Ze)),mt=_i(rt.x,rt.y,0,v),ht=mt[3]>0?mt:Ln(ie,rt,yt,1,v,void 0,he,X.canonical),wt=Ns(He,vt,(ht[0]-yt[0])*ue,ht[1]-yt[1]);if(f.flipState=wt&&wt.needsFlipping?Do.flipRequired:Do.flipNotRequired,wt)return wt}const Xe=so(ge*P.getoffsetX(Ie),ve,Pe,u,W,ie,Fe,Re,qe,L,b,ae,le,!1,!1,he,X,se);if(!Xe)return{notEnoughRoom:!0};nt(Xe)}return{}}function Gn(f,r,u,g,v){const{x:b,y:M,z:P}=g.projectTilePoint(f.x,f.y,r);if(!v)return _i(b,M,P,u);const[L,N,F]=v(f);return _i(b+L,M+N,P+F,u)}function Ln(f,r,u,g,v,b,M,P){const L=Gn(f.sub(r)._unit()._add(f),P,v,M,b);return o.sub(L,u,L),o.normalize(L,L),o.scaleAndAdd(L,u,L,g)}function so(f,r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue,le,he,X){const se=g?f-r:f+r;let ge=se>0?1:-1,ve=0;g&&(ge*=-1,ve=Math.PI),ge<0&&(ve+=Math.PI);let Pe=P+M+(ge>0?0:1)|0,Re=v,Ie=v,Ne=0,Fe=0;const He=Math.abs(se),vt=[],qe=[];let nt=b,Xe=nt;const yt=()=>Ln(Xe,nt,Ie,He-Ne+1,F,ie,le,he.canonical);for(;Ne+Fe<=He;){if(Pe+=ge,Pe<P||Pe>=L)return null;if(Ie=Re,Xe=nt,vt.push(Ie),ae&&qe.push(Xe),nt=new o.Point(N.getx(Pe),N.gety(Pe)),Re=W[Pe],!Re){const on=Gn(nt,he.canonical,F,le,ie);Re=on[3]>0?W[Pe]=on:yt()}Ne+=Fe,Fe=o.distance(Ie,Re)}ue&&ie&&(W[Pe]&&(Re=yt(),Fe=o.distance(Ie,Re)),W[Pe]=Re);const Ze=(He-Ne)/Fe,rt=nt.sub(Xe)._mult(Ze)._add(Xe),mt=o.sub([],Re,Ie),ht=o.scaleAndAdd([],Ie,mt,Ze);let wt=[0,0,1],Jt=mt[0],dn=mt[1];if(X&&(wt=le.upVector(he.canonical,rt.x,rt.y),wt[0]!==0||wt[1]!==0||wt[2]!==1)){const on=[wt[2],0,-wt[0]],Pn=o.cross([],wt,on);o.normalize(on,on),o.normalize(Pn,Pn),Jt=o.dot(mt,on),dn=o.dot(mt,Pn)}if(u){const on=o.cross([],wt,mt);o.normalize(on,on),o.scaleAndAdd(ht,ht,on,u*ge)}const Zt=ve+Math.atan2(dn,Jt);return vt.push(ht),ae&&qe.push(rt),{point:ht,angle:Zt,path:vt,tilePath:qe,up:wt}}function vo(f,r){const u=r.length,g=u+4*f;r.resize(g),r.float32.fill(-1/0,4*u,4*g)}function Cn(f,r,u){const g=r[0],v=r[1];return f[0]=u[0]*g+u[4]*v+u[12],f[1]=u[1]*g+u[5]*v+u[13],f[3]=u[3]*g+u[7]*v+u[15],f}const xo=100;class Va{constructor(r,u,g=new la(r.width+200,r.height+200,25),v=new la(r.width+200,r.height+200,25)){this.transform=r,this.grid=g,this.ignoredGrid=v,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+xo,this.screenBottomBoundary=r.height+xo,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=u}placeCollisionBox(r,u,g,v,b,M,P,L){let N=g.projectedAnchorX,F=g.projectedAnchorY,W=g.projectedAnchorZ;const ie=g.elevation,ae=g.tileID,ue=r.getProjection();if(ie&&ae){const[Re,Ie,Ne]=ue.upVector(ae.canonical,g.tileAnchorX,g.tileAnchorY),Fe=ue.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;N+=Re*ie*Fe,F+=Ie*ie*Fe,W+=Ne*ie*Fe}const le=this.projectAndGetPerspectiveRatio(P,N,F,W,g.tileID,ue.name==="globe"||!!ie||this.transform.pitch>0,ue),he=M*le.perspectiveRatio,X=(g.x1*u+v.x-g.padding)*he+le.point.x,se=(g.y1*u+v.y-g.padding)*he+le.point.y,ge=(g.x2*u+v.x+g.padding)*he+le.point.x,ve=(g.y2*u+v.y+g.padding)*he+le.point.y,Pe=le.perspectiveRatio<=.55||le.occluded;return!this.isInsideGrid(X,se,ge,ve)||!b&&this.grid.hitTest(X,se,ge,ve,L)||Pe?{box:[],offscreen:!1,occluded:le.occluded}:{box:[X,se,ge,ve],offscreen:this.isOffscreen(X,se,ge,ve),occluded:!1}}placeCollisionCircles(r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue,le){const he=[],X=this.transform.elevation,se=r.getProjection(),ge=X?X.getAtTileOffsetFunc(le,this.transform.center.lat,this.transform.worldSize,se):null,ve=new o.Point(g.tileAnchorX,g.tileAnchorY);let{x:Pe,y:Re,z:Ie}=se.projectTilePoint(ve.x,ve.y,le.canonical);if(ge){const[rt,mt,ht]=ge(ve);Pe+=rt,Re+=mt,Ie+=ht}const Ne=se.name==="globe",Fe=this.projectAndGetPerspectiveRatio(P,Pe,Re,Ie,le,Ne||!!X||this.transform.pitch>0,se),{perspectiveRatio:He}=Fe,vt=(W?M/He:M*He)/o.ONE_EM,qe=_i(Pe,Re,Ie,L),nt=Fe.signedDistanceFromCamera>0?vl(vt,b,g.lineOffsetX*vt,g.lineOffsetY*vt,!1,qe,ve,g,v,L,{},X&&!W?ge:null,W&&!!X,se,le,W):null;let Xe=!1,yt=!1,Ze=!0;if(nt&&!Fe.occluded){const rt=.5*ae*He+ue,mt=new o.Point(-100,-100),ht=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),wt=new yh,{first:Jt,last:dn}=nt,Zt=Jt.path.length;let on=[];for(let Qt=Zt-1;Qt>=1;Qt--)on.push(Jt.path[Qt]);for(let Qt=1;Qt<dn.path.length;Qt++)on.push(dn.path[Qt]);const Pn=2.5*rt;N&&(on=on.map(([Qt,Un,nr],rr)=>(ge&&!Ne&&(nr=ge(rr<Zt-1?Jt.tilePath[Zt-1-rr]:dn.tilePath[rr-Zt+2])[2]),_i(Qt,Un,nr,N))),on.some(Qt=>Qt[3]<=0)&&(on=[]));let Dn=[];if(on.length>0){let Qt=1/0,Un=-1/0,nr=1/0,rr=-1/0;for(const Jn of on)Qt=Math.min(Qt,Jn[0]),nr=Math.min(nr,Jn[1]),Un=Math.max(Un,Jn[0]),rr=Math.max(rr,Jn[1]);Un>=mt.x&&Qt<=ht.x&&rr>=mt.y&&nr<=ht.y&&(Dn=[on.map(Jn=>new o.Point(Jn[0],Jn[1]))],(Qt<mt.x||Un>ht.x||nr<mt.y||rr>ht.y)&&(Dn=o.clipLine(Dn,mt.x,mt.y,ht.x,ht.y)))}for(const Qt of Dn){wt.reset(Qt,.25*rt);let Un=0;Un=wt.length<=.5*rt?1:Math.ceil(wt.paddedLength/Pn)+1;for(let nr=0;nr<Un;nr++){const rr=nr/Math.max(Un-1,1),Jn=wt.lerp(rr),bi=Jn.x+xo,jr=Jn.y+xo;he.push(bi,jr,rt,0);const Co=bi-rt,$o=jr-rt,En=bi+rt,ur=jr+rt;if(Ze=Ze&&this.isOffscreen(Co,$o,En,ur),yt=yt||this.isInsideGrid(Co,$o,En,ur),!u&&this.grid.hitTestCircle(bi,jr,rt,ie)&&(Xe=!0,!F))return{circles:[],offscreen:!1,collisionDetected:Xe,occluded:!1}}}}return{circles:!F&&Xe||!yt?[]:he,offscreen:Ze,collisionDetected:Xe,occluded:Fe.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,v=1/0,b=-1/0,M=-1/0;for(const F of r){const W=new o.Point(F.x+xo,F.y+xo);g=Math.min(g,W.x),v=Math.min(v,W.y),b=Math.max(b,W.x),M=Math.max(M,W.y),u.push(W)}const P=this.grid.query(g,v,b,M).concat(this.ignoredGrid.query(g,v,b,M)),L={},N={};for(const F of P){const W=F.key;if(L[W.bucketInstanceId]===void 0&&(L[W.bucketInstanceId]={}),L[W.bucketInstanceId][W.featureIndex])continue;const ie=[new o.Point(F.x1,F.y1),new o.Point(F.x2,F.y1),new o.Point(F.x2,F.y2),new o.Point(F.x1,F.y2)];o.polygonIntersectsPolygon(u,ie)&&(L[W.bucketInstanceId][W.featureIndex]=!0,N[W.bucketInstanceId]===void 0&&(N[W.bucketInstanceId]=[]),N[W.bucketInstanceId].push(W.featureIndex))}return N}insertCollisionBox(r,u,g,v,b){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:v,collisionGroupID:b},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,u,g,v,b){const M=u?this.ignoredGrid:this.grid,P={bucketInstanceId:g,featureIndex:v,collisionGroupID:b};for(let L=0;L<r.length;L+=4)M.insertCircle(P,r[L],r[L+1],r[L+2])}projectAndGetPerspectiveRatio(r,u,g,v,b,M,P){const L=[u,g,v,1];let N=!1;v||this.transform.pitch>0?(o.transformMat4$1(L,L,r),this.fogState&&b&&P.name!=="globe"&&(N=function(ie,ae,ue,le,he,X){const se=X.calculateFogTileMatrix(he),ge=[ae,ue,le];return o.transformMat4(ge,ge,se),fn(ie,ge,X.pitch,X._fov)}(this.fogState,u,g,v,b.toUnwrapped(),this.transform)>.9)):Cn(L,L,r);const F=L[3];return{point:new o.Point((L[0]/F+1)/2*this.transform.width+xo,(-L[1]/F+1)/2*this.transform.height+xo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(P)/F*.5,1.5),signedDistanceFromCamera:F,occluded:M&&L[2]>F||N}}isOffscreen(r,u,g,v){return g<xo||r>=this.screenRightBoundary||v<xo||u>this.screenBottomBoundary}isInsideGrid(r,u,g,v){return g>=0&&r<this.gridRightBoundary&&v>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const r=o.identity([]);return o.translate(r,r,[-100,-100,0]),r}}function er(f,r,u){const g=r.createTileMatrix(f,f.worldSize,u.toUnwrapped());return o.multiply(new Float32Array(16),f.projMatrix,g)}function wo(f,r,u){if(r.projection.name===u.projection.name)return f.projMatrix;const g=u.clone();return g.setProjection(r.projection),er(g,r.getProjection(),f)}function _r(f,r,u){return r.name===u.projection.name?f.projMatrix:er(u,r,f)}class yc{constructor(r,u,g,v){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?u:-u))):v&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class vs{constructor(r,u,g,v,b,M=!1){this.text=new yc(r?r.text:null,u,g,b),this.icon=new yc(r?r.icon:null,u,v,b),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class xl{constructor(r,u,g,v=!1){this.text=r,this.icon=u,this.skipFade=g,this.clipped=v}}class wl{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class xu{constructor(r,u,g,v,b){this.bucketInstanceId=r,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=v,this.tileID=b}}class wu{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const u=++this.maxGroupID;this.collisionGroups[r]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[r]}}function zo(f,r,u,g,v){const{horizontalAlign:b,verticalAlign:M}=o.getAnchorAlignment(f),P=-(b-.5)*r,L=-(M-.5)*u,N=o.evaluateVariableOffset(f,g);return new o.Point(P+N[0]*v,L+N[1]*v)}function Oo(f,r,u,g,v){const b=new o.Point(f,r);return u&&b._rotate(g?v:-v),b}class rs{constructor(r,u,g,v,b){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new Va(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new wu(g),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,u,g,v){const b=g.getBucket(u),M=g.latestFeatureIndex;if(!b||!M||u.id!==b.layerIds[0])return;const P=b.layers[0].layout,L=g.collisionBoxArray,N=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),F=g.tileSize/o.EXTENT,W=g.tileID.toUnwrapped();this.transform.setProjection(b.projection);const ie=(ae=g.tileID,ue=b.getProjection(),le=this.transform,ue.name===this.projection?le.calculateProjMatrix(ae.toUnwrapped()):er(le,ue,ae));var ae,ue,le;const he=P.get("text-pitch-alignment")==="map",X=P.get("text-rotation-alignment")==="map";u.compileFilter();const se=u.dynamicFilter(),ge=u.dynamicFilterNeedsFeature(),ve=this.transform.calculatePixelsToTileUnitsMatrix(g),Pe=ci(ie,g.tileID.canonical,he,X,this.transform,b.getProjection(),ve);let Re=null;if(he){const Fe=Qr(ie,g.tileID.canonical,he,X,this.transform,b.getProjection(),ve);Re=o.multiply([],this.transform.labelPlaneMatrix,Fe)}let Ie=null;se&&g.latestFeatureIndex&&(Ie={unwrappedTileID:W,dynamicFilter:se,dynamicFilterNeedsFeature:ge,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new xu(b.bucketInstanceId,M,b.sourceLayerIndex,b.index,g.tileID);const Ne={bucket:b,layout:P,posMatrix:ie,textLabelPlaneMatrix:Pe,labelToScreenMatrix:Re,clippingData:Ie,scale:N,textPixelRatio:F,holdingForFade:g.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(v)for(const Fe of b.sortKeyRanges){const{sortKey:He,symbolInstanceStart:vt,symbolInstanceEnd:qe}=Fe;r.push({sortKey:He,symbolInstanceStart:vt,symbolInstanceEnd:qe,parameters:Ne})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Ne})}attemptAnchorPlacement(r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue,le,he,X,se){const{textOffset0:ge,textOffset1:ve,crossTileID:Pe}=ie,Re=[ge,ve],Ie=zo(r,g,v,Re,b),Ne=this.collisionIndex.placeCollisionBox(ue,b,u,Oo(Ie.x,Ie.y,M,P,this.transform.angle),W,L,N,F.predicate);if(he){const Fe=ue.getSymbolInstanceIconSize(se,this.transform.zoom,ie.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ue,Fe,he,Oo(Ie.x,Ie.y,M,P,this.transform.angle),W,L,N,F.predicate).box.length===0)return}if(Ne.box.length>0){let Fe;return this.prevPlacement&&this.prevPlacement.variableOffsets[Pe]&&this.prevPlacement.placements[Pe]&&this.prevPlacement.placements[Pe].text&&(Fe=this.prevPlacement.variableOffsets[Pe].anchor),this.variableOffsets[Pe]={textOffset:Re,width:g,height:v,anchor:r,textScale:b,prevAnchor:Fe},this.markUsedJustification(ue,r,ie,le),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,le,ie),this.placedOrientations[Pe]=le),{shift:Ie,placedGlyphBoxes:Ne}}}placeLayerBucketPart(r,u,g,v){const{bucket:b,layout:M,posMatrix:P,textLabelPlaneMatrix:L,labelToScreenMatrix:N,clippingData:F,textPixelRatio:W,holdingForFade:ie,collisionBoxArray:ae,partiallyEvaluatedTextSize:ue,partiallyEvaluatedIconSize:le,collisionGroup:he}=r.parameters,X=M.get("text-optional"),se=M.get("icon-optional"),ge=M.get("text-allow-overlap"),ve=M.get("icon-allow-overlap"),Pe=M.get("text-rotation-alignment")==="map",Re=M.get("text-pitch-alignment")==="map",Ie=M.get("icon-text-fit")!=="none",Ne=M.get("symbol-z-order")==="viewport-y";this.transform.setProjection(b.projection);let Fe=ge&&(ve||!b.hasIconData()||se),He=ve&&(ge||!b.hasTextData()||X);!b.collisionArrays&&ae&&b.deserializeCollisionBoxes(ae),g&&v&&b.updateCollisionDebugBuffers(this.transform.zoom,ae);const vt=(qe,nt,Xe)=>{const{crossTileID:yt,numVerticalGlyphVertices:Ze}=qe;if(F){const En={zoom:this.transform.zoom,pitch:this.transform.pitch};let ur=null;if(F.dynamicFilterNeedsFeature){const Yn=this.retainedQueryData[b.bucketInstanceId];ur=F.featureIndex.loadFeature({featureIndex:qe.featureIndex,bucketIndex:Yn.bucketIndex,sourceLayerIndex:Yn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,F.dynamicFilter)(En,ur,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new o.Point(qe.tileAnchorX,qe.tileAnchorY),this.transform.calculateDistanceTileData(F.unwrappedTileID)))return this.placements[yt]=new xl(!1,!1,!1,!0),void u.add(yt)}if(u.has(yt))return;if(ie)return void(this.placements[yt]=new xl(!1,!1,!1));let rt=!1,mt=!1,ht=!0,wt=!1,Jt=!1,dn=null,Zt={box:null,offscreen:null,occluded:null},on={box:null},Pn=null,Dn=null,Qt=null,Un=0,nr=0,rr=0;Xe.textFeatureIndex?Un=Xe.textFeatureIndex:qe.useRuntimeCollisionCircles&&(Un=qe.featureIndex),Xe.verticalTextFeatureIndex&&(nr=Xe.verticalTextFeatureIndex);const Jn=En=>{En.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;const ur=this.transform.elevation;(ur||En.elevation)&&(En.elevation=ur?ur.getAtTileOffset(En.tileID,En.tileAnchorX,En.tileAnchorY):0)},bi=Xe.textBox;if(bi){Jn(bi);const En=Yn=>{let Vr=o.WritingMode.horizontal;if(b.allowVerticalPlacement&&!Yn&&this.prevPlacement){const Ti=this.prevPlacement.placedOrientations[yt];Ti&&(this.placedOrientations[yt]=Ti,Vr=Ti,this.markUsedOrientation(b,Vr,qe))}return Vr},ur=(Yn,Vr)=>{if(b.allowVerticalPlacement&&Ze>0&&Xe.verticalTextBox){for(const Ti of b.writingModes)if(Ti===o.WritingMode.vertical?(Zt=Vr(),on=Zt):Zt=Yn(),Zt&&Zt.box&&Zt.box.length)break}else Zt=Yn()};if(M.get("text-variable-anchor")){let Yn=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[yt]){const fr=this.prevPlacement.variableOffsets[yt];Yn.indexOf(fr.anchor)>0&&(Yn=Yn.filter(ri=>ri!==fr.anchor),Yn.unshift(fr.anchor))}const Vr=(fr,ri,Mr)=>{const Rr=b.getSymbolInstanceTextSize(ue,qe,this.transform.zoom,nt),Zr=(fr.x2-fr.x1)*Rr+2*fr.padding,Go=(fr.y2-fr.y1)*Rr+2*fr.padding,qo=Ie&&!ve?ri:null;qo&&Jn(qo);let us={box:[],offscreen:!1,occluded:!1};const Nc=ge?2*Yn.length:Yn.length;for(let ii=0;ii<Nc;++ii){const qu=this.attemptAnchorPlacement(Yn[ii%Yn.length],fr,Zr,Go,Rr,Pe,Re,W,P,he,ii>=Yn.length,qe,nt,b,Mr,qo,ue,le);if(qu&&(us=qu.placedGlyphBoxes,us&&us.box&&us.box.length)){rt=!0,dn=qu.shift;break}}return us};ur(()=>Vr(bi,Xe.iconBox,o.WritingMode.horizontal),()=>{const fr=Xe.verticalTextBox;return fr&&Jn(fr),b.allowVerticalPlacement&&!(Zt&&Zt.box&&Zt.box.length)&&Ze>0&&fr?Vr(fr,Xe.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Zt&&(rt=Zt.box,ht=Zt.offscreen,wt=Zt.occluded);const Ti=En(!(!Zt||!Zt.box));if(!rt&&this.prevPlacement){const fr=this.prevPlacement.variableOffsets[yt];fr&&(this.variableOffsets[yt]=fr,this.markUsedJustification(b,fr.anchor,qe,Ti))}}else{const Yn=(Vr,Ti)=>{const fr=b.getSymbolInstanceTextSize(ue,qe,this.transform.zoom,nt),ri=this.collisionIndex.placeCollisionBox(b,fr,Vr,new o.Point(0,0),ge,W,P,he.predicate);return ri&&ri.box&&ri.box.length&&(this.markUsedOrientation(b,Ti,qe),this.placedOrientations[yt]=Ti),ri};ur(()=>Yn(bi,o.WritingMode.horizontal),()=>{const Vr=Xe.verticalTextBox;return b.allowVerticalPlacement&&Ze>0&&Vr?(Jn(Vr),Yn(Vr,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),En(!!(Zt&&Zt.box&&Zt.box.length))}}if(Pn=Zt,rt=Pn&&Pn.box&&Pn.box.length>0,ht=Pn&&Pn.offscreen,wt=Pn&&Pn.occluded,qe.useRuntimeCollisionCircles){const En=b.text.placedSymbolArray.get(qe.centerJustifiedTextSymbolIndex>=0?qe.centerJustifiedTextSymbolIndex:qe.verticalPlacedTextSymbolIndex),ur=o.evaluateSizeForFeature(b.textSizeData,ue,En),Yn=M.get("text-padding");Dn=this.collisionIndex.placeCollisionCircles(b,ge,En,b.lineVertexArray,b.glyphOffsetArray,ur,P,L,N,g,Re,he.predicate,qe.collisionCircleDiameter*ur/o.ONE_EM,Yn,this.retainedQueryData[b.bucketInstanceId].tileID),rt=ge||Dn.circles.length>0&&!Dn.collisionDetected,ht=ht&&Dn.offscreen,wt=Dn.occluded}if(Xe.iconFeatureIndex&&(rr=Xe.iconFeatureIndex),Xe.iconBox){const En=ur=>{Jn(ur);const Yn=Ie&&dn?Oo(dn.x,dn.y,Pe,Re,this.transform.angle):new o.Point(0,0),Vr=b.getSymbolInstanceIconSize(le,this.transform.zoom,qe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,Vr,ur,Yn,ve,W,P,he.predicate)};on&&on.box&&on.box.length&&Xe.verticalIconBox?(Qt=En(Xe.verticalIconBox),mt=Qt.box.length>0):(Qt=En(Xe.iconBox),mt=Qt.box.length>0),ht=ht&&Qt.offscreen,Jt=Qt.occluded}const jr=X||qe.numHorizontalGlyphVertices===0&&Ze===0,Co=se||qe.numIconVertices===0;if(jr||Co?Co?jr||(mt=mt&&rt):rt=mt&&rt:mt=rt=mt&&rt,rt&&Pn&&Pn.box&&this.collisionIndex.insertCollisionBox(Pn.box,M.get("text-ignore-placement"),b.bucketInstanceId,on&&on.box&&nr?nr:Un,he.ID),mt&&Qt&&this.collisionIndex.insertCollisionBox(Qt.box,M.get("icon-ignore-placement"),b.bucketInstanceId,rr,he.ID),Dn&&(rt&&this.collisionIndex.insertCollisionCircles(Dn.circles,M.get("text-ignore-placement"),b.bucketInstanceId,Un,he.ID),g)){const En=b.bucketInstanceId;let ur=this.collisionCircleArrays[En];ur===void 0&&(ur=this.collisionCircleArrays[En]=new wl);for(let Yn=0;Yn<Dn.circles.length;Yn+=4)ur.circles.push(Dn.circles[Yn+0]),ur.circles.push(Dn.circles[Yn+1]),ur.circles.push(Dn.circles[Yn+2]),ur.circles.push(Dn.collisionDetected?1:0)}const $o=b.projection.name!=="globe";Fe=Fe&&($o||!wt),He=He&&($o||!Jt),this.placements[yt]=new xl(rt||Fe,mt||He,ht||b.justReloaded),u.add(yt)};if(Ne){const qe=b.getSortedSymbolIndexes(this.transform.angle);for(let nt=qe.length-1;nt>=0;--nt){const Xe=qe[nt];vt(b.symbolInstances.get(Xe),Xe,b.collisionArrays[Xe])}}else for(let qe=r.symbolInstanceStart;qe<r.symbolInstanceEnd;qe++)vt(b.symbolInstances.get(qe),qe,b.collisionArrays[qe]);if(g&&b.bucketInstanceId in this.collisionCircleArrays){const qe=this.collisionCircleArrays[b.bucketInstanceId];o.invert(qe.invProjMatrix,P),qe.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(r,u,g,v){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:L,crossTileID:N}=g,F=o.getAnchorJustification(u),W=v===o.WritingMode.vertical?L:F==="left"?b:F==="center"?M:F==="right"?P:-1;b>=0&&(r.text.placedSymbolArray.get(b).crossTileID=W>=0&&b!==W?0:N),M>=0&&(r.text.placedSymbolArray.get(M).crossTileID=W>=0&&M!==W?0:N),P>=0&&(r.text.placedSymbolArray.get(P).crossTileID=W>=0&&P!==W?0:N),L>=0&&(r.text.placedSymbolArray.get(L).crossTileID=W>=0&&L!==W?0:N)}markUsedOrientation(r,u,g){const v=u===o.WritingMode.horizontal||u===o.WritingMode.horizontalOnly?u:0,b=u===o.WritingMode.vertical?u:0,{leftJustifiedTextSymbolIndex:M,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:N}=g,F=r.text.placedSymbolArray;M>=0&&(F.get(M).placedOrientation=v),P>=0&&(F.get(P).placedOrientation=v),L>=0&&(F.get(L).placedOrientation=v),N>=0&&(F.get(N).placedOrientation=b)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const v=u?u.symbolFadeChange(r):1,b=u?u.opacities:{},M=u?u.variableOffsets:{},P=u?u.placedOrientations:{};for(const L in this.placements){const N=this.placements[L],F=b[L];F?(this.opacities[L]=new vs(F,v,N.text,N.icon,null,N.clipped),g=g||N.text!==F.text.placed||N.icon!==F.icon.placed):(this.opacities[L]=new vs(null,v,N.text,N.icon,N.skipFade,N.clipped),g=g||N.text||N.icon)}for(const L in b){const N=b[L];if(!this.opacities[L]){const F=new vs(N,v,!1,!1);F.isHidden()||(this.opacities[L]=F,g=g||N.text.placed||N.icon.placed)}}for(const L in M)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=M[L]);for(const L in P)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=P[L]);g?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:r)}updateLayerOpacities(r,u){const g=new Set;for(const v of u){const b=v.getBucket(r);b&&v.latestFeatureIndex&&r.id===b.layerIds[0]&&this.updateBucketOpacities(b,g,v.collisionBoxArray)}}updateBucketOpacities(r,u,g){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const v=r.layers[0].layout,b=!!r.layers[0].dynamicFilter(),M=new vs(null,0,!1,!1,!0),P=v.get("text-allow-overlap"),L=v.get("icon-allow-overlap"),N=v.get("text-variable-anchor"),F=v.get("text-rotation-alignment")==="map",W=v.get("text-pitch-alignment")==="map",ie=v.get("icon-text-fit")!=="none",ae=new vs(null,0,P&&(L||!r.hasIconData()||v.get("icon-optional")),L&&(P||!r.hasTextData()||v.get("text-optional")),!0);!r.collisionArrays&&g&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(g);const ue=(he,X,se)=>{for(let ge=0;ge<X/4;ge++)he.opacityVertexArray.emplaceBack(se)};let le=0;for(let he=0;he<r.symbolInstances.length;he++){const X=r.symbolInstances.get(he),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:ge,crossTileID:ve,numIconVertices:Pe}=X,Re=u.has(ve);let Ie=this.opacities[ve];Re?Ie=M:Ie||(Ie=ae,this.opacities[ve]=Ie),u.add(ve);const Ne=se>0||ge>0,Fe=Pe>0,He=this.placedOrientations[ve],vt=He===o.WritingMode.vertical,qe=He===o.WritingMode.horizontal||He===o.WritingMode.horizontalOnly;if(!Ne&&!Fe||Ie.isHidden()||le++,Ne){const nt=ua(Ie.text);ue(r.text,se,vt?Or:nt),ue(r.text,ge,qe?Or:nt);const Xe=Ie.text.isHidden(),{leftJustifiedTextSymbolIndex:yt,centerJustifiedTextSymbolIndex:Ze,rightJustifiedTextSymbolIndex:rt,verticalPlacedTextSymbolIndex:mt}=X,ht=r.text.placedSymbolArray,wt=Xe||vt?1:0;yt>=0&&(ht.get(yt).hidden=wt),Ze>=0&&(ht.get(Ze).hidden=wt),rt>=0&&(ht.get(rt).hidden=wt),mt>=0&&(ht.get(mt).hidden=Xe||qe?1:0);const Jt=this.variableOffsets[ve];Jt&&this.markUsedJustification(r,Jt.anchor,X,He);const dn=this.placedOrientations[ve];dn&&(this.markUsedJustification(r,"left",X,dn),this.markUsedOrientation(r,dn,X))}if(Fe){const nt=ua(Ie.icon),{placedIconSymbolIndex:Xe,verticalPlacedIconSymbolIndex:yt}=X,Ze=r.icon.placedSymbolArray,rt=Ie.icon.isHidden()?1:0;Xe>=0&&(ue(r.icon,Pe,vt?Or:nt),Ze.get(Xe).hidden=rt),yt>=0&&(ue(r.icon,X.numVerticalIconVertices,qe?Or:nt),Ze.get(yt).hidden=rt)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const nt=r.collisionArrays[he];if(nt){let Xe=new o.Point(0,0),yt=!0;if(nt.textBox||nt.verticalTextBox){if(N){const rt=this.variableOffsets[ve];rt?(Xe=zo(rt.anchor,rt.width,rt.height,rt.textOffset,rt.textScale),F&&Xe._rotate(W?this.transform.angle:-this.transform.angle)):yt=!1}b&&(yt=!Ie.clipped),nt.textBox&&xs(r.textCollisionBox.collisionVertexArray,Ie.text.placed,!yt||vt,Xe.x,Xe.y),nt.verticalTextBox&&xs(r.textCollisionBox.collisionVertexArray,Ie.text.placed,!yt||qe,Xe.x,Xe.y)}const Ze=yt&&!!(!qe&&nt.verticalIconBox);nt.iconBox&&xs(r.iconCollisionBox.collisionVertexArray,Ie.icon.placed,Ze,ie?Xe.x:0,ie?Xe.y:0),nt.verticalIconBox&&xs(r.iconCollisionBox.collisionVertexArray,Ie.icon.placed,!Ze,ie?Xe.x:0,ie?Xe.y:0)}}}if(r.fullyClipped=le===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const he=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=he.invProjMatrix,r.placementViewportMatrix=he.viewportMatrix,r.collisionCircleArray=he.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>r}setStale(){this.stale=!0}}function xs(f,r,u,g,v){f.emplaceBack(r?1:0,u?1:0,g||0,v||0),f.emplaceBack(r?1:0,u?1:0,g||0,v||0),f.emplaceBack(r?1:0,u?1:0,g||0,v||0),f.emplaceBack(r?1:0,u?1:0,g||0,v||0)}const vi=Math.pow(2,25),dr=Math.pow(2,24),_h=Math.pow(2,17),_c=Math.pow(2,16),xi=Math.pow(2,9),Bo=Math.pow(2,8),vh=Math.pow(2,1);function ua(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,u=Math.floor(127*f.opacity);return u*vi+r*dr+u*_h+r*_c+u*xi+r*Bo+u*vh+r}const Or=0;class bu{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,u,g,v,b){const M=this._bucketParts;for(;this._currentTileIndex<r.length;)if(u.getBucketParts(M,v,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((P,L)=>P.sortKey-L.sortKey));this._currentPartIndex<M.length;){const P=M[this._currentPartIndex];if(u.placeLayerBucketPart(P,this._seenCrossTileIDs,g,P.symbolInstanceStart===0),this._currentPartIndex++,b())return!0}return!1}}class Ua{constructor(r,u,g,v,b,M,P,L){this.placement=new rs(r,b,M,P,L),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(r,u,g){const v=o.exported.now(),b=()=>{const M=o.exported.now()-v;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=u[r[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=P)&&(!M.maxzoom||M.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new bu(M)),this._inProgressLayer.continuePlacement(g[M.source],this.placement,this._showCollisionBoxes,M,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const is=512/o.EXTENT/2;class Wr{constructor(r,u,g){this.tileID=r,this.bucketInstanceId=g,this.index=new o.KDBush(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const v=r.canonical.x*o.EXTENT,b=r.canonical.y*o.EXTENT;for(let M=0;M<u.length;M++){const{key:P,crossTileID:L,tileAnchorX:N,tileAnchorY:F}=u.get(M),W=Math.floor((v+N)*is),ie=Math.floor((b+F)*is);this.index.add(W,ie),this.keys.push(P),this.crossTileIDs.push(L)}this.index.finish()}findMatches(r,u,g){const v=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),b=is/Math.pow(2,u.canonical.z-this.tileID.canonical.z),M=u.canonical.x*o.EXTENT,P=u.canonical.y*o.EXTENT;for(let L=0;L<r.length;L++){const N=r.get(L);if(N.crossTileID)continue;const{key:F,tileAnchorX:W,tileAnchorY:ie}=N,ae=Math.floor((M+W)*b),ue=Math.floor((P+ie)*b),le=this.index.range(ae-v,ue-v,ae+v,ue+v);for(const he of le){const X=this.crossTileIDs[he];if(this.keys[he]===F&&!g.has(X)){g.add(X),N.crossTileID=X;break}}}}}class bl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class xh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const u=Math.round((r-this.lng)/360);if(u!==0)for(const g in this.indexes){const v=this.indexes[g],b={};for(const M in v){const P=v[M];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+u),b[P.tileID.key]=P}this.indexes[g]=b}this.lng=r}addBucket(r,u,g){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const v=this.usedCrossTileIDs[r.overscaledZ];for(const b in this.indexes){const M=this.indexes[b];if(Number(b)>r.overscaledZ)for(const P in M){const L=M[P];L.tileID.isChildOf(r)&&L.findMatches(u.symbolInstances,r,v)}else{const P=M[r.scaledTo(Number(b)).key];P&&P.findMatches(u.symbolInstances,r,v)}}for(let b=0;b<u.symbolInstances.length;b++){const M=u.symbolInstances.get(b);M.crossTileID||(M.crossTileID=g.generate(),v.add(M.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Wr(r,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(r,u){for(const g of u.crossTileIDs)this.usedCrossTileIDs[r].delete(g)}removeStaleBuckets(r){let u=!1;for(const g in this.indexes){const v=this.indexes[g];for(const b in v)r[v[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,v[b]),delete v[b],u=!0)}return u}}class js{constructor(){this.layerIndexes={},this.crossTileIDs=new bl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,u,g,v){let b=this.layerIndexes[r.id];b===void 0&&(b=this.layerIndexes[r.id]=new xh);let M=!1;const P={};v.name!=="globe"&&b.handleWrapJump(g);for(const L of u){const N=L.getBucket(r);N&&r.id===N.layerIds[0]&&(N.bucketInstanceId||(N.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(L.tileID,N,this.crossTileIDs)&&(M=!0),P[N.bucketInstanceId]=!0)}return b.removeStaleBuckets(P)&&(M=!0),M}pruneUnusedLayers(r){const u={};r.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const ws=(f,r)=>o.emitValidationErrors(f,r&&r.filter(u=>u.identifier!=="source.canvas")),$a=o.pick(Qn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),wh=o.pick(Qn,["setCenter","setZoom","setBearing","setPitch"]),vc={version:8,layers:[],sources:{}},bo={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Fo extends o.Evented{constructor(r,u={}){super(),this.map=r,this.dispatcher=new te(ja(),this),this.imageManager=new Lt,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(r._requestManager,u.localFontFamily?o.LocalGlyphMode.all:u.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.crossTileSymbolIndex=new js,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const g=this;this._rtlTextPluginCallback=Fo.registerForPluginStateChange(v=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(b,M)=>{if(o.triggerPluginCompletionEvent(b),M&&M.every(P=>P))for(const P in g._sourceCaches){const L=g._sourceCaches[P],N=L.getSource().type;N!=="vector"&&N!=="geojson"||L.reload()}})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const b=this.getSource(v.sourceId);if(b&&b.vectorLayerIds)for(const M in this._layers){const P=this._layers[M];P.source===b.id&&this._validateLayer(P)}})}loadURL(r,u={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!o.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,u.accessToken);const v=this.map._requestManager.transformRequest(r,o.ResourceType.Style);this._request=o.getJSON(v,(b,M)=>{this._request=null,b?this.fire(new o.ErrorEvent(b)):M&&this._load(M,g)})}loadJSON(r,u={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(r,u.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(vc,!1)}_updateLayerCount(r,u){const g=u?1:-1;r.is3D()&&(this._num3DLayers+=g),r.type==="circle"&&(this._numCircleLayers+=g),r.type==="symbol"&&(this._numSymbolLayers+=g)}_load(r,u){if(u&&ws(this,o.validateStyle(r)))return;this._loaded=!0,this.stylesheet=o.clone$1(r),this._updateMapProjection();for(const v in r.sources)this.addSource(v,r.sources[v],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const g=mh(this.stylesheet.layers);this._order=g.map(v=>v.id),this._layers={},this._serializedLayers={};for(const v of g){const b=o.createStyleLayer(v);b.setEventedParent(this,{layer:{id:b.id}}),this._layers[b.id]=b,this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new zt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(r){this._spriteRequest=function(u,g,v){let b,M,P;const L=o.exported.devicePixelRatio>1?"@2x":"";let N=o.getJSON(g.transformRequest(g.normalizeSpriteURL(u,L,".json"),o.ResourceType.SpriteJSON),(ie,ae)=>{N=null,P||(P=ie,b=ae,W())}),F=o.getImage(g.transformRequest(g.normalizeSpriteURL(u,L,".png"),o.ResourceType.SpriteImage),(ie,ae)=>{F=null,P||(P=ie,M=ae,W())});function W(){if(P)v(P);else if(b&&M){const ie=o.exported.getImageData(M),ae={};for(const ue in b){const{width:le,height:he,x:X,y:se,sdf:ge,pixelRatio:ve,stretchX:Pe,stretchY:Re,content:Ie}=b[ue],Ne=new o.RGBAImage({width:le,height:he});o.RGBAImage.copy(ie,Ne,{x:X,y:se},{x:0,y:0},{width:le,height:he}),ae[ue]={data:Ne,pixelRatio:ve,sdf:ge,stretchX:Pe,stretchY:Re,content:Ie}}v(null,ae)}}return{cancel(){N&&(N.cancel(),N=null),F&&(F.cancel(),F=null)}}}(r,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new o.ErrorEvent(u));else if(g)for(const v in g)this.imageManager.addImage(v,g[v]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(r){const u=this.getSource(r.source);if(!u)return;const g=r.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const u=[];for(const g of r){const v=this._layers[g];v.type!=="custom"&&u.push(v.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&(typeof r.isLayerDraped=="function"?r.isLayerDraped():bo[r.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const u=this._changed;if(this._changed){const v=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(v.length||b.length)&&this._updateWorkerLayers(v,b);for(const M in this._updatedSources){const P=this._updatedSources[M];P==="reload"?this._reloadSource(M):P==="clear"&&this._clearSource(M)}this._updateTilesForChangedImages();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const g={};for(const v in this._sourceCaches){const b=this._sourceCaches[v];g[v]=b.used,b.used=!1}for(const v of this._order){const b=this._layers[v];if(b.recalculate(r,this._availableImages),!b.isHidden(r.zoom)){const P=this._getLayerSourceCache(b);P&&(P.used=!0)}const M=this.map.painter;if(M){const P=b.getProgramIds();if(!P)continue;const L=b.getProgramConfiguration(r.zoom);for(const N of P)M.useProgram(N,L)}}for(const v in g){const b=this._sourceCaches[v];g[v]!==b.used&&b.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),ws(this,o.validateStyle(r)))return!1;(r=o.clone$1(r)).layers=mh(r.layers);const u=function(v,b){if(!v)return[{command:Qn.setStyle,args:[b]}];let M=[];try{if(!I(v.version,b.version))return[{command:Qn.setStyle,args:[b]}];I(v.center,b.center)||M.push({command:Qn.setCenter,args:[b.center]}),I(v.zoom,b.zoom)||M.push({command:Qn.setZoom,args:[b.zoom]}),I(v.bearing,b.bearing)||M.push({command:Qn.setBearing,args:[b.bearing]}),I(v.pitch,b.pitch)||M.push({command:Qn.setPitch,args:[b.pitch]}),I(v.sprite,b.sprite)||M.push({command:Qn.setSprite,args:[b.sprite]}),I(v.glyphs,b.glyphs)||M.push({command:Qn.setGlyphs,args:[b.glyphs]}),I(v.transition,b.transition)||M.push({command:Qn.setTransition,args:[b.transition]}),I(v.light,b.light)||M.push({command:Qn.setLight,args:[b.light]}),I(v.fog,b.fog)||M.push({command:Qn.setFog,args:[b.fog]}),I(v.projection,b.projection)||M.push({command:Qn.setProjection,args:[b.projection]});const P={},L=[];(function(W,ie,ae,ue){let le;for(le in ie=ie||{},W=W||{})W.hasOwnProperty(le)&&(ie.hasOwnProperty(le)||vu(le,ae,ue));for(le in ie){if(!ie.hasOwnProperty(le))continue;const he=ie[le];W.hasOwnProperty(le)?I(W[le],he)||(W[le].type==="geojson"&&he.type==="geojson"&&gc(W,ie,le)?ae.push({command:Qn.setGeoJSONSourceData,args:[le,he.data]}):Nr(le,ie,ae,ue)):gh(le,ie,ae)}})(v.sources,b.sources,L,P);const N=[];v.layers&&v.layers.forEach(W=>{W.source&&P[W.source]?M.push({command:Qn.removeLayer,args:[W.id]}):N.push(W)});let F=v.terrain;F&&P[F.source]&&(M.push({command:Qn.setTerrain,args:[void 0]}),F=void 0),M=M.concat(L),I(F,b.terrain)||M.push({command:Qn.setTerrain,args:[b.terrain]}),function(W,ie,ae){ie=ie||[];const ue=(W=W||[]).map(_s),le=ie.map(_s),he=W.reduce(yl,{}),X=ie.reduce(yl,{}),se=ue.slice(),ge=Object.create(null);let ve,Pe,Re,Ie,Ne,Fe,He;for(ve=0,Pe=0;ve<ue.length;ve++)Re=ue[ve],X.hasOwnProperty(Re)?Pe++:(ae.push({command:Qn.removeLayer,args:[Re]}),se.splice(se.indexOf(Re,Pe),1));for(ve=0,Pe=0;ve<le.length;ve++)Re=le[le.length-1-ve],se[se.length-1-ve]!==Re&&(he.hasOwnProperty(Re)?(ae.push({command:Qn.removeLayer,args:[Re]}),se.splice(se.lastIndexOf(Re,se.length-Pe),1)):Pe++,Fe=se[se.length-ve],ae.push({command:Qn.addLayer,args:[X[Re],Fe]}),se.splice(se.length-ve,0,Re),ge[Re]=!0);for(ve=0;ve<le.length;ve++)if(Re=le[ve],Ie=he[Re],Ne=X[Re],!ge[Re]&&!I(Ie,Ne))if(I(Ie.source,Ne.source)&&I(Ie["source-layer"],Ne["source-layer"])&&I(Ie.type,Ne.type)){for(He in Lo(Ie.layout,Ne.layout,ae,Re,null,Qn.setLayoutProperty),Lo(Ie.paint,Ne.paint,ae,Re,null,Qn.setPaintProperty),I(Ie.filter,Ne.filter)||ae.push({command:Qn.setFilter,args:[Re,Ne.filter]}),I(Ie.minzoom,Ne.minzoom)&&I(Ie.maxzoom,Ne.maxzoom)||ae.push({command:Qn.setLayerZoomRange,args:[Re,Ne.minzoom,Ne.maxzoom]}),Ie)Ie.hasOwnProperty(He)&&He!=="layout"&&He!=="paint"&&He!=="filter"&&He!=="metadata"&&He!=="minzoom"&&He!=="maxzoom"&&(He.indexOf("paint.")===0?Lo(Ie[He],Ne[He],ae,Re,He.slice(6),Qn.setPaintProperty):I(Ie[He],Ne[He])||ae.push({command:Qn.setLayerProperty,args:[Re,He,Ne[He]]}));for(He in Ne)Ne.hasOwnProperty(He)&&!Ie.hasOwnProperty(He)&&He!=="layout"&&He!=="paint"&&He!=="filter"&&He!=="metadata"&&He!=="minzoom"&&He!=="maxzoom"&&(He.indexOf("paint.")===0?Lo(Ie[He],Ne[He],ae,Re,He.slice(6),Qn.setPaintProperty):I(Ie[He],Ne[He])||ae.push({command:Qn.setLayerProperty,args:[Re,He,Ne[He]]}))}else ae.push({command:Qn.removeLayer,args:[Re]}),Fe=se[se.lastIndexOf(Re)+1],ae.push({command:Qn.addLayer,args:[Ne,Fe]})}(N,b.layers,M)}catch(P){console.warn("Unable to compute style diff:",P),M=[{command:Qn.setStyle,args:[b]}]}return M}(this.serialize(),r).filter(v=>!(v.command in wh));if(u.length===0)return!1;const g=u.filter(v=>!(v.command in $a));if(g.length>0)throw new Error(`Unimplemented: ${g.map(v=>v.command).join(", ")}.`);return u.forEach(v=>{v.command!=="setTransition"&&v.command!=="setProjection"&&this[v.command].apply(this,v.args)}),this.stylesheet=r,this._updateMapProjection(),!0}addImage(r,u){return this.getImage(r)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,u),this._afterImageUpdated(r),this)}updateImage(r,u){this.imageManager.updateImage(r,u)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r),this._afterImageUpdated(r),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,u,g={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(o.validateSource,`sources.${r}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const v=Sn(r,u,this.dispatcher,this);v.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(r),source:v.serialize(),sourceId:r}));const b=M=>{const P=(M?"symbol:":"other:")+r,L=this._sourceCaches[P]=new o.SourceCache(P,v,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[r]=L,L.style=this,L.onAdd(this.map)};b(!1),u.type!=="vector"&&u.type!=="geojson"||b(!0),v.onAdd&&v.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const u=this.getSource(r);if(!u)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===r)return this.fire(new o.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new o.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const g=this._getSourceCaches(r);for(const v of g)delete this._sourceCaches[v.id],delete this._updatedSources[v.id],v.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles();return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(r,u){this._checkLoaded(),this.getSource(r).setData(u),this._changed=!0}getSource(r){const u=this._getSourceCache(r);return u&&u.getSource()}_getSources(){const r=[];for(const u in this._otherSourceCaches){const g=this._getSourceCache(u);g&&r.push(g.getSource())}return r}addLayer(r,u,g={}){this._checkLoaded();const v=r.id;if(this.getLayer(v))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${v}" already exists on this map`)));let b;if(r.type==="custom"){if(ws(this,o.validateCustomStyleLayer(r)))return;b=o.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(v,r.source),r=o.clone$1(r),r=o.extend(r,{source:v})),this._validate(o.validateLayer,`layers.${v}`,r,{arrayIndex:-1},g))return;b=o.createStyleLayer(r),this._validateLayer(b),b.setEventedParent(this,{layer:{id:v}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const M=u?this._order.indexOf(u):this._order.length;if(u&&M===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(M,0,v),this._layerOrderChanged=!0,this._layers[v]=b;const P=this._getLayerSourceCache(b);if(this._removedLayers[v]&&b.source&&P&&b.type!=="custom"){const L=this._removedLayers[v];delete this._removedLayers[v],L.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",P.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,u){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===u)return;const g=this._order.indexOf(r);this._order.splice(g,1);const v=u?this._order.indexOf(u):this._order.length;u&&v===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(v,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const u=this._layers[r];if(!u)return void this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const g=this._order.indexOf(r);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=u,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const u in this._layers)if(this._layers[u].type===r)return!0;return!1}setLayerZoomRange(r,u,g){this._checkLoaded();const v=this.getLayer(r);v?v.minzoom===u&&v.maxzoom===g||(u!=null&&(v.minzoom=u),g!=null&&(v.maxzoom=g),this._updateLayer(v)):this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,u,g={}){this._checkLoaded();const v=this.getLayer(r);if(v){if(!I(v.filter,u))return u==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(o.validateFilter,`layers.${v.id}.filter`,u,{layerType:v.type},g)||(v.filter=o.clone$1(u),this._updateLayer(v)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){const u=this.getLayer(r);return u&&o.clone$1(u.filter)}setLayoutProperty(r,u,g,v={}){this._checkLoaded();const b=this.getLayer(r);b?I(b.getLayoutProperty(u),g)||(b.setLayoutProperty(u,g,v),this._updateLayer(b)):this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,u){const g=this.getLayer(r);if(g)return g.getLayoutProperty(u);this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,u,g,v={}){this._checkLoaded();const b=this.getLayer(r);b?I(b.getPaintProperty(u),g)||(b.setPaintProperty(u,g,v)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,u){const g=this.getLayer(r);return g&&g.getPaintProperty(u)}setFeatureState(r,u){this._checkLoaded();const g=r.source,v=r.sourceLayer,b=this.getSource(g);if(!b)return void this.fire(new o.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const M=b.type;if(M==="geojson"&&v)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(M==="vector"&&!v)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const P=this._getSourceCaches(g);for(const L of P)L.setFeatureState(v,r.id,u)}removeFeatureState(r,u){this._checkLoaded();const g=r.source,v=this.getSource(g);if(!v)return void this.fire(new o.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const b=v.type,M=b==="vector"?r.sourceLayer:void 0;if(b==="vector"&&!M)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const P=this._getSourceCaches(g);for(const L of P)L.removeFeatureState(M,r.id,u)}getFeatureState(r){this._checkLoaded();const u=r.source,g=r.sourceLayer,v=this.getSource(u);if(v){if(v.type!=="vector"||g)return r.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(g,r.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();r[g.id]||(r[g.id]=g.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},u=>u!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const u=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&u&&u.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",u.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const u=M=>this._layers[M].type==="fill-extrusion",g={},v=[];for(let M=this._order.length-1;M>=0;M--){const P=this._order[M];if(u(P)){g[P]=M;for(const L of r){const N=L[P];if(N)for(const F of N)v.push(F)}}}v.sort((M,P)=>P.intersectionZ-M.intersectionZ);const b=[];for(let M=this._order.length-1;M>=0;M--){const P=this._order[M];if(u(P))for(let L=v.length-1;L>=0;L--){const N=v[L].feature;if(g[N.layer.id]<M)break;b.push(N),v.pop()}else for(const L of r){const N=L[P];if(N)for(const F of N)b.push(F.feature)}}return b}queryRenderedFeatures(r,u,g){u&&u.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",u.filter,null,u);const v={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const L of u.layers){const N=this._layers[L];if(!N)return this.fire(new o.ErrorEvent(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];v[N.source]=!0}}const b=[];u.availableImages=this._availableImages;const M=u&&u.layers?u.layers.some(L=>{const N=this.getLayer(L);return N&&N.is3D()}):this.has3DLayers(),P=Pt.createFromScreenPoints(r,g);for(const L in this._sourceCaches){const N=this._sourceCaches[L].getSource().id;u.layers&&!v[N]||b.push(Ir(this._sourceCaches[L],this._layers,this._serializedLayers,P,u,g,M,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(L,N,F,W,ie,ae,ue){const le={},he=ae.queryRenderedSymbols(W),X=[];for(const se of Object.keys(he).map(Number))X.push(ue[se]);X.sort(Fi);for(const se of X){const ge=se.featureIndex.lookupSymbolFeatures(he[se.bucketInstanceId],N,se.bucketIndex,se.sourceLayerIndex,ie.filter,ie.layers,ie.availableImages,L);for(const ve in ge){const Pe=le[ve]=le[ve]||[],Re=ge[ve];Re.sort((Ie,Ne)=>{const Fe=se.featureSortOrder;if(Fe){const He=Fe.indexOf(Ie.featureIndex);return Fe.indexOf(Ne.featureIndex)-He}return Ne.featureIndex-Ie.featureIndex});for(const Ie of Re)Pe.push(Ie)}}for(const se in le)le[se].forEach(ge=>{const ve=ge.feature,Pe=F(L[se]);if(!Pe)return;const Re=Pe.getFeatureState(ve.layer["source-layer"],ve.id);ve.source=ve.layer.source,ve.layer["source-layer"]&&(ve.sourceLayer=ve.layer["source-layer"]),ve.state=Re});return le}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),P.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(r,u){u&&u.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",u.filter,null,u);const g=this._getSourceCaches(r);let v=[];for(const b of g)v=v.concat(Jr(b,u));return v}addSourceType(r,u,g){return Fo.getSourceType(r)?g(new Error(`A source type called "${r}" already exists.`)):(Fo.setSourceType(r,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:u.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(r,u={}){this._checkLoaded();const g=this.light.getLight();let v=!1;for(const M in r)if(!I(r[M],g[M])){v=!0;break}if(!v)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(r,u),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,u=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let g=r;if(u===1){if(typeof g.source=="object"){const v="terrain-dem-src";this.addSource(v,g.source),g=o.clone$1(g),g=o.extend(g,{source:v})}if(this._validate(o.validateTerrain,"terrain",g))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,u)}else{const v=this.terrain,b=v.get();for(const M of Object.keys(o.spec.terrain))!g.hasOwnProperty(M)&&o.spec.terrain[M].default&&(g[M]=o.spec.terrain[M].default);for(const M in g)if(!I(g[M],b[M])){v.set(g),this.stylesheet.terrain=g;const P=this._setTransitionParameters({duration:0});v.updateTransitions(P);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const u=this.fog=new Le(r,this.map.transform);this.stylesheet.fog=r;const g=this._setTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,g=u.get();Object.keys(r).length===0&&u.set(r);for(const v in r)if(!I(r[v],g[v])){u.set(r),this.stylesheet.fog=r;const b=this._setTransitionParameters({duration:0});u.updateTransitions(b);break}}else this._createFog(r);this._markersNeedUpdate=!0}_setTransitionParameters(r){return{now:o.exported.now(),transition:o.extend(r,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(g=>this.isLayerDraped(this._layers[g])),u=this._order.filter(g=>!this.isLayerDraped(this._layers[g]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...u)}_createTerrain(r,u){const g=this.terrain=new ln(r,u);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const v=this._setTransitionParameters({duration:0});g.updateTransitions(v)}_force3DLayerUpdate(){for(const r in this._layers){const u=this._layers[r];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const u=this._layers[r];u.type==="symbol"&&this._updateLayer(u)}}_validate(r,u,g,v,b={}){return(!b||b.validate!==!1)&&ws(this,r.call(o.validateStyle,o.extend({key:u,style:this.serialize(),value:g,styleSpec:o.spec},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const u=this._getSourceCaches(r);for(const g of u)g.clearTiles()}_reloadSource(r){const u=this._getSourceCaches(r);for(const g of u)g.resume(),g.reload()}_reloadSources(){for(const r of this._getSources())r.reload&&r.reload()}_updateSources(r){for(const u in this._sourceCaches)this._sourceCaches[u].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const u=this._sourceCaches[r];u.resume(),u.reload()}}_updatePlacement(r,u,g,v,b=!1){let M=!1,P=!1;const L={};for(const N of this._order){const F=this._layers[N];if(F.type!=="symbol")continue;if(!L[F.source]){const ie=this._getLayerSourceCache(F);if(!ie)continue;L[F.source]=ie.getRenderableIds(!0).map(ae=>ie.getTileByID(ae)).sort((ae,ue)=>ue.tileID.overscaledZ-ae.tileID.overscaledZ||(ae.tileID.isLessThan(ue.tileID)?-1:1))}const W=this.crossTileSymbolIndex.addLayer(F,L[F.source],r.center.lng,r.projection);M=M||W}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||g===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),r.zoom))&&(this.pauseablePlacement=new Ua(r,this._order,b,u,g,v,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),P=!0),M&&this.pauseablePlacement.placement.setStale()),P||M)for(const N of this._order){const F=this._layers[N];F.type==="symbol"&&this.placement.updateLayerOpacities(F,L[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,u,g){this.imageManager.getImages(u.icons,g),this._updateTilesForChangedImages();const v=b=>{b&&b.setDependencies(u.tileID.key,u.type,u.icons)};v(this._otherSourceCaches[u.source]),v(this._symbolSourceCaches[u.source])}getGlyphs(r,u,g){this.glyphManager.getGlyphs(u.stacks,g)}getResource(r,u,g){return o.makeRequest(u,g)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const u=[];return this._otherSourceCaches[r]&&u.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&u.push(this._symbolSourceCaches[r]),u}_isSourceCacheLoaded(r){const u=this._getSourceCaches(r);return u.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${r}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Fo.getSourceType=function(f){return wn[f]},Fo.setSourceType=function(f,r){wn[f]=r},Fo.registerForPluginStateChange=o.registerForPluginStateChange;var Tl=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,ca="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",No=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,ha=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,bs=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Ni={},os={};const Ga=[];Ts(Tl,Ga),Ts(No,Ga),Ts(ha,Ga),Ts(bs,Ga),Ni=Xn("",No),os=Xn(bs,ha);const El=Xn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),xc=Tl,Tu=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Eu={background:Xn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Xn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Xn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Xn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Xn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Xn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Xn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Xn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Xn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Xn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Xn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Xn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Xn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Xn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Xn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Xn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Xn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Xn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Xn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Xn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Xn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Xn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Xn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Xn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Xn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Xn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ca),skyboxGradient:Xn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ca),skyboxCapture:Xn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Xn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Xn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Ts(f,r){const u=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const v=g.split(" ");for(const b of v)r.includes(b)||r.push(b)}}function Xn(f,r){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),v={},b=[...Ga];return Ts(f,b),Ts(r,b),{fragmentSource:f=f.replace(u,(M,P,L,N,F)=>(v[F]=!0,P==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${L} ${N} ${F};
#else
uniform ${L} ${N} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${L} ${N} ${F} = u_${F};
#endif
`)),vertexSource:r=r.replace(u,(M,P,L,N,F)=>{const W=N==="float"?"vec2":"vec4",ie=F.match(/color/)?"color":W;return v[F]?P==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${L} ${W} a_${F};
varying ${L} ${N} ${F};
#else
uniform ${L} ${N} u_${F};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${L} ${N} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${ie}(a_${F}, u_${F}_t);
#else
    ${L} ${N} ${F} = u_${F};
#endif
`:P==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${L} ${W} a_${F};
#else
uniform ${L} ${N} u_${F};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${L} ${N} ${F} = a_${F};
#else
    ${L} ${N} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${L} ${N} ${F} = unpack_mix_${ie}(a_${F}, u_${F}_t);
#else
    ${L} ${N} ${F} = u_${F};
#endif
`}),staticAttributes:g,usedDefines:b}}class Ld{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,u,g,v,b,M,P){this.context=r;let L=this.boundPaintVertexBuffers.length!==v.length;for(let F=0;!L&&F<v.length;F++)this.boundPaintVertexBuffers[F]!==v[F]&&(L=!0);let N=this.boundDynamicVertexBuffers.length!==P.length;for(let F=0;!N&&F<P.length;F++)this.boundDynamicVertexBuffers[F]!==P[F]&&(N=!0);if(!r.extVertexArrayObject||!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||L||N||this.boundIndexBuffer!==b||this.boundVertexOffset!==M)this.freshBind(u,g,v,b,M,P);else{r.bindVertexArrayOES.set(this.vao);for(const F of P)F&&F.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(r,u,g,v,b,M){let P;const L=r.numAttributes,N=this.context,F=N.gl;if(N.extVertexArrayObject)this.vao&&this.destroy(),this.vao=N.extVertexArrayObject.createVertexArrayOES(),N.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=r,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=v,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=M;else{P=N.currentNumAttributes||0;for(let W=L;W<P;W++)F.disableVertexAttribArray(W)}u.enableAttributes(F,r),u.bind(),u.setVertexAttribPointers(F,r,b);for(const W of g)W.enableAttributes(F,r),W.bind(),W.setVertexAttribPointers(F,r,b);for(const W of M)W&&(W.enableAttributes(F,r),W.bind(),W.setVertexAttribPointers(F,r,b));v&&v.bind(),N.currentNumAttributes=L}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function bh(f,r){const u=Math.pow(2,r.canonical.z),g=r.canonical.y;return[new o.MercatorCoordinate(0,g/u).toLngLat().lat,new o.MercatorCoordinate(0,(g+1)/u).toLngLat().lat]}function Dd(f,r,u,g,v,b,M){const P=f.context,L=P.gl,N=u.fbo;if(!N)return;f.prepareDrawTile();const F=f.useProgram("hillshade");P.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,N.colorAttachment.get());const W=((le,he,X,se)=>{const ge=X.paint.get("hillshade-shadow-color"),ve=X.paint.get("hillshade-highlight-color"),Pe=X.paint.get("hillshade-accent-color");let Re=X.paint.get("hillshade-illumination-direction")*(Math.PI/180);X.paint.get("hillshade-illumination-anchor")==="viewport"&&(Re-=le.transform.angle);const Ie=!le.options.moving;return{u_matrix:se||le.transform.calculateProjMatrix(he.tileID.toUnwrapped(),Ie),u_image:0,u_latrange:bh(0,he.tileID),u_light:[X.paint.get("hillshade-exaggeration"),Re],u_shadow:ge,u_highlight:ve,u_accent:Pe}})(f,u,g,f.terrain?r.projMatrix:null);f.prepareDrawProgram(P,F,r.toUnwrapped());const{tileBoundsBuffer:ie,tileBoundsIndexBuffer:ae,tileBoundsSegments:ue}=f.getTileBoundsBuffers(u);F.draw(P,L.TRIANGLES,v,b,M,o.CullFaceMode.disabled,W,g.id,ie,ae,ue)}function Th(f,r,u){if(!r.needsDEMTextureUpload)return;const g=f.context,v=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(u.stride);const b=u.getPixels();r.demTexture?r.demTexture.update(b,{premultiply:!1}):r.demTexture=new o.Texture(g,b,v.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function wc(f,r,u,g,v,b){const M=f.context,P=M.gl;if(!r.dem)return;const L=r.dem;if(M.activeTexture.set(P.TEXTURE1),Th(f,r,L),!r.demTexture)return;r.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE);const N=L.dim;M.activeTexture.set(P.TEXTURE0);let F=r.fbo;if(!F){const ue=new o.Texture(M,{width:N,height:N,data:null},P.RGBA);ue.bind(P.LINEAR,P.CLAMP_TO_EDGE),F=r.fbo=M.createFramebuffer(N,N,!0),F.colorAttachment.set(ue.texture)}M.bindFramebuffer.set(F.framebuffer),M.viewport.set([0,0,N,N]);const{tileBoundsBuffer:W,tileBoundsIndexBuffer:ie,tileBoundsSegments:ae}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(M,P.TRIANGLES,g,v,b,o.CullFaceMode.disabled,((ue,le)=>{const he=le.stride,X=o.create();return o.ortho(X,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(X,X,[0,-o.EXTENT,0]),{u_matrix:X,u_image:1,u_dimension:[he,he],u_zoom:ue.overscaledZ,u_unpack:le.unpackVector}})(r.tileID,L),u.id,W,ie,ae),r.needsHillshadePrepare=!1}const Eh=f=>({u_matrix:new o.UniformMatrix4f(f),u_image0:new o.Uniform1i(f),u_skirt_height:new o.Uniform1f(f)}),Sl=(f,r)=>({u_matrix:f,u_image0:0,u_skirt_height:r}),bc=(f,r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:v,u_merc_center:b,u_image0:0,u_frustum_tl:M,u_frustum_tr:P,u_frustum_br:L,u_frustum_bl:N,u_globe_pos:F,u_globe_radius:W,u_viewport:ie,u_grid_matrix:ue?Float32Array.from(ue):new Float32Array(9),u_skirt_height:ae});function Cl(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const Vs=new class{constructor(){this.operations={}}newMorphing(f,r,u,g,v){if(f in this.operations){const b=this.operations[f];b.to.tileID.key!==u.tileID.key&&(b.queued=u)}else this.operations[f]={startTime:g,phase:0,duration:v,from:r,to:u,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const u=this.operations[r];for(u.phase=(f-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},da={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Tc(f){return 6*Math.pow(1.5,22-f)}function zd(f,r){const u=1<<f.z;return!r&&(f.x===0||f.x===u-1)||f.y===0||f.y===u-1}const Su=f=>({u_matrix:f});function Sh(f,r,u,g,v){if(v>0){const b=o.exported.now(),M=(b-f.timeAdded)/v,P=r?(b-r.timeAdded)/v:-1,L=u.getSource(),N=g.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),F=!r||Math.abs(r.tileID.overscaledZ-N)>Math.abs(f.tileID.overscaledZ-N),W=F&&f.refreshedUponExpiration?1:o.clamp(F?M:1-P,0,1);return f.refreshedUponExpiration&&M>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-W}:{opacity:W,mix:0}}return{opacity:1,mix:0}}class Cu extends o.SourceCache{constructor(r){const u={type:"raster-dem",maxzoom:r.transform.maxZoom},g=new te(ja(),null),v=Sn("mock-dem",u,g,r.style);super("mock-dem",v,!1),v.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,u){r.state="loaded",u(null)}}class Ec extends o.SourceCache{constructor(r){const u=Sn("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new te(ja(),null),r.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,u,g){if(r.freezeTileCoverage)return;this.transform=r;const v=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,M)=>{if(b[M.key]="",!this._tiles[M.key]){const P=new o.Tile(M,this._source.tileSize*M.overscaleFactor(),r.tileZoom);P.state="loaded",this._tiles[M.key]=P}return b},{});for(const b in this._tiles)b in v||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(r){const u=this.proxyCachedFBO[r];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Sc extends o.OverscaledTileID{constructor(r,u,g){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class Ch extends o.Elevation{constructor(r,u){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,v,b]=function(L){const N=new o.StructArrayLayout2i4,F=new o.StructArrayLayout3ui6,W=131;N.reserve(17161),F.reserve(33800);const ie=o.EXTENT/128,ae=o.EXTENT+ie/2,ue=ae+ie;for(let he=-ie;he<ue;he+=ie)for(let X=-ie;X<ue;X+=ie){const se=X<0||X>ae||he<0||he>ae?24575:0,ge=o.clamp(Math.round(X),0,o.EXTENT),ve=o.clamp(Math.round(he),0,o.EXTENT);N.emplaceBack(ge+se,ve)}const le=(he,X)=>{const se=X*W+he;F.emplaceBack(se+1,se,se+W),F.emplaceBack(se+W,se+W+1,se+1)};for(let he=1;he<129;he++)for(let X=1;X<129;X++)le(X,he);return[0,129].forEach(he=>{for(let X=0;X<130;X++)le(X,he),le(he,X)}),[N,F,32768]}(),M=r.context;this.gridBuffer=M.createVertexBuffer(g,o.posAttributes.members),this.gridIndexBuffer=M.createIndexBuffer(v),this.gridSegments=o.SegmentVector.simpleSegment(0,0,g.length,v.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,g.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ec(u.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.EXTENT,0,o.EXTENT,0,1);const P=M.gl;this._overlapStencilMode=new o.StencilMode({func:P.GEQUAL,mask:255},0,255,P.KEEP,P.KEEP,P.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Cu(u.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,u,g){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const v=r.terrain.properties;this.sourceCache=r.terrain.drapeRenderMode===0?this._mockSourceCache:r._getSourceCache(v.get("source")),this._exaggeration=v.get("exaggeration");const b=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const M=this.getScaledDemTileSize();this.sourceCache.update(u,M,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),u.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=u.getIds().map(L=>{const N=u.getTileByID(L).tileID;return N.projMatrix=g.calculateProjMatrix(N.toUnwrapped()),N});(function(L,N){const F=N.transform.pointCoordinate(N.transform.getCameraPoint()),W=new o.Point(F.x,F.y);L.sort((ie,ae)=>{if(ae.overscaledZ-ie.overscaledZ)return ae.overscaledZ-ie.overscaledZ;const ue=new o.Point(ie.canonical.x+(1<<ie.canonical.z)*ie.wrap,ie.canonical.y),le=new o.Point(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),he=W.mult(1<<ie.canonical.z);return he.x-=.5,he.y-=.5,he.distSqr(ue)-he.distSqr(le)})})(v,this.painter),this._previousZoom=g.zoom;const b=this.proxyToSource||{};this.proxyToSource={},v.forEach(L=>{this.proxyToSource[L.key]={}}),this.terrainTileForTile={};const M=this._style._sourceCaches;for(const L in M){const N=M[L];if(!N.used||(N!==this.sourceCache&&this.resetTileLookupCache(N.id),this._setupProxiedCoordsForOrtho(N,r[L],b),N.usedForTerrain))continue;const F=r[L];N.getSource().reparseOverscaled&&this._assignTerrainTiles(F)}this.proxiedCoords[u.id]=v.map(L=>new Sc(L,L.key,this.orthoMatrix)),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const P={};this._visibleDemTiles=[];for(const L of this.proxyCoords){const N=this.terrainTileForTile[L.key];if(!N)continue;const F=N.tileID.key;F in P||(this._visibleDemTiles.push(N),P[F]=F)}}_assignTerrainTiles(r){this._initializing||r.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const r=this.painter.context,u=r.gl;for(const g in this.terrainTileForTile){const v=this.terrainTileForTile[g],b=v.dem;!b||v.demTexture&&!v.needsDEMTextureUpload||(r.activeTexture.set(u.TEXTURE1),Th(this.painter,v,b))}}_prepareDemTileUniforms(r,u,g,v){if(!u||u.demTexture==null)return!1;const b=r.tileID.canonical,M=Math.pow(2,u.tileID.canonical.z-b.z),P=v||"";return g[`u_dem_tl${P}`]=[b.x*M%1,b.y*M%1],g[`u_dem_scale${P}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,u=r.gl;if(!this._emptyDepthBufferTexture){const g=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(r,g,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const u=this._visibleDemTiles.reduce((g,v)=>{if(!v.dem)return g;const b=v.dem.tree.minimums[0];return b>0&&r++,g+b},0);return r?u/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,u=r.gl;r.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),v=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(g,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(v,{premultiply:!1}):b=this._emptyDEMTexture=new o.Texture(r,v,u.RGBA,{premultiply:!1}),b}setupElevationDraw(r,u,g){const v=this.painter.context,b=v.gl,M=(P=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(P),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var P;M.u_dem_size=this.sourceCache.getSource().tileSize,M.u_exaggeration=this.exaggeration();let L=null,N=null,F=1;if(g&&g.morphing&&this._useVertexMorphing){const W=g.morphing.srcDemTile,ie=g.morphing.dstDemTile;F=g.morphing.phase,W&&ie&&(this._prepareDemTileUniforms(r,W,M,"_prev")&&(N=W),this._prepareDemTileUniforms(r,ie,M)&&(L=ie))}if(N&&L?(v.activeTexture.set(b.TEXTURE2),L.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),v.activeTexture.set(b.TEXTURE4),N.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),M.u_dem_lerp=F):(L=this.terrainTileForTile[r.tileID.key],v.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(r,L,M)?L.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),v.activeTexture.set(b.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(M.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),M.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&L){const W=(1<<L.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=W}if(g&&g.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(v,M),this.painter.transform.projection.name==="globe"){const W=this.globeUniformValues(this.painter.transform,r.tileID.canonical,g&&g.useDenormalizedUpVectorScale);u.setGlobeUniformValues(v,W)}}globeUniformValues(r,u,g){const v=r.projection;return{u_tile_tl_up:v.upVector(u,0,0),u_tile_tr_up:v.upVector(u,o.EXTENT,0),u_tile_br_up:v.upVector(u,o.EXTENT,o.EXTENT),u_tile_bl_up:v.upVector(u,0,o.EXTENT),u_tile_up_scale:g?o.globeMetersToEcef(1):v.upVectorScale(u,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const u=this.painter,g=this.painter.context;r.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(v,b,M,P,L){if(v.transform.projection.name==="globe")(function(N,F,W,ie,ae){const ue=N.context,le=ue.gl;let he,X;const se=N.options.showTerrainWireframe?2:0,ge=N.transform,ve=o.globeUseCustomAntiAliasing(N,ue,ge),Pe=(yt,Ze)=>{if(X===yt)return;const rt=[da[yt],"PROJECTION_GLOBE_VIEW"];ve&&rt.push("CUSTOM_ANTIALIASING"),Ze&&rt.push(da[se]),he=N.useProgram("globeRaster",null,rt),X=yt},Re=N.colorModeForRenderPass(),Ie=new o.DepthMode(le.LEQUAL,o.DepthMode.ReadWrite,N.depthRangeFor3D);Vs.update(ae);const Ne=o.calculateGlobeMercatorMatrix(ge),Fe=[o.mercatorXfromLng(ge.center.lng),o.mercatorYfromLat(ge.center.lat)],He=se?[!1,!0]:[!1],vt=N.globeSharedBuffers,qe=[ge.width*o.exported.devicePixelRatio,ge.height*o.exported.devicePixelRatio],nt=Float32Array.from(ge.globeMatrix),Xe={useDenormalizedUpVectorScale:!0};if(He.forEach(yt=>{const Ze=N.transform,rt=Tc(Ze.zoom)*F.exaggeration();X=-1;const mt=yt?le.LINES:le.TRIANGLES;for(const ht of ie){const wt=W.getTile(ht),Jt=o.StencilMode.disabled,dn=F.prevTerrainTileForTile[ht.key],Zt=F.terrainTileForTile[ht.key];Cl(dn,Zt)&&Vs.newMorphing(ht.key,dn,Zt,ae,250),ue.activeTexture.set(le.TEXTURE0),wt.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);const on=Vs.getMorphValuesForProxy(ht.key),Pn=on?1:0;on&&o.extend$1(Xe,{morphing:{srcDemTile:on.from,dstDemTile:on.to,phase:o.easeCubicInOut(on.phase)}});const Dn=o.tileCornersToBounds(ht.canonical),Qt=o.getLatitudinalLod(Dn.getCenter().lat),Un=o.getGridMatrix(ht.canonical,Dn,Qt,Ze.worldSize/Ze._pixelsPerMercatorPixel),nr=o.globeNormalizeECEF(o.globeTileBounds(ht.canonical)),rr=bc(Ze.projMatrix,nt,Ne,nr,o.globeToMercatorTransition(Ze.zoom),Fe,Ze.frustumCorners.TL,Ze.frustumCorners.TR,Ze.frustumCorners.BR,Ze.frustumCorners.BL,Ze.globeCenterInViewSpace,Ze.globeRadius,qe,rt,Un);if(Pe(Pn,yt),F.setupElevationDraw(wt,he,Xe),N.prepareDrawProgram(ue,he,ht.toUnwrapped()),vt){const[Jn,bi,jr]=yt?vt.getWirefameBuffers(N.context,Qt):vt.getGridBuffers(Qt,rt!==0);he.draw(ue,mt,Ie,Jt,Re,o.CullFaceMode.backCCW,rr,"globe_raster",Jn,bi,jr)}}}),vt){const yt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ve&&yt.push("CUSTOM_ANTIALIASING"),he=N.useProgram("globeRaster",null,yt);for(const Ze of ie){const{x:rt,y:mt,z:ht}=Ze.canonical,wt=mt===0,Jt=mt===(1<<ht)-1,[dn,Zt,on,Pn]=vt.getPoleBuffers(ht);if(Pn&&(wt||Jt)){const Dn=W.getTile(Ze);ue.activeTexture.set(le.TEXTURE0),Dn.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);let Qt=o.globePoleMatrixForTile(ht,rt,ge);const Un=o.globeNormalizeECEF(o.globeTileBounds(Ze.canonical)),nr=(rr,Jn)=>rr.draw(ue,le.TRIANGLES,Ie,o.StencilMode.disabled,Re,o.CullFaceMode.disabled,bc(ge.projMatrix,Qt,Qt,Un,0,Fe,ge.frustumCorners.TL,ge.frustumCorners.TR,ge.frustumCorners.BR,ge.frustumCorners.BL,ge.globeCenterInViewSpace,ge.globeRadius,qe,0),"globe_pole_raster",Jn,on,Pn);F.setupElevationDraw(Dn,he,Xe),N.prepareDrawProgram(ue,he,Ze.toUnwrapped()),wt&&nr(he,dn),Jt&&(Qt=o.scale(o.create(),Qt,[1,-1,1]),nr(he,Zt))}}}})(v,b,M,P,L);else{const N=v.context,F=N.gl;let W,ie;const ae=v.options.showTerrainWireframe?2:0,ue=(ge,ve)=>{if(ie===ge)return;const Pe=[da[ge]];ve&&Pe.push(da[ae]),W=v.useProgram("terrainRaster",null,Pe),ie=ge},le=v.colorModeForRenderPass(),he=new o.DepthMode(F.LEQUAL,o.DepthMode.ReadWrite,v.depthRangeFor3D);Vs.update(L);const X=v.transform,se=Tc(X.zoom)*b.exaggeration();(ae?[!1,!0]:[!1]).forEach(ge=>{ie=-1;const ve=ge?F.LINES:F.TRIANGLES,[Pe,Re]=ge?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const Ie of P){const Ne=M.getTile(Ie),Fe=o.StencilMode.disabled,He=b.prevTerrainTileForTile[Ie.key],vt=b.terrainTileForTile[Ie.key];Cl(He,vt)&&Vs.newMorphing(Ie.key,He,vt,L,250),N.activeTexture.set(F.TEXTURE0),Ne.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST);const qe=Vs.getMorphValuesForProxy(Ie.key),nt=qe?1:0;let Xe;qe&&(Xe={morphing:{srcDemTile:qe.from,dstDemTile:qe.to,phase:o.easeCubicInOut(qe.phase)}});const yt=Sl(Ie.projMatrix,zd(Ie.canonical,X.renderWorldCopies)?se/10:se);ue(nt,ge),b.setupElevationDraw(Ne,W,Xe),v.prepareDrawProgram(N,W,Ie.toUnwrapped()),W.draw(N,ve,he,Fe,le,o.CullFaceMode.backCCW,yt,"terrain_raster",b.gridBuffer,Pe,Re)}})}}(u,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,v=this.proxySourceCache,b=this.proxiedCoords[v.id],M=this._drapedRenderBatches.shift(),P=[],L=u.style.order;let N=0;for(const F of b){const W=v.getTileByID(F.proxyTileKey),ie=v.proxyCachedFBO[F.key]?v.proxyCachedFBO[F.key][r]:void 0,ae=ie!==void 0?v.renderCache[ie]:this.pool[N++],ue=ie!==void 0;if(W.texture=ae.tex,ue&&!ae.dirty){P.push(W.tileID);continue}let le;g.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(g.clear({color:o.Color.transparent,stencil:0}),ae.dirty=!1);for(let he=M.start;he<=M.end;++he){const X=u.style._layers[L[he]];if(X.isHidden(u.transform.zoom))continue;const se=u.style._getLayerSourceCache(X),ge=se?this.proxyToSource[F.key][se.id]:[F];if(!ge)continue;const ve=ge;g.viewport.set([0,0,ae.fb.width,ae.fb.height]),le!==(se?se.id:null)&&(this._setupStencil(ae,ge,X,se),le=se?se.id:null),u.renderLayer(u,se,X,ve)}this.renderedToTile?(ae.dirty=!0,P.push(W.tileID)):ue||--N,N===5&&(N=0,this.renderToBackBuffer(P))}return this.renderToBackBuffer(P),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),M.end+1}postRender(){}renderCacheEfficiency(r){const u=r.order.length;if(u===0)return{efficiency:100};let g,v=0,b=0,M=!1;for(let P=0;P<u;++P){const L=r._layers[r.order[P]];this._style.isLayerDraped(L)?(M&&++v,++b):M||(M=!0,g=L.id)}return b===0?{efficiency:100}:{efficiency:100*(1-v/b),firstUndrapedLayer:g}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{r=Math.min(r,u.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,u,g){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const M=b.tileID,P=1<<M.overscaledZ,{x:L,y:N}=M.canonical,F=L/P,W=(L+1)/P,ie=N/P,ae=(N+1)/P;return{minx:F,miny:ie,maxx:W,maxy:ae,t:b.dem.tree.raycastRoot(F,ie,W,ae,r,u,g),tile:b}});v.sort((b,M)=>(b.t!==null?b.t:Number.MAX_VALUE)-(M.t!==null?M.t:Number.MAX_VALUE));for(const b of v){if(b.t==null)return null;const M=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,r,u,g);if(M!=null)return M}return null}_createFBO(){const r=this.painter.context,u=r.gl,g=this.drapeBufferSize;r.activeTexture.set(u.TEXTURE0);const v=new o.Texture(r,{width:g[0],height:g[1],data:null},u.RGBA);v.bind(u.LINEAR,u.CLAMP_TO_EDGE);const b=r.createFramebuffer(g[0],g[1],!1);return b.colorAttachment.set(v.texture),b.depthAttachment=new ze(r,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:b,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const u=this._style._layers[r],g=u.isHidden(this.painter.transform.zoom);return u.type==="custom"?!g&&u.shouldRedrape():!g&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const g of this._style._getSources())if(g instanceof Dt){r=!0;break}if(!r)return;const u={};for(let g=0;g<this._style.order.length;++g){const v=this._style._layers[this._style.order[g]],b=this._style._getLayerSourceCache(v);if(b&&!u[b.id]&&!v.isHidden(this.painter.transform.zoom)&&v.type==="line"&&v.widthExpression()instanceof o.ZoomDependentExpression){u[b.id]=!0;for(const M of this.proxyCoords){const P=this.proxyToSource[M.key][b.id];if(P)for(const L of P)this._clearRenderCacheForTile(b.id,L)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const g in this._style._sourceCaches)if(this._style._sourceCaches[g]._source instanceof xt){r=!0;break}if(!r)return;const u={};for(let g=0;g<this._style.order.length;++g){const v=this._style._layers[this._style.order[g]],b=this._style._getLayerSourceCache(v);if(!b||u[b.id]||v.isHidden(this.painter.transform.zoom)||v.type!=="raster")continue;const M=v.paint.get("raster-fade-duration");for(const P of this.proxyCoords){const L=this.proxyToSource[P.key][b.id];if(L)for(const N of L){const F=Sh(b.getTile(N),b.findLoadedParent(N,0),b,this.painter.transform,M);(F.opacity!==1||F.mix!==0)&&this._clearRenderCacheForTile(b.id,N)}}}}_setupDrapedRenderBatches(){const r=this._style.order,u=r.length;if(u===0)return;const g=[];let v,b=0,M=this._style._layers[r[b]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++b<u;)M=this._style._layers[r[b]];for(;b<u;++b){const P=this._style._layers[r[b]];P.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(P)?v===void 0&&(v=b):v!==void 0&&(g.push({start:v,end:b-1}),v=void 0))}v!==void 0&&g.push({start:v,end:b-1}),this._drapedRenderBatches=g}_setupRenderCache(r){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const M=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let P=0;P<M.length;++P){const L=Object.values(M[P]);u.renderCachePool.push(...L)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,v=this._tilesDirty;for(let M=g.length-1;M>=0;M--){const P=g[M];if(u.getTileByID(P.key),u.proxyCachedFBO[P.key]!==void 0){const L=r[P.key],N=this.proxyToSource[P.key];let F=0;for(const W in N){const ie=N[W],ae=L[W];if(!ae||ae.length!==ie.length||ie.some((ue,le)=>ue!==ae[le]||v[W]&&v[W].hasOwnProperty(ue.key))){F=-1;break}++F}for(const W in u.proxyCachedFBO[P.key])u.renderCache[u.proxyCachedFBO[P.key][W]].dirty=F<0||F!==Object.values(L).length}}const b=[...this._drapedRenderBatches];b.sort((M,P)=>P.end-P.start-(M.end-M.start));for(const M of b)for(const P of g){if(u.proxyCachedFBO[P.key])continue;let L=u.renderCachePool.pop();L===void 0&&u.renderCache.length<50&&(L=u.renderCache.length,u.renderCache.push(this._createFBO())),L!==void 0&&(u.proxyCachedFBO[P.key]={},u.proxyCachedFBO[P.key][M.start]=L,u.renderCache[L].dirty=!0)}this._tilesDirty={}}_setupStencil(r,u,g,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,M=b.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let P;if(g.isTileClipped())P=u.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);P=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+P>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=P,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(r,u){const g=this.painter,v=this.painter.context,b=v.gl;g._tileClippingMaskIDs={},v.setColorMode(o.ColorMode.disabled),v.setDepthMode(o.DepthMode.disabled);const M=g.useProgram("clippingMask");for(const P of r){const L=g._tileClippingMaskIDs[P.key]=--u;M.draw(v,b.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:b.ALWAYS,mask:0},L,255,b.KEEP,b.KEEP,b.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Su(P.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(r){const u=this.painter.transform;if(r.x<0||r.x>u.width||r.y<0||r.y>u.height)return null;const g=[r.x,r.y,1,1];o.transformMat4$1(g,g,u.pixelMatrixInverse),o.scale$1(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const v=u._camera.position,b=o.mercatorZfromAltitude(1,u.center.lat),M=[v[0],v[1],v[2]/b,0],P=o.subtract([],g.slice(0,3),M);o.normalize(P,P);const L=this.raycast(M,P,this._exaggeration);return L!==null&&L?(o.scaleAndAdd(M,M,P,L),M[3]=M[2],M[2]*=b,M):null}drawDepth(){const r=this.painter,u=r.context,g=this.proxySourceCache,v=Math.ceil(r.width),b=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===v&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const M=u.gl,P=u.createFramebuffer(v,b,!0);u.activeTexture.set(M.TEXTURE0);const L=new o.Texture(u,{width:v,height:b,data:null},M.RGBA);L.bind(M.NEAREST,M.CLAMP_TO_EDGE),P.colorAttachment.set(L.texture);const N=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,v,b);P.depthAttachment.set(N),this._depthFBO=P,this._depthTexture=L}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,v,b]),function(M,P,L,N){if(M.transform.projection.name==="globe")return;const F=M.context,W=F.gl;F.clear({depth:1});const ie=M.useProgram("terrainDepth"),ae=new o.DepthMode(W.LESS,o.DepthMode.ReadWrite,M.depthRangeFor3D);for(const ue of N){const le=L.getTile(ue),he=Sl(ue.projMatrix,0);P.setupElevationDraw(le,ie),ie.draw(F,W.TRIANGLES,ae,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,he,"terrain_depth",P.gridBuffer,P.gridIndexBuffer,P.gridNoSkirtSegments)}}(r,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,u,g){if(r.getSource()instanceof Tn)return this._setupProxiedCoordsForImageSource(r,u,g);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const v=this.proxiedCoords[r.id]=[],b=this.proxyCoords;for(let P=0;P<b.length;P++){const L=b[P],N=this._findTileCoveringTileID(L,r);if(N){const F=this._createProxiedId(L,N,g[L.key]&&g[L.key][r.id]);v.push(F),this.proxyToSource[L.key][r.id]=[F]}}let M=!1;for(let P=0;P<u.length;P++){const L=r.getTile(u[P]);if(!L||!L.hasData())continue;const N=this._findTileCoveringTileID(L.tileID,this.proxySourceCache);if(N&&N.tileID.canonical.z!==L.tileID.canonical.z){const F=this.proxyToSource[N.tileID.key][r.id],W=this._createProxiedId(N.tileID,L,g[N.tileID.key]&&g[N.tileID.key][r.id]);F?F.splice(F.length-1,0,W):this.proxyToSource[N.tileID.key][r.id]=[W],v.push(W),M=!0}}this._sourceTilesOverlap[r.id]=M}_setupProxiedCoordsForImageSource(r,u,g){if(!r.getSource().loaded())return;const v=this.proxiedCoords[r.id]=[],b=this.proxyCoords,M=r.getSource(),P=new o.Point(M.tileID.x,M.tileID.y)._div(1<<M.tileID.z),L=M.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((F,W)=>(F.min.x=Math.min(F.min.x,W.x-P.x),F.min.y=Math.min(F.min.y,W.y-P.y),F.max.x=Math.max(F.max.x,W.x-P.x),F.max.y=Math.max(F.max.y,W.y-P.y),F),{min:new o.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),N=(F,W)=>{const ie=F.wrap+F.canonical.x/(1<<F.canonical.z),ae=F.canonical.y/(1<<F.canonical.z),ue=o.EXTENT/(1<<F.canonical.z),le=W.wrap+W.canonical.x/(1<<W.canonical.z),he=W.canonical.y/(1<<W.canonical.z);return ie+ue<le+L.min.x||ie>le+L.max.x||ae+ue<he+L.min.y||ae>he+L.max.y};for(let F=0;F<b.length;F++){const W=b[F];for(let ie=0;ie<u.length;ie++){const ae=r.getTile(u[ie]);if(!ae||!ae.hasData()||N(W,ae.tileID))continue;const ue=this._createProxiedId(W,ae,g[W.key]&&g[W.key][r.id]),le=this.proxyToSource[W.key][r.id];le?le.push(ue):this.proxyToSource[W.key][r.id]=[ue],v.push(ue)}}}_createProxiedId(r,u,g){let v=this.orthoMatrix;if(g){const b=g.find(M=>M.key===u.tileID.key);if(b)return b}if(u.tileID.key!==r.key){const b=r.canonical.z-u.tileID.canonical.z;let M,P,L;v=o.create();const N=u.tileID.wrap-r.wrap<<r.overscaledZ;b>0?(M=o.EXTENT>>b,P=M*((u.tileID.canonical.x<<b)-r.canonical.x+N),L=M*((u.tileID.canonical.y<<b)-r.canonical.y)):(M=o.EXTENT<<-b,P=o.EXTENT*(u.tileID.canonical.x-(r.canonical.x+N<<-b)),L=o.EXTENT*(u.tileID.canonical.y-(r.canonical.y<<-b))),o.ortho(v,0,M,0,M,0,1),o.translate(v,v,[P,L,0])}return new Sc(u.tileID,r.key,v)}_findTileCoveringTileID(r,u){let g=u.getTile(r);if(g&&g.hasData())return g;const v=this._findCoveringTileCache[u.id],b=v[r.key];if(g=b?u.getTileByID(b):null,g&&g.hasData()||b===null)return g;let M=g?g.tileID:r,P=M.overscaledZ;const L=u.getSource().minzoom,N=[];if(!b){const W=u.getSource().maxzoom;if(r.canonical.z>=W){const ie=r.canonical.z-W;u.getSource().reparseOverscaled?(P=Math.max(r.canonical.z+2,u.transform.tileZoom),M=new o.OverscaledTileID(P,r.wrap,W,r.canonical.x>>ie,r.canonical.y>>ie)):ie!==0&&(P=W,M=new o.OverscaledTileID(P,r.wrap,W,r.canonical.x>>ie,r.canonical.y>>ie))}M.key!==r.key&&(N.push(M.key),g=u.getTile(M))}const F=W=>{N.forEach(ie=>{v[ie]=W}),N.length=0};for(P-=1;P>=L&&(!g||!g.hasData());P--){g&&F(g.tileID.key);const W=M.calculateScaledKey(P);if(g=u.getTileByID(W),g&&g.hasData())break;const ie=v[W];if(ie===null)break;ie===void 0?N.push(W):g=u.getTileByID(ie)}return F(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,u){let g=this._tilesDirty[r];g||(g=this._tilesDirty[r]={}),g[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(u){let g=0;const v=new o.StructArrayLayout2ui4,b=131;for(let M=1;M<129;M++){for(let P=1;P<129;P++)g=M*b+P,v.emplaceBack(g,g+1),v.emplaceBack(g,g+b),v.emplaceBack(g+1,g+b),M===128&&v.emplaceBack(g+b,g+b+1);v.emplaceBack(g+1,g+1+b)}return v}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Zn{static cacheKey(r,u,g,v){let b=`${u}${v?v.cacheKey:""}`;for(const M of g)r.usedDefines.includes(M)&&(b+=`/${M}`);return b}constructor(r,u,g,v,b,M){const P=r.gl;this.program=P.createProgram();const L=function(X){const se=[];for(let ge=0;ge<X.length;ge++){if(X[ge]===null)continue;const ve=X[ge].split(" ");se.push(ve.pop())}return se}(g.staticAttributes),N=v?v.getBinderAttributes():[],F=L.concat(N);let W=v?v.defines():[];W=W.concat(M.map(X=>`#define ${X}`));const ie=r.isWebGL2?`#version 300 es
`:"",ae=ie+W.concat(r.extStandardDerivatives&&ie.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Tu):Tu,Tu,xc,El.fragmentSource,os.fragmentSource,g.fragmentSource).join(`
`),ue=ie+W.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,xc,El.vertexSource,os.vertexSource,Ni.vertexSource,g.vertexSource).join(`
`),le=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);P.shaderSource(le,ae),P.compileShader(le),P.attachShader(this.program,le);const he=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())this.failedToCreate=!0;else{P.shaderSource(he,ue),P.compileShader(he),P.attachShader(this.program,he),this.attributes={},this.numAttributes=F.length;for(let X=0;X<this.numAttributes;X++)F[X]&&(P.bindAttribLocation(this.program,X,F[X]),this.attributes[F[X]]=X);P.linkProgram(this.program),P.deleteShader(he),P.deleteShader(le),this.fixedUniforms=b(r),this.binderUniforms=v?v.getUniforms(r):[],M.includes("TERRAIN")&&(this.terrainUniforms=(X=>({u_dem:new o.Uniform1i(X),u_dem_prev:new o.Uniform1i(X),u_dem_unpack:new o.Uniform4f(X),u_dem_tl:new o.Uniform2f(X),u_dem_scale:new o.Uniform1f(X),u_dem_tl_prev:new o.Uniform2f(X),u_dem_scale_prev:new o.Uniform1f(X),u_dem_size:new o.Uniform1f(X),u_dem_lerp:new o.Uniform1f(X),u_exaggeration:new o.Uniform1f(X),u_depth:new o.Uniform1i(X),u_depth_size_inv:new o.Uniform2f(X),u_meter_to_dem:new o.Uniform1f(X),u_label_plane_matrix_inv:new o.UniformMatrix4f(X)}))(r)),M.includes("GLOBE")&&(this.globeUniforms=(X=>({u_tile_tl_up:new o.Uniform3f(X),u_tile_tr_up:new o.Uniform3f(X),u_tile_br_up:new o.Uniform3f(X),u_tile_bl_up:new o.Uniform3f(X),u_tile_up_scale:new o.Uniform1f(X)}))(r)),M.includes("FOG")&&(this.fogUniforms=(X=>({u_fog_matrix:new o.UniformMatrix4f(X),u_fog_range:new o.Uniform2f(X),u_fog_color:new o.Uniform4f(X),u_fog_horizon_blend:new o.Uniform1f(X),u_fog_temporal_offset:new o.Uniform1f(X),u_frustum_tl:new o.Uniform3f(X),u_frustum_tr:new o.Uniform3f(X),u_frustum_br:new o.Uniform3f(X),u_frustum_bl:new o.Uniform3f(X),u_globe_pos:new o.Uniform3f(X),u_globe_radius:new o.Uniform1f(X),u_globe_transition:new o.Uniform1f(X),u_is_globe:new o.Uniform1i(X),u_viewport:new o.Uniform2f(X)}))(r))}}setTerrainUniformValues(r,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const v in u)g[v]&&g[v].set(this.program,v,u[v])}}setGlobeUniformValues(r,u){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const v in u)g[v]&&g[v].set(this.program,v,u[v])}}setFogUniformValues(r,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const v in u)g[v].set(this.program,v,u[v])}}draw(r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue,le){const he=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(g),r.setStencilMode(v),r.setColorMode(b),r.setCullFace(M);for(const se of Object.keys(this.fixedUniforms))this.fixedUniforms[se].set(this.program,se,P[se]);ue&&ue.setUniforms(this.program,r,this.binderUniforms,ie,{zoom:ae});const X={[he.LINES]:2,[he.TRIANGLES]:3,[he.LINE_STRIP]:1}[u];for(const se of W.get()){const ge=se.vaos||(se.vaos={});(ge[L]||(ge[L]=new Ld)).bind(r,this,N,ue?ue.getPaintVertexBuffers():[],F,se.vertexOffset,le||[]),he.drawElements(u,se.primitiveLength*X,he.UNSIGNED_SHORT,se.primitiveOffset*X*2)}}}function Au(f,r){const u=Math.pow(2,r.tileID.overscaledZ),g=r.tileSize*Math.pow(2,f.transform.tileZoom)/u,v=g*(r.tileID.canonical.x+r.tileID.wrap*u),b=g*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_tile_units_to_pixels:1/Ue(r,1,f.transform.tileZoom),u_pixel_coord_upper:[v>>16,b>>16],u_pixel_coord_lower:[65535&v,65535&b]}}const Od=o.create(),Ah=(f,r,u,g,v,b,M,P,L,N,F)=>{const W=r.style.light,ie=W.properties.get("position"),ae=[ie.x,ie.y,ie.z],ue=o.create$1();W.properties.get("anchor")==="viewport"&&(o.fromRotation(ue,-r.transform.angle),o.transformMat3(ae,ae,ue));const le=W.properties.get("color"),he=r.transform,X={u_matrix:f,u_lightpos:ae,u_lightintensity:W.properties.get("intensity"),u_lightcolor:[le.r,le.g,le.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Od,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:v,u_edge_radius:b};return he.projection.name==="globe"&&(X.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],X.u_zoom_transition=L,X.u_inv_rot_matrix=F,X.u_merc_center=N,X.u_up_dir=he.projection.upVector(new o.CanonicalTileID(0,0,0),N[0]*o.EXTENT,N[1]*o.EXTENT),X.u_height_lift=P),X},Bd=(f,r,u,g,v,b,M,P,L,N,F,W)=>{const ie=Ah(f,r,u,g,v,b,M,L,N,F,W),ae={u_height_factor:-Math.pow(2,M.overscaledZ)/P.tileSize/8};return o.extend(ie,Au(r,P),ae)},qa=f=>({u_matrix:f}),Mh=(f,r,u)=>o.extend(qa(f),Au(r,u)),op=(f,r)=>({u_matrix:f,u_world:r}),kh=(f,r,u,g)=>o.extend(Mh(f,r,u),{u_world:g}),Mu=o.create(),Ph=(f,r,u,g,v,b)=>{const M=f.transform,P=M.projection.name==="globe";let L;if(b.paint.get("circle-pitch-alignment")==="map")if(P){const F=o.globePixelsToTileUnits(M.zoom,r.canonical)*M._pixelsPerMercatorPixel;L=Float32Array.from([F,0,0,F])}else L=M.calculatePixelsToTileUnitsMatrix(u);else L=new Float32Array([M.pixelsToGLUnits[0],0,0,M.pixelsToGLUnits[1]]);const N={u_camera_to_center_distance:M.cameraToCenterDistance,u_matrix:f.translatePosMatrix(r.projMatrix,u,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:L,u_inv_rot_matrix:Mu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){N.u_inv_rot_matrix=g,N.u_merc_center=v,N.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],N.u_zoom_transition=o.globeToMercatorTransition(M.zoom);const F=v[0]*o.EXTENT,W=v[1]*o.EXTENT;N.u_up_dir=M.projection.upVector(new o.CanonicalTileID(0,0,0),F,W)}return N},Cc=f=>{const r=[];return f.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),f.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},Ac=(f,r,u,g)=>{const v=o.EXTENT/u.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(g),u_extrude_scale:[r.pixelsToGLUnits[0]/v,r.pixelsToGLUnits[1]/v]}},ku=(f,r,u=1)=>({u_matrix:f,u_color:r,u_overlay:0,u_overlay_scale:u}),Ih=o.create(),Rh=(f,r,u,g,v,b,M)=>{const P=f.transform,L=P.projection.name==="globe",N=L?o.globePixelsToTileUnits(P.zoom,r.canonical)*P._pixelsPerMercatorPixel:Ue(u,1,b),F={u_matrix:r.projMatrix,u_extrude_scale:N,u_intensity:M,u_inv_rot_matrix:Ih,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){F.u_inv_rot_matrix=g,F.u_merc_center=v,F.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],F.u_zoom_transition=o.globeToMercatorTransition(P.zoom);const W=v[0]*o.EXTENT,ie=v[1]*o.EXTENT;F.u_up_dir=P.projection.upVector(new o.CanonicalTileID(0,0,0),W,ie)}return F},Al=(f,r,u,g,v,b,M)=>{const P=f.transform,L=P.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:Lh(f,r,u,g),u_pixels_to_tile_units:L,u_device_pixel_ratio:b,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:kl(u)?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Ml(r,f.transform),u_alpha_discard_threshold:0,u_trim_offset:M}},Pu=(f,r,u,g,v)=>{const b=f.transform;return{u_matrix:Lh(f,r,u,g),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:v,u_image:0,u_tile_units_to_pixels:Ml(r,b),u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ml(f,r){return 1/Ue(f,1,r.tileZoom)}function Lh(f,r,u,g){return f.translatePosMatrix(g||r.tileID.projMatrix,r,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function kl(f){const r=f.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const Mc=(f,r,u,g,v,b)=>{return{u_matrix:f,u_tl_parent:r,u_scale_parent:u,u_fade_t:g.mix,u_opacity:g.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(P=v.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(M=v.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:ao(v.paint.get("raster-hue-rotate")),u_perspective_transform:b};var M,P};function ao(f){f*=Math.PI/180;const r=Math.sin(f),u=Math.cos(f);return[(2*u+1)/3,(-Math.sqrt(3)*r-u+1)/3,(Math.sqrt(3)*r-u+1)/3]}const fa=o.create(),Dh=(f,r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue,le)=>{const he=v.transform,X={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:he.cameraToCenterDistance,u_rotate_symbol:+u,u_aspect_ratio:he.width/he.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:M,u_coord_matrix:P,u_is_text:+L,u_pitch_with_map:+g,u_texsize:N,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:fa,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:fa,u_up_vector:[0,-1,0]};return le.name==="globe"&&(X.u_tile_id=[F.canonical.x,F.canonical.y,1<<F.canonical.z],X.u_zoom_transition=W,X.u_inv_rot_matrix=ae,X.u_merc_center=ie,X.u_camera_forward=he._camera.forward(),X.u_ecef_origin=o.globeECEFOrigin(he.globeMatrix,F.toUnwrapped()),X.u_tile_matrix=Float32Array.from(he.globeMatrix),X.u_up_vector=ue),X},Wa=(f,r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue,le,he)=>o.extend(Dh(f,r,u,g,v,b,M,P,L,N,W,ie,ae,ue,le,he),{u_gamma_scale:g?v.transform.cameraToCenterDistance*Math.cos(v.terrain?0:v.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:1}),Fd=(f,r,u,g,v,b,M,P,L,N,F,W,ie,ae,ue,le)=>o.extend(Wa(f,r,u,g,v,b,M,P,!0,L,!0,F,W,ie,ae,ue,le),{u_texsize_icon:N,u_texture_icon:1}),kc=(f,r,u)=>({u_matrix:f,u_opacity:r,u_color:u}),zh=(f,r,u,g,v)=>o.extend(function(b,M,P){const L=M.imageManager.getPattern(b.toString()),{width:N,height:F}=M.imageManager.getPixelSize(),W=Math.pow(2,P.tileID.overscaledZ),ie=P.tileSize*Math.pow(2,M.transform.tileZoom)/W,ae=ie*(P.tileID.canonical.x+P.tileID.wrap*W),ue=ie*P.tileID.canonical.y;return{u_image:0,u_pattern_tl:L.tl,u_pattern_br:L.br,u_texsize:[N,F],u_pattern_size:L.displaySize,u_tile_units_to_pixels:1/Ue(P,1,M.transform.tileZoom),u_pixel_coord_upper:[ae>>16,ue>>16],u_pixel_coord_lower:[65535&ae,65535&ue]}}(g,u,v),{u_matrix:f,u_opacity:r}),Iu={fillExtrusion:f=>({u_matrix:new o.UniformMatrix4f(f),u_lightpos:new o.Uniform3f(f),u_lightintensity:new o.Uniform1f(f),u_lightcolor:new o.Uniform3f(f),u_vertical_gradient:new o.Uniform1f(f),u_opacity:new o.Uniform1f(f),u_edge_radius:new o.Uniform1f(f),u_ao:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_up_dir:new o.Uniform3f(f),u_height_lift:new o.Uniform1f(f)}),fillExtrusionPattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_lightpos:new o.Uniform3f(f),u_lightintensity:new o.Uniform1f(f),u_lightcolor:new o.Uniform3f(f),u_vertical_gradient:new o.Uniform1f(f),u_height_factor:new o.Uniform1f(f),u_edge_radius:new o.Uniform1f(f),u_ao:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_up_dir:new o.Uniform3f(f),u_height_lift:new o.Uniform1f(f),u_image:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_pixel_coord_upper:new o.Uniform2f(f),u_pixel_coord_lower:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f),u_opacity:new o.Uniform1f(f)}),fill:f=>({u_matrix:new o.UniformMatrix4f(f)}),fillPattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_image:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_pixel_coord_upper:new o.Uniform2f(f),u_pixel_coord_lower:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f)}),fillOutline:f=>({u_matrix:new o.UniformMatrix4f(f),u_world:new o.Uniform2f(f)}),fillOutlinePattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_world:new o.Uniform2f(f),u_image:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_pixel_coord_upper:new o.Uniform2f(f),u_pixel_coord_lower:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f)}),circle:f=>({u_camera_to_center_distance:new o.Uniform1f(f),u_extrude_scale:new o.UniformMatrix2f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_up_dir:new o.Uniform3f(f)}),collisionBox:f=>({u_matrix:new o.UniformMatrix4f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_extrude_scale:new o.Uniform2f(f)}),collisionCircle:f=>({u_matrix:new o.UniformMatrix4f(f),u_inv_matrix:new o.UniformMatrix4f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_viewport_size:new o.Uniform2f(f)}),debug:f=>({u_color:new o.UniformColor(f),u_matrix:new o.UniformMatrix4f(f),u_overlay:new o.Uniform1i(f),u_overlay_scale:new o.Uniform1f(f)}),clippingMask:f=>({u_matrix:new o.UniformMatrix4f(f)}),heatmap:f=>({u_extrude_scale:new o.Uniform1f(f),u_intensity:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_up_dir:new o.Uniform3f(f)}),heatmapTexture:f=>({u_image:new o.Uniform1i(f),u_color_ramp:new o.Uniform1i(f),u_opacity:new o.Uniform1f(f)}),hillshade:f=>({u_matrix:new o.UniformMatrix4f(f),u_image:new o.Uniform1i(f),u_latrange:new o.Uniform2f(f),u_light:new o.Uniform2f(f),u_shadow:new o.UniformColor(f),u_highlight:new o.UniformColor(f),u_accent:new o.UniformColor(f)}),hillshadePrepare:f=>({u_matrix:new o.UniformMatrix4f(f),u_image:new o.Uniform1i(f),u_dimension:new o.Uniform2f(f),u_zoom:new o.Uniform1f(f),u_unpack:new o.Uniform4f(f)}),line:f=>({u_matrix:new o.UniformMatrix4f(f),u_pixels_to_tile_units:new o.UniformMatrix2f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_units_to_pixels:new o.Uniform2f(f),u_dash_image:new o.Uniform1i(f),u_gradient_image:new o.Uniform1i(f),u_image_height:new o.Uniform1f(f),u_texsize:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f),u_alpha_discard_threshold:new o.Uniform1f(f),u_trim_offset:new o.Uniform2f(f)}),linePattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_texsize:new o.Uniform2f(f),u_pixels_to_tile_units:new o.UniformMatrix2f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_image:new o.Uniform1i(f),u_units_to_pixels:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f),u_alpha_discard_threshold:new o.Uniform1f(f)}),raster:f=>({u_matrix:new o.UniformMatrix4f(f),u_tl_parent:new o.Uniform2f(f),u_scale_parent:new o.Uniform1f(f),u_fade_t:new o.Uniform1f(f),u_opacity:new o.Uniform1f(f),u_image0:new o.Uniform1i(f),u_image1:new o.Uniform1i(f),u_brightness_low:new o.Uniform1f(f),u_brightness_high:new o.Uniform1f(f),u_saturation_factor:new o.Uniform1f(f),u_contrast_factor:new o.Uniform1f(f),u_spin_weights:new o.Uniform3f(f),u_perspective_transform:new o.Uniform2f(f)}),symbolIcon:f=>({u_is_size_zoom_constant:new o.Uniform1i(f),u_is_size_feature_constant:new o.Uniform1i(f),u_size_t:new o.Uniform1f(f),u_size:new o.Uniform1f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_rotate_symbol:new o.Uniform1i(f),u_aspect_ratio:new o.Uniform1f(f),u_fade_change:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_label_plane_matrix:new o.UniformMatrix4f(f),u_coord_matrix:new o.UniformMatrix4f(f),u_is_text:new o.Uniform1i(f),u_pitch_with_map:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_camera_forward:new o.Uniform3f(f),u_tile_matrix:new o.UniformMatrix4f(f),u_up_vector:new o.Uniform3f(f),u_ecef_origin:new o.Uniform3f(f),u_texture:new o.Uniform1i(f)}),symbolSDF:f=>({u_is_size_zoom_constant:new o.Uniform1i(f),u_is_size_feature_constant:new o.Uniform1i(f),u_size_t:new o.Uniform1f(f),u_size:new o.Uniform1f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_rotate_symbol:new o.Uniform1i(f),u_aspect_ratio:new o.Uniform1f(f),u_fade_change:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_label_plane_matrix:new o.UniformMatrix4f(f),u_coord_matrix:new o.UniformMatrix4f(f),u_is_text:new o.Uniform1i(f),u_pitch_with_map:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_texture:new o.Uniform1i(f),u_gamma_scale:new o.Uniform1f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_camera_forward:new o.Uniform3f(f),u_tile_matrix:new o.UniformMatrix4f(f),u_up_vector:new o.Uniform3f(f),u_ecef_origin:new o.Uniform3f(f),u_is_halo:new o.Uniform1i(f)}),symbolTextAndIcon:f=>({u_is_size_zoom_constant:new o.Uniform1i(f),u_is_size_feature_constant:new o.Uniform1i(f),u_size_t:new o.Uniform1f(f),u_size:new o.Uniform1f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_rotate_symbol:new o.Uniform1i(f),u_aspect_ratio:new o.Uniform1f(f),u_fade_change:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_label_plane_matrix:new o.UniformMatrix4f(f),u_coord_matrix:new o.UniformMatrix4f(f),u_is_text:new o.Uniform1i(f),u_pitch_with_map:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_texsize_icon:new o.Uniform2f(f),u_texture:new o.Uniform1i(f),u_texture_icon:new o.Uniform1i(f),u_gamma_scale:new o.Uniform1f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_is_halo:new o.Uniform1i(f)}),background:f=>({u_matrix:new o.UniformMatrix4f(f),u_opacity:new o.Uniform1f(f),u_color:new o.UniformColor(f)}),backgroundPattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_opacity:new o.Uniform1f(f),u_image:new o.Uniform1i(f),u_pattern_tl:new o.Uniform2f(f),u_pattern_br:new o.Uniform2f(f),u_texsize:new o.Uniform2f(f),u_pattern_size:new o.Uniform2f(f),u_pixel_coord_upper:new o.Uniform2f(f),u_pixel_coord_lower:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f)}),terrainRaster:Eh,terrainDepth:Eh,skybox:f=>({u_matrix:new o.UniformMatrix4f(f),u_sun_direction:new o.Uniform3f(f),u_cubemap:new o.Uniform1i(f),u_opacity:new o.Uniform1f(f),u_temporal_offset:new o.Uniform1f(f)}),skyboxGradient:f=>({u_matrix:new o.UniformMatrix4f(f),u_color_ramp:new o.Uniform1i(f),u_center_direction:new o.Uniform3f(f),u_radius:new o.Uniform1f(f),u_opacity:new o.Uniform1f(f),u_temporal_offset:new o.Uniform1f(f)}),skyboxCapture:f=>({u_matrix_3f:new o.UniformMatrix3f(f),u_sun_direction:new o.Uniform3f(f),u_sun_intensity:new o.Uniform1f(f),u_color_tint_r:new o.Uniform4f(f),u_color_tint_m:new o.Uniform4f(f),u_luminance:new o.Uniform1f(f)}),globeRaster:f=>({u_proj_matrix:new o.UniformMatrix4f(f),u_globe_matrix:new o.UniformMatrix4f(f),u_normalize_matrix:new o.UniformMatrix4f(f),u_merc_matrix:new o.UniformMatrix4f(f),u_zoom_transition:new o.Uniform1f(f),u_merc_center:new o.Uniform2f(f),u_image0:new o.Uniform1i(f),u_grid_matrix:new o.UniformMatrix3f(f),u_skirt_height:new o.Uniform1f(f),u_frustum_tl:new o.Uniform3f(f),u_frustum_tr:new o.Uniform3f(f),u_frustum_br:new o.Uniform3f(f),u_frustum_bl:new o.Uniform3f(f),u_globe_pos:new o.Uniform3f(f),u_globe_radius:new o.Uniform1f(f),u_viewport:new o.Uniform2f(f)}),globeAtmosphere:f=>({u_frustum_tl:new o.Uniform3f(f),u_frustum_tr:new o.Uniform3f(f),u_frustum_br:new o.Uniform3f(f),u_frustum_bl:new o.Uniform3f(f),u_horizon:new o.Uniform1f(f),u_transition:new o.Uniform1f(f),u_fadeout_range:new o.Uniform1f(f),u_color:new o.Uniform4f(f),u_high_color:new o.Uniform4f(f),u_space_color:new o.Uniform4f(f),u_star_intensity:new o.Uniform1f(f),u_star_density:new o.Uniform1f(f),u_star_size:new o.Uniform1f(f),u_temporal_offset:new o.Uniform1f(f),u_horizon_angle:new o.Uniform1f(f),u_rotation_matrix:new o.UniformMatrix4f(f)})};let Ru;function Pl(f,r,u,g,v,b,M){const P=f.context,L=P.gl,N=f.transform,F=f.useProgram("collisionBox"),W=[];let ie=0,ae=0;for(let ve=0;ve<g.length;ve++){const Pe=g[ve],Re=r.getTile(Pe),Ie=Re.getBucket(u);if(!Ie)continue;const Ne=wo(Pe,Ie,N);let Fe=Ne;v[0]===0&&v[1]===0||(Fe=f.translatePosMatrix(Ne,Re,v,b));const He=M?Ie.textCollisionBox:Ie.iconCollisionBox,vt=Ie.collisionCircleArray;if(vt.length>0){const qe=o.create(),nt=Fe;o.mul(qe,Ie.placementInvProjMatrix,N.glCoordMatrix),o.mul(qe,qe,Ie.placementViewportMatrix),W.push({circleArray:vt,circleOffset:ae,transform:nt,invTransform:qe,projection:Ie.getProjection()}),ie+=vt.length/4,ae=ie}He&&(f.terrain&&f.terrain.setupElevationDraw(Re,F),F.draw(P,L.LINES,o.DepthMode.disabled,o.StencilMode.disabled,f.colorModeForRenderPass(),o.CullFaceMode.disabled,Ac(Fe,N,Re,Ie.getProjection()),u.id,He.layoutVertexBuffer,He.indexBuffer,He.segments,null,N.zoom,null,[He.collisionVertexBuffer,He.collisionVertexBufferExt]))}if(!M||!W.length)return;const ue=f.useProgram("collisionCircle"),le=new o.StructArrayLayout2f1f2i16;le.resize(4*ie),le._trim();let he=0;for(const ve of W)for(let Pe=0;Pe<ve.circleArray.length/4;Pe++){const Re=4*Pe,Ie=ve.circleArray[Re+0],Ne=ve.circleArray[Re+1],Fe=ve.circleArray[Re+2],He=ve.circleArray[Re+3];le.emplace(he++,Ie,Ne,Fe,He,0),le.emplace(he++,Ie,Ne,Fe,He,1),le.emplace(he++,Ie,Ne,Fe,He,2),le.emplace(he++,Ie,Ne,Fe,He,3)}(!Ru||Ru.length<2*ie)&&(Ru=function(ve){const Pe=2*ve,Re=new o.StructArrayLayout3ui6;Re.resize(Pe),Re._trim();for(let Ie=0;Ie<Pe;Ie++){const Ne=6*Ie;Re.uint16[Ne+0]=4*Ie+0,Re.uint16[Ne+1]=4*Ie+1,Re.uint16[Ne+2]=4*Ie+2,Re.uint16[Ne+3]=4*Ie+2,Re.uint16[Ne+4]=4*Ie+3,Re.uint16[Ne+5]=4*Ie+0}return Re}(ie));const X=P.createIndexBuffer(Ru,!0),se=P.createVertexBuffer(le,o.collisionCircleLayout.members,!0);for(const ve of W){const Pe={u_matrix:ve.transform,u_inv_matrix:ve.invTransform,u_camera_to_center_distance:(ge=N).getCameraToCenterDistance(ve.projection),u_viewport_size:[ge.width,ge.height]};ue.draw(P,L.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,f.colorModeForRenderPass(),o.CullFaceMode.disabled,Pe,u.id,se,X,o.SegmentVector.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,N.zoom)}var ge;se.destroy(),X.destroy()}const Oh=o.create();function Bh({width:f,height:r,anchor:u,textOffset:g,textScale:v},b){const{horizontalAlign:M,verticalAlign:P}=o.getAnchorAlignment(u),L=-(M-.5)*f,N=-(P-.5)*r,F=o.evaluateVariableOffset(u,g);return new o.Point((L/v+F[0])*b,(N/v+F[1])*b)}function sp(f,r,u,g,v,b,M,P,L,N,F){const W=f.text.placedSymbolArray,ie=f.text.dynamicLayoutVertexArray,ae=f.icon.dynamicLayoutVertexArray,ue={},le=f.getProjection(),he=_r(P,le,b),X=b.elevation,se=le.upVectorScale(P.canonical,b.center.lat,b.worldSize).metersToTile;ie.clear();for(let ge=0;ge<W.length;ge++){const ve=W.get(ge),{tileAnchorX:Pe,tileAnchorY:Re,numGlyphs:Ie}=ve,Ne=ve.hidden||!ve.crossTileID||f.allowVerticalPlacement&&!ve.placedOrientation?null:g[ve.crossTileID];if(Ne){let Fe=0,He=0,vt=0;if(X){const wt=X?X.getAtTileOffset(P,Pe,Re):0,[Jt,dn,Zt]=le.upVector(P.canonical,Pe,Re);Fe=wt*Jt*se,He=wt*dn*se,vt=wt*Zt*se}let[qe,nt,Xe,yt]=_i(ve.projectedAnchorX+Fe,ve.projectedAnchorY+He,ve.projectedAnchorZ+vt,u?he:M);const Ze=Rd(b.getCameraToCenterDistance(le),yt);let rt=v.evaluateSizeForFeature(f.textSizeData,N,ve)*Ze/o.ONE_EM;u&&(rt*=f.tilePixelRatio/L);const mt=Bh(Ne,rt);u?({x:qe,y:nt,z:Xe}=le.projectTilePoint(Pe+mt.x,Re+mt.y,P.canonical),[qe,nt,Xe]=_i(qe+Fe,nt+He,Xe+vt,M)):(r&&mt._rotate(-b.angle),qe+=mt.x,nt+=mt.y,Xe=0);const ht=f.allowVerticalPlacement&&ve.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let wt=0;wt<Ie;wt++)o.addDynamicAttributes(ie,qe,nt,Xe,ht);F&&ve.associatedIconIndex>=0&&(ue[ve.associatedIconIndex]={x:qe,y:nt,z:Xe,angle:ht})}else vo(Ie,ie)}if(F){ae.clear();const ge=f.icon.placedSymbolArray;for(let ve=0;ve<ge.length;ve++){const Pe=ge.get(ve),{numGlyphs:Re}=Pe,Ie=ue[ve];if(Pe.hidden||!Ie)vo(Re,ae);else{const{x:Ne,y:Fe,z:He,angle:vt}=Ie;for(let qe=0;qe<Re;qe++)o.addDynamicAttributes(ae,Ne,Fe,He,vt)}}f.icon.dynamicLayoutVertexBuffer.updateData(ae)}f.text.dynamicLayoutVertexBuffer.updateData(ie)}function Fh(f,r,u){return u.iconsInText&&r?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Nd(f,r,u,g,v,b,M,P,L,N,F,W){const ie=f.context,ae=ie.gl,ue=f.transform,le=P==="map",he=L==="map",X=le&&u.layout.get("symbol-placement")!=="point",se=le&&!he&&!X,ge=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ve=!1;const Pe=f.depthModeForSublayer(0,o.DepthMode.ReadOnly),Re=[o.mercatorXfromLng(ue.center.lng),o.mercatorYfromLat(ue.center.lat)],Ie=u.layout.get("text-variable-anchor"),Ne=ue.projection.name==="globe",Fe=[],He=[0,-1,0];let vt=He;!Ne&&!ue.mercatorFromTransition||le||(vt=function(qe){const nt=qe._camera.getWorldToCamera(qe.worldSize,1),Xe=o.multiply([],nt,qe.globeMatrix);o.invert(Xe,Xe);const yt=[0,0,0],Ze=[0,1,0,0];return o.transformMat4$1(Ze,Ze,Xe),yt[0]=Ze[0],yt[1]=Ze[1],yt[2]=Ze[2],o.normalize(yt,yt),yt}(ue));for(const qe of g){const nt=r.getTile(qe),Xe=nt.getBucket(u);if(!Xe||Xe.projection.name==="mercator"&&Ne)continue;const yt=v?Xe.text:Xe.icon;if(!yt||Xe.fullyClipped||!yt.segments.get().length)continue;const Ze=yt.programConfigurations.get(u.id),rt=v||Xe.sdfIcons,mt=v?Xe.textSizeData:Xe.iconSizeData,ht=he||ue.pitch!==0,wt=o.evaluateSizeForZoom(mt,ue.zoom);let Jt,dn,Zt,on,Pn=[0,0],Dn=null;if(v)dn=nt.glyphAtlasTexture,Zt=ae.LINEAR,Jt=nt.glyphAtlasTexture.size,Xe.iconsInText&&(Pn=nt.imageAtlasTexture.size,Dn=nt.imageAtlasTexture,on=ht||f.options.rotating||f.options.zooming||mt.kind==="composite"||mt.kind==="camera"?ae.LINEAR:ae.NEAREST);else{const Go=u.layout.get("icon-size").constantOr(0)!==1||Xe.iconsNeedLinear;dn=nt.imageAtlasTexture,Zt=rt||f.options.rotating||f.options.zooming||Go||ht?ae.LINEAR:ae.NEAREST,Jt=nt.imageAtlasTexture.size}const Qt=Xe.projection.name==="globe",Un=Qt?vt:He,nr=Qt?o.globeToMercatorTransition(ue.zoom):0,rr=_r(qe,Xe.getProjection(),ue),Jn=ue.calculatePixelsToTileUnitsMatrix(nt),bi=ot(rr,nt.tileID.canonical,he,le,ue,Xe.getProjection(),Jn),jr=f.terrain&&he&&X?o.invert(o.create(),bi):Oh,Co=Qr(rr,nt.tileID.canonical,he,le,ue,Xe.getProjection(),Jn),$o=Ie&&Xe.hasTextData(),En=u.layout.get("icon-text-fit")!=="none"&&$o&&Xe.hasIconData();if(X){const Go=ue.elevation,qo=Go?Go.getAtTileOffsetFunc(qe,ue.center.lat,ue.worldSize,Xe.getProjection()):null,us=ci(rr,nt.tileID.canonical,he,le,ue,Xe.getProjection(),Jn);_l(Xe,rr,f,v,us,Co,he,N,qo,qe)}const ur=X||v&&Ie||En,Yn=f.translatePosMatrix(rr,nt,b,M),Vr=ur?Oh:bi,Ti=f.translatePosMatrix(Co,nt,b,M,!0),fr=Xe.getProjection().createInversionMatrix(ue,qe.canonical),ri=[];f.terrainRenderModeElevated()&&he&&ri.push("PITCH_WITH_MAP_TERRAIN"),Qt&&ri.push("PROJECTION_GLOBE_VIEW"),ur&&ri.push("PROJECTED_POS_ON_VIEWPORT");const Mr=rt&&u.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Rr;Rr=rt?Xe.iconsInText?Fd(mt.kind,wt,se,he,f,Yn,Vr,Ti,Jt,Pn,qe,nr,Re,fr,Un,Xe.getProjection()):Wa(mt.kind,wt,se,he,f,Yn,Vr,Ti,v,Jt,!0,qe,nr,Re,fr,Un,Xe.getProjection()):Dh(mt.kind,wt,se,he,f,Yn,Vr,Ti,v,Jt,qe,nr,Re,fr,Un,Xe.getProjection());const Zr={program:f.useProgram(Fh(rt,v,Xe),Ze,ri),buffers:yt,uniformValues:Rr,atlasTexture:dn,atlasTextureIcon:Dn,atlasInterpolation:Zt,atlasInterpolationIcon:on,isSDF:rt,hasHalo:Mr,tile:nt,labelPlaneMatrixInv:jr};if(ge&&Xe.canOverlap){ve=!0;const Go=yt.segments.get();for(const qo of Go)Fe.push({segments:new o.SegmentVector([qo]),sortKey:qo.sortKey,state:Zr})}else Fe.push({segments:yt.segments,sortKey:0,state:Zr})}ve&&Fe.sort((qe,nt)=>qe.sortKey-nt.sortKey);for(const qe of Fe){const nt=qe.state;if(f.terrain&&f.terrain.setupElevationDraw(nt.tile,nt.program,{useDepthForOcclusion:!Ne,labelPlaneMatrixInv:nt.labelPlaneMatrixInv}),ie.activeTexture.set(ae.TEXTURE0),nt.atlasTexture.bind(nt.atlasInterpolation,ae.CLAMP_TO_EDGE),nt.atlasTextureIcon&&(ie.activeTexture.set(ae.TEXTURE1),nt.atlasTextureIcon&&nt.atlasTextureIcon.bind(nt.atlasInterpolationIcon,ae.CLAMP_TO_EDGE)),nt.isSDF){const Xe=nt.uniformValues;nt.hasHalo&&(Xe.u_is_halo=1,Lu(nt.buffers,qe.segments,u,f,nt.program,Pe,F,W,Xe)),Xe.u_is_halo=0}Lu(nt.buffers,qe.segments,u,f,nt.program,Pe,F,W,nt.uniformValues)}}function Lu(f,r,u,g,v,b,M,P,L){const N=g.context,F=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer];v.draw(N,N.gl.TRIANGLES,b,M,P,o.CullFaceMode.disabled,L,u.id,f.layoutVertexBuffer,f.indexBuffer,r,u.paint,g.transform.zoom,f.programConfigurations.get(u.id),F)}function jo(f,r,u,g,v,b,M){const P=f.context.gl,L=u.paint.get("fill-pattern"),N=L&&L.constantOr(1);let F,W,ie,ae,ue;M?(W=N&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=P.LINES):(W=N?"fillPattern":"fill",F=P.TRIANGLES);for(const le of g){const he=r.getTile(le);if(N&&!he.patternsLoaded())continue;const X=he.getBucket(u);if(!X)continue;f.prepareDrawTile();const se=X.programConfigurations.get(u.id),ge=f.useProgram(W,se);N&&(f.context.activeTexture.set(P.TEXTURE0),he.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),se.updatePaintBuffers());const ve=L.constantOr(null);if(ve&&he.imageAtlas){const Re=he.imageAtlas.patternPositions[ve.toString()];Re&&se.setConstantPatternPositions(Re)}const Pe=f.translatePosMatrix(le.projMatrix,he,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(M){ae=X.indexBuffer2,ue=X.segments2;const Re=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[P.drawingBufferWidth,P.drawingBufferHeight];ie=W==="fillOutlinePattern"&&N?kh(Pe,f,he,Re):op(Pe,Re)}else ae=X.indexBuffer,ue=X.segments,ie=N?Mh(Pe,f,he):qa(Pe);f.prepareDrawProgram(f.context,ge,le.toUnwrapped()),ge.draw(f.context,F,v,f.stencilModeForClipping(le),b,o.CullFaceMode.disabled,ie,u.id,X.layoutVertexBuffer,ae,ue,u.paint,f.transform.zoom,se)}}function pa(f,r,u,g,v,b,M){const P=f.context,L=P.gl,N=f.transform,F=u.paint.get("fill-extrusion-pattern"),W=F.constantOr(1),ie=u.paint.get("fill-extrusion-opacity"),ae=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),u.paint.get("fill-extrusion-ambient-occlusion-radius")],ue=u.layout.get("fill-extrusion-edge-radius"),le=ue>0&&!u.paint.get("fill-extrusion-rounded-roof"),he=le?0:ue,X=N.projection.name==="globe"?o.fillExtrusionHeightLift():0,se=N.projection.name==="globe",ge=se?o.globeToMercatorTransition(N.zoom):0,ve=[o.mercatorXfromLng(N.center.lng),o.mercatorYfromLat(N.center.lat)],Pe=[];se&&Pe.push("PROJECTION_GLOBE_VIEW"),ae[0]>0&&Pe.push("FAUX_AO"),le&&Pe.push("ZERO_ROOF_RADIUS");for(const Re of g){const Ie=r.getTile(Re),Ne=Ie.getBucket(u);if(!Ne||Ne.projection.name!==N.projection.name)continue;const Fe=Ne.programConfigurations.get(u.id),He=f.useProgram(W?"fillExtrusionPattern":"fillExtrusion",Fe,Pe);if(f.terrain){const rt=f.terrain;if(f.style.terrainSetForDrapingOnly())rt.setupElevationDraw(Ie,He,{useMeterToDem:!0});else{if(!Ne.enableTerrain)continue;if(rt.setupElevationDraw(Ie,He,{useMeterToDem:!0}),Nh(P,r,Re,Ne,u,rt),!Ne.centroidVertexBuffer){const mt=He.attributes.a_centroid_pos;mt!==void 0&&L.vertexAttrib2f(mt,0,0)}}}W&&(f.context.activeTexture.set(L.TEXTURE0),Ie.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),Fe.updatePaintBuffers());const vt=F.constantOr(null);if(vt&&Ie.imageAtlas){const rt=Ie.imageAtlas.patternPositions[vt.toString()];rt&&Fe.setConstantPatternPositions(rt)}const qe=f.translatePosMatrix(Re.projMatrix,Ie,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),nt=N.projection.createInversionMatrix(N,Re.canonical),Xe=u.paint.get("fill-extrusion-vertical-gradient"),yt=W?Bd(qe,f,Xe,ie,ae,he,Re,Ie,X,ge,ve,nt):Ah(qe,f,Xe,ie,ae,he,Re,X,ge,ve,nt);f.prepareDrawProgram(P,He,Re.toUnwrapped());const Ze=[];f.terrain&&Ze.push(Ne.centroidVertexBuffer),se&&Ze.push(Ne.layoutVertexExtBuffer),He.draw(P,P.gl.TRIANGLES,v,b,M,o.CullFaceMode.backCCW,yt,u.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,u.paint,f.transform.zoom,Fe,Ze)}}function Nh(f,r,u,g,v,b){const M=[X=>{let se=X.canonical.x-1,ge=X.wrap;return se<0&&(se=(1<<X.canonical.z)-1,ge--),new o.OverscaledTileID(X.overscaledZ,ge,X.canonical.z,se,X.canonical.y)},X=>{let se=X.canonical.x+1,ge=X.wrap;return se===1<<X.canonical.z&&(se=0,ge++),new o.OverscaledTileID(X.overscaledZ,ge,X.canonical.z,se,X.canonical.y)},X=>new o.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,(X.canonical.y===0?1<<X.canonical.z:X.canonical.y)-1),X=>new o.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y===(1<<X.canonical.z)-1?0:X.canonical.y+1)],P=X=>{const se=r.getSource().minzoom,ge=Pe=>{const Re=r.getTileByID(Pe);if(Re&&Re.hasData())return Re.getBucket(v)},ve=[0,-1,1];for(const Pe of ve){if(X.overscaledZ+Pe<se)continue;const Re=ge(X.calculateScaledKey(X.overscaledZ+Pe));if(Re)return Re}},L=[0,0,0],N=(X,se)=>(L[0]=Math.min(X.min.y,se.min.y),L[1]=Math.max(X.max.y,se.max.y),L[2]=o.EXTENT-se.min.x>X.max.x?se.min.x-o.EXTENT:X.max.x,L),F=(X,se)=>(L[0]=Math.min(X.min.x,se.min.x),L[1]=Math.max(X.max.x,se.max.x),L[2]=o.EXTENT-se.min.y>X.max.y?se.min.y-o.EXTENT:X.max.y,L),W=[(X,se)=>N(X,se),(X,se)=>N(se,X),(X,se)=>F(X,se),(X,se)=>F(se,X)],ie=new o.Point(0,0);let ae,ue,le;const he=(X,se,ge,ve,Pe)=>{const Re=[[ve?ge:X,ve?X:ge,0],[ve?ge:se,ve?se:ge,0]],Ie=Pe<0?o.EXTENT+Pe:Pe,Ne=[ve?Ie:(X+se)/2,ve?(X+se)/2:Ie,0];return ge===0&&Pe<0||ge!==0&&Pe>0?b.getForTilePoints(le,[Ne],!0,ue):Re.push(Ne),b.getForTilePoints(u,Re,!0,ae),Math.max(Re[0][2],Re[1][2],Ne[2])/b.exaggeration()};for(let X=0;X<4;X++){const se=(X<2?1:5)-X,ge=g.borders[X];if(ge.length===0)continue;const ve=le=M[X](u),Pe=P(ve);if(!(Pe&&Pe instanceof o.FillExtrusionBucket&&Pe.enableTerrain)||g.borderDoneWithNeighborZ[X]===Pe.canonical.z&&Pe.borderDoneWithNeighborZ[se]===g.canonical.z||(ue=b.findDEMTileFor(ve),!ue||!ue.dem))continue;if(!ae){const Fe=b.findDEMTileFor(u);if(!Fe||!Fe.dem)return;ae=Fe}const Re=Pe.borders[se];let Ie=0;const Ne=Pe.borderDoneWithNeighborZ[se]!==g.canonical.z;if(g.canonical.z===Pe.canonical.z){for(let Fe=0;Fe<ge.length;Fe++){const He=g.featuresOnBorder[ge[Fe]],vt=He.borders[X];let qe;for(;Ie<Re.length&&(qe=Pe.featuresOnBorder[Re[Ie]],!(qe.borders[se][1]>vt[0]+3));)Ne&&Pe.encodeCentroid(void 0,qe,!1),Ie++;if(qe&&Ie<Re.length){const nt=Ie;let Xe=0;for(;!(qe.borders[se][0]>vt[1]-3)&&(Xe++,++Ie!==Re.length);)qe=Pe.featuresOnBorder[Re[Ie]];if(qe=Pe.featuresOnBorder[Re[nt]],He.intersectsCount()>1||qe.intersectsCount()>1||Xe!==1){Xe!==1&&(Ie=nt),g.encodeCentroid(void 0,He,!1),Ne&&Pe.encodeCentroid(void 0,qe,!1);continue}const yt=W[X](He,qe),Ze=X%2?o.EXTENT-1:0;ie.x=he(yt[0],Math.min(o.EXTENT-1,yt[1]),Ze,X<2,yt[2]),ie.y=0,g.encodeCentroid(ie,He,!1),Ne&&Pe.encodeCentroid(ie,qe,!1)}else g.encodeCentroid(void 0,He,!1)}g.borderDoneWithNeighborZ[X]=Pe.canonical.z,g.needsCentroidUpdate=!0,Ne&&(Pe.borderDoneWithNeighborZ[se]=g.canonical.z,Pe.needsCentroidUpdate=!0)}else{for(const Fe of ge)g.encodeCentroid(void 0,g.featuresOnBorder[Fe],!1);if(Ne){for(const Fe of Re)Pe.encodeCentroid(void 0,Pe.featuresOnBorder[Fe],!1);Pe.borderDoneWithNeighborZ[se]=g.canonical.z,Pe.needsCentroidUpdate=!0}g.borderDoneWithNeighborZ[X]=Pe.canonical.z,g.needsCentroidUpdate=!0}}(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(f)}const Za=new o.Color(1,0,0,1),jd=new o.Color(0,1,0,1),Vd=new o.Color(0,0,1,1),jh=new o.Color(1,0,1,1),ap=new o.Color(0,1,1,1);function lp(f,r,u){const g=f.context,v=f.transform,b=g.gl,M=v.projection.name==="globe",P=M?["PROJECTION_GLOBE_VIEW"]:null;let L=u.projMatrix;if(M&&o.globeToMercatorTransition(v.zoom)>0){const He=o.transitionTileAABBinECEF(u.canonical,v),vt=o.globeDenormalizeECEF(He);L=o.multiply(new Float32Array(16),v.globeMatrix,vt),o.multiply(L,v.projMatrix,L)}const N=f.useProgram("debug",null,P),F=r.getTileByID(u.key);f.terrain&&f.terrain.setupElevationDraw(F,N);const W=o.DepthMode.disabled,ie=o.StencilMode.disabled,ae=f.colorModeForRenderPass(),ue="$debug";g.activeTexture.set(b.TEXTURE0),f.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),M?F._makeGlobeTileDebugBuffers(f.context,v):F._makeDebugTileBoundsBuffers(f.context,v.projection);const le=F._tileDebugBuffer||f.debugBuffer,he=F._tileDebugIndexBuffer||f.debugIndexBuffer,X=F._tileDebugSegments||f.debugSegments;N.draw(g,b.LINE_STRIP,W,ie,ae,o.CullFaceMode.disabled,ku(L,o.Color.red),ue,le,he,X,null,null,null,[F._globeTileDebugBorderBuffer]);const se=F.latestRawTileData,ge=Math.floor((se&&se.byteLength||0)/1024),ve=r.getTile(u).tileSize,Pe=512/Math.min(ve,512)*(u.overscaledZ/v.zoom)*.5;let Re=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Re+=` => ${u.overscaledZ}`),Re+=` ${ge}kb`,function(He,vt){He.initDebugOverlayCanvas();const qe=He.debugOverlayCanvas,nt=He.context.gl,Xe=He.debugOverlayCanvas.getContext("2d");Xe.clearRect(0,0,qe.width,qe.height),Xe.shadowColor="white",Xe.shadowBlur=2,Xe.lineWidth=1.5,Xe.strokeStyle="white",Xe.textBaseline="top",Xe.font="bold 36px Open Sans, sans-serif",Xe.fillText(vt,5,5),Xe.strokeText(vt,5,5),He.debugOverlayTexture.update(qe),He.debugOverlayTexture.bind(nt.LINEAR,nt.CLAMP_TO_EDGE)}(f,Re);const Ie=F._tileDebugTextBuffer||f.debugBuffer,Ne=F._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,Fe=F._tileDebugTextSegments||f.debugSegments;N.draw(g,b.TRIANGLES,W,ie,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,ku(L,o.Color.transparent,Pe),ue,Ie,Ne,Fe,null,null,null,[F._globeTileDebugTextBuffer])}function Ha(f,r,u,g){Es(f,0,r+u/2,f.transform.width,u,g)}function Il(f,r,u,g){Es(f,r-u/2,0,u,f.transform.height,g)}function Es(f,r,u,g,v,b){const M=f.context,P=M.gl;P.enable(P.SCISSOR_TEST),P.scissor(r*o.exported.devicePixelRatio,u*o.exported.devicePixelRatio,g*o.exported.devicePixelRatio,v*o.exported.devicePixelRatio),M.clear({color:b}),P.disable(P.SCISSOR_TEST)}const Pc=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Vh}=Pc;function Vo(f,r,u,g){f.emplaceBack(r,u,g)}class Us{constructor(r){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Vo(this.vertexArray,-1,-1,1),Vo(this.vertexArray,1,-1,1),Vo(this.vertexArray,-1,1,1),Vo(this.vertexArray,1,1,1),Vo(this.vertexArray,-1,-1,-1),Vo(this.vertexArray,1,-1,-1),Vo(this.vertexArray,-1,1,-1),Vo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Vh),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function lo(f,r,u,g,v,b){const M=f.gl,P=r.paint.get("sky-atmosphere-color"),L=r.paint.get("sky-atmosphere-halo-color"),N=r.paint.get("sky-atmosphere-sun-intensity"),F=((W,ie,ae,ue,le)=>({u_matrix_3f:W,u_sun_direction:ie,u_sun_intensity:ae,u_color_tint_r:[ue.r,ue.g,ue.b,ue.a],u_color_tint_m:[le.r,le.g,le.b,le.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),g),v,N,P,L);M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+b,r.skyboxTexture,0),u.draw(f,M.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,F,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Rl=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Du{constructor(r){const u=new o.StructArrayLayout5f20;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new o.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(u,Rl.members),this.indexBuffer=r.createIndexBuffer(g),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ma={symbol:function(f,r,u,g,v){if(f.renderPass!=="translucent")return;const b=o.StencilMode.disabled,M=f.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(P,L,N,F,W,ie,ae){const ue=L.transform,le=W==="map",he=ie==="map";for(const X of P){const se=F.getTile(X),ge=se.getBucket(N);if(!ge||!ge.text||!ge.text.segments.get().length)continue;const ve=o.evaluateSizeForZoom(ge.textSizeData,ue.zoom),Pe=_r(X,ge.getProjection(),ue),Re=ue.calculatePixelsToTileUnitsMatrix(se),Ie=ot(Pe,se.tileID.canonical,he,le,ue,ge.getProjection(),Re),Ne=N.layout.get("icon-text-fit")!=="none"&&ge.hasIconData();if(ve){const Fe=Math.pow(2,ue.zoom-se.tileID.overscaledZ);sp(ge,le,he,ae,o.symbolSize,ue,Ie,X,Fe,ve,Ne)}}}(g,f,u,r,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),v),u.paint.get("icon-opacity").constantOr(1)!==0&&Nd(f,r,u,g,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),b,M),u.paint.get("text-opacity").constantOr(1)!==0&&Nd(f,r,u,g,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),b,M),r.map.showCollisionBoxes&&(Pl(f,r,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Pl(f,r,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,u,g){if(f.renderPass!=="translucent")return;const v=u.paint.get("circle-opacity"),b=u.paint.get("circle-stroke-width"),M=u.paint.get("circle-stroke-opacity"),P=u.layout.get("circle-sort-key").constantOr(1)!==void 0;if(v.constantOr(1)===0&&(b.constantOr(1)===0||M.constantOr(1)===0))return;const L=f.context,N=L.gl,F=f.transform,W=f.depthModeForSublayer(0,o.DepthMode.ReadOnly),ie=o.StencilMode.disabled,ae=f.colorModeForRenderPass(),ue=F.projection.name==="globe",le=[o.mercatorXfromLng(F.center.lng),o.mercatorYfromLat(F.center.lat)],he=[];for(let se=0;se<g.length;se++){const ge=g[se],ve=r.getTile(ge),Pe=ve.getBucket(u);if(!Pe||Pe.projection.name!==F.projection.name)continue;const Re=Pe.programConfigurations.get(u.id),Ie=Cc(u);ue&&Ie.push("PROJECTION_GLOBE_VIEW");const Ne=f.useProgram("circle",Re,Ie),Fe=Pe.layoutVertexBuffer,He=Pe.globeExtVertexBuffer,vt=Pe.indexBuffer,qe=F.projection.createInversionMatrix(F,ge.canonical),nt={programConfiguration:Re,program:Ne,layoutVertexBuffer:Fe,globeExtVertexBuffer:He,indexBuffer:vt,uniformValues:Ph(f,ge,ve,qe,le,u),tile:ve};if(P){const Xe=Pe.segments.get();for(const yt of Xe)he.push({segments:new o.SegmentVector([yt]),sortKey:yt.sortKey,state:nt})}else he.push({segments:Pe.segments,sortKey:0,state:nt})}P&&he.sort((se,ge)=>se.sortKey-ge.sortKey);const X={useDepthForOcclusion:!ue};for(const se of he){const{programConfiguration:ge,program:ve,layoutVertexBuffer:Pe,globeExtVertexBuffer:Re,indexBuffer:Ie,uniformValues:Ne,tile:Fe}=se.state,He=se.segments;f.terrain&&f.terrain.setupElevationDraw(Fe,ve,X),f.prepareDrawProgram(L,ve,Fe.tileID.toUnwrapped()),ve.draw(L,N.TRIANGLES,W,ie,ae,o.CullFaceMode.disabled,Ne,u.id,Pe,Ie,He,u.paint,F.zoom,ge,[Re])}},heatmap:function(f,r,u,g){if(u.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const v=f.context,b=v.gl,M=o.StencilMode.disabled,P=new o.ColorMode([b.ONE,b.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(ae,ue,le,he){const X=ae.gl,se=ue.width*he,ge=ue.height*he;ae.activeTexture.set(X.TEXTURE1),ae.viewport.set([0,0,se,ge]);let ve=le.heatmapFbo;if(!ve||ve&&(ve.width!==se||ve.height!==ge)){ve&&ve.destroy();const Pe=X.createTexture();X.bindTexture(X.TEXTURE_2D,Pe),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),ve=le.heatmapFbo=ae.createFramebuffer(se,ge,!1),function(Re,Ie,Ne,Fe,He,vt){const qe=Re.gl;qe.texImage2D(qe.TEXTURE_2D,0,Re.isWebGL2&&Re.extRenderToTextureHalfFloat?qe.RGBA16F:qe.RGBA,He,vt,0,qe.RGBA,Re.extRenderToTextureHalfFloat?Re.isWebGL2?qe.HALF_FLOAT:Re.extTextureHalfFloat.HALF_FLOAT_OES:qe.UNSIGNED_BYTE,null),Fe.colorAttachment.set(Ne)}(ae,0,Pe,ve,se,ge)}else X.bindTexture(X.TEXTURE_2D,ve.colorAttachment.get()),ae.bindFramebuffer.set(ve.framebuffer)})(v,f,u,f.transform.projection.name==="globe"?.5:.25),v.clear({color:o.Color.transparent});const L=f.transform,N=L.projection.name==="globe",F=N?["PROJECTION_GLOBE_VIEW"]:null,W=N?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,ie=[o.mercatorXfromLng(L.center.lng),o.mercatorYfromLat(L.center.lat)];for(let ae=0;ae<g.length;ae++){const ue=g[ae];if(r.hasRenderableParent(ue))continue;const le=r.getTile(ue),he=le.getBucket(u);if(!he||he.projection.name!==L.projection.name)continue;const X=he.programConfigurations.get(u.id),se=f.useProgram("heatmap",X,F),{zoom:ge}=f.transform;f.terrain&&f.terrain.setupElevationDraw(le,se),f.prepareDrawProgram(v,se,ue.toUnwrapped());const ve=L.projection.createInversionMatrix(L,ue.canonical);se.draw(v,b.TRIANGLES,o.DepthMode.disabled,M,P,W,Rh(f,ue,le,ve,ie,ge,u.paint.get("heatmap-intensity")),u.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,u.paint,f.transform.zoom,X,N?[he.globeExtVertexBuffer]:null)}v.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(v,b){const M=v.context,P=M.gl,L=b.heatmapFbo;if(!L)return;M.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,L.colorAttachment.get()),M.activeTexture.set(P.TEXTURE1);let N=b.colorRampTexture;N||(N=b.colorRampTexture=new o.Texture(M,b.colorRamp,P.RGBA)),N.bind(P.LINEAR,P.CLAMP_TO_EDGE),v.useProgram("heatmapTexture").draw(M,P.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,v.colorModeForRenderPass(),o.CullFaceMode.disabled,((F,W,ie,ae)=>({u_image:0,u_color_ramp:1,u_opacity:W.paint.get("heatmap-opacity")}))(0,b),b.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,b.paint,v.transform.zoom)}(f,u))},line:function(f,r,u,g){if(f.renderPass!=="translucent")return;const v=u.paint.get("line-opacity"),b=u.paint.get("line-width");if(v.constantOr(1)===0||b.constantOr(1)===0)return;const M=f.depthModeForSublayer(0,o.DepthMode.ReadOnly),P=f.colorModeForRenderPass(),L=f.terrain&&f.terrain.renderingToTexture?1:o.exported.devicePixelRatio,N=u.paint.get("line-dasharray"),F=N.constantOr(1),W=u.layout.get("line-cap"),ie=u.paint.get("line-pattern"),ae=ie.constantOr(1),ue=u.paint.get("line-gradient"),le=ae?"linePattern":"line",he=f.context,X=he.gl,se=(ve=>{const Pe=[];kl(ve)&&Pe.push("RENDER_LINE_DASH"),ve.paint.get("line-gradient")&&Pe.push("RENDER_LINE_GRADIENT");const Re=ve.paint.get("line-trim-offset");Re[0]===0&&Re[1]===0||Pe.push("RENDER_LINE_TRIM_OFFSET");const Ie=ve.paint.get("line-pattern").constantOr(1),Ne=ve.paint.get("line-opacity").constantOr(1)!==1;return!Ie&&Ne&&Pe.push("RENDER_LINE_ALPHA_DISCARD"),Pe})(u);let ge=se.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ge=!1);for(const ve of g){const Pe=r.getTile(ve);if(ae&&!Pe.patternsLoaded())continue;const Re=Pe.getBucket(u);if(!Re)continue;f.prepareDrawTile();const Ie=Re.programConfigurations.get(u.id),Ne=f.useProgram(le,Ie,se),Fe=ie.constantOr(null);if(Fe&&Pe.imageAtlas){const rt=Pe.imageAtlas.patternPositions[Fe.toString()];rt&&Ie.setConstantPatternPositions(rt)}const He=N.constantOr(null),vt=W.constantOr(null);if(!ae&&He&&vt&&Pe.lineAtlas){const rt=Pe.lineAtlas.getDash(He,vt);rt&&Ie.setConstantPatternPositions(rt)}let[qe,nt]=u.paint.get("line-trim-offset");(vt==="round"||vt==="square")&&qe!==nt&&(qe===0&&(qe-=1),nt===1&&(nt+=1));const Xe=f.terrain?ve.projMatrix:null,yt=ae?Pu(f,Pe,u,Xe,L):Al(f,Pe,u,Xe,Re.lineClipsArray.length,L,[qe,nt]);if(ue){const rt=Re.gradients[u.id];let mt=rt.texture;if(u.gradientVersion!==rt.version){let ht=256;if(u.stepInterpolant){const wt=r.getSource().maxzoom,Jt=ve.canonical.z===wt?Math.ceil(1<<f.transform.maxZoom-ve.canonical.z):1;ht=o.clamp(o.nextPowerOfTwo(Re.maxLineLength/o.EXTENT*1024*Jt),256,he.maxTextureSize)}rt.gradient=o.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:ht,image:rt.gradient||void 0,clips:Re.lineClipsArray}),rt.texture?rt.texture.update(rt.gradient):rt.texture=new o.Texture(he,rt.gradient,X.RGBA),rt.version=u.gradientVersion,mt=rt.texture}he.activeTexture.set(X.TEXTURE1),mt.bind(u.stepInterpolant?X.NEAREST:X.LINEAR,X.CLAMP_TO_EDGE)}F&&(he.activeTexture.set(X.TEXTURE0),Pe.lineAtlasTexture.bind(X.LINEAR,X.REPEAT),Ie.updatePaintBuffers()),ae&&(he.activeTexture.set(X.TEXTURE0),Pe.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Ie.updatePaintBuffers()),f.prepareDrawProgram(he,Ne,ve.toUnwrapped());const Ze=rt=>{Ne.draw(he,X.TRIANGLES,M,rt,P,o.CullFaceMode.disabled,yt,u.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,u.paint,f.transform.zoom,Ie,[Re.layoutVertexBuffer2])};if(ge){const rt=f.stencilModeForClipping(ve).ref;rt===0&&f.terrain&&he.clear({stencil:0});const mt={func:X.EQUAL,mask:255};yt.u_alpha_discard_threshold=.8,Ze(new o.StencilMode(mt,rt,255,X.KEEP,X.KEEP,X.INVERT)),yt.u_alpha_discard_threshold=0,Ze(new o.StencilMode(mt,rt,255,X.KEEP,X.KEEP,X.KEEP))}else Ze(f.stencilModeForClipping(ve))}ge&&(f.resetStencilClippingMasks(),f.terrain&&he.clear({stencil:0}))},fill:function(f,r,u,g){const v=u.paint.get("fill-color"),b=u.paint.get("fill-opacity");if(b.constantOr(1)===0)return;const M=f.colorModeForRenderPass(),P=u.paint.get("fill-pattern"),L=f.opaquePassEnabledForLayer()&&!P.constantOr(1)&&v.constantOr(o.Color.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===L){const N=f.depthModeForSublayer(1,f.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);jo(f,r,u,g,N,M,!1)}if(f.renderPass==="translucent"&&u.paint.get("fill-antialias")){const N=f.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);jo(f,r,u,g,N,M,!0)}},"fill-extrusion":function(f,r,u,g){const v=u.paint.get("fill-extrusion-opacity");if(v!==0&&f.renderPass==="translucent"){const b=new o.DepthMode(f.context.gl.LEQUAL,o.DepthMode.ReadWrite,f.depthRangeFor3D);if(v!==1||u.paint.get("fill-extrusion-pattern").constantOr(1))pa(f,r,u,g,b,o.StencilMode.disabled,o.ColorMode.disabled),pa(f,r,u,g,b,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const M=f.colorModeForRenderPass();pa(f,r,u,g,b,o.StencilMode.disabled,M)}}},hillshade:function(f,r,u,g){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const v=f.context,b=f.depthModeForSublayer(0,o.DepthMode.ReadOnly),M=f.colorModeForRenderPass(),P=f.terrain&&f.terrain.renderingToTexture,[L,N]=f.renderPass!=="translucent"||P?[{},g]:f.stencilConfigForOverlap(g);for(const F of N){const W=r.getTile(F);if(W.needsHillshadePrepare&&f.renderPass==="offscreen")wc(f,W,u,b,o.StencilMode.disabled,M);else if(f.renderPass==="translucent"){const ie=P&&f.terrain?f.terrain.stencilModeForRTTOverlap(F):L[F.overscaledZ];Dd(f,F,W,u,b,ie,M)}}v.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,u,g,v,b){if(f.renderPass!=="translucent"||u.paint.get("raster-opacity")===0||!g.length)return;const M=f.context,P=M.gl,L=r.getSource(),N=f.useProgram("raster"),F=f.colorModeForRenderPass(),W=f.terrain&&f.terrain.renderingToTexture,[ie,ae]=L instanceof Tn||W?[{},g]:f.stencilConfigForOverlap(g),ue=ae[ae.length-1].overscaledZ,le=!f.options.moving;for(const he of ae){const X=W?o.DepthMode.disabled:f.depthModeForSublayer(he.overscaledZ-ue,u.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,P.LESS),se=he.toUnwrapped(),ge=r.getTile(he);if(W&&(!ge||!ge.hasData()))continue;const ve=W?he.projMatrix:f.transform.calculateProjMatrix(se,le),Pe=f.terrain&&W?f.terrain.stencilModeForRTTOverlap(he):ie[he.overscaledZ],Re=b?0:u.paint.get("raster-fade-duration");ge.registerFadeDuration(Re);const Ie=r.findLoadedParent(he,0),Ne=Sh(ge,Ie,r,f.transform,Re);let Fe,He;f.terrain&&f.terrain.prepareDrawTile();const vt=u.paint.get("raster-resampling")==="nearest"?P.NEAREST:P.LINEAR;M.activeTexture.set(P.TEXTURE0),ge.texture.bind(vt,P.CLAMP_TO_EDGE),M.activeTexture.set(P.TEXTURE1),Ie?(Ie.texture.bind(vt,P.CLAMP_TO_EDGE),Fe=Math.pow(2,Ie.tileID.overscaledZ-ge.tileID.overscaledZ),He=[ge.tileID.canonical.x*Fe%1,ge.tileID.canonical.y*Fe%1]):ge.texture.bind(vt,P.CLAMP_TO_EDGE),ge.texture.useMipmap&&M.extTextureFilterAnisotropic&&f.transform.pitch>20&&P.texParameterf(P.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax);const qe=Mc(ve,He||[0,0],Fe||1,Ne,u,L instanceof Tn?L.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(M,N,se),L instanceof Tn)L.boundsBuffer&&L.boundsSegments&&N.draw(M,P.TRIANGLES,X,o.StencilMode.disabled,F,o.CullFaceMode.disabled,qe,u.id,L.boundsBuffer,f.quadTriangleIndexBuffer,L.boundsSegments);else{const{tileBoundsBuffer:nt,tileBoundsIndexBuffer:Xe,tileBoundsSegments:yt}=f.getTileBoundsBuffers(ge);N.draw(M,P.TRIANGLES,X,Pe,F,o.CullFaceMode.disabled,qe,u.id,nt,Xe,yt)}}f.resetStencilClippingMasks()},background:function(f,r,u,g){const v=u.paint.get("background-color"),b=u.paint.get("background-opacity");if(b===0)return;const M=f.context,P=M.gl,L=f.transform,N=L.tileSize,F=u.paint.get("background-pattern");if(f.isPatternMissing(F))return;const W=!F&&v.a===1&&b===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==W)return;const ie=o.StencilMode.disabled,ae=f.depthModeForSublayer(0,W==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),ue=f.colorModeForRenderPass(),le=f.useProgram(F?"backgroundPattern":"background");let he,X=g;X||(he=f.getBackgroundTiles(),X=Object.values(he).map(se=>se.tileID)),F&&(M.activeTexture.set(P.TEXTURE0),f.imageManager.bind(f.context));for(const se of X){const ge=se.toUnwrapped(),ve=g?se.projMatrix:f.transform.calculateProjMatrix(ge);f.prepareDrawTile();const Pe=r?r.getTile(se):he?he[se.key]:new o.Tile(se,N,L.zoom,f),Re=F?zh(ve,b,f,F,{tileID:se,tileSize:N}):kc(ve,b,v);f.prepareDrawProgram(M,le,ge);const{tileBoundsBuffer:Ie,tileBoundsIndexBuffer:Ne,tileBoundsSegments:Fe}=f.getTileBoundsBuffers(Pe);le.draw(M,P.TRIANGLES,ae,ie,ue,o.CullFaceMode.disabled,Re,u.id,Ie,Ne,Fe)}},sky:function(f,r,u){const g=f.transform,v=g.projection.name==="mercator"||g.projection.name==="globe"?1:o.smoothstep(7,8,g.zoom),b=u.paint.get("sky-opacity")*v;if(b===0)return;const M=f.context,P=u.paint.get("sky-type"),L=new o.DepthMode(M.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),N=f.frameCounter/1e3%1;P==="atmosphere"?f.renderPass==="offscreen"?u.needsSkyboxCapture(f)&&(function(F,W,ie,ae){const ue=F.context,le=ue.gl;let he=W.skyboxFbo;if(!he){he=W.skyboxFbo=ue.createFramebuffer(32,32,!1),W.skyboxGeometry=new Us(ue),W.skyboxTexture=ue.gl.createTexture(),le.bindTexture(le.TEXTURE_CUBE_MAP,W.skyboxTexture),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MAG_FILTER,le.LINEAR);for(let ve=0;ve<6;++ve)le.texImage2D(le.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,le.RGBA,32,32,0,le.RGBA,le.UNSIGNED_BYTE,null)}ue.bindFramebuffer.set(he.framebuffer),ue.viewport.set([0,0,32,32]);const X=W.getCenter(F,!0),se=F.useProgram("skyboxCapture"),ge=new Float64Array(16);o.identity(ge),o.rotateY(ge,ge,.5*-Math.PI),lo(ue,W,se,ge,X,0),o.identity(ge),o.rotateY(ge,ge,.5*Math.PI),lo(ue,W,se,ge,X,1),o.identity(ge),o.rotateX(ge,ge,.5*-Math.PI),lo(ue,W,se,ge,X,2),o.identity(ge),o.rotateX(ge,ge,.5*Math.PI),lo(ue,W,se,ge,X,3),o.identity(ge),lo(ue,W,se,ge,X,4),o.identity(ge),o.rotateY(ge,ge,Math.PI),lo(ue,W,se,ge,X,5),ue.viewport.set([0,0,F.width,F.height])}(f,u),u.markSkyboxValid(f)):f.renderPass==="sky"&&function(F,W,ie,ae,ue){const le=F.context,he=le.gl,X=F.transform,se=F.useProgram("skybox");le.activeTexture.set(he.TEXTURE0),he.bindTexture(he.TEXTURE_CUBE_MAP,W.skyboxTexture);const ge=((ve,Pe,Re,Ie,Ne)=>({u_matrix:ve,u_sun_direction:Pe,u_cubemap:0,u_opacity:Ie,u_temporal_offset:Ne}))(X.skyboxMatrix,W.getCenter(F,!1),0,ae,ue);F.prepareDrawProgram(le,se),se.draw(le,he.TRIANGLES,ie,o.StencilMode.disabled,F.colorModeForRenderPass(),o.CullFaceMode.backCW,ge,"skybox",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)}(f,u,L,b,N):P==="gradient"&&f.renderPass==="sky"&&function(F,W,ie,ae,ue){const le=F.context,he=le.gl,X=F.transform,se=F.useProgram("skyboxGradient");W.skyboxGeometry||(W.skyboxGeometry=new Us(le)),le.activeTexture.set(he.TEXTURE0);let ge=W.colorRampTexture;ge||(ge=W.colorRampTexture=new o.Texture(le,W.colorRamp,he.RGBA)),ge.bind(he.LINEAR,he.CLAMP_TO_EDGE);const ve=((Pe,Re,Ie,Ne,Fe)=>({u_matrix:Pe,u_color_ramp:0,u_center_direction:Re,u_radius:o.degToRad(Ie),u_opacity:Ne,u_temporal_offset:Fe}))(X.skyboxMatrix,W.getCenter(F,!1),W.paint.get("sky-gradient-radius"),ae,ue);F.prepareDrawProgram(le,se),se.draw(le,he.TRIANGLES,ie,o.StencilMode.disabled,F.colorModeForRenderPass(),o.CullFaceMode.backCW,ve,"skyboxGradient",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)}(f,u,L,b,N)},debug:function(f,r,u){for(let g=0;g<u.length;g++)lp(f,r,u[g])},custom:function(f,r,u,g){const v=f.context,b=u.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&u.isLayerDraped()){if(f.renderPass==="offscreen"){const M=b.prerender;if(M){if(f.setCustomLayerDefaults(),v.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const P=f.transform.pointMerc;M.call(b,v.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(f.transform.zoom),[P.x,P.y],f.transform.pixelsPerMeterRatio)}else M.call(b,v.gl,f.transform.customLayerMatrix());v.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const P=b.renderToTile;if(P){const L=g[0].canonical,N=new o.MercatorCoordinate(L.x+g[0].wrap*(1<<L.z),L.y,L.z);v.setDepthMode(o.DepthMode.disabled),v.setStencilMode(o.StencilMode.disabled),v.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),P.call(b,v.gl,N),v.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),v.setColorMode(f.colorModeForRenderPass()),v.setStencilMode(o.StencilMode.disabled);const M=b.renderingMode==="3d"?new o.DepthMode(f.context.gl.LEQUAL,o.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,o.DepthMode.ReadOnly);if(v.setDepthMode(M),f.transform.projection.name==="globe"){const P=f.transform.pointMerc;b.render(v.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(f.transform.zoom),[P.x,P.y],f.transform.pixelsPerMeterRatio)}else b.render(v.gl,f.transform.customLayerMatrix());v.setDirty(),f.setBaseState(),v.bindFramebuffer.set(null)}}else o.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Xa{constructor(r,u,g=!1){this.context=new Tt(r,g),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,u){const g=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ch(this,r));const v=this._terrain;this.transform.elevation=g?v:null,v.update(r,this.transform,u)}_updateFog(r){const u=r.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,v]=u.getFovAdjustedRange(this.transform._fov);if(g>v)return void(this.transform.fogCullDistSq=null);const b=g+.78*(v-g);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,u){if(this.width=r*o.exported.devicePixelRatio,this.height=u*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._layers[g].resize()}setup(){const r=this.context,u=new o.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(o.EXTENT,0),u.emplaceBack(0,o.EXTENT),u.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(u,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const g=new o.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(o.EXTENT,0),g.emplaceBack(0,o.EXTENT),g.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=r.createVertexBuffer(g,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const v=new o.StructArrayLayout2i4;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(v,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const b=new o.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(o.EXTENT,0,o.EXTENT,0),b.emplaceBack(0,o.EXTENT,0,o.EXTENT),b.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(b,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const M=new o.StructArrayLayout3ui6;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(M);const P=new o.StructArrayLayout1ui2;for(const N of[0,1,3,2,0])P.emplaceBack(N);this.debugIndexBuffer=r.createIndexBuffer(P),this.emptyTexture=new o.Texture(r,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=o.create();const L=this.context.gl;this.stencilClearMode=new o.StencilMode({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new Du(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,u=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,u.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,Su(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,u,g){if(!u||this.currentStencilSource===u.id||!r.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let P=!1;for(const L of g)if(this._tileClippingMaskIDs[L.key]===void 0){P=!0;break}if(!P)return}this.currentStencilSource=u.id;const v=this.context,b=v.gl;this.nextStencilID+g.length>256&&this.clearStencil(),v.setColorMode(o.ColorMode.disabled),v.setDepthMode(o.DepthMode.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of g){const L=u.getTile(P),N=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,{tileBoundsBuffer:F,tileBoundsIndexBuffer:W,tileBoundsSegments:ie}=this.getTileBoundsBuffers(L);M.draw(v,b.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:b.ALWAYS,mask:0},N,255,b.KEEP,b.KEEP,b.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Su(P.projMatrix),"$clipping",F,W,ie)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,u=this.context.gl;return new o.StencilMode({func:u.NOTEQUAL,mask:255},r,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const u=this.context.gl;return new o.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(r){const u=this.context.gl,g=r.sort((M,P)=>P.overscaledZ-M.overscaledZ),v=g[g.length-1].overscaledZ,b=g[0].overscaledZ-v+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const M={};for(let P=0;P<b;P++)M[P+v]=new o.StencilMode({func:u.GEQUAL,mask:255},P+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[M,g]}return[{[v]:o.StencilMode.disabled},g]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([r.CONSTANT_COLOR,r.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(r,u,g){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new o.DepthMode(g||this.context.gl.LEQUAL,u,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,u){this.style=r,this.options=u,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const g=this.style.order,v=this.style._sourceCaches;for(const N in v){const F=v[N];F.used&&F.prepare(this.context)}const b={},M={},P={};for(const N in v){const F=v[N];b[N]=F.getVisibleCoordinates(),M[N]=b[N].slice().reverse(),P[N]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let N=0;N<g.length;N++)if(this.style._layers[g[N]].is3D()){this.opaquePassCutoff=N;break}if(this.terrain&&(this.terrain.updateTileBinding(P),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),!o.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const N of g){const F=this.style._layers[N],W=r._getLayerSourceCache(F);if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const ie=W?M[W.id]:void 0;(F.type==="custom"||F.isSky()||ie&&ie.length)&&this.renderLayer(this,W,F,ie)}this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon];const L=this.terrain;if(L&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&L.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:u.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const N=this.style._layers[g[this.currentLayer]],F=r._getLayerSourceCache(N);if(N.isSky())continue;const W=F?M[F.id]:void 0;this._renderTileClippingMasks(N,F,W),this.renderLayer(this,F,N,W)}if(this.style.fog&&this.transform.projection.supportsFog&&function(N,F){const W=N.context,ie=W.gl,ae=N.transform,ue=new o.DepthMode(ie.LEQUAL,o.DepthMode.ReadOnly,[0,1]),le=N.useProgram("globeAtmosphere",null,ae.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),he=o.globeToMercatorTransition(ae.zoom),X=F.properties.get("color").toArray01(),se=F.properties.get("high-color").toArray01(),ge=F.properties.get("space-color").toArray01PremultipliedAlpha(),ve=o.identity$1([]);o.rotateY$1(ve,ve,-o.degToRad(ae._center.lng)),o.rotateX$1(ve,ve,o.degToRad(ae._center.lat)),o.rotateZ$1(ve,ve,ae.angle),o.rotateX$1(ve,ve,-ae._pitch);const Pe=o.fromQuat(new Float32Array(16),ve),Re=o.mapValue(F.properties.get("star-intensity"),0,1,0,.25),Ie=5e-4,Ne=o.mapValue(F.properties.get("horizon-blend"),0,1,Ie,.25),Fe=o.globeUseCustomAntiAliasing(N,W,ae)&&Ne===Ie?ae.worldSize/(2*Math.PI*1.025)-1:ae.globeRadius,He=N.frameCounter/1e3%1,vt=o.length(ae.globeCenterInViewSpace),qe=Math.sqrt(Math.pow(vt,2)-Math.pow(Fe,2)),nt=Math.acos(qe/vt),Xe=((Ze,rt,mt,ht,wt,Jt,dn,Zt,on,Pn,Dn,Qt,Un,nr)=>({u_frustum_tl:Ze,u_frustum_tr:rt,u_frustum_br:mt,u_frustum_bl:ht,u_horizon:wt,u_transition:Jt,u_fadeout_range:dn,u_color:Zt,u_high_color:on,u_space_color:Pn,u_star_intensity:Dn,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Qt,u_horizon_angle:Un,u_rotation_matrix:nr}))(ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.frustumCorners.horizon,he,Ne,X,se,ge,Re,He,nt,Pe);N.prepareDrawProgram(W,le);const yt=N.atmosphereBuffer;yt&&le.draw(W,ie.TRIANGLES,ue,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,Xe,"skybox",yt.vertexBuffer,yt.indexBuffer,yt.segments)}(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const N=this.style._layers[g[this.currentLayer]],F=r._getLayerSourceCache(N);N.isSky()&&this.renderLayer(this,F,N,F?M[F.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;){const N=this.style._layers[g[this.currentLayer]],F=r._getLayerSourceCache(N);if(N.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(N)){if(N.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const W=F?(N.type==="symbol"?P:M)[F.id]:void 0;this._renderTileClippingMasks(N,F,F?b[F.id]:void 0),this.renderLayer(this,F,N,W),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let N=null;o.values(this.style._layers).forEach(F=>{const W=r._getLayerSourceCache(F);W&&!F.isHidden(this.transform.zoom)&&(!N||N.getSource().maxzoom<W.getSource().maxzoom)&&(N=W)}),N&&this.options.showTileBoundaries&&ma.debug(this,N,N.getVisibleCoordinates())}this.options.showPadding&&function(N){const F=N.transform.padding;Ha(N,N.transform.height-(F.top||0),3,Za),Ha(N,F.bottom||0,3,jd),Il(N,F.left||0,3,Vd),Il(N,N.transform.width-(F.right||0),3,jh);const W=N.transform.centerPoint;(function(ie,ae,ue,le){Es(ie,ae-1,ue-10,2,20,le),Es(ie,ae-10,ue-1,20,2,le)})(N,W.x,N.transform.height-W.y,ap)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}renderLayer(r,u,g,v){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||v&&v.length)&&(this.id=g.id,this.gpuTimingStart(g),(!r.transform.projection.unsupportedLayers||!r.transform.projection.unsupportedLayers.includes(g.type)||r.terrain&&g.type==="custom")&&ma[g.type](r,u,g,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let g=this.gpuTimers[r.id];g||(g=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),g.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,g.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,u=r.createQueryEXT();this.deferredRenderGpuTimeQueries.push(u),r.beginQueryEXT(r.TIME_ELAPSED_EXT,u)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const u={};for(const g in r){const v=r[g],b=this.context.extTimerQuery,M=b.getQueryObjectEXT(v.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(v.query),u[g]=M}return u}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.extTimerQuery;let g=0;for(const v of r)g+=u.getQueryObjectEXT(v,u.QUERY_RESULT_EXT)/1e6,u.deleteQueryEXT(v);return g}translatePosMatrix(r,u,g,v,b){if(!g[0]&&!g[1])return r;const M=b?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(M){const N=Math.sin(M),F=Math.cos(M);g=[g[0]*F-g[1]*N,g[0]*N+g[1]*F]}const P=[b?g[0]:Ue(u,g[0],this.transform.zoom),b?g[1]:Ue(u,g[1],this.transform.zoom),0],L=new Float32Array(16);return o.translate(L,r,P),L}saveTileTexture(r){const u=this._tileTextures[r.size[0]];u?u.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const u=this._tileTextures[r];return u&&u.length>0?u.pop():null}isPatternMissing(r){return r===null||r!==void 0&&!this.imageManager.getPattern(r.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,u=this.terrain&&this.terrain.exaggeration()===0,g=this.style&&this.style.fog,v=[];return this.terrainRenderModeElevated()&&v.push("TERRAIN"),this.transform.projection.name==="globe"&&v.push("GLOBE"),u&&v.push("ZERO_EXAGGERATION"),g&&!r&&g.getOpacity(this.transform.pitch)!==0&&v.push("FOG"),r&&v.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&v.push("OVERDRAW_INSPECTOR"),v}useProgram(r,u,g){this.cache=this.cache||{};const v=g||[],b=this.currentGlobalDefines().concat(v),M=Zn.cacheKey(Eu[r],r,b,u);return this.cache[M]||(this.cache[M]=new Zn(this.context,r,Eu[r],u,Iu[r],b)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(r,u,g){if(this.terrain&&this.terrain.renderingToTexture)return;const v=this.style.fog;if(v){const b=v.getOpacity(this.transform.pitch),M=((P,L,N,F,W,ie,ae,ue,le,he,X)=>{const se=P.transform,ge=L.properties.get("color").toArray01();ge[3]=F;const ve=P.frameCounter/1e3%1;return{u_fog_matrix:N?se.calculateFogTileMatrix(N):P.identityMat,u_fog_range:L.getFovAdjustedRange(se._fov),u_fog_color:ge,u_fog_horizon_blend:L.properties.get("horizon-blend"),u_fog_temporal_offset:ve,u_frustum_tl:W,u_frustum_tr:ie,u_frustum_br:ae,u_frustum_bl:ue,u_globe_pos:le,u_globe_radius:he,u_viewport:X,u_globe_transition:o.globeToMercatorTransition(se.zoom),u_is_globe:+(se.projection.name==="globe")}})(this,v,g,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);u.setFogUniformValues(r,M)}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,u=r.createTexture();return r.bindTexture(r.TEXTURE_2D,u),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const v of g)u[v.key]=r[v.key]||new o.Tile(v,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class zu{constructor(r=0,u=0,g=0,v=0){if(isNaN(r)||r<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=u,this.left=g,this.right=v}interpolate(r,u,g){return u.top!=null&&r.top!=null&&(this.top=o.number(r.top,u.top,g)),u.bottom!=null&&r.bottom!=null&&(this.bottom=o.number(r.bottom,u.bottom,g)),u.left!=null&&r.left!=null&&(this.left=o.number(r.left,u.left,g)),u.right!=null&&r.right!=null&&(this.right=o.number(r.right,u.right,g)),this}getCenter(r,u){const g=o.clamp((this.left+r-this.right)/2,0,r),v=o.clamp((this.top+u-this.bottom)/2,0,u);return new o.Point(g,v)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new zu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ou(f,r){const u=o.getColumn(f,3);o.fromQuat(f,r),o.setColumn(f,3,u)}function Kn(f,r){const u=o.identity$1([]);return o.rotateZ$1(u,u,-r),o.rotateX$1(u,u,-f),u}function Ll(f,r){const u=[f[0],f[1],0],g=[r[0],r[1],0];if(o.length(u)>=1e-15){const M=o.normalize([],u);o.scale$2(g,M,o.dot(g,M)),r[0]=g[0],r[1]=g[1]}const v=o.cross([],r,f);if(o.len(v)<1e-15)return null;const b=Math.atan2(-v[1],v[0]);return Kn(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),b)}class $s{constructor(r,u){this.position=r,this.orientation=u}get position(){return this._position}set position(r){if(r){const u=r instanceof o.MercatorCoordinate?r:new o.MercatorCoordinate(r[0],r[1],r[2]);this._renderWorldCopies&&(u.x=o.wrap(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(r,u){if(this.orientation=null,!this.position)return;const g=this.position,v=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(r)):0,b=o.MercatorCoordinate.fromLngLat(r,v),M=[b.x-g.x,b.y-g.y,b.z-g.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=Ll(M,u)}setPitchBearing(r,u){this.orientation=Kn(o.degToRad(r),o.degToRad(-u))}}class Dl{constructor(r,u){this._transform=o.identity([]),this.orientation=u,this.position=r}get mercatorPosition(){const r=this.position;return new o.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=o.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var u;r&&o.setColumn(this._transform,3,[(u=r)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||o.identity$1([]),r&&Ou(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,u){this._orientation=Kn(r,u),Ou(this._transform,this._orientation)}forward(){const r=o.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=o.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=o.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,u){const g=new Float64Array(16);return o.invert(g,this.getWorldToCamera(r,u)),g}getWorldToCameraPosition(r,u,g){const v=this.position;o.scale$2(v,v,-r);const b=new Float64Array(16);return o.fromScaling(b,[g,g,g]),o.translate(b,b,v),b[10]*=u,b}getWorldToCamera(r,u){const g=new Float64Array(16),v=new Float64Array(4),b=this.position;return o.conjugate(v,this._orientation),o.scale$2(b,b,-r),o.fromQuat(g,v),o.translate(g,g,b),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(r,u,g,v){const b=new Float64Array(16);return o.perspective(b,r,u,g,v),b}getDistanceToElevation(r,u=!1){const g=r===0?0:o.mercatorZfromAltitude(r,u?o.latFromMercatorY(this.position[1]):this.position[1]),v=this.forward();return(g-this.position[2])/v[2]}clone(){return new Dl([...this.position],[...this.orientation])}}function ga(f,r){const u=Ic(f.projection,f.zoom,f.width,f.height),g=function(b,M,P,L,N){const F=new o.LngLat(P.lng-180*To,P.lat),W=new o.LngLat(P.lng+180*To,P.lat),ie=b.project(F.lng,F.lat),ae=b.project(W.lng,W.lat),ue=-Math.atan2(ae.y-ie.y,ae.x-ie.x),le=o.MercatorCoordinate.fromLngLat(P);le.y=o.clamp(le.y,-1+To,1-To);const he=le.toLngLat(),X=b.project(he.lng,he.lat),se=o.MercatorCoordinate.fromLngLat(he);se.x+=To;const ge=se.toLngLat(),ve=b.project(ge.lng,ge.lat),Pe=Bu(ve.x-X.x,ve.y-X.y,ue),Re=o.MercatorCoordinate.fromLngLat(he);Re.y+=To;const Ie=Re.toLngLat(),Ne=b.project(Ie.lng,Ie.lat),Fe=Bu(Ne.x-X.x,Ne.y-X.y,ue),He=Math.abs(Pe.x)/Math.abs(Fe.y),vt=o.identity([]);o.rotateZ(vt,vt,-ue*(1-(N?0:L)));const qe=o.identity([]);return o.scale(qe,qe,[1,1-(1-He)*L,1]),qe[4]=-Fe.x/Fe.y*L,o.rotateZ(qe,qe,ue),o.multiply(qe,vt,qe),qe}(f.projection,0,f.center,u,r),v=Ud(f);return o.scale(g,g,[v,v,1]),g}function Ud(f){const r=f.projection,u=Ic(f.projection,f.zoom,f.width,f.height),g=$d(r,f.center),v=$d(r,o.LngLat.convert(r.center));return Math.pow(2,g*u+(1-u)*v)}function Ic(f,r,u,g,v=1/0){const b=f.range;if(!b)return 0;const M=Math.min(v,Math.max(u,g)),P=Math.log(M/1024)/Math.LN2;return o.smoothstep(b[0]+P,b[1]+P,r)}const To=1/4e4;function $d(f,r){const u=o.clamp(r.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),g=new o.LngLat(r.lng-180*To,u),v=new o.LngLat(r.lng+180*To,u),b=f.project(g.lng,u),M=f.project(v.lng,u),P=o.MercatorCoordinate.fromLngLat(g),L=o.MercatorCoordinate.fromLngLat(v),N=M.x-b.x,F=M.y-b.y,W=L.x-P.x,ie=L.y-P.y,ae=Math.sqrt((W*W+ie*ie)/(N*N+F*F));return Math.log(ae)/Math.LN2}function Bu(f,r,u){const g=Math.cos(u),v=Math.sin(u);return{x:f*g-r*v,y:f*v+r*g}}class Ka{constructor(r,u,g,v,b,M,P){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=r||0,this._maxZoom=u||22,this._minPitch=g??0,this._maxPitch=v??60,this.setProjection(M),this.setMaxBounds(P),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new zu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Dl,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const r=new Ka(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(r,u=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(r||g)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const g=!I(u,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.getProjection({name:"mercator"});const u=r!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.Point(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const u=-r*Math.PI/180;var g;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(g=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),function(v,b,M){var P=b[0],L=b[1],N=b[2],F=b[3],W=Math.sin(M),ie=Math.cos(M);v[0]=P*ie+N*W,v[1]=L*ie+F*W,v[2]=P*-W+N*ie,v[3]=L*-W+F*ie}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const u=o.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=o.degToRad(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const u=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;this._centerAltitude=r.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=r.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let v=0,b=0;for(let M=0;M<u.length;M++){const P=new o.Point(u[M][0]*this.width,g+u[M][1]*(this.height-g)),L=r.pointCoordinate(P);if(!L)continue;const N=1/Math.hypot(L[0]-this._camera.position[0],L[1]-this._camera.position[1]);v+=L[3]*N,b+=N}return b===0?NaN:v/b}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,v=this._mercatorZfromZoom(r),b=this._mercatorZfromZoom(this._maxZoom),M=Math.max(v-g,b);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let g;g=r.z<this._camera.position[2]?[u.x,u.y,u.z]:[r.x,r.y,r.z];const v=o.length(o.sub([],this._camera.position,g));return o.clamp(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let u=!1;if(r.orientation&&!o.exactEquals(r.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(r.orientation)),r.position){const g=[r.position.x,r.position.y,r.position.z];o.exactEquals$1(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,u=new $s;return u.position=new o.MercatorCoordinate(r[0],r[1],r[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(r){if(!o.length$1(r))return!1;o.normalize$1(r,r);const u=o.transformQuat([],[0,0,-1],r),g=o.transformQuat([],[0,-1,0],r);if(g[2]<0)return!1;const v=Ll(u,g);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(r){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;r[2]=o.clamp(r[2],v/g,v/u),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,u,g){this._unmodified=!1,this._edgeInsets.interpolate(r,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const u=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(r){const u=[new o.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const g=this.pointCoordinate(new o.Point(0,0)),v=this.pointCoordinate(new o.Point(this.width,0)),b=this.pointCoordinate(new o.Point(this.width,this.height)),M=this.pointCoordinate(new o.Point(0,this.height)),P=Math.floor(Math.min(g.x,v.x,b.x,M.x)),L=Math.floor(Math.max(g.x,v.x,b.x,M.x)),N=1;for(let F=P-N;F<=L+N;F++)F!==0&&u.push(new o.UnwrappedTileID(F,r))}return u}coveringTiles(r){let u=this.coveringZoomLevel(r);const g=u,v=this.elevation&&!r.isTerrainDEM,b=this.projection.name==="mercator";if(r.minzoom!==void 0&&u<r.minzoom)return[];r.maxzoom!==void 0&&u>r.maxzoom&&(u=r.maxzoom);const M=this.locationCoordinate(this.center),P=this.center.lat,L=1<<u,N=[L*M.x,L*M.y,0],F=this.projection.name==="globe",W=!F,ie=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,W),ae=F?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ue=L*o.mercatorZfromAltitude(1,this.center.lat),le=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),he=[L*ae.x,L*ae.y,le*(W?1:ue)],X=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),se=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,ge=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ve=r.isTerrainDEM?-ge:this._elevation?this._elevation.getMinElevationBelowMSL():0,Pe=this.projection.isReprojectedInTileSpace?Ud(this):1,Re=Ze=>{const mt=new o.MercatorCoordinate(Ze.x+25e-6,Ze.y,Ze.z),ht=new o.MercatorCoordinate(Ze.x,Ze.y+25e-6,Ze.z),wt=Ze.toLngLat(),Jt=mt.toLngLat(),dn=ht.toLngLat(),Zt=this.locationCoordinate(wt),on=this.locationCoordinate(Jt),Pn=this.locationCoordinate(dn),Dn=Math.hypot(on.x-Zt.x,on.y-Zt.y),Qt=Math.hypot(Pn.x-Zt.x,Pn.y-Zt.y);return Math.sqrt(Dn*Qt)*Pe/25e-6},Ie=Ze=>{const rt=ge,mt=ve;return{aabb:o.tileAABB(this,L,0,0,0,Ze,mt,rt,this.projection),zoom:0,x:0,y:0,minZ:mt,maxZ:rt,wrap:Ze,fullyVisible:!1}},Ne=[];let Fe=[];const He=u,vt=r.reparseOverscaled?g:u,qe=Ze=>Ze*Ze,nt=qe((le-this._centerAltitude)*ue),Xe=Ze=>{if(!this._elevation||!Ze.tileID||!b)return;const rt=this._elevation.getMinMaxForTile(Ze.tileID),mt=Ze.aabb;rt?(mt.min[2]=rt.min,mt.max[2]=rt.max,mt.center[2]=(mt.min[2]+mt.max[2])/2):(Ze.shouldSplit=yt(Ze),Ze.shouldSplit||(mt.min[2]=mt.max[2]=mt.center[2]=this._centerAltitude))},yt=Ze=>{if(Ze.zoom<se)return!0;if(Ze.zoom===He)return!1;if(Ze.shouldSplit!=null)return Ze.shouldSplit;const rt=Ze.aabb.distanceX(he),mt=Ze.aabb.distanceY(he);let ht=nt,wt=1;if(F){ht=qe(Ze.aabb.distanceZ(he));const Zt=Math.pow(2,Ze.zoom),on=o.latFromMercatorY((Ze.y+1)/Zt),Pn=o.latFromMercatorY(Ze.y/Zt),Dn=Math.min(Math.max(P,on),Pn),Qt=o.circumferenceAtLatitude(Dn)/o.circumferenceAtLatitude(P);if(wt=Dn===P?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Qt/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&Ze.zoom===He-1&&Qt>=.9)return!0}else if(v&&(ht=qe(Ze.aabb.distanceZ(he)*ue)),this.projection.isReprojectedInTileSpace&&g<=5){const Zt=Math.pow(2,Ze.zoom),on=Re(new o.MercatorCoordinate((Ze.x+.5)/Zt,(Ze.y+.5)/Zt));wt=on>.85?1:on}const Jt=rt*rt+mt*mt+ht,dn=qe((1<<He-Ze.zoom)*X*wt*((Zt,on)=>{if(on*qe(.707)<Zt)return 1;const Pn=Math.sqrt(on/Zt);return Pn/(1.4144271570014144+(Math.pow(1.1,Pn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ht,nt),Jt));return Jt<dn};if(this.renderWorldCopies)for(let Ze=1;Ze<=3;Ze++)Ne.push(Ie(-Ze)),Ne.push(Ie(Ze));for(Ne.push(Ie(0));Ne.length>0;){const Ze=Ne.pop(),rt=Ze.x,mt=Ze.y;let ht=Ze.fullyVisible;if(!ht){const wt=Ze.aabb.intersects(ie);if(wt===0)continue;ht=wt===2}if(Ze.zoom!==He&&yt(Ze))for(let wt=0;wt<4;wt++){const Jt=(rt<<1)+wt%2,dn=(mt<<1)+(wt>>1),Zt={aabb:b?Ze.aabb.quadrant(wt):o.tileAABB(this,L,Ze.zoom+1,Jt,dn,Ze.wrap,Ze.minZ,Ze.maxZ,this.projection),zoom:Ze.zoom+1,x:Jt,y:dn,wrap:Ze.wrap,fullyVisible:ht,tileID:void 0,shouldSplit:void 0,minZ:Ze.minZ,maxZ:Ze.maxZ};v&&!F&&(Zt.tileID=new o.OverscaledTileID(Ze.zoom+1===He?vt:Ze.zoom+1,Ze.wrap,Ze.zoom+1,Jt,dn),Xe(Zt)),Ne.push(Zt)}else{const wt=Ze.zoom===He?vt:Ze.zoom;if(r.minzoom&&r.minzoom>wt)continue;const Jt=N[0]-(.5+rt+(Ze.wrap<<Ze.zoom))*(1<<u-Ze.zoom),dn=N[1]-.5-mt,Zt=Ze.tileID?Ze.tileID:new o.OverscaledTileID(wt,Ze.wrap,Ze.zoom,rt,mt);Fe.push({tileID:Zt,distanceSq:Jt*Jt+dn*dn})}}if(this.fogCullDistSq){const Ze=this.fogCullDistSq,rt=this.horizonLineFromTop();Fe=Fe.filter(mt=>{const ht=[0,0,0,1],wt=[o.EXTENT,o.EXTENT,0,1],Jt=this.calculateFogTileMatrix(mt.tileID.toUnwrapped());o.transformMat4$1(ht,ht,Jt),o.transformMat4$1(wt,wt,Jt);const dn=o.getAABBPointSquareDist(ht,wt);if(dn===0)return!0;let Zt=!1;const on=this._elevation;if(on&&dn>Ze&&rt!==0){const Pn=this.calculateProjMatrix(mt.tileID.toUnwrapped());let Dn;r.isTerrainDEM||(Dn=on.getMinMaxForTile(mt.tileID)),Dn||(Dn={min:ve,max:ge});const Qt=o.furthestTileCorner(this.rotation),Un=[Qt[0]*o.EXTENT,Qt[1]*o.EXTENT,Dn.max];o.transformMat4(Un,Un,Pn),Zt=(1-Un[1])*this.height*.5<rt}return dn<Ze||Zt})}return Fe.sort((Ze,rt)=>Ze.distanceSq-rt.distanceSq).map(Ze=>Ze.tileID)}resize(r,u){this.width=r,this.height=u,this.pixelsToGLUnits=[2/r,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const u=o.clamp(r.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),g=this.projection.project(r.lng,u);return new o.Point(g.x*this.worldSize,g.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,u){let g,v;const b=this.centerPoint;if(this.projection.name==="globe"){const P=this.worldSize;g=(u.x-b.x)/P,v=(u.y-b.y)/P}else{const P=this.pointCoordinate(u),L=this.pointCoordinate(b);g=P.x-L.x,v=P.y-L.y}const M=this.locationCoordinate(r);this.setLocation(new o.MercatorCoordinate(M.x-g,M.y-v))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,u){const g=u?o.mercatorZfromAltitude(u,r.lat):void 0,v=this.projection.project(r.lng,r.lat);return new o.MercatorCoordinate(v.x,v.y,g)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,u){const g=u??this._centerAltitude,v=[r.x,r.y,0,1],b=[r.x,r.y,1,1];o.transformMat4$1(v,v,this.pixelMatrixInverse),o.transformMat4$1(b,b,this.pixelMatrixInverse);const M=b[3];o.scale$1(v,v,1/v[3]),o.scale$1(b,b,1/M);const P=v[2],L=b[2];return{p0:v,p1:b,t:P===L?0:(g-P)/(L-P)}}screenPointToMercatorRay(r){const u=[r.x,r.y,0,1],g=[r.x,r.y,1,1];return o.transformMat4$1(u,u,this.pixelMatrixInverse),o.transformMat4$1(g,g,this.pixelMatrixInverse),o.scale$1(u,u,1/u[3]),o.scale$1(g,g,1/g[3]),u[2]=o.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,g[2]=o.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,o.scale$1(u,u,1/this.worldSize),o.scale$1(g,g,1/this.worldSize),new o.Ray([u[0],u[1],u[2]],o.normalize([],o.sub([],g,u)))}rayIntersectionCoordinate(r){const{p0:u,p1:g,t:v}=r,b=o.mercatorZfromAltitude(u[2],this._center.lat),M=o.mercatorZfromAltitude(g[2],this._center.lat);return new o.MercatorCoordinate(o.number(u[0],g[0],v)/this.worldSize,o.number(u[1],g[1],v)/this.worldSize,o.number(b,M,v))}pointCoordinate(r,u=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,u)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let u=this.projection.pointCoordinate3D(this,r.x,r.y);if(u)return new o.MercatorCoordinate(u[0],u[1],u[2]);let g=0,v=this.horizonLineFromTop();if(r.y>v)return this.pointCoordinate(r);const b=.02*v,M=r.clone();for(let P=0;P<10&&v-g>b;P++){M.y=o.number(g,v,.66);const L=this.projection.pointCoordinate3D(this,M.x,M.y);L?(v=M.y,u=L):g=M.y}return u?new o.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(r);const u=this.pointCoordinate(r);return u.y>=0&&u.y<=1}_coordinatePoint(r,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,v=[r.x*this.worldSize,r.y*this.worldSize,g+r.toAltitude(),1];return o.transformMat4$1(v,v,this.pixelMatrix),v[3]>0?new o.Point(v[0]/v[3],v[1]/v[3]):new o.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:u}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,v=this.width-this._edgeInsets.right,b=this.pointLocation3D(new o.Point(u,r)),M=this.pointLocation3D(new o.Point(v,r)),P=this.pointLocation3D(new o.Point(v,g)),L=this.pointLocation3D(new o.Point(u,g));let N=Math.min(b.lng,M.lng,P.lng,L.lng),F=Math.max(b.lng,M.lng,P.lng,L.lng),W=Math.min(b.lat,M.lat,P.lat,L.lat),ie=Math.max(b.lat,M.lat,P.lat,L.lat);const ae=Math.pow(2,-this.zoom)/16*270,ue=this.projection.name==="globe"?1:4,le=(he,X,se,ge,ve)=>{const Pe=(he+se)/2,Re=(X+ge)/2,Ie=new o.Point(Pe,Re),{lng:Ne,lat:Fe}=this.pointLocation3D(Ie),He=Math.max(0,N-Ne,W-Fe,Ne-F,Fe-ie);N=Math.min(N,Ne),F=Math.max(F,Ne),W=Math.min(W,Fe),ie=Math.max(ie,Fe),(ve<ue||He>ae)&&(le(he,X,Pe,Re,ve+1),le(Pe,Re,se,ge,ve+1))};if(le(u,r,v,r,1),le(v,r,v,g,1),le(v,g,u,g,1),le(u,g,u,r,1),this.projection.name==="globe"){const[he,X]=o.polesInViewport(this);he?(ie=90,F=180,N=-180):X&&(W=-90,F=180,N=-180)}return new o.LngLatBounds(new o.LngLat(N,W),new o.LngLat(F,ie))}_getBoundsRectangular(r,u){const{top:g,left:v}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,M=this.width-this._edgeInsets.right,P=new o.Point(v,g),L=new o.Point(M,g),N=new o.Point(M,b),F=new o.Point(v,b);let W=this.pointCoordinate(P,r),ie=this.pointCoordinate(L,r);const ae=this.pointCoordinate(N,u),ue=this.pointCoordinate(F,u),le=(he,X)=>(X.y-he.y)/(X.x-he.x);return W.y>1&&ie.y>=0?W=new o.MercatorCoordinate((1-ue.y)/le(ue,W)+ue.x,1):W.y<0&&ie.y<=1&&(W=new o.MercatorCoordinate(-ue.y/le(ue,W)+ue.x,0)),ie.y>1&&W.y>=0?ie=new o.MercatorCoordinate((1-ae.y)/le(ae,ie)+ae.x,1):ie.y<0&&W.y<=1&&(ie=new o.MercatorCoordinate(-ae.y/le(ae,ie)+ae.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(W)).extend(this.coordinateLocation(ie)).extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=r.visibleDemTiles.reduce((g,v)=>{if(v.dem){const b=v.dem.tree;g.min=Math.min(g.min,b.minimums[0]),g.max=Math.max(g.max,b.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*r.exaggeration(),u.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return r?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,u){return this.projection.createTileMatrix(this,u,r)}calculateDistanceTileData(r){const u=r.key,g=this._distanceTileDataCache;if(g[u])return g[u];const v=r.canonical,b=1/this.height,M=this.cameraWorldSize,P=M/this.zoomScale(v.z),L=(v.x+Math.pow(2,v.z)*r.wrap)*P,N=v.y*P,F=this.point;F.x*=M/this.worldSize,F.y*=M/this.worldSize;const W=this.angle,ie=Math.sin(-W),ae=-Math.cos(-W);return g[u]={bearing:[ie,ae],center:[(F.x-L)*b,(F.y-N)*b],scale:P/o.EXTENT*b},g[u]}calculateFogTileMatrix(r){const u=r.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const v=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return o.multiply(v,this.worldToFogMatrix,v),g[u]=new Float32Array(v),g[u]}calculateProjMatrix(r,u=!1){const g=r.key,v=u?this._alignedProjMatrixCache:this._projMatrixCache;if(v[g])return v[g];const b=this.calculatePosMatrix(r,this.worldSize);return o.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,b),v[g]=new Float32Array(b),v[g]}calculatePixelsToTileUnitsMatrix(r){const u=r.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const v=function(b,M){const{scale:P}=b.tileTransform,L=P*o.EXTENT/(b.tileSize*Math.pow(2,M.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return N=new Float32Array(4),ie=(F=M.inverseAdjustmentMatrix)[1],ae=F[2],ue=F[3],he=(W=[L,L])[1],N[0]=F[0]*(le=W[0]),N[1]=ie*le,N[2]=ae*he,N[3]=ue*he,N;var N,F,W,ie,ae,ue,le,he}(r,this);return g[u]=v,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,u=o.fromScaling([],[r,r,r]);return o.multiply(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const u=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),v=this._camera.forward(),b=o.mercatorZfromAltitude(1,this._center.lat);g[2]/=b,v[2]/=b,o.normalize(v,v);const M=r.raycast(g,v,r.exaggeration());if(M){const P=o.scaleAndAdd([],g,v,M),L=new o.MercatorCoordinate(P[0],P[1],o.mercatorZfromAltitude(P[2],o.latFromMercatorY(P[1]))),N=(L.z+o.length([L.x-g[0],L.y-g[1],L.z-g[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(N),this._centerAltitude=L.toAltitude(),this._center=this.coordinateLocation(L),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const u=this._elevation,g=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(g),b=u.getAtPointOrZero(new o.MercatorCoordinate(...v)),M=this.pixelsPerMeter/this.worldSize*b,P=this._minimumHeightOverTerrain(),L=v[2]-M;if(L<=P)if(L<0||r){const N=this.locationCoordinate(this._center,this._centerAltitude),F=[v[0],v[1],N.z-v[2]],W=o.length(F);F[2]-=(P-L)/this._pixelsPerMercatorPixel;const ie=o.length(F);if(ie===0)return;o.scale$2(F,F,W/ie*this._pixelsPerMercatorPixel),this._camera.position=[v[0],v[1],N.z*this._pixelsPerMercatorPixel-F[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const ie=this.center;return ie.lat=o.clamp(ie.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(ie.lng=o.clamp(ie.lng,this.minLng,this.maxLng)),this.center=ie,void(this._constraining=!1)}const u=this._unmodified,{x:g,y:v}=this.point;let b=0,M=g,P=v;const L=this.width/2,N=this.height/2,F=this.worldMinY*this.scale,W=this.worldMaxY*this.scale;if(v-N<F&&(P=F+N),v+N>W&&(P=W-N),W-F<this.height&&(b=Math.max(b,this.height/(W-F)),P=(W+F)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ie=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,ue=this.worldSize/2-(ie+ae)/2;M=(g+ue+this.worldSize)%this.worldSize-ue,M-L<ie&&(M=ie+L),M+L>ae&&(M=ae-L),ae-ie<this.width&&(b=Math.max(b,this.width/(ae-ie)),M=(ae+ie)/2)}M===g&&P===v||(this.center=this.unproject(new o.Point(M,P))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,u=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.mercatorZfromAltitude(1,this.center.lat)/o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE));const g=Ic(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,g),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const v=this.projection.zAxisUnit==="meters"?u:1,b=this._camera.getWorldToCamera(this.worldSize,v),M=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);M[8]=2*-r.x/this.width,M[9]=2*r.y/this.height;let P=o.mul([],M,b);if(this.projection.isReprojectedInTileSpace){const Re=this.locationCoordinate(this.center),Ie=o.identity([]);o.translate(Ie,Ie,[Re.x*this.worldSize,Re.y*this.worldSize,0]),o.multiply(Ie,Ie,ga(this)),o.translate(Ie,Ie,[-Re.x*this.worldSize,-Re.y*this.worldSize,0]),o.multiply(P,P,Ie),this.inverseAdjustmentMatrix=function(Ne){const Fe=ga(Ne,!0);return Y([],[Fe[0],Fe[1],Fe[4],Fe[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],P,[this.worldSize,this.worldSize,this.worldSize/v,1]),this.projMatrix=P,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const L=o.invert([],M);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(L,this.horizonLineFromTop(),this.height);const N=new Float32Array(16);o.identity(N),o.scale(N,N,[1,-1,1]),o.rotateX(N,N,this._pitch),o.rotateZ(N,N,this.angle);const F=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),W=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;F[8]=2*-r.x/this.width,F[9]=2*(r.y+W)/this.height,this.skyboxMatrix=o.multiply(N,F,N);const ie=this.point,ae=ie.x,ue=ie.y,le=this.width%2/2,he=this.height%2/2,X=Math.cos(this.angle),se=Math.sin(this.angle),ge=ae-Math.round(ae)+X*le+se*he,ve=ue-Math.round(ue)+X*he+se*le,Pe=new Float64Array(P);if(o.translate(Pe,Pe,[ge>.5?ge-1:ge,ve>.5?ve-1:ve,0]),this.alignedProjMatrix=Pe,P=o.create(),o.scale(P,P,[this.width/2,-this.height/2,1]),o.translate(P,P,[1,-1,0]),this.labelPlaneMatrix=P,P=o.create(),o.scale(P,P,[1,-1,1]),o.translate(P,P,[-1,-1,0]),o.scale(P,P,[2/this.width,2/this.height,1]),this.glCoordMatrix=P,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},P=o.invert(new Float64Array(16),this.pixelMatrix),!P)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=P,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const Re=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(Re,Re,b),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=P;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,g=this._camera.position,v=1/this.height/this._pixelsPerMercatorPixel,b=[r,r,u];o.scale$2(b,b,v),o.scale$2(g,g,-1),o.multiply$2(g,g,b);const M=o.create();o.translate(M,M,g),o.scale(M,M,b),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,u,v)}_computeCameraPosition(r){const u=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),v=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-r/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-g[0]*b,v.y/this.worldSize-g[1]*b,r/this.worldSize*this._centerAltitude-g[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],v=r[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),v>0&&(b=Math.min((u-g)/v,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,r,b),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:v}=this._camera.getPitchBearing(),b=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),P=Math.max((r[2]-b)/Math.cos(g),M),L=this._zoomFromMercatorZ(P);o.scaleAndAdd(r,r,u,P),this._pitch=o.clamp(g,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(v,-Math.PI,Math.PI),this._setZoom(o.clamp(L,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let u=0,g=o.GLOBE_ZOOM_THRESHOLD_MAX,v=0,b=1/0;for(;g-u>1e-6&&g>u;){const M=u+.5*(g-u),P=this.tileSize*Math.pow(2,M),L=this.getCameraToCenterDistance(this.projection,M,P),N=this.scaleZoom(L/(r*this.tileSize)),F=Math.abs(M-N);F<b&&(b=F,v=M),M<N?u=M:g=M}return v}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,u){const g=Math.min(r.x,u.x),v=Math.max(r.x,u.x),b=Math.min(r.y,u.y),M=Math.max(r.y,u.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const P=[new o.Point(g,b),new o.Point(v,M),new o.Point(g,M),new o.Point(v,b)],L=this.renderWorldCopies?-3:0,N=this.renderWorldCopies?4:1;for(const F of P){const W=this.pointRayIntersection(F);if(W.t<0)return!0;const ie=this.rayIntersectionCoordinate(W);if(ie.x<L||ie.y<0||ie.x>N||ie.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.Point(0,0),new o.Point(this.width,this.height))}zoomDeltaToMovement(r,u){const g=o.length(o.sub([],this._camera.position,r)),v=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(v)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([u,g,v],b){const M=[u,g,v,1];o.transformMat4$1(M,M,b);const P=M[3]=Math.max(M[3],1e-6);return M[0]/=P,M[1]/=P,M[2]/=P,M}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.Point(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,r))}}getCameraToCenterDistance(r,u=this.zoom,g=this.worldSize){const v=Ic(r,u,this.width,this.height,1024),b=r.pixelSpaceConversion(this.center.lat,g,v);return .5/Math.tan(.5*this._fov)*this.height*b}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.multiply(r,r,this.globeMatrix),r}}function hr(f,r){let u=!1,g=null;const v=()=>{g=null,u&&(f(),g=setTimeout(v,r),u=!1)};return()=>(u=!0,g||v(),g)}class Fu{constructor(r){this._hashName=r&&encodeURIComponent(r),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=hr(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,o.window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const u=ya(r);if(this._hashName){const g=this._hashName;let v=!1;const b=o.window.location.hash.slice(1).split("&").map(M=>{const P=M.split("=")[0];return P===g?(v=!0,`${P}=${u}`):M}).filter(M=>M);return v||b.push(`${g}=${u}`),`#${b.join("&")}`}return`#${u}`}_getCurrentHash(){const r=o.window.location.hash.replace("#","");if(this._hashName){let u;return r.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(g))){const g=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(u[3]||0):r.getBearing();return r.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,r)}}function ya(f,r){const u=f.getCenter(),g=Math.round(100*f.getZoom())/100,v=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,v),M=Math.round(u.lng*b)/b,P=Math.round(u.lat*b)/b,L=f.getBearing(),N=f.getPitch();let F=r?`/${M}/${P}/${g}`:`${g}/${P}/${M}`;return(L||N)&&(F+="/"+Math.round(10*L)/10),N&&(F+=`/${Math.round(N)}`),F}const Gs={linearity:.3,easing:o.bezier(0,0,.3,1)},Nu=o.extend({deceleration:2500,maxSpeed:1400},Gs),zl=o.extend({deceleration:20,maxSpeed:1400},Gs),Nt=o.extend({deceleration:1e3,maxSpeed:360},Gs),uo=o.extend({deceleration:1e3,maxSpeed:90},Gs);class Ya{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,u=o.exported.now();for(;r.length>0&&u-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(u.pan.mag()){const b=ju(u.pan.mag(),g,o.extend({},Nu,r||{}));v.offset=u.pan.mult(b.amount/u.pan.mag()),v.center=this._map.transform.center,Ol(v,b)}if(u.zoom){const b=ju(u.zoom,g,zl);v.zoom=this._map.transform.zoom+b.amount,Ol(v,b)}if(u.bearing){const b=ju(u.bearing,g,Nt);v.bearing=this._map.transform.bearing+o.clamp(b.amount,-179,179),Ol(v,b)}if(u.pitch){const b=ju(u.pitch,g,uo);v.pitch=this._map.transform.pitch+b.amount,Ol(v,b)}if(v.zoom||v.bearing){const b=u.pinchAround===void 0?u.around:u.pinchAround;v.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function Ol(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function ju(f,r,u){const{maxSpeed:g,linearity:v,deceleration:b}=u,M=o.clamp(f*v/(r/1e3),-g,g),P=Math.abs(M)/(b*v);return{easing:u.easing,duration:1e3*P,amount:M*(P/2)}}class wi extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,g,v={}){const b=_e(u.getCanvasContainer(),g),M=u.unproject(b);super(r,o.extend({point:b,lngLat:M,originalEvent:g},v)),this._defaultPrevented=!1,this.target=u}}class Bl extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,g){const v=r==="touchend"?g.changedTouches:g.touches,b=Se(u.getCanvasContainer(),v),M=b.map(L=>u.unproject(L)),P=b.reduce((L,N,F,W)=>L.add(N.div(W.length)),new o.Point(0,0));super(r,{points:b,point:P,lngLats:M,lngLat:u.unproject(P),originalEvent:g}),this._defaultPrevented=!1}}class Ja extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,g){super(r,{originalEvent:g}),this._defaultPrevented=!1}}class Fl{constructor(r,u){this._map=r,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new Ja(r.type,this._map,r))}mousedown(r,u){return this._mousedownPos=u,this._firePreventable(new wi(r.type,this._map,r))}mouseup(r){this._map.fire(new wi(r.type,this._map,r))}preclick(r){const u=o.extend({},r);u.type="preclick",this._map.fire(new wi(u.type,this._map,u))}click(r,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(r),this._map.fire(new wi(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new wi(r.type,this._map,r))}mouseover(r){this._map.fire(new wi(r.type,this._map,r))}mouseout(r){this._map.fire(new wi(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Bl(r.type,this._map,r))}touchmove(r){this._map.fire(new Bl(r.type,this._map,r))}touchend(r){this._map.fire(new Bl(r.type,this._map,r))}touchcancel(r){this._map.fire(new Bl(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nl{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new wi(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new wi(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rc{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,u){this.isEnabled()&&r.shiftKey&&r.button===0&&(xe(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(r,u){if(!this._active)return;const g=u,v=this._startPos,b=this._lastPos;if(!v||!b||b.equals(g)||!this._box&&g.dist(v)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=ee("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const M=Math.min(v.x,g.x),P=Math.max(v.x,g.x),L=Math.min(v.y,g.y),N=Math.max(v.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${L}px)`,this._box.style.width=P-M+"px",this._box.style.height=N-L+"px")})}mouseupWindow(r,u){if(!this._active)return;const g=this._startPos,v=u;if(g&&r.button===0){if(this.reset(),de(),g.x!==v.x||g.y!==v.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:b=>b.fitScreenCoordinates(g,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ce(),delete this._startPos,delete this._lastPos}_fireEvent(r,u){return this._map.fire(new o.Event(r,{originalEvent:u}))}}function jl(f,r){const u={};for(let g=0;g<f.length;g++)u[f[g].identifier]=r[g];return u}class _a{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),g.length===this.numTouches&&(this.centroid=function(v){const b=new o.Point(0,0);for(const M of v)b._add(M);return b.div(v.length)}(u),this.touches=jl(g,u)))}touchmove(r,u,g){if(this.aborted||!this.centroid)return;const v=jl(g,u);for(const b in this.touches){const M=v[b];(!M||M.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(r,u,g){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Uh{constructor(r){this.singleTap=new _a(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,u,g){this.singleTap.touchstart(r,u,g)}touchmove(r,u,g){this.singleTap.touchmove(r,u,g)}touchend(r,u,g){const v=this.singleTap.touchend(r,u,g);if(v){const b=r.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(v)<30;if(b&&M||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class Gd{constructor(){this._zoomIn=new Uh({numTouches:1,numTaps:2}),this._zoomOut=new Uh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,u,g){this._zoomIn.touchstart(r,u,g),this._zoomOut.touchstart(r,u,g)}touchmove(r,u,g){this._zoomIn.touchmove(r,u,g),this._zoomOut.touchmove(r,u,g)}touchend(r,u,g){const v=this._zoomIn.touchend(r,u,g),b=this._zoomOut.touchend(r,u,g);return v?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(v)},{originalEvent:r})}):b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(b)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const qd={0:1,2:2};class Vl{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,u){return!1}_move(r,u){return{}}mousedown(r,u){if(this._lastPoint)return;const g=$e(r);this._correctButton(r,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(r,u){const g=this._lastPoint;if(g){if(r.preventDefault(),this._eventButton!=null&&function(v,b){const M=qd[b];return v.buttons===void 0||(v.buttons&M)!==M}(r,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(r){this._lastPoint&&$e(r)===this._eventButton&&(this._moved&&de(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vu extends Vl{mousedown(r,u){super.mousedown(r,u),this._lastPoint&&(this._active=!0)}_correctButton(r,u){return u===0&&!r.ctrlKey}_move(r,u){return{around:u,panDelta:u.sub(r)}}}class Ss extends Vl{_correctButton(r,u){return u===0&&r.ctrlKey||u===2}_move(r,u){const g=.8*(u.x-r.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(r){r.preventDefault()}}class Lc extends Vl{_correctButton(r,u){return u===0&&r.ctrlKey||u===2}_move(r,u){const g=-.5*(u.y-r.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(r){r.preventDefault()}}class qs{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)}touchstart(r,u,g){return this._calculateTransform(r,u,g)}touchmove(r,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!o.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,u,g)}}touchend(r,u,g){this._calculateTransform(r,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,u,g){g.length>0&&(this._active=!0);const v=jl(g,u),b=new o.Point(0,0),M=new o.Point(0,0);let P=0;for(const N in v){const F=v[N],W=this._touches[N];W&&(b._add(F),M._add(F.sub(W)),P++,v[N]=F)}if(this._touches=v,P<this._minTouches||!M.mag())return;const L=M.div(P);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(P),panDelta:L}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ee("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class co{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,u,g){return{}}touchstart(r,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(r,u,g){const v=this._firstTwoTouches;if(!v)return;r.preventDefault();const[b,M]=v,P=Ws(g,u,b),L=Ws(g,u,M);if(!P||!L)return;const N=this._aroundCenter?null:P.add(L).div(2);return this._move([P,L],N,r)}touchend(r,u,g){if(!this._firstTwoTouches)return;const[v,b]=this._firstTwoTouches,M=Ws(g,u,v),P=Ws(g,u,b);M&&P||(this._active&&de(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ws(f,r,u){for(let g=0;g<f.length;g++)if(f[g].identifier===u)return r[g]}function ss(f,r){return Math.log(f/r)/Math.LN2}class Dc extends co{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,u){const g=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(ss(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ss(this._distance,g),pinchAround:u}}}function $h(f,r){return 180*f.angleWith(r)/Math.PI}class Wd extends co{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,u){const g=this._vector;if(this._vector=r[0].sub(r[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:$h(this._vector,g),pinchAround:u}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const u=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const v=$h(r,g);return Math.abs(v)<u}}function ho(f){return Math.abs(f.y)>Math.abs(f.x)}class Ul extends co{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,ho(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,u,g){const v=this._lastPoints;if(!v)return;const b=r[0].sub(v[0]),M=r[1].sub(v[1]);return this._map._cooperativeGestures&&!o.isFullscreen()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(b,M,g.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(b.y+M.y)/2*-.5})}gestureBeginsVertically(r,u,g){if(this._valid!==void 0)return this._valid;const v=r.mag()>=2,b=u.mag()>=2;if(!v&&!b)return;if(!v||!b)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const M=r.y>0==u.y>0;return ho(r)&&ho(u)&&M}}const Qa={panStep:100,bearingStep:15,pitchStep:10};class zc{constructor(){const r=Qa;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let u=0,g=0,v=0,b=0,M=0;switch(r.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:r.shiftKey?g=-1:(r.preventDefault(),b=-1);break;case 39:r.shiftKey?g=1:(r.preventDefault(),b=1);break;case 38:r.shiftKey?v=1:(r.preventDefault(),M=-1);break;case 40:r.shiftKey?v=-1:(r.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(g=0,v=0),{cameraAnimation:P=>{const L=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:Oc,zoom:u?Math.round(L)+u*(r.shiftKey?2:1):L,bearing:P.getBearing()+g*this._bearingStep,pitch:P.getPitch()+v*this._pitchStep,offset:[-b*this._panStep,-M*this._panStep],center:P.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Oc(f){return f*(2-f)}const va=4.000244140625;class Zs{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||o.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=r.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const g=o.exported.now(),v=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%va==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(v*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),r.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=r,this._delta-=u,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=_e(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const L=this._type==="wheel"&&Math.abs(this._delta)>va?this._wheelZoomRate:this._defaultZoomRate;let N=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&N!==0&&(N=1/N);const F=u(),W=Math.pow(2,F),ie=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):W;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(ie*N))),this._type==="wheel"&&(this._startZoom=F,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),v=this._startZoom,b=this._easing;let M,P=!1;if(this._type==="wheel"&&v&&b){const L=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),N=b(L);M=o.number(v,g,N),L<1?this._frameId||(this._frameId=!0):P=!0}else M=g,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:M-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let u=o.ease;if(this._prevEase){const g=this._prevEase,v=(o.exported.now()-g.start)/g.duration,b=g.easing(v+.01)-g.easing(v),M=.27/Math.sqrt(b*b+1e-4)*.01,P=Math.sqrt(.0729-M*M);u=o.bezier(M,P,.25,1)}return this._prevEase={start:o.exported.now(),duration:r,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ee("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Ar{constructor(r,u){this._clickZoom=r,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class qn{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,u){return r.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(r.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xa{constructor(){this._tap=new Uh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,u,g){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(r,u,g))}touchmove(r,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const v=u[0],b=v.y-this._swipePoint.y;return this._swipePoint=v,r.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(r,u,g)}touchend(r,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(r,u,g)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Li{constructor(r,u,g){this._el=r,this._mousePan=u,this._touchPan=g}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class fo{constructor(r,u,g){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class el{constructor(r,u,g,v){this._el=r,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Di=f=>f.zoom||f.drag||f.pitch||f.rotate;class Ki extends o.Event{}class Bc{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,u){const g=o.sub([],u,r);this.radius=o.length(g[2]<0?o.div([],g,this.constants):[g[0],g[1],0])}projectRay(r){o.div(r,r,this.constants),o.normalize(r,r),o.mul$1(r,r,this.constants);const u=o.scale$2([],r,this.radius);if(u[2]>0){const g=o.scale$2([],[0,0,1],o.dot(u,[0,0,1])),v=o.scale$2([],o.normalize([],[u[0],u[1],0]),this.radius),b=o.add([],u,o.scale$2([],o.sub([],o.add([],v,g),u),2));u[0]=b[0],u[1]=b[1]}return u}}function Uo(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class as{constructor(r,u){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ya(r),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Bc,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),o.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[v,b,M]of this._listeners)v.addEventListener(b,v===o.window.document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[r,u,g]of this._listeners)r.removeEventListener(u,r===o.window.document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(r){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new Fl(u,r));const v=u.boxZoom=new Rc(u,r);this._add("boxZoom",v);const b=new Gd,M=new qn;u.doubleClickZoom=new Ar(M,b),this._add("tapZoom",b),this._add("clickZoom",M);const P=new xa;this._add("tapDragZoom",P);const L=u.touchPitch=new Ul(u);this._add("touchPitch",L);const N=new Ss(r),F=new Lc(r);u.dragRotate=new fo(r,N,F),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);const W=new Vu(r),ie=new qs(u,r);u.dragPan=new Li(g,W,ie),this._add("mousePan",W),this._add("touchPan",ie,["touchZoom","touchRotate"]);const ae=new Wd,ue=new Dc;u.touchZoomRotate=new el(g,ue,ae,P),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Nl(u));const le=u.scrollZoom=new Zs(u,this);this._add("scrollZoom",le,["mousePan"]);const he=u.keyboard=new zc;this._add("keyboard",he);for(const X of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[X]&&u[X].enable(r[X])}_add(r,u,g){this._handlers.push({handlerName:r,handler:u,allowed:g}),this._handlersById[r]=u}stop(r){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Di(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,u,g){for(const v in r)if(v!==g&&(!u||u.indexOf(v)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const u=[];for(const g of r)this._el.contains(g.target)&&u.push(g);return u}handleEvent(r,u){this._updatingCamera=!0;const g=r.type==="renderFrame",v=g?void 0:r,b={needsRenderFrame:!1},M={},P={},L=r.touches?this._getMapTouches(r.touches):void 0,N=L?Se(this._el,L):g?void 0:_e(this._el,r);for(const{handlerName:ie,handler:ae,allowed:ue}of this._handlers){if(!ae.isEnabled())continue;let le;this._blockedByActive(P,ue,ie)?ae.reset():ae[u||r.type]&&(le=ae[u||r.type](r,N,L),this.mergeHandlerResult(b,M,le,ie,v),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||ae.isActive())&&(P[ie]=ae)}const F={};for(const ie in this._previousActiveHandlers)P[ie]||(F[ie]=v);this._previousActiveHandlers=P,(Object.keys(F).length||Uo(b))&&(this._changes.push([b,M,F]),this._triggerRenderFrame()),(Object.keys(P).length||Uo(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:W}=b;W&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],W(this._map))}mergeHandlerResult(r,u,g,v,b){if(!g)return;o.extend(r,g);const M={handlerName:v,originalEvent:g.originalEvent||b};g.zoomDelta!==void 0&&(u.zoom=M),g.panDelta!==void 0&&(u.drag=M),g.pitchDelta!==void 0&&(u.pitch=M),g.bearingDelta!==void 0&&(u.rotate=M)}_applyChanges(){const r={},u={},g={};for(const[v,b,M]of this._changes)v.panDelta&&(r.panDelta=(r.panDelta||new o.Point(0,0))._add(v.panDelta)),v.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(r.around=v.around),v.aroundCoord!==void 0&&(r.aroundCoord=v.aroundCoord),v.pinchAround!==void 0&&(r.pinchAround=v.pinchAround),v.noInertia&&(r.noInertia=v.noInertia),o.extend(u,b),o.extend(g,M);this._updateMapTransform(r,u,g),this._changes=[]}_updateMapTransform(r,u,g){const v=this._map,b=v.transform,M=se=>[se.x,se.y,se.z];if((se=>{const ge=this._eventsInProgress.drag;return ge&&!this._handlersById[ge.handlerName].isActive()})()&&!Uo(r)){const se=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",se!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&v._stop(!0),!Uo(r))return void this._fireEvents(u,g,!0);let{panDelta:P,zoomDelta:L,bearingDelta:N,pitchDelta:F,around:W,aroundCoord:ie,pinchAround:ae}=r;b._isCameraConstrained&&(L>0&&(L=0),b._isCameraConstrained=!1),ae!==void 0&&(W=ae),(L||(se=>u[se]&&!this._eventsInProgress[se])("drag"))&&W&&(this._dragOrigin=M(b.pointCoordinate3D(W)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",v._stop(!0),W=W||v.transform.centerPoint,N&&(b.bearing+=N),F&&(b.pitch+=F),b._updateCameraState();const ue=[0,0,0];if(P)if(b.projection.name==="mercator"){const se=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(W).dir),ge=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(W.sub(P)).dir);ue[0]=ge[0]-se[0],ue[1]=ge[1]-se[1]}else{const se=b.pointCoordinate(W);if(b.projection.name==="globe"){P=P.rotate(-b.angle);const ge=b._pixelsPerMercatorPixel/b.worldSize;ue[0]=-P.x*o.mercatorScale(o.latFromMercatorY(se.y))*ge,ue[1]=-P.y*o.mercatorScale(b.center.lat)*ge}else{const ge=b.pointCoordinate(W.sub(P));se&&ge&&(ue[0]=ge.x-se.x,ue[1]=ge.y-se.y)}}const le=b.zoom,he=[0,0,0];if(L){const se=M(ie||b.pointCoordinate3D(W)),ge={dir:o.normalize([],o.sub([],se,b._camera.position))};if(ge.dir[2]<0){const ve=b.zoomDeltaToMovement(se,L);o.scale$2(he,ge.dir,ve)}}const X=o.add(ue,ue,he);b._translateCameraConstrained(X),L&&Math.abs(b.zoom-le)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(u,g,!0)}_fireEvents(r,u,g){const v=Di(this._eventsInProgress),b=Di(r),M={};for(const F in r){const{originalEvent:W}=r[F];this._eventsInProgress[F]||(M[`${F}start`]=W),this._eventsInProgress[F]=r[F]}!v&&b&&this._fireEvent("movestart",b.originalEvent);for(const F in M)this._fireEvent(F,M[F]);b&&this._fireEvent("move",b.originalEvent);for(const F in r){const{originalEvent:W}=r[F];this._fireEvent(F,W)}const P={};let L;for(const F in this._eventsInProgress){const{handlerName:W,originalEvent:ie}=this._eventsInProgress[F];this._handlersById[W].isActive()||(delete this._eventsInProgress[F],L=u[W]||ie,P[`${F}end`]=L)}for(const F in P)this._fireEvent(F,P[F]);const N=Di(this._eventsInProgress);if(g&&(v||b)&&!N){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),W=ie=>ie!==0&&-this._bearingSnap<ie&&ie<this._bearingSnap;F?(W(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:L})):(this._map.fire(new o.Event("moveend",{originalEvent:L})),W(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,u){this._map.fire(new o.Event(r,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Ki("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Cs="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Uu extends o.Evented{constructor(r,u){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,u){return this.jumpTo({center:r},u)}panBy(r,u,g){return r=o.Point.convert(r).mult(-1),this.panTo(this.transform.center,o.extend({offset:r},u),g)}panTo(r,u,g){return this.easeTo(o.extend({center:r},u),g)}getZoom(){return this.transform.zoom}setZoom(r,u){return this.jumpTo({zoom:r},u),this}zoomTo(r,u,g){return this.easeTo(o.extend({zoom:r},u),g)}zoomIn(r,u){return this.zoomTo(this.getZoom()+1,r,u),this}zoomOut(r,u){return this.zoomTo(this.getZoom()-1,r,u),this}getBearing(){return this.transform.bearing}setBearing(r,u){return this.jumpTo({bearing:r},u),this}getPadding(){return this.transform.padding}setPadding(r,u){return this.jumpTo({padding:r},u),this}rotateTo(r,u,g){return this.easeTo(o.extend({bearing:r},u),g)}resetNorth(r,u){return this.rotateTo(0,o.extend({duration:1e3},r),u),this}resetNorthPitch(r,u){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},r),u),this}snapToNorth(r,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,u):this}getPitch(){return this.transform.pitch}setPitch(r,u){return this.jumpTo({pitch:r},u),this}cameraForBounds(r,u){r=o.LngLatBounds.convert(r);const g=u&&u.bearing||0,v=u&&u.pitch||0,b=r.getNorthWest(),M=r.getSouthEast();return this._cameraForBounds(this.transform,b,M,g,v,u)}_extendCameraOptions(r){const u={top:0,bottom:0,right:0,left:0};if(typeof(r=o.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const g=r.padding;r.padding={top:g,bottom:g,right:g,left:g}}return r.padding=o.extend(u,r.padding),r}_minimumAABBFrustumDistance(r,u){const g=u.max[0]-u.min[0],v=u.max[1]-u.min[1];return g/v>r.aspect?g/(2*Math.tan(.5*r.fovX)*r.aspect):v/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,u,g,v,b,M){const P=r.clone(),L=this._extendCameraOptions(M);P.bearing=v,P.pitch=b;const N=o.LngLat.convert(u),F=o.LngLat.convert(g),W=.5*(N.lat+F.lat),ie=.5*(N.lng+F.lng),ae=o.latLngToECEF(W,ie),ue=o.normalize([],ae),le=o.normalize([],o.cross([],ue,[0,1,0])),he=o.cross([],le,ue),X=[le[0],le[1],le[2],0,he[0],he[1],he[2],0,ue[0],ue[1],ue[2],0,0,0,0,1],se=[ae,o.latLngToECEF(N.lat,N.lng),o.latLngToECEF(F.lat,N.lng),o.latLngToECEF(F.lat,F.lng),o.latLngToECEF(N.lat,F.lng),o.latLngToECEF(W,N.lng),o.latLngToECEF(W,F.lng),o.latLngToECEF(N.lat,ie),o.latLngToECEF(F.lat,ie)];let ge=o.Aabb.fromPoints(se.map(ht=>[o.dot(le,ht),o.dot(he,ht),o.dot(ue,ht)]));const ve=o.transformMat4([],ge.center,X);o.squaredLength(ve)===0&&o.set(ve,0,0,1),o.normalize(ve,ve),o.scale$2(ve,ve,o.GLOBE_RADIUS),P.center=o.ecefToLatLng(ve);const Pe=P.getWorldToCameraMatrix(),Re=o.invert(new Float64Array(16),Pe);ge=o.Aabb.applyTransform(ge,o.multiply([],Pe,X)),o.transformMat4(ve,ve,Pe);const Ie=.5*(ge.max[2]-ge.min[2]),Ne=this._minimumAABBFrustumDistance(P,ge),Fe=o.scale$2([],[0,0,1],Ie),He=o.add(Fe,ve,Fe),vt=Ne+(P.pitch===0?0:o.distance(ve,He)),qe=P.globeCenterInViewSpace,nt=o.sub([],ve,[qe[0],qe[1],qe[2]]);o.normalize(nt,nt),o.scale$2(nt,nt,vt);const Xe=o.add([],ve,nt);o.transformMat4(Xe,Xe,Re);const yt=o.earthRadius/o.GLOBE_RADIUS,Ze=o.length(Xe),rt=o.mercatorZfromAltitude(Math.max(Ze*yt-o.earthRadius,Number.EPSILON),0),mt=Math.min(P.zoomFromMercatorZAdjusted(rt),L.maxZoom);return mt>.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(P.setProjection({name:"mercator"}),P.zoom=mt,this._cameraForBounds(P,u,g,v,b,M)):{center:P.center,zoom:mt,bearing:v,pitch:b}}queryTerrainElevation(r,u){const g=this.transform.elevation;return g?(u=o.extend({},{exaggerated:!0},u),g.getAtPoint(o.MercatorCoordinate.fromLngLat(r),null,u.exaggerated)):null}_cameraForBounds(r,u,g,v,b,M){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,u,g,v,b,M);const P=r.clone(),L=this._extendCameraOptions(M),N=P.padding;P.bearing=v,P.pitch=b;const F=o.LngLat.convert(u),W=o.LngLat.convert(g),ie=new o.LngLat(F.lng,W.lat),ae=new o.LngLat(W.lng,F.lat),ue=P.project(F),le=P.project(W),he=this.queryTerrainElevation(F),X=this.queryTerrainElevation(W),se=this.queryTerrainElevation(ie),ge=this.queryTerrainElevation(ae),ve=[[ue.x,ue.y,Math.min(he||0,X||0,se||0,ge||0)],[le.x,le.y,Math.max(he||0,X||0,se||0,ge||0)]];let Pe=o.Aabb.fromPoints(ve);const Re=P.getWorldToCameraMatrix(),Ie=o.invert(new Float64Array(16),Re);Pe=o.Aabb.applyTransform(Pe,Re);const Ne=o.sub([],Pe.max,Pe.min),Fe=N.left||0,He=N.right||0,vt=N.bottom||0,qe=N.top||0,{left:nt,right:Xe,top:yt,bottom:Ze}=L.padding,rt=.5*(Fe+He),mt=.5*(qe+vt),ht=Math.min(P.scaleZoom(P.scale*Math.min((P.width-(Fe+He+nt+Xe))/Ne[0],(P.height-(vt+qe+Ze+yt))/Ne[1])),L.maxZoom),wt=P.scale/P.zoomScale(ht);Pe=new o.Aabb([Pe.min[0]-(nt+rt)*wt,Pe.min[1]-(Ze+mt)*wt,Pe.min[2]],[Pe.max[0]+(Xe+rt)*wt,Pe.max[1]+(yt+mt)*wt,Pe.max[2]]);const Jt=.5*Ne[2],dn=this._minimumAABBFrustumDistance(P,Pe),Zt=[0,0,1,0];o.transformMat4$1(Zt,Zt,Re),o.normalize$2(Zt,Zt);const on=o.scale$2([],Zt,dn+Jt),Pn=o.add([],Pe.center,on),Dn=(typeof L.offset.x=="number"&&typeof L.offset.y=="number"?new o.Point(L.offset.x,L.offset.y):o.Point.convert(L.offset)).rotate(-o.degToRad(v));Pe.center[0]-=Dn.x*wt,Pe.center[1]+=Dn.y*wt,o.transformMat4(Pe.center,Pe.center,Ie),o.transformMat4(Pn,Pn,Ie);const Qt=[Pe.center[0],Pe.center[1],Pn[2]*P.pixelsPerMeter];o.scale$2(Qt,Qt,1/P.worldSize);const Un=o.lngFromMercatorX(Qt[0]),nr=o.latFromMercatorY(Qt[1]),rr=Math.min(P._zoomFromMercatorZ(Qt[2]),L.maxZoom),Jn=new o.LngLat(Un,nr);return P.mercatorFromTransition&&rr<.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(P.setProjection({name:"globe"}),P.zoom=rr,this._cameraForBounds(P,u,g,v,b,M)):{center:Jn,zoom:rr,bearing:v,pitch:b}}fitBounds(r,u,g){const v=this.cameraForBounds(r,u);return this._fitInternal(v,u,g)}fitScreenCoordinates(r,u,g,v,b){const M=o.Point.convert(r),P=o.Point.convert(u),L=new o.Point(Math.min(M.x,P.x),Math.min(M.y,P.y)),N=new o.Point(Math.max(M.x,P.x),Math.max(M.y,P.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(M,P))return this;const F=this.transform.pointLocation3D(L),W=this.transform.pointLocation3D(N),ie=this.transform.pointLocation3D(new o.Point(L.x,N.y)),ae=this.transform.pointLocation3D(new o.Point(N.x,L.y)),ue=[Math.min(F.lng,W.lng,ie.lng,ae.lng),Math.min(F.lat,W.lat,ie.lat,ae.lat)],le=[Math.max(F.lng,W.lng,ie.lng,ae.lng),Math.max(F.lat,W.lat,ie.lat,ae.lat)],he=v&&v.pitch?v.pitch:this.getPitch(),X=this._cameraForBounds(this.transform,ue,le,g,he,v);return this._fitInternal(X,v,b)}_fitInternal(r,u,g){return r?(delete(u=o.extend(r,u)).padding,u.linear?this.easeTo(u,g):this.flyTo(u,g)):this}jumpTo(r,u){this.stop();const g=r.preloadOnly?this.transform.clone():this.transform;let v=!1,b=!1,M=!1;return"zoom"in r&&g.zoom!==+r.zoom&&(v=!0,g.zoom=+r.zoom),r.center!==void 0&&(g.center=o.LngLat.convert(r.center)),"bearing"in r&&g.bearing!==+r.bearing&&(b=!0,g.bearing=+r.bearing),"pitch"in r&&g.pitch!==+r.pitch&&(M=!0,g.pitch=+r.pitch),r.padding==null||g.isPaddingEqual(r.padding)||(g.padding=r.padding),r.preloadOnly?(this._preloadTiles(g),this):(this.fire(new o.Event("movestart",u)).fire(new o.Event("move",u)),v&&this.fire(new o.Event("zoomstart",u)).fire(new o.Event("zoom",u)).fire(new o.Event("zoomend",u)),b&&this.fire(new o.Event("rotatestart",u)).fire(new o.Event("rotate",u)).fire(new o.Event("rotateend",u)),M&&this.fire(new o.Event("pitchstart",u)).fire(new o.Event("pitch",u)).fire(new o.Event("pitchend",u)),this.fire(new o.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(Cs),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return o.warnOnce(Cs),this;this.stop();const v=g.zoom,b=g.pitch,M=g.bearing;g.setFreeCameraOptions(r);const P=v!==g.zoom,L=b!==g.pitch,N=M!==g.bearing;return this.fire(new o.Event("movestart",u)).fire(new o.Event("move",u)),P&&this.fire(new o.Event("zoomstart",u)).fire(new o.Event("zoom",u)).fire(new o.Event("zoomend",u)),N&&this.fire(new o.Event("rotatestart",u)).fire(new o.Event("rotate",u)).fire(new o.Event("rotateend",u)),L&&this.fire(new o.Event("pitchstart",u)).fire(new o.Event("pitch",u)).fire(new o.Event("pitchend",u)),this.fire(new o.Event("moveend",u)),this}easeTo(r,u){this._stop(!1,r.easeId),((r=o.extend({offset:[0,0],duration:500,easing:o.ease},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const g=this.transform,v=this.getZoom(),b=this.getBearing(),M=this.getPitch(),P=this.getPadding(),L="zoom"in r?+r.zoom:v,N="bearing"in r?this._normalizeBearing(r.bearing,b):b,F="pitch"in r?+r.pitch:M,W="padding"in r?r.padding:g.padding,ie=o.Point.convert(r.offset);let ae,ue,le;if(g.projection.name==="globe"){const Fe=o.MercatorCoordinate.fromLngLat(g.center),He=ie.rotate(-g.angle);Fe.x+=He.x/g.worldSize,Fe.y+=He.y/g.worldSize;const vt=Fe.toLngLat(),qe=o.LngLat.convert(r.center||vt);this._normalizeCenter(qe),ae=g.centerPoint.add(He),ue=new o.Point(Fe.x,Fe.y).mult(g.worldSize),le=new o.Point(o.mercatorXfromLng(qe.lng),o.mercatorYfromLat(qe.lat)).mult(g.worldSize).sub(ue)}else{ae=g.centerPoint.add(ie);const Fe=g.pointLocation(ae),He=o.LngLat.convert(r.center||Fe);this._normalizeCenter(He),ue=g.project(Fe),le=g.project(He).sub(ue)}const he=g.zoomScale(L-v);let X,se;r.around&&(X=o.LngLat.convert(r.around),se=g.locationPoint(X));const ge=this._zooming||L!==v,ve=this._rotating||b!==N,Pe=this._pitching||F!==M,Re=!g.isPaddingEqual(W),Ie=Fe=>He=>{if(ge&&(Fe.zoom=o.number(v,L,He)),ve&&(Fe.bearing=o.number(b,N,He)),Pe&&(Fe.pitch=o.number(M,F,He)),Re&&(Fe.interpolatePadding(P,W,He),ae=Fe.centerPoint.add(ie)),X)Fe.setLocationAtPoint(X,se);else{const vt=Fe.zoomScale(Fe.zoom-v),qe=L>v?Math.min(2,he):Math.max(.5,he),nt=Math.pow(qe,1-He),Xe=Fe.unproject(ue.add(le.mult(He*nt)).mult(vt));Fe.setLocationAtPoint(Fe.renderWorldCopies?Xe.wrap():Xe,ae)}return r.preloadOnly||this._fireMoveEvents(u),Fe};if(r.preloadOnly){const Fe=this._emulate(Ie,r.duration,g);return this._preloadTiles(Fe),this}const Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ge,this._rotating=ve,this._pitching=Pe,this._padding=Re,this._easeId=r.easeId,this._prepareEase(u,r.noMoveStart,Ne),this._ease(Ie(g),Fe=>{g.recenterOnTerrain(),this._afterEase(u,Fe)},r),this}_prepareEase(r,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||g.moving||this.fire(new o.Event("movestart",r)),this._zooming&&!g.zooming&&this.fire(new o.Event("zoomstart",r)),this._rotating&&!g.rotating&&this.fire(new o.Event("rotatestart",r)),this._pitching&&!g.pitching&&this.fire(new o.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.Event("move",r)),this._zooming&&this.fire(new o.Event("zoom",r)),this._rotating&&this.fire(new o.Event("rotate",r)),this._pitching&&this.fire(new o.Event("pitch",r))}_afterEase(r,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,v=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new o.Event("zoomend",r)),v&&this.fire(new o.Event("rotateend",r)),b&&this.fire(new o.Event("pitchend",r)),this.fire(new o.Event("moveend",r))}flyTo(r,u){if(this._prefersReducedMotion(r)){const ht=o.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ht,u)}this.stop(),r=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},r);const g=this.transform,v=this.getZoom(),b=this.getBearing(),M=this.getPitch(),P=this.getPadding(),L="zoom"in r?o.clamp(+r.zoom,g.minZoom,g.maxZoom):v,N="bearing"in r?this._normalizeBearing(r.bearing,b):b,F="pitch"in r?+r.pitch:M,W="padding"in r?r.padding:g.padding,ie=g.zoomScale(L-v),ae=o.Point.convert(r.offset);let ue=g.centerPoint.add(ae);const le=g.pointLocation(ue),he=o.LngLat.convert(r.center||le);this._normalizeCenter(he);const X=g.project(le),se=g.project(he).sub(X);let ge=r.curve;const ve=Math.max(g.width,g.height),Pe=ve/ie,Re=se.mag();if("minZoom"in r){const ht=o.clamp(Math.min(r.minZoom,v,L),g.minZoom,g.maxZoom),wt=ve/g.zoomScale(ht-v);ge=Math.sqrt(wt/Re*2)}const Ie=ge*ge;function Ne(ht){const wt=(Pe*Pe-ve*ve+(ht?-1:1)*Ie*Ie*Re*Re)/(2*(ht?Pe:ve)*Ie*Re);return Math.log(Math.sqrt(wt*wt+1)-wt)}function Fe(ht){return(Math.exp(ht)-Math.exp(-ht))/2}function He(ht){return(Math.exp(ht)+Math.exp(-ht))/2}const vt=Ne(0);let qe=function(ht){return He(vt)/He(vt+ge*ht)},nt=function(ht){return ve*((He(vt)*(Fe(wt=vt+ge*ht)/He(wt))-Fe(vt))/Ie)/Re;var wt},Xe=(Ne(1)-vt)/ge;if(Math.abs(Re)<1e-6||!isFinite(Xe)){if(Math.abs(ve-Pe)<1e-6)return this.easeTo(r,u);const ht=Pe<ve?-1:1;Xe=Math.abs(Math.log(Pe/ve))/ge,nt=function(){return 0},qe=function(wt){return Math.exp(ht*ge*wt)}}r.duration="duration"in r?+r.duration:1e3*Xe/("screenSpeed"in r?+r.screenSpeed/ge:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const yt=b!==N,Ze=F!==M,rt=!g.isPaddingEqual(W),mt=ht=>wt=>{const Jt=wt*Xe,dn=1/qe(Jt);ht.zoom=wt===1?L:v+ht.scaleZoom(dn),yt&&(ht.bearing=o.number(b,N,wt)),Ze&&(ht.pitch=o.number(M,F,wt)),rt&&(ht.interpolatePadding(P,W,wt),ue=ht.centerPoint.add(ae));const Zt=wt===1?he:ht.unproject(X.add(se.mult(nt(Jt))).mult(dn));return ht.setLocationAtPoint(ht.renderWorldCopies?Zt.wrap():Zt,ue),ht._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(u),ht};if(r.preloadOnly){const ht=this._emulate(mt,r.duration,g);return this._preloadTiles(ht),this}return this._zooming=!0,this._rotating=yt,this._pitching=Ze,this._padding=rt,this._prepareEase(u,!1),this._ease(mt(g),()=>this._afterEase(u),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!r){const g=this.handlers;g&&g.stop(!1)}return this}_ease(r,u,g){g.animate===!1||g.duration===0?(r(1),u()):(this._easeStart=o.exported.now(),this._easeOptions=g,this._onEaseFrame=r,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,u){r=o.wrap(r,-180,180);const g=Math.abs(r-u);return Math.abs(r-360-u)<g&&(r-=360),Math.abs(r+360-u)<g&&(r+=360),r}_normalizeCenter(r){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const g=r.lng-u.center.lng;r.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&o.exported.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,u,g){const v=Math.ceil(15*u/1e3),b=[],M=r(g.clone());for(let P=0;P<=v;P++){const L=M(P/v);b.push(L.clone())}return b}}class Vt{constructor(r={}){this.options=r,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const u=this.options&&this.options.compact;return this._map=r,this._container=ee("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ee("button","mapboxgl-ctrl-attrib-button",this._container),ee("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ee("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,u){const g=this._map._getUIString(`AttributionControl.${u}`);r.setAttribute("aria-label",g),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(r){const g=u.reduce((v,b,M)=>(b.value&&(v+=`${b.key}=${b.value}${M<u.length-1?"&":""}`),v),"?");r.href=`${o.config.FEEDBACK_URL}/${g}#${ya(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const u=this._map.style._sourceCaches;for(const v in u){const b=u[v];if(b.used){const M=b.getSource();M.attribution&&r.indexOf(M.attribution)<0&&r.push(M.attribution)}}r.sort((v,b)=>v.length-b.length),r=r.filter((v,b)=>{for(let M=b+1;M<r.length;M++)if(r[M].indexOf(v)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const g=r.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,r.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class $l{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=ee("div","mapboxgl-ctrl");const u=ee("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const u in r){const g=r[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const u=r[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class $u{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const u=++this._id;return this._queue.push({callback:r,id:u,cancelled:!1}),u}remove(r){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const v of g)if(v.id===r)return void(v.cancelled=!0)}run(r=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function tl(f,r,u){if(f=new o.LngLat(f.lng,f.lat),r){const g=new o.LngLat(f.lng-360,f.lat),v=new o.LngLat(f.lng+360,f.lat),b=360*Math.ceil(Math.abs(f.lng-u.center.lng)/360),M=u.locationPoint(f).distSqr(r),P=r.x<0||r.y<0||r.x>u.width||r.y>u.height;u.locationPoint(g).distSqr(r)<M&&(P||Math.abs(g.lng-u.center.lng)<b)?f=g:u.locationPoint(v).distSqr(r)<M&&(P||Math.abs(v.lng-u.center.lng)<b)&&(f=v)}for(;Math.abs(f.lng-u.center.lng)>180;){const g=u.locationPoint(f);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;f.lng>u.center.lng?f.lng-=360:f.lng+=360}return f}const nl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Bt extends o.Evented{constructor(r,u){if(super(),(r instanceof o.window.HTMLElement||u)&&(r=o.extend({element:r},u)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=o.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=ee("div");const v=41,b=27,M=H("svg",{display:"block",height:v*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${v}`},this._element),P=H("radialGradient",{id:"shadowGradient"},H("defs",{},M));H("stop",{offset:"10%","stop-opacity":.4},P),H("stop",{offset:"100%","stop-opacity":.05},P),H("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),H("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),H("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),H("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=o.Point.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",v=>{v.preventDefault()}),this._element.addEventListener("mousedown",v=>{v.preventDefault()});const g=this._element.classList;for(const v in nl)g.remove(`mapboxgl-marker-anchor-${v}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const u=r.code,g=r.charCode||r.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(r){const u=r.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,u=this._pos;if(!r||!u)return!1;const g=r.unproject(u),v=r.getFreeCameraOptions();if(!v.position)return!1;const b=v.position.toLngLat();return b.distanceTo(g)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const u=this._pos;if(!u||u.x<0||u.x>r.transform.width||u.y<0||u.y>r.transform.height)return void this._clearFadeTimer();const g=r.unproject(u);let v;r._showingGlobe()&&o.isLngLatBehindGlobe(r.transform,this._lngLat)?v=0:(v=1-r._queryFogOpacity(g),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(v*=this._occludedOpacity)),this._element.style.opacity=`${v}`,this._element.style.pointerEvents=v>0?"auto":"none",this._popup&&this._popup._setOpacity(v),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${nl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const r=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!r||g!=="map")return"";if(!u._showingGlobe()){const L=u.getPitch();return L?`rotateX(${L}deg)`:""}const v=o.radToDeg(o.globeTiltAtLngLat(u.transform,this._lngLat)),b=r.sub(o.globeCenterToScreenPoint(u.transform)),M=Math.abs(b.x)+Math.abs(b.y);if(M===0)return"";const P=v/M;return`rotateX(${-b.y*P}deg) rotateY(${b.x*P}deg)`}_calculateZTransform(){const r=this._pos,u=this._map;if(!u||!r)return"";let g=0;const v=this.getRotationAlignment();if(v==="map")if(u._showingGlobe()){const b=u.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),M=u.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);g=o.radToDeg(Math.atan2(M.y,M.x))-90}else g=-u.getBearing();else if(v==="horizon"){const b=o.smoothstep(4,6,u.getZoom()),M=o.globeCenterToScreenPoint(u.transform);M.y+=b*u.transform.height;const P=r.sub(M),L=o.radToDeg(Math.atan2(P.y,P.x));g=(L>90?L-270:L+90)*(1-b)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(r){o.window.cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=tl(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),r===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=o.Point.convert(r),this._update(),this}_onMove(r){const u=this._map;if(!u)return;const g=this._pointerdownPos,v=this._positionDelta;if(g&&v){if(!this._isDragging){const b=this._clickTolerance||u._clickTolerance;if(r.point.dist(g)<b)return;this._isDragging=!0}this._pos=r.point.sub(v),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(r){const u=this._map,g=this._pos;u&&g&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(g),this._pointerdownPos=r.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const u=this._map;return u&&(r?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const wa={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Gl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Gu(f=new o.Point(0,0),r="bottom"){if(typeof f=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new o.Point(0,f);case"top-left":return new o.Point(u,u);case"top-right":return new o.Point(-u,u);case"bottom":return new o.Point(0,-f);case"bottom-left":return new o.Point(u,-u);case"bottom-right":return new o.Point(-u,-u);case"left":return new o.Point(f,0);case"right":return new o.Point(-f,0)}return new o.Point(0,0)}return f instanceof o.Point||Array.isArray(f)?o.Point.convert(f):o.Point.convert(f[r]||[0,0])}class ql{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const u=o.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,u,g){this._start=this.getValue(u),this._end=r,this._startTime=u,this._endTime=u+g}}const Eo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},So={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},rl={showCompass:!0,showZoom:!0,visualizePitch:!1};class Hs{constructor(r,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new Ss({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,g&&(this.mousePitch=new Lc({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(r,u){this.mouseRotate.mousedown(r,u),this.mousePitch&&this.mousePitch.mousedown(r,u),xe()}move(r,u){const g=this.map,v=this.mouseRotate.mousemoveWindow(r,u),b=v&&v.bearingDelta;if(b&&g.setBearing(g.getBearing()+b),this.mousePitch){const M=this.mousePitch.mousemoveWindow(r,u),P=M&&M.pitchDelta;P&&g.setPitch(g.getPitch()+P)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ce(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(o.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),_e(this.element,r)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,_e(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Se(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=Se(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ls={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Xs={maxWidth:100,unit:"metric"},Fc={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ba={version:o.version,supported:O,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Uu{constructor(f){if(o.LivePerformanceUtils.mark(o.PerformanceMarkers.create),(f=o.extend({},So,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(f.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ka(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._useWebGL2=f.useWebGL2,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new $u,this._domRenderTaskQueue=new $u,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.uniqueId(),this._locale=o.extend({},Eo,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ql(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new o.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,typeof f.container=="string"){if(this._container=o.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new as(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new Fu(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,o.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new Vt({customAttribution:f.customAttribution})),this._logoControl=new $l,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new o.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new o.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=f.onAdd(this);this._controls.push(f);const g=this._controlPositions[r];return r.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new o.Event("movestart",f)).fire(new o.Event("move",f)),this.fire(new o.Event("resize",f)),r&&this.fire(new o.Event("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(o.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?o.window.navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?o.window.navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style._reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let u;r==="globe"&&f.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(f.setMercatorFromTransition(),u=!0):r==="mercator"&&f.zoom<o.GLOBE_ZOOM_THRESHOLD_MAX&&(f.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;if(r=f.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const u in this.style._sourceCaches)this.style._sourceCaches[u].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(f){return this.transform.locationPoint3D(o.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(o.Point.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,u){if(f==="mouseenter"||f==="mouseover"){let g=!1;const v=M=>{const P=r.filter(N=>this.getLayer(N)),L=P.length?this.queryRenderedFeatures(M.point,{layers:P}):[];L.length?g||(g=!0,u.call(this,new wi(f,this,M.originalEvent,{features:L}))):g=!1},b=()=>{g=!1};return{layers:new Set(r),listener:u,delegates:{mousemove:v,mouseout:b}}}if(f==="mouseleave"||f==="mouseout"){let g=!1;const v=M=>{const P=r.filter(L=>this.getLayer(L));(P.length?this.queryRenderedFeatures(M.point,{layers:P}):[]).length?g=!0:g&&(g=!1,u.call(this,new wi(f,this,M.originalEvent)))},b=M=>{g&&(g=!1,u.call(this,new wi(f,this,M.originalEvent)))};return{layers:new Set(r),listener:u,delegates:{mousemove:v,mouseout:b}}}{const g=v=>{const b=r.filter(P=>this.getLayer(P)),M=b.length?this.queryRenderedFeatures(v.point,{layers:b}):[];M.length&&(v.features=M,u.call(this,v),delete v.features)};return{layers:new Set(r),listener:u,delegates:{[f]:g}}}}on(f,r,u){if(u===void 0)return super.on(f,r);Array.isArray(r)||(r=[r]);const g=this._createDelegatedListener(f,r,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(g);for(const v in g.delegates)this.on(v,g.delegates[v]);return this}once(f,r,u){if(u===void 0)return super.once(f,r);Array.isArray(r)||(r=[r]);const g=this._createDelegatedListener(f,r,u);for(const v in g.delegates)this.once(v,g.delegates[v]);return this}off(f,r,u){if(u===void 0)return super.off(f,r);r=new Set(Array.isArray(r)?r:[r]);const g=(b,M)=>{if(b.size!==M.size)return!1;for(const P of b)if(!M.has(P))return!1;return!0},v=this._delegatedListeners?this._delegatedListeners[f]:void 0;return v&&(b=>{for(let M=0;M<b.length;M++){const P=b[M];if(P.listener===u&&g(P.layers,r)){for(const L in P.delegates)this.off(L,P.delegates[L]);return b.splice(M,1),this}}})(v),this}queryRenderedFeatures(f,r){return this.style?(r!==void 0||f===void 0||f instanceof o.Point||Array.isArray(f)||(r=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(f,r){return this.style.querySourceFeatures(f,r)}isPointOnSurface(f){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&o.warnOnce(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.Point.convert(f))}setStyle(f,r){return(r=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new Fo(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Fo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,r){if(typeof f=="string"){const u=this._requestManager.normalizeStyleURL(f),g=this._requestManager.transformRequest(u,o.ResourceType.Style);o.getJSON(g,(v,b)=>{v?this.fire(new o.ErrorEvent(v)):b&&this._updateDiff(b,r)})}else typeof f=="object"&&this._updateDiff(f,r)}_updateDiff(f,r){try{this.style.setState(f)&&this._update(!0)}catch(u){o.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(f,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(f,r){return this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const r in f){const u=f[r]._tiles;for(const g in u){const v=u[g];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}addSourceType(f,r,u){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,u)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,r,{pixelRatio:u=1,sdf:g=!1,stretchX:v,stretchY:b,content:M}={}){if(this._lazyInitEmptyStyle(),r instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&r instanceof o.window.ImageBitmap){const{width:P,height:L,data:N}=o.exported.getImageData(r);this.style.addImage(f,{data:new o.RGBAImage({width:P,height:L},N),pixelRatio:u,stretchX:v,stretchY:b,content:M,sdf:g,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:P,height:L}=r,N=r;this.style.addImage(f,{data:new o.RGBAImage({width:P,height:L},new Uint8Array(N.data)),pixelRatio:u,stretchX:v,stretchY:b,content:M,sdf:g,version:0,userImage:N}),N.onAdd&&N.onAdd(this,f)}}updateImage(f,r){const u=this.style.getImage(f);if(!u)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=r instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&r instanceof o.window.ImageBitmap?o.exported.getImageData(r):r,{width:v,height:b}=g;v!==void 0&&b!==void 0?v===u.data.width&&b===u.data.height?(u.data.replace(g.data,!(r instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&r instanceof o.window.ImageBitmap)),this.style.updateImage(f,u)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${v}, ${b})
                must be that same as the previous version of the image
                (${u.data.width}, ${u.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){o.getImage(this._requestManager.transformRequest(f,o.ResourceType.Image),(u,g)=>{r(u,g instanceof o.window.HTMLImageElement?o.exported.getImageData(g):g)})}listImages(){return this.style.listImages()}addLayer(f,r){return this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)}moveLayer(f,r){return this.style.moveLayer(f,r),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,r,u){return this.style.setLayerZoomRange(f,r,u),this._update(!0)}setFilter(f,r,u={}){return this.style.setFilter(f,r,u),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,r,u,g={}){return this.style.setPaintProperty(f,r,u,g),this._update(!0)}getPaintProperty(f,r){return this.style.getPaintProperty(f,r)}setLayoutProperty(f,r,u,g={}){return this.style.setLayoutProperty(f,r,u,g),this._update(!0)}getLayoutProperty(f,r){return this.style.getLayoutProperty(f,r)}setLight(f,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(f),this.transform):0}setFeatureState(f,r){return this.style.setFeatureState(f,r),this._update()}removeFeatureState(f,r){return this.style.removeFeatureState(f,r),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let u,g,v,b=this._container;for(;b&&(!g||!v);){const M=o.window.getComputedStyle(b).transform;M&&M!=="none"&&(u=M.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(v=u[3])),b=b.parentElement}this._containerWidth=g?Math.abs(f/g):f,this._containerHeight=v?Math.abs(r/v):r}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=ee("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=ee("div","mapboxgl-canvas-container",f);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=ee("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=ee("div","mapboxgl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{g[v]=ee("div",`mapboxgl-ctrl-${v}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const u=o.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(f),this._canvas.height=u*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=o.extend({},O.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._useWebGL2&&this._canvas.getContext("webgl2",f),u=r||this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);u?(this._useWebGL2&&!r&&o.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),o.storeAuthState(u,!0),this.painter=new Xa(u,this.transform,!!r),this.on("data",g=>{g.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(u)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;const u=this.painter.context.extTimerQuery,g=o.exported.now();if(this.listens("gpu-timing-frame")&&(r=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],o.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],o.window.performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const v=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const P=this.transform.zoom,L=this.transform.pitch,N=o.exported.now(),F=new o.EvaluationParameters(P,{now:N,fadeDuration:v,pitch:L,transition:this.style.getTransition()});this.style.update(F)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(g),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(g),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,v,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const P=o.exported.now()-g;u.endQueryEXT(u.TIME_ELAPSED_EXT,r),setTimeout(()=>{const L=u.getQueryObjectEXT(r,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(r),this.fire(new o.Event("gpu-timing-frame",{cpuTime:P,gpuTime:L})),o.window.performance.mark("frame-gpu",{startTime:g,detail:{gpuTime:L}})},50)}if(this.listens("gpu-timing-layer")){const P=this.painter.collectGpuTimers();setTimeout(()=>{const L=this.painter.queryGpuTimers(P);this.fire(new o.Event("gpu-timing-layer",{layerTimes:L}))},50)}if(this.listens("gpu-timing-deferred-render")){const P=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const L=this.painter.queryGpuTimeDeferredRender(P);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:L}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(M||this._repaint)this.triggerRepaint();else{const P=!this.isMoving()&&this.loaded();if(P&&(b=this._updateAverageElevation(g,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),P&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const L=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:L})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,o.LivePerformanceUtils.mark(o.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&o.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const u=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);if((r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const g=this.transform.averageElevation;let v=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(v)?v=0:this._averageElevationLastSampledAt=f;const M=Math.abs(g-v);if(M>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(v),u(v);this._averageElevation.easeTo(v,f,300)}else if(M>1e-4)return this._averageElevation.jumpTo(v),u(v)}return!!this._averageElevation.isEasing(f)&&u(this._averageElevation.getValue(f))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===o.AUTH_ERR_MSG||f.status===401)){const r=this.painter.context.gl;o.storeAuthState(r,!1),this._logoControl instanceof $l&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function v(b){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,b,0);const M=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,M),M}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(v(f),r.canvasCopies.map(v),r.timeStamps)}_canvasPixelComparison(f,r,u){let g=u[1]-u[0];const v=f.length/4;for(let b=0;b<r.length;b++){const M=r[b];let P=0;for(let L=0;L<M.length;L+=4)M[L]===f[L]&&M[L+1]===f[L+1]&&M[L+2]===f[L+2]&&M[L+3]===f[L+3]&&(P+=1);g+=(u[b+2]-u[b+1])*(1-P/v)}return g}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1),o.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=o.exported.frame(r=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(r)}))}_preloadTiles(f){const r=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(r,(u,g)=>u._preloadTiles(f,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){o.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,f&&this._update())}_setCacheLimits(f,r){o.setCacheLimits(f,r)}get version(){return o.version}},NavigationControl:class{constructor(f){this.options=o.extend({},rl,f),this._container=ee("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),ee("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),ee("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:r}):u.resetNorth({},{originalEvent:r}))}),this._compassIcon=ee("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),u=r===f.getMaxZoom(),g=r===f.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Hs(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const u=ee("button",f,this._container);return u.type="button",u.addEventListener("click",r),u}_setButtonTitle(f,r){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",u),f.firstElementChild&&f.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends o.Evented{constructor(f){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},ls,f),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=hr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=ee("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,f(u)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(u=>r(u.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),u=f.coords;return!!r&&(u.longitude<r.getWest()||u.longitude>r.getEast()||u.latitude<r.getSouth()||u.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",f)),this._finish()}}_updateCamera(f){const r=new o.LngLat(f.coords.longitude,f.coords.latitude),u=f.coords.accuracy,g=this._map.getBearing(),v=o.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(u),v,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new o.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=o.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,u=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=ee("button","mapboxgl-ctrl-geolocate",this._container),ee("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ee("div","mapboxgl-user-location"),this._dotElement.appendChild(ee("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ee("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Bt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ee("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Bt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Vt,ScaleControl:class{constructor(f){this.options=o.extend({},Xs,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,u=r._containerHeight/2,g=r._containerWidth/2-f/2,v=r.unproject([g,u]),b=r.unproject([g+f,u]),M=v.distanceTo(b);if(this.options.unit==="imperial"){const P=3.2808*M;P>5280?this._setScale(f,P/5280,"mile"):this._setScale(f,P,"foot")}else this.options.unit==="nautical"?this._setScale(f,M/1852,"nautical-mile"):M>=1e3?this._setScale(f,M/1e3,"kilometer"):this._setScale(f,M,"meter")}_setScale(f,r,u){this._map._requestDomTask(()=>{const g=function(b){const M=Math.pow(10,`${Math.floor(b)}`.length-1);let P=b/M;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(L){const N=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*N)/N}(P),M*P}(r),v=g/r;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(g):`${g}&nbsp;${Fc[u]}`,this._container.style.width=f*v+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=ee("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof o.window.HTMLElement?this._container=f.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=ee("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=ee("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ee("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(f){super(),this.options=o.extend(Object.create(wa),f),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=o.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(o.window.document.createTextNode(f))}setHTML(f){const r=o.window.document.createDocumentFragment(),u=o.window.document.createElement("body");let g;for(u.innerHTML=f;g=u.firstChild,g;)r.appendChild(g);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=ee("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const u=this._closeButton=ee("button","mapboxgl-popup-close-button",r);u.type="button",u.setAttribute("aria-label","Close popup"),u.setAttribute("aria-hidden","true"),u.innerHTML="&#215;",u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,u=this._container,g=this._pos;if(!r||!u||!g)return"bottom";const v=u.offsetWidth,b=u.offsetHeight,M=g.x<v/2,P=g.x>r.transform.width-v/2;if(g.y+f<b)return M?"top-left":P?"top-right":"top";if(g.y>r.transform.height-b){if(M)return"bottom-left";if(P)return"bottom-right"}return M?"left":P?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,u=this._content;if(!r||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=ee("div","mapboxgl-popup",r.getContainer()),this._tip=ee("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=tl(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const v=this._pos=this._trackPointer&&f?f:r.project(this._lngLat),b=Gu(this.options.offset),M=this._anchor=this._getAnchor(b.y),P=Gu(this.options.offset,M),L=v.add(P).round();r._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${nl[M]} translate(${L.x}px,${L.y}px)`)})}if(!this._marker&&r._showingGlobe()){const v=o.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(v)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Gl);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Bt,Style:Fo,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:$s,Evented:o.Evented,config:o.config,prewarm:function(){ja().acquire(ns)},clearPrewarmedResources:function(){const f=Xi;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(ns),Xi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(f){o.config.ACCESS_TOKEN=f},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(f){o.config.API_URL=f},get workerCount(){return ui.workerCount},set workerCount(f){ui.workerCount=f},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){o.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){o.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return ba});var k=T;return k})}(ny)),ny.exports}var J3=Y3();const If=Ay(J3);var ov,Ob;function tp(){if(Ob)return ov;Ob=1,ov=s;var i=Object.prototype.hasOwnProperty;function s(){for(var c={},p=0;p<arguments.length;p++){var _=arguments[p];for(var T in _)i.call(_,T)&&(c[T]=_[T])}return c}return ov}var sv={exports:{}},Bb;function Q3(){return Bb||(Bb=1,function(i,s){(function(){var c={};i.exports=c,c.simpleFilter=function(p,_){return _.filter(function(T){return c.test(p,T)})},c.test=function(p,_){return c.match(p,_)!==null},c.match=function(p,_,T){T=T||{};var S=0,k=[],o=_.length,I=0,O=0,V=T.pre||"",q=T.post||"",ee=T.caseSensitive&&_||_.toLowerCase(),H;p=T.caseSensitive&&p||p.toLowerCase();for(var j=0;j<o;j++)H=_[j],ee[j]===p[S]?(H=V+H+q,S+=1,O+=1+O):O=0,I+=O,k[k.length]=H;return S===p.length?(I=ee===p?1/0:I,{rendered:k.join(""),score:I}):null},c.filter=function(p,_,T){return!_||_.length===0?[]:typeof p!="string"?_:(T=T||{},_.reduce(function(S,k,o,I){var O=k;T.extract&&(O=T.extract(k));var V=c.match(p,O,T);return V!=null&&(S[S.length]={string:V.rendered,score:V.score,index:o,original:k}),S},[]).sort(function(S,k){var o=k.score-S.score;return o||S.index-k.index}))}})()}(sv)),sv.exports}var av,Fb;function eD(){if(Fb)return av;Fb=1;var i=function(s){return this.component=s,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,s.el.parentNode.insertBefore(this.wrapper,s.el.nextSibling),this};return i.prototype.show=function(){this.element.style.display="block"},i.prototype.hide=function(){this.element.style.display="none"},i.prototype.add=function(s){this.items.push(s)},i.prototype.clear=function(){this.items=[],this.active=0},i.prototype.isEmpty=function(){return!this.items.length},i.prototype.isVisible=function(){return this.element.style.display==="block"},i.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var s=0;s<this.items.length;s++)this.drawItem(this.items[s],this.active===s);this.show()},i.prototype.drawItem=function(s,c){var p=document.createElement("li"),_=document.createElement("a");c&&(p.className+=" active"),_.innerHTML=s.string,p.appendChild(_),this.element.appendChild(p),p.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),p.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,s)}).bind(this))},i.prototype.handleMouseUp=function(s){this.selectingListItem=!1,this.component.value(s.original),this.clear(),this.draw()},i.prototype.move=function(s){this.active=s,this.draw()},i.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)},i.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},i.prototype.drawError=function(s){var c=document.createElement("li");c.innerHTML=s,this.element.appendChild(c),this.show()},av=i,av}var lv,Nb;function tD(){if(Nb)return lv;Nb=1;var i=tp(),s=Q3(),c=eD(),p=function(_,T,S){return S=S||{},this.options=i({minLength:2,limit:5,filter:!0,hideOnBlur:!0},S),this.el=_,this.data=T||[],this.list=new c(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(k){this.handleKeyUp(k.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(k){this.handleKeyDown(k)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(k){this.handlePaste(k)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};return p.prototype.handleKeyUp=function(_){_===40||_===38||_===27||_===13||_===9||this.handleInputChange(this.el.value)},p.prototype.handleKeyDown=function(_){switch(_.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&_.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},p.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},p.prototype.handlePaste=function(_){if(_.clipboardData)this.handleInputChange(_.clipboardData.getData("Text"));else{var T=this;setTimeout(function(){T.handleInputChange(_.target.value)},100)}},p.prototype.handleInputChange=function(_){if(this.query=this.normalize(_),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(T){for(var S=0;S<T.length&&(this.list.add(T[S]),S!==this.options.limit-1);S++);this.list.draw()}).bind(this))},p.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},p.prototype.update=function(_){this.data=_,this.handleKeyUp()},p.prototype.clear=function(){this.data=[],this.list.clear()},p.prototype.normalize=function(_){return _=_.toLowerCase(),_},p.prototype.match=function(_,T){return _.indexOf(T)>-1},p.prototype.value=function(_){if(this.selected=_,this.el.value=this.getItemValue(_),document.createEvent){var T=document.createEvent("HTMLEvents");T.initEvent("change",!0,!1),this.el.dispatchEvent(T)}else this.el.fireEvent("onchange")},p.prototype.getCandidates=function(_){var T={pre:"<strong>",post:"</strong>",extract:(function(k){return this.getItemValue(k)}).bind(this)},S;this.options.filter?(S=s.filter(this.query,this.data,T),S=S.map((function(k){return{original:k.original,string:this.render(k.original,k.string)}}).bind(this))):S=this.data.map((function(k){var o=this.render(k);return{original:k,string:o}}).bind(this)),_(S)},p.prototype.getItemValue=function(_){return _},p.prototype.render=function(_,T){if(T)return T;for(var S=_.original?this.getItemValue(_.original):this.getItemValue(_),k=this.normalize(S),o=k.lastIndexOf(this.query);o>-1;){var I=o+this.query.length;S=S.slice(0,o)+"<strong>"+S.slice(o,I)+"</strong>"+S.slice(I),o=k.slice(0,o).lastIndexOf(this.query)}return S},p.prototype.renderError=function(_){this.list.drawError(_)},lv=p,lv}var uv,jb;function nD(){if(jb)return uv;jb=1;var i=tD();return uv=i,typeof window<"u"&&(window.Suggestions=i),uv}var cv,Vb;function rD(){if(Vb)return cv;Vb=1;var i="Expected a function",s=NaN,c="[object Symbol]",p=/^\s+|\s+$/g,_=/^[-+]0x[0-9a-f]+$/i,T=/^0b[01]+$/i,S=/^0o[0-7]+$/i,k=parseInt,o=typeof uh=="object"&&uh&&uh.Object===Object&&uh,I=typeof self=="object"&&self&&self.Object===Object&&self,O=o||I||Function("return this")(),V=Object.prototype,q=V.toString,ee=Math.max,H=Math.min,j=function(){return O.Date.now()};function Z(de,_e,Se){var $e,dt,Y,pt,Lt,lt,zt=0,$n=!1,ln=!1,fn=!0;if(typeof de!="function")throw new TypeError(i);_e=me(_e)||0,ne(Se)&&($n=!!Se.leading,ln="maxWait"in Se,Y=ln?ee(me(Se.maxWait)||0,_e):Y,fn="trailing"in Se?!!Se.trailing:fn);function gt(St){var Ft=$e,en=dt;return $e=dt=void 0,zt=St,pt=de.apply(en,Ft),pt}function Et(St){return zt=St,Lt=setTimeout(Ue,_e),$n?gt(St):pt}function Le(St){var Ft=St-lt,en=St-zt,yn=_e-Ft;return ln?H(yn,Y-en):yn}function te(St){var Ft=St-lt,en=St-zt;return lt===void 0||Ft>=_e||Ft<0||ln&&en>=Y}function Ue(){var St=j();if(te(St))return Pt(St);Lt=setTimeout(Ue,Le(St))}function Pt(St){return Lt=void 0,fn&&$e?gt(St):($e=dt=void 0,pt)}function kt(){Lt!==void 0&&clearTimeout(Lt),zt=0,$e=lt=dt=Lt=void 0}function qt(){return Lt===void 0?pt:Pt(j())}function Wt(){var St=j(),Ft=te(St);if($e=arguments,dt=this,lt=St,Ft){if(Lt===void 0)return Et(lt);if(ln)return Lt=setTimeout(Ue,_e),gt(lt)}return Lt===void 0&&(Lt=setTimeout(Ue,_e)),pt}return Wt.cancel=kt,Wt.flush=qt,Wt}function ne(de){var _e=typeof de;return!!de&&(_e=="object"||_e=="function")}function xe(de){return!!de&&typeof de=="object"}function ce(de){return typeof de=="symbol"||xe(de)&&q.call(de)==c}function me(de){if(typeof de=="number")return de;if(ce(de))return s;if(ne(de)){var _e=typeof de.valueOf=="function"?de.valueOf():de;de=ne(_e)?_e+"":_e}if(typeof de!="string")return de===0?de:+de;de=de.replace(p,"");var Se=T.test(de);return Se||S.test(de)?k(de.slice(2),Se?2:8):_.test(de)?s:+de}return cv=Z,cv}var $g={exports:{}},Ub;function iD(){if(Ub)return $g.exports;Ub=1;var i=typeof Reflect=="object"?Reflect:null,s=i&&typeof i.apply=="function"?i.apply:function(de,_e,Se){return Function.prototype.apply.call(de,_e,Se)},c;i&&typeof i.ownKeys=="function"?c=i.ownKeys:Object.getOwnPropertySymbols?c=function(de){return Object.getOwnPropertyNames(de).concat(Object.getOwnPropertySymbols(de))}:c=function(de){return Object.getOwnPropertyNames(de)};function p(me){console&&console.warn&&console.warn(me)}var _=Number.isNaN||function(de){return de!==de};function T(){T.init.call(this)}$g.exports=T,$g.exports.once=ne,T.EventEmitter=T,T.prototype._events=void 0,T.prototype._eventsCount=0,T.prototype._maxListeners=void 0;var S=10;function k(me){if(typeof me!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof me)}Object.defineProperty(T,"defaultMaxListeners",{enumerable:!0,get:function(){return S},set:function(me){if(typeof me!="number"||me<0||_(me))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+me+".");S=me}}),T.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},T.prototype.setMaxListeners=function(de){if(typeof de!="number"||de<0||_(de))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+de+".");return this._maxListeners=de,this};function o(me){return me._maxListeners===void 0?T.defaultMaxListeners:me._maxListeners}T.prototype.getMaxListeners=function(){return o(this)},T.prototype.emit=function(de){for(var _e=[],Se=1;Se<arguments.length;Se++)_e.push(arguments[Se]);var $e=de==="error",dt=this._events;if(dt!==void 0)$e=$e&&dt.error===void 0;else if(!$e)return!1;if($e){var Y;if(_e.length>0&&(Y=_e[0]),Y instanceof Error)throw Y;var pt=new Error("Unhandled error."+(Y?" ("+Y.message+")":""));throw pt.context=Y,pt}var Lt=dt[de];if(Lt===void 0)return!1;if(typeof Lt=="function")s(Lt,this,_e);else for(var lt=Lt.length,zt=H(Lt,lt),Se=0;Se<lt;++Se)s(zt[Se],this,_e);return!0};function I(me,de,_e,Se){var $e,dt,Y;if(k(_e),dt=me._events,dt===void 0?(dt=me._events=Object.create(null),me._eventsCount=0):(dt.newListener!==void 0&&(me.emit("newListener",de,_e.listener?_e.listener:_e),dt=me._events),Y=dt[de]),Y===void 0)Y=dt[de]=_e,++me._eventsCount;else if(typeof Y=="function"?Y=dt[de]=Se?[_e,Y]:[Y,_e]:Se?Y.unshift(_e):Y.push(_e),$e=o(me),$e>0&&Y.length>$e&&!Y.warned){Y.warned=!0;var pt=new Error("Possible EventEmitter memory leak detected. "+Y.length+" "+String(de)+" listeners added. Use emitter.setMaxListeners() to increase limit");pt.name="MaxListenersExceededWarning",pt.emitter=me,pt.type=de,pt.count=Y.length,p(pt)}return me}T.prototype.addListener=function(de,_e){return I(this,de,_e,!1)},T.prototype.on=T.prototype.addListener,T.prototype.prependListener=function(de,_e){return I(this,de,_e,!0)};function O(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function V(me,de,_e){var Se={fired:!1,wrapFn:void 0,target:me,type:de,listener:_e},$e=O.bind(Se);return $e.listener=_e,Se.wrapFn=$e,$e}T.prototype.once=function(de,_e){return k(_e),this.on(de,V(this,de,_e)),this},T.prototype.prependOnceListener=function(de,_e){return k(_e),this.prependListener(de,V(this,de,_e)),this},T.prototype.removeListener=function(de,_e){var Se,$e,dt,Y,pt;if(k(_e),$e=this._events,$e===void 0)return this;if(Se=$e[de],Se===void 0)return this;if(Se===_e||Se.listener===_e)--this._eventsCount===0?this._events=Object.create(null):(delete $e[de],$e.removeListener&&this.emit("removeListener",de,Se.listener||_e));else if(typeof Se!="function"){for(dt=-1,Y=Se.length-1;Y>=0;Y--)if(Se[Y]===_e||Se[Y].listener===_e){pt=Se[Y].listener,dt=Y;break}if(dt<0)return this;dt===0?Se.shift():j(Se,dt),Se.length===1&&($e[de]=Se[0]),$e.removeListener!==void 0&&this.emit("removeListener",de,pt||_e)}return this},T.prototype.off=T.prototype.removeListener,T.prototype.removeAllListeners=function(de){var _e,Se,$e;if(Se=this._events,Se===void 0)return this;if(Se.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Se[de]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Se[de]),this;if(arguments.length===0){var dt=Object.keys(Se),Y;for($e=0;$e<dt.length;++$e)Y=dt[$e],Y!=="removeListener"&&this.removeAllListeners(Y);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(_e=Se[de],typeof _e=="function")this.removeListener(de,_e);else if(_e!==void 0)for($e=_e.length-1;$e>=0;$e--)this.removeListener(de,_e[$e]);return this};function q(me,de,_e){var Se=me._events;if(Se===void 0)return[];var $e=Se[de];return $e===void 0?[]:typeof $e=="function"?_e?[$e.listener||$e]:[$e]:_e?Z($e):H($e,$e.length)}T.prototype.listeners=function(de){return q(this,de,!0)},T.prototype.rawListeners=function(de){return q(this,de,!1)},T.listenerCount=function(me,de){return typeof me.listenerCount=="function"?me.listenerCount(de):ee.call(me,de)},T.prototype.listenerCount=ee;function ee(me){var de=this._events;if(de!==void 0){var _e=de[me];if(typeof _e=="function")return 1;if(_e!==void 0)return _e.length}return 0}T.prototype.eventNames=function(){return this._eventsCount>0?c(this._events):[]};function H(me,de){for(var _e=new Array(de),Se=0;Se<de;++Se)_e[Se]=me[Se];return _e}function j(me,de){for(;de+1<me.length;de++)me[de]=me[de+1];me.pop()}function Z(me){for(var de=new Array(me.length),_e=0;_e<de.length;++_e)de[_e]=me[_e].listener||me[_e];return de}function ne(me,de){return new Promise(function(_e,Se){function $e(Y){me.removeListener(de,dt),Se(Y)}function dt(){typeof me.removeListener=="function"&&me.removeListener("error",$e),_e([].slice.call(arguments))}ce(me,de,dt,{once:!0}),de!=="error"&&xe(me,$e,{once:!0})})}function xe(me,de,_e){typeof me.on=="function"&&ce(me,"error",de,_e)}function ce(me,de,_e,Se){if(typeof me.on=="function")Se.once?me.once(de,_e):me.on(de,_e);else if(typeof me.addEventListener=="function")me.addEventListener(de,function $e(dt){Se.once&&me.removeEventListener(de,$e),_e(dt)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof me)}return $g.exports}var hv,$b;function oD(){return $b||($b=1,hv={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}),hv}var dv,Gb;function sD(){if(Gb)return dv;Gb=1;function i(p){var _=p.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return _?{key:_[1],value:_[2]}:null}function s(p){var _=p.match(/<?([^>]*)>(.*)/);if(!_)return null;var T=_[1],S=_[2].split(";"),k=null,o=S.reduce(function(I,O){var V=i(O);return V?V.key==="rel"?(k||(k=V.value),I):(I[V.key]=V.value,I):I},{});return k?{url:T,rel:k,params:o}:null}function c(p){return p?p.split(/,\s*</).reduce(function(_,T){var S=s(T);if(!S)return _;var k=S.rel.split(/\s+/);return k.forEach(function(o){_[o]||(_[o]={url:S.url,params:S.params})}),_},{}):{}}return dv=c,dv}var fv,qb;function aD(){if(qb)return fv;qb=1;var i=sD();function s(c,p){this.request=c,this.headers=p.headers,this.rawBody=p.body,this.statusCode=p.statusCode;try{this.body=JSON.parse(p.body||"{}")}catch{this.body=p.body}this.links=i(this.headers.link)}return s.prototype.hasNextPage=function(){return!!this.links.next},s.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},fv=s,fv}var pv,Wb;function Dy(){return Wb||(Wb=1,pv={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}),pv}var mv,Zb;function lD(){if(Zb)return mv;Zb=1;var i=Dy();function s(c){var p=c.type||i.ERROR_HTTP,_;if(c.body)try{_=JSON.parse(c.body)}catch{_=c.body}else _=null;var T=c.message||null;T||(typeof _=="string"?T=_:_&&typeof _.message=="string"?T=_.message:p===i.ERROR_REQUEST_ABORTED&&(T="Request aborted")),this.message=T,this.type=p,this.statusCode=c.statusCode||null,this.request=c.request,this.body=_}return mv=s,mv}var gv,Hb;function uD(){if(Hb)return gv;Hb=1;function i(c){var p=c.indexOf(":"),_=c.substring(0,p).trim().toLowerCase(),T=c.substring(p+1).trim();return{name:_,value:T}}function s(c){var p={};return c&&c.trim().split(/[\r|\n]+/).forEach(function(_){var T=i(_);p[T.name]=T.value}),p}return gv=s,gv}var yv,Xb;function cD(){if(Xb)return yv;Xb=1;var i=aD(),s=lD(),c=Dy(),p=uD(),_={};function T(V){var q=_[V.id];q&&(q.abort(),delete _[V.id])}function S(V,q){return new i(V,{body:q.response,headers:p(q.getAllResponseHeaders()),statusCode:q.status})}function k(V){var q=V.total,ee=V.loaded,H=100*ee/q;return{total:q,transferred:ee,percent:H}}function o(V,q){return new Promise(function(ee,H){q.onprogress=function(ne){V.emitter.emit(c.EVENT_PROGRESS_DOWNLOAD,k(ne))};var j=V.file;j&&(q.upload.onprogress=function(ne){V.emitter.emit(c.EVENT_PROGRESS_UPLOAD,k(ne))}),q.onerror=function(ne){H(ne)},q.onabort=function(){var ne=new s({request:V,type:c.ERROR_REQUEST_ABORTED});H(ne)},q.onload=function(){if(delete _[V.id],q.status<200||q.status>=400){var ne=new s({request:V,body:q.response,statusCode:q.status});H(ne);return}ee(q)};var Z=V.body;typeof Z=="string"?q.send(Z):Z?q.send(JSON.stringify(Z)):j?q.send(j):q.send(),_[V.id]=q}).then(function(ee){return S(V,ee)})}function I(V,q){var ee=V.url(q),H=new window.XMLHttpRequest;return H.open(V.method,ee),Object.keys(V.headers).forEach(function(j){H.setRequestHeader(j,V.headers[j])}),H}function O(V){return Promise.resolve().then(function(){var q=I(V,V.client.accessToken);return o(V,q)})}return yv={browserAbort:T,sendRequestXhr:o,browserSend:O,createRequestXhr:I},yv}var cm={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */var hD=cm.exports,Kb;function dD(){return Kb||(Kb=1,function(i,s){(function(c){var p=s,_=i&&i.exports==p&&i,T=typeof uh=="object"&&uh;(T.global===T||T.window===T)&&(c=T);var S=function(H){this.message=H};S.prototype=new Error,S.prototype.name="InvalidCharacterError";var k=function(H){throw new S(H)},o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=/[\t\n\f\r ]/g,O=function(H){H=String(H).replace(I,"");var j=H.length;j%4==0&&(H=H.replace(/==?$/,""),j=H.length),(j%4==1||/[^+a-zA-Z0-9/]/.test(H))&&k("Invalid character: the string to be decoded is not correctly encoded.");for(var Z=0,ne,xe,ce="",me=-1;++me<j;)xe=o.indexOf(H.charAt(me)),ne=Z%4?ne*64+xe:xe,Z++%4&&(ce+=String.fromCharCode(255&ne>>(-2*Z&6)));return ce},V=function(H){H=String(H),/[^\0-\xFF]/.test(H)&&k("The string to be encoded contains characters outside of the Latin1 range.");for(var j=H.length%3,Z="",ne=-1,xe,ce,me,de,_e=H.length-j;++ne<_e;)xe=H.charCodeAt(ne)<<16,ce=H.charCodeAt(++ne)<<8,me=H.charCodeAt(++ne),de=xe+ce+me,Z+=o.charAt(de>>18&63)+o.charAt(de>>12&63)+o.charAt(de>>6&63)+o.charAt(de&63);return j==2?(xe=H.charCodeAt(ne)<<8,ce=H.charCodeAt(++ne),de=xe+ce,Z+=o.charAt(de>>10)+o.charAt(de>>4&63)+o.charAt(de<<2&63)+"="):j==1&&(de=H.charCodeAt(ne),Z+=o.charAt(de>>2)+o.charAt(de<<4&63)+"=="),Z},q={encode:V,decode:O,version:"0.1.0"};if(p&&!p.nodeType)if(_)_.exports=q;else for(var ee in q)q.hasOwnProperty(ee)&&(p[ee]=q[ee]);else c.base64=q})(hD)}(cm,cm.exports)),cm.exports}var _v,Yb;function rC(){if(Yb)return _v;Yb=1;var i=dD(),s={};function c(T){if(s[T])return s[T];var S=T.split("."),k=S[0],o=S[1];if(!o)throw new Error("Invalid token");var I=p(o),O={usage:k,user:I.u};return _(I,"a")&&(O.authorization=I.a),_(I,"exp")&&(O.expires=I.exp*1e3),_(I,"iat")&&(O.created=I.iat*1e3),_(I,"scopes")&&(O.scopes=I.scopes),_(I,"client")&&(O.client=I.client),_(I,"ll")&&(O.lastLogin=I.ll),_(I,"iu")&&(O.impersonator=I.iu),s[T]=O,O}function p(T){try{return JSON.parse(i.decode(T))}catch{throw new Error("Invalid token")}}function _(T,S){return Object.prototype.hasOwnProperty.call(T,S)}return _v=c,_v}var vv={exports:{}},Jb;function fD(){return Jb||(Jb=1,function(i){var s=Object.prototype.hasOwnProperty,c="~";function p(){}Object.create&&(p.prototype=Object.create(null),new p().__proto__||(c=!1));function _(o,I,O){this.fn=o,this.context=I,this.once=O||!1}function T(o,I,O,V,q){if(typeof O!="function")throw new TypeError("The listener must be a function");var ee=new _(O,V||o,q),H=c?c+I:I;return o._events[H]?o._events[H].fn?o._events[H]=[o._events[H],ee]:o._events[H].push(ee):(o._events[H]=ee,o._eventsCount++),o}function S(o,I){--o._eventsCount===0?o._events=new p:delete o._events[I]}function k(){this._events=new p,this._eventsCount=0}k.prototype.eventNames=function(){var I=[],O,V;if(this._eventsCount===0)return I;for(V in O=this._events)s.call(O,V)&&I.push(c?V.slice(1):V);return Object.getOwnPropertySymbols?I.concat(Object.getOwnPropertySymbols(O)):I},k.prototype.listeners=function(I){var O=c?c+I:I,V=this._events[O];if(!V)return[];if(V.fn)return[V.fn];for(var q=0,ee=V.length,H=new Array(ee);q<ee;q++)H[q]=V[q].fn;return H},k.prototype.listenerCount=function(I){var O=c?c+I:I,V=this._events[O];return V?V.fn?1:V.length:0},k.prototype.emit=function(I,O,V,q,ee,H){var j=c?c+I:I;if(!this._events[j])return!1;var Z=this._events[j],ne=arguments.length,xe,ce;if(Z.fn){switch(Z.once&&this.removeListener(I,Z.fn,void 0,!0),ne){case 1:return Z.fn.call(Z.context),!0;case 2:return Z.fn.call(Z.context,O),!0;case 3:return Z.fn.call(Z.context,O,V),!0;case 4:return Z.fn.call(Z.context,O,V,q),!0;case 5:return Z.fn.call(Z.context,O,V,q,ee),!0;case 6:return Z.fn.call(Z.context,O,V,q,ee,H),!0}for(ce=1,xe=new Array(ne-1);ce<ne;ce++)xe[ce-1]=arguments[ce];Z.fn.apply(Z.context,xe)}else{var me=Z.length,de;for(ce=0;ce<me;ce++)switch(Z[ce].once&&this.removeListener(I,Z[ce].fn,void 0,!0),ne){case 1:Z[ce].fn.call(Z[ce].context);break;case 2:Z[ce].fn.call(Z[ce].context,O);break;case 3:Z[ce].fn.call(Z[ce].context,O,V);break;case 4:Z[ce].fn.call(Z[ce].context,O,V,q);break;default:if(!xe)for(de=1,xe=new Array(ne-1);de<ne;de++)xe[de-1]=arguments[de];Z[ce].fn.apply(Z[ce].context,xe)}}return!0},k.prototype.on=function(I,O,V){return T(this,I,O,V,!1)},k.prototype.once=function(I,O,V){return T(this,I,O,V,!0)},k.prototype.removeListener=function(I,O,V,q){var ee=c?c+I:I;if(!this._events[ee])return this;if(!O)return S(this,ee),this;var H=this._events[ee];if(H.fn)H.fn===O&&(!q||H.once)&&(!V||H.context===V)&&S(this,ee);else{for(var j=0,Z=[],ne=H.length;j<ne;j++)(H[j].fn!==O||q&&!H[j].once||V&&H[j].context!==V)&&Z.push(H[j]);Z.length?this._events[ee]=Z.length===1?Z[0]:Z:S(this,ee)}return this},k.prototype.removeAllListeners=function(I){var O;return I?(O=c?c+I:I,this._events[O]&&S(this,O)):(this._events=new p,this._eventsCount=0),this},k.prototype.off=k.prototype.removeListener,k.prototype.addListener=k.prototype.on,k.prefixed=c,k.EventEmitter=k,i.exports=k}(vv)),vv.exports}var xv,Qb;function pD(){if(Qb)return xv;Qb=1;function i(S){return S.map(encodeURIComponent).join(",")}function s(S){return Array.isArray(S)?i(S):encodeURIComponent(String(S))}function c(S,k,o){if(o===!1||o===null)return S;var I=/\?/.test(S)?"&":"?",O=encodeURIComponent(k);return o!==void 0&&o!==""&&o!==!0&&(O+="="+s(o)),""+S+I+O}function p(S,k){if(!k)return S;var o=S;return Object.keys(k).forEach(function(I){var O=k[I];O!==void 0&&(Array.isArray(O)&&(O=O.filter(function(V){return V!=null}).join(",")),o=c(o,I,O))}),o}function _(S,k){if(!k||S.slice(0,4)==="http")return S;var o=S[0]==="/"?"":"/";return""+k.replace(/\/$/,"")+o+S}function T(S,k){return k?S.replace(/\/:([a-zA-Z0-9]+)/g,function(o,I){var O=k[I];if(O===void 0)throw new Error("Unspecified route parameter "+I);var V=s(O);return"/"+V}):S}return xv={appendQueryObject:p,appendQueryParam:c,prependOrigin:_,interpolateRouteParams:T},xv}var wv,eT;function mD(){if(eT)return wv;eT=1;var i=rC(),s=tp(),c=fD(),p=pD(),_=Dy(),T=1;function S(k,o){if(!k)throw new Error("MapiRequest requires a client");if(!o||!o.path||!o.method)throw new Error("MapiRequest requires an options object with path and method properties");var I={};o.body&&(I["content-type"]="application/json");var O=s(I,o.headers),V=Object.keys(O).reduce(function(q,ee){return q[ee.toLowerCase()]=O[ee],q},{});this.id=T++,this._options=o,this.emitter=new c,this.client=k,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=o.path,this.method=o.method,this.origin=o.origin||k.origin,this.query=o.query||{},this.params=o.params||{},this.body=o.body||null,this.file=o.file||null,this.encoding=o.encoding||"utf8",this.sendFileAs=o.sendFileAs||null,this.headers=V}return S.prototype.url=function(o){var I=p.prependOrigin(this.path,this.origin);I=p.appendQueryObject(I,this.query);var O=this.params,V=o??this.client.accessToken;if(V){I=p.appendQueryParam(I,"access_token",V);var q=i(V).user;O=s({ownerId:q},O)}return I=p.interpolateRouteParams(I,O),I},S.prototype.send=function(){var o=this;if(o.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return o.sent=!0,o.client.sendRequest(o).then(function(I){return o.response=I,o.emitter.emit(_.EVENT_RESPONSE,I),I},function(I){throw o.error=I,o.emitter.emit(_.EVENT_ERROR,I),I})},S.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))},S.prototype.eachPage=function(o){var I=this;function O(ee){function H(){delete I._nextPageRequest;var j=ee.nextPage();j&&(I._nextPageRequest=j,q(j))}o(null,ee,H)}function V(ee){o(ee,null,function(){})}function q(ee){ee.send().then(O,V)}q(this)},S.prototype.clone=function(){return this._extend()},S.prototype._extend=function(o){var I=s(this._options,o);return new S(this.client,I)},wv=S,wv}var bv,tT;function iC(){if(tT)return bv;tT=1;var i=rC(),s=mD(),c=Dy();function p(_){if(!_||!_.accessToken)throw new Error("Cannot create a client without an access token");i(_.accessToken),this.accessToken=_.accessToken,this.origin=_.origin||c.API_ORIGIN}return p.prototype.createRequest=function(T){return new s(this,T)},bv=p,bv}var Tv,nT;function oC(){if(nT)return Tv;nT=1;var i=cD(),s=iC();function c(_){s.call(this,_)}c.prototype=Object.create(s.prototype),c.prototype.constructor=c,c.prototype.sendRequest=i.browserSend,c.prototype.abortRequest=i.browserAbort;function p(_){return new c(_)}return Tv=p,Tv}var Ev,rT;function gD(){if(rT)return Ev;rT=1;var i=oC();return Ev=i,Ev}var Sv,iT;function yD(){if(iT)return Sv;iT=1;var i=Object.prototype.toString;return Sv=function(s){var c;return i.call(s)==="[object Object]"&&(c=Object.getPrototypeOf(s),c===null||c===Object.getPrototypeOf({}))},Sv}var Cv,oT;function _D(){if(oT)return Cv;oT=1;var i=yD(),s=tp(),c="value",p=`
  `,_={};_.assert=function(H,j){return j=j||{},function(Z){var ne=S(H,Z);if(ne){var xe=k(ne,j);throw j.apiName&&(xe=j.apiName+": "+xe),new Error(xe)}}},_.shape=function(j){var Z=ee(j);return function(xe){var ce=S(_.plainObject,xe);if(ce)return ce;for(var me,de,_e=[],Se=0;Se<Z.length;Se++)me=Z[Se].key,de=Z[Se].value,ce=S(de,xe[me]),ce&&_e.push([me].concat(ce));return _e.length<2?_e[0]:function($e){_e=_e.map(function(pt){var Lt=pt[0],lt=k(pt,$e).split(`
`).join(p);return"- "+Lt+": "+lt});var dt=$e.path.join("."),Y=dt===c?"":" of "+dt;return"The following properties"+Y+" have invalid values:"+p+_e.join(p)}}},_.strictShape=function(j){var Z=_.shape(j);return function(xe){var ce=Z(xe);if(ce)return ce;var me=Object.keys(xe).reduce(function(de,_e){return j[_e]===void 0&&de.push(_e),de},[]);if(me.length!==0)return function(){return"The following keys are invalid: "+me.join(", ")}}},_.arrayOf=function(j){return T(j)},_.tuple=function(){var j=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return T(j)};function T(H){var j=Array.isArray(H),Z=function(ne){return j?H[ne]:H};return function(xe){var ce=S(_.plainArray,xe);if(ce)return ce;if(j&&xe.length!==H.length)return"an array with "+H.length+" items";for(var me=0;me<xe.length;me++)if(ce=S(Z(me),xe[me]),ce)return[me].concat(ce)}}_.required=function(j){function Z(ne){return ne==null?function(xe){return V(xe,q(xe.path)?"cannot be undefined/null.":"is required.")}:j.apply(this,arguments)}return Z.__required=!0,Z},_.oneOfType=function(){var j=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(ne){var xe=j.map(function(ce){return S(ce,ne)}).filter(Boolean);if(xe.length===j.length)return xe.every(function(ce){return ce.length===1&&typeof ce[0]=="string"})?o(xe.map(function(ce){return ce[0]})):xe.reduce(function(ce,me){return me.length>ce.length?me:ce})}},_.equal=function(j){return function(ne){if(ne!==j)return JSON.stringify(j)}},_.oneOf=function(){var j=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),Z=j.map(function(ne){return _.equal(ne)});return _.oneOfType.apply(this,Z)},_.range=function(j){var Z=j[0],ne=j[1];return function(ce){var me=S(_.number,ce);if(me||ce<Z||ce>ne)return"number between "+Z+" & "+ne+" (inclusive)"}},_.any=function(){},_.boolean=function(j){if(typeof j!="boolean")return"boolean"},_.number=function(j){if(typeof j!="number")return"number"},_.plainArray=function(j){if(!Array.isArray(j))return"array"},_.plainObject=function(j){if(!i(j))return"object"},_.string=function(j){if(typeof j!="string")return"string"},_.func=function(j){if(typeof j!="function")return"function"};function S(H,j){if(!(j==null&&!H.hasOwnProperty("__required"))){var Z=H(j);if(Z)return Array.isArray(Z)?Z:[Z]}}function k(H,j){var Z=H.length,ne=H[Z-1],xe=H.slice(0,Z-1);return xe.length===0&&(xe=[c]),j=s(j,{path:xe}),typeof ne=="function"?ne(j):V(j,I(ne))}function o(H){return H.length<2?H[0]:H.length===2?H.join(" or "):H.slice(0,-1).join(", ")+", or "+H.slice(-1)}function I(H){return"must be "+O(H)+"."}function O(H){return/^an? /.test(H)?H:/^[aeiou]/i.test(H)?"an "+H:/^[a-z]/i.test(H)?"a "+H:H}function V(H,j){var Z=q(H.path),ne=H.path.join(".")+" "+j,xe=Z?"Item at position ":"";return xe+ne}function q(H){return typeof H[H.length-1]=="number"||typeof H[0]=="number"}function ee(H){return Object.keys(H||{}).map(function(j){return{key:j,value:H[j]}})}return _.validate=S,_.processMessage=k,Cv=_,Cv}var Av,sT;function vD(){if(sT)return Av;sT=1;var i=tp(),s=_D();function c(S){if(typeof window<"u")return S instanceof uh.Blob||S instanceof uh.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof S=="string"||S.pipe!==void 0))return"Filename or Readable stream"}function p(S,k){return s.assert(s.strictShape(S),k)}function _(S){var k="date";if(typeof S=="boolean")return k;try{var o=new Date(S);if(o.getTime&&isNaN(o.getTime()))return k}catch{return k}}function T(S){return s.tuple(s.number,s.number)(S)}return Av=i(s,{file:c,date:_,coordinates:T,assertShape:p}),Av}var Mv,aT;function xD(){if(aT)return Mv;aT=1;function i(s,c){var p=function(_,T){return c.indexOf(_)!==-1&&T!==void 0};return typeof c=="function"&&(p=c),Object.keys(s).filter(function(_){return p(_,s[_])}).reduce(function(_,T){return _[T]=s[T],_},{})}return Mv=i,Mv}var kv,lT;function wD(){if(lT)return kv;lT=1;function i(s,c){return Object.keys(s).reduce(function(p,_){return p[_]=c(_,s[_]),p},{})}return kv=i,kv}var Pv,uT;function bD(){if(uT)return Pv;uT=1;var i=wD();function s(c){return i(c,function(p,_){return typeof _=="boolean"?JSON.stringify(_):_})}return Pv=s,Pv}var Iv,cT;function TD(){if(cT)return Iv;cT=1;var i=iC(),s=oC();function c(p){return function(_){var T;i.prototype.isPrototypeOf(_)?T=_:T=s(_);var S=Object.create(p);return S.client=T,S}}return Iv=c,Iv}var Rv,hT;function ED(){if(hT)return Rv;hT=1;var i=tp(),s=vD(),c=xD(),p=bD(),_=TD(),T={},S=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];return T.forwardGeocode=function(k){s.assertShape({query:s.required(s.string),mode:s.oneOf("mapbox.places","mapbox.places-permanent"),countries:s.arrayOf(s.string),proximity:s.oneOf(s.coordinates,"ip"),types:s.arrayOf(s.oneOf(S)),autocomplete:s.boolean,bbox:s.arrayOf(s.number),limit:s.number,language:s.arrayOf(s.string),routing:s.boolean,fuzzyMatch:s.boolean,worldview:s.string,session_token:s.string})(k),k.mode=k.mode||"mapbox.places";var o=p(i({country:k.countries},c(k,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview","session_token"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:c(k,["mode","query"]),query:o})},T.reverseGeocode=function(k){s.assertShape({query:s.required(s.coordinates),mode:s.oneOf("mapbox.places","mapbox.places-permanent"),countries:s.arrayOf(s.string),types:s.arrayOf(s.oneOf(S)),bbox:s.arrayOf(s.number),limit:s.number,language:s.arrayOf(s.string),reverseMode:s.oneOf("distance","score"),routing:s.boolean,worldview:s.string,session_token:s.string})(k),k.mode=k.mode||"mapbox.places";var o=p(i({country:k.countries},c(k,["country","types","bbox","limit","language","reverseMode","routing","worldview","session_token"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:c(k,["mode","query"]),query:o})},Rv=_(T),Rv}let SD="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",sC=i=>crypto.getRandomValues(new Uint8Array(i)),aC=(i,s,c)=>{let p=(2<<Math.log(i.length-1)/Math.LN2)-1,_=-~(1.6*p*s/i.length);return(T=s)=>{let S="";for(;;){let k=c(_),o=_|0;for(;o--;)if(S+=i[k[o]&p]||"",S.length===T)return S}}},CD=(i,s=21)=>aC(i,s,sC),AD=(i=21)=>crypto.getRandomValues(new Uint8Array(i)).reduce((s,c)=>(c&=63,c<36?s+=c.toString(36):c<62?s+=(c-26).toString(36).toUpperCase():c>62?s+="-":s+="_",s),"");const MD=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet:CD,customRandom:aC,nanoid:AD,random:sC,urlAlphabet:SD},Symbol.toStringTag,{value:"Module"})),kD=zM(MD);var Lv,dT;function PD(){if(dT)return Lv;dT=1;var i=kD.nanoid;function s(c){this.origin=c.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=c.accessToken,this.version="0.3.0",this.pluginSessionID=this.generateSessionID(),this.sessionIncrementer=0,this.userAgent=this.getUserAgent(),this.options=c,this.send=this.send.bind(this),this.countries=c.countries?c.countries.split(","):null,this.types=c.types?c.types.split(","):null,this.bbox=c.bbox?c.bbox:null,this.language=c.language?c.language.split(","):null,this.limit=c.limit?+c.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(c),this.eventQueue=new Array,this.flushInterval=c.flushInterval||1e3,this.maxQueueSize=c.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}return s.prototype={select:function(c,p){var _=this.getEventPayload("search.select",p,{selectedFeature:c});if(_&&!(_.resultIndex===this.lastSentIndex&&_.queryString===this.lastSentInput||_.resultIndex==-1))return this.lastSentIndex=_.resultIndex,this.lastSentInput=_.queryString,this.push(_)},start:function(c){var p=this.getEventPayload("search.start",c);if(p)return this.push(p)},keyevent:function(c,p){if(c.key&&!(c.metaKey||[9,27,37,39,13,38,40].indexOf(c.keyCode)!==-1)){var _=this.getEventPayload("search.keystroke",p,{key:c.key});if(_)return this.push(_)}},send:function(c,p){if(!this.enableEventLogging)return p?p():void 0;var _=this.getRequestOptions(c);this.request(_,(function(T){if(T)return this.handleError(T,p);if(p)return p()}).bind(this))},getRequestOptions:function(c){Array.isArray(c)||(c=[c]);var p={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(c)};return p},getEventPayload:function(c,p,_={}){if(c==="search.select"&&!_.selectedFeature||c==="search.keystroke"&&!_.key)return null;var T;if(!p.options.proximity)T=null;else if(typeof p.options.proximity=="object")T=[p.options.proximity.longitude,p.options.proximity.latitude];else if(p.options.proximity==="ip"){var S=p._headers?p._headers["ip-proximity"]:null;S&&typeof S=="string"?T=S.split(",").map(parseFloat):T=[999,999]}else T=p.options.proximity;var k=p._map?p._map.getZoom():void 0,o={event:c,version:this.getEventSchemaVersion(c),created:+new Date,sessionIdentifier:this.getSessionId(),country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:p.options.autocomplete,fuzzyMatch:p.options.fuzzyMatch,proximity:T,limit:p.options.limit,routing:p.options.routing,worldview:p.options.worldview,mapZoom:k,keyboardLocale:this.locale};if(c==="search.select"?o.queryString=p.inputString:c!="search.select"&&p._inputEl?o.queryString=p._inputEl.value:o.queryString=p.inputString,["search.keystroke","search.select"].includes(c)&&(o.path="geocoding/v5/mapbox.places"),c==="search.keystroke"&&_.key)o.lastAction=_.key;else if(c==="search.select"&&_.selectedFeature){var I=_.selectedFeature,O=this.getSelectedIndex(I,p);if(o.resultIndex=O,o.resultPlaceName=I.place_name,o.resultId=I.id,I.properties&&(o.resultMapboxId=I.properties.mapbox_id),p._typeahead){var V=p._typeahead.data;V&&V.length>0&&(o.suggestionIds=this.getSuggestionIds(V),o.suggestionNames=this.getSuggestionNames(V),o.suggestionTypes=this.getSuggestionTypes(V),o.suggestionSources=this.getSuggestionSources(V))}}return this.validatePayload(o)?o:null},request:function(c,p){var _=new XMLHttpRequest;_.onreadystatechange=function(){if(this.readyState==4)return this.status==204?p(null):p(this.statusText)},_.open(c.method,c.host+"/"+c.path,!0);for(var T in c.headers){var S=c.headers[T];_.setRequestHeader(T,S)}_.send(c.body)},handleError:function(c,p){if(p)return p(c)},generateSessionID:function(){return i()},getSessionId:function(){return this.pluginSessionID+"."+this.sessionIncrementer},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(c,p){if(p._typeahead){var _=p._typeahead.data,T=c.id,S=_.map(function(o){return o.id}),k=S.indexOf(T);return k}},getSuggestionIds:function(c){return c.map(function(p){return p.properties?p.properties.mapbox_id||"":p.id||""})},getSuggestionNames:function(c){return c.map(function(p){return p.place_name||""})},getSuggestionTypes:function(c){return c.map(function(p){return p.place_type&&Array.isArray(p.place_type)&&p.place_type[0]||""})},getSuggestionSources:function(c){return c.map(function(p){return p._source||""})},getEventSchemaVersion:function(c){return["search.keystroke","search.select"].includes(c)?"2.2":"2.0"},validatePayload:function(c){if(!c||!c.event)return!1;var p=["event","created","sessionIdentifier","queryString"],_=["event","created","sessionIdentifier","queryString","lastAction"],T=["event","created","sessionIdentifier","queryString","resultIndex","path","suggestionIds"],S=c.event;return S==="search.start"?this.objectHasRequiredProps(c,p):S==="search.keystroke"?this.objectHasRequiredProps(c,_):S==="search.select"?this.objectHasRequiredProps(c,T):!0},objectHasRequiredProps:function(c,p){return p.every(function(_){return _==="queryString"?typeof c[_]=="string"&&c[_].length>0:c[_]!==void 0})},shouldEnableLogging:function(c){return!(c.enableEventLogging===!1||c.origin&&c.origin!=="https://api.mapbox.com")},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(c,p){this.eventQueue.push(c),(this.eventQueue.length>=this.maxQueueSize||p)&&this.flush()},remove:function(){this.flush()}},Lv=s,Lv}var Dv,fT;function ID(){if(fT)return Dv;fT=1;var i={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"לחפש",ja:"サーチ",lv:"Meklēt",pt:"Procurar",sr:"Претрага",zh:"搜索",cs:"Vyhledávání",hu:"Keresés",ka:"ძიება",nb:"Søke",sk:"Vyhľadávanie",th:"ค้นหา",fi:"Hae",is:"Leita",ko:"수색",pl:"Szukaj",sl:"Iskanje",fa:"جستجو",ru:"Поиск"};return Dv={placeholder:i},Dv}var ry={exports:{}},RD=ry.exports,pT;function LD(){return pT||(pT=1,function(i){(function(s,c,p){i.exports?i.exports=p():s[c]=p()})(RD,"subtag",function(){var s="",c=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function p(o){return o.match(c)||[]}function _(o){return p(o).filter(function(I,O){return I&&O})}function T(o){return o=p(o),{language:o[1]||s,extlang:o[2]||s,script:o[3]||s,region:o[4]||s}}function S(o,I,O){Object.defineProperty(o,I,{value:O,enumerable:!0})}function k(o,I,O){function V(q){return p(q)[o]||s}S(V,"pattern",I),S(T,O,V)}return k(1,/^[a-zA-Z]{2,3}$/,"language"),k(2,/^[a-zA-Z]{3}$/,"extlang"),k(3,/^[a-zA-Z]{4}$/,"script"),k(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),S(T,"split",_),T})}(ry)),ry.exports}var zv,mT;function DD(){if(mT)return zv;mT=1;function i(){}return i.prototype={isSupport:function(){return!!window.navigator.geolocation},getCurrentPosition:function(){const s={enableHighAccuracy:!0};return new Promise(function(c,p){window.navigator.geolocation.getCurrentPosition(c,p,s)})}},zv=i,zv}var Ov,gT;function zD(){if(gT)return Ov;gT=1;function i(p,_){const T=s(p),S=["address","street","place","country"];var k;if(typeof _=="function")return _(T);const o=S.indexOf(_);return o===-1?k=S:k=S.slice(o),k.reduce(function(I,O){return T[O]?(I!==""&&(I=I+", "),I+T[O]):I},"")}function s(p){const _=p.address||"",T=p.text||"",S=p.place_name||"",o={address:S.split(",")[0],houseNumber:_,street:T,placeName:S};return p.context.forEach(function(I){const O=I.id.split(".")[0];o[O]=I.text}),o}return Ov={transformFeatureToGeolocationText:i,getAddressInfo:s,REVERSE_GEOCODE_COORD_RGX:/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/},Ov}var Bv,yT;function OD(){if(yT)return Bv;yT=1;var i=nD(),s=rD(),c=tp(),p=iD().EventEmitter,_=oD(),T=gD(),S=ED(),k=PD(),o=ID(),I=LD(),O=DD(),V=zD();const q={FORWARD:0,LOCAL:1,REVERSE:2};function ee(){var j=document.createElement("div");return j.className="mapboxgl-ctrl-geocoder--powered-by",j.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',j}function H(j){this._eventEmitter=new p,this.options=c({},this.options,j),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new O}return H.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(j){return j.place_name},render:function(j){var Z=j.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+Z[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+Z.splice(1,Z.length).join(",")+"</div></div>"}},_headers:{},addTo:function(j){function Z(ne,xe){if(!document.body.contains(xe))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const ce=ne.onAdd();xe.appendChild(ce)}if(j._controlContainer)j.addControl(this);else if(j instanceof HTMLElement)Z(this,j);else if(typeof j=="string"){const ne=document.querySelectorAll(j);if(ne.length===0)throw new Error("Element ",j,"not found.");if(ne.length>1)throw new Error("Geocoder can only be added to a single html element");Z(this,ne[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(j){if(j&&typeof j!="string"&&(this._map=j),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=S(T({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new k(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var Z=this.container=document.createElement("div");Z.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var ne=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",s(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function($e){this.eventManager.keyevent($e,this)}).bind(this));var xe=document.createElement("div");xe.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var ce=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(ce),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),xe.appendChild(this._clearEl),xe.appendChild(this._loadingEl),Z.appendChild(ne),Z.appendChild(this._inputEl),Z.appendChild(xe),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var me=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(me),xe.appendChild(this._geolocateEl),this._showGeolocateButton()}var de=this._typeahead=new i(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),de.getItemValue=this.options.getItemValue;var _e=de.list.draw,Se=this._footerNode=ee();return de.list.draw=function(){_e.call(this),Se.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),Se.addEventListener("mouseup",(function(){this.selectingListItem=!1}).bind(this)),this.element.appendChild(Se)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),Z},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then((function(j){this._hideLoadingIcon();const Z={geometry:{type:"Point",coordinates:[j.coords.longitude,j.coords.latitude]}};this._handleMarker(Z),this._fly(Z),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(Z),this._showClearButton(),this.fresh=!1;const ne={limit:1,language:[this.options.language],query:Z.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const xe=Z.geometry.coordinates[0]+","+Z.geometry.coordinates[1];this._setInputValue(xe),this._eventEmitter.emit("result",{result:Z})}else this.geocoderService.reverseGeocode(ne).send().then((function(xe){const ce=xe.body.features[0];if(ce){const me=V.transformFeatureToGeolocationText(ce,this.options.addressAccuracy);this._setInputValue(me),ce.user_coordinates=Z.geometry.coordinates,this._eventEmitter.emit("result",{result:ce})}else this._eventEmitter.emit("result",{result:{user_coordinates:Z.geometry.coordinates}})}).bind(this))}).bind(this)).catch((function(j){j.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}).bind(this))},createIcon:function(j,Z){var ne=document.createElementNS("http://www.w3.org/2000/svg","svg");return ne.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+j),ne.setAttribute("viewBox","0 0 18 18"),ne.setAttribute("xml:space","preserve"),ne.setAttribute("width",18),ne.setAttribute("height",18),ne.innerHTML=Z,ne},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(j){this._inputEl.value=j,setTimeout((function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}).bind(this),1)},_onPaste:function(j){var Z=(j.clipboardData||window.clipboardData).getData("text");Z.length>=this.options.minLength&&this._geocode(Z)},_onKeyDown:function(j){var Z=27,ne=9;if(j.keyCode===Z&&this.options.clearAndBlurOnEsc)return this._clear(j),this._inputEl.blur();var xe=j.target&&j.target.shadowRoot?j.target.shadowRoot.activeElement:j.target,ce=xe?xe.value:"";if(!ce)return this.fresh=!0,j.keyCode!==ne&&this.clear(j),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(j.metaKey||[ne,Z,37,39,13,38,40].indexOf(j.keyCode)!==-1)&&xe.value.length>=this.options.minLength&&this._geocode(xe.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(j){this.options.clearOnBlur&&this._clearOnBlur(j),this.options.collapsed&&this._collapse()},_onChange:function(){var j=this._typeahead.selected;j&&JSON.stringify(j)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(j),this.options.marker&&this._mapboxgl&&this._handleMarker(j),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(j),this._eventEmitter.emit("result",{result:j}),this.eventManager.select(j,this))},_fly:function(j){var Z;if(j.properties&&_[j.properties.short_code])Z=c({},this.options.flyTo),this._map&&this._map.fitBounds(_[j.properties.short_code].bbox,Z);else if(j.bbox){var ne=j.bbox;Z=c({},this.options.flyTo),this._map&&this._map.fitBounds([[ne[0],ne[1]],[ne[2],ne[3]]],Z)}else{var xe={zoom:this.options.zoom};Z=c({},xe,this.options.flyTo),j.center?Z.center=j.center:j.geometry&&j.geometry.type&&j.geometry.type==="Point"&&j.geometry.coordinates&&(Z.center=j.geometry.coordinates),this._map&&this._map.flyTo(Z)}},_requestType:function(j,Z){var ne;return j.localGeocoderOnly?ne=q.LOCAL:j.reverseGeocode&&V.REVERSE_GEOCODE_COORD_RGX.test(Z)?ne=q.REVERSE:ne=q.FORWARD,ne},_setupConfig:function(j,Z){const ne=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],xe=/[\s,]+/;var ce=this,me=ne.reduce(function(_e,Se){if(ce.options[Se]===void 0||ce.options[Se]===null)return _e;["countries","types","language"].indexOf(Se)>-1?_e[Se]=ce.options[Se].split(xe):_e[Se]=ce.options[Se];const $e=typeof ce.options[Se].longitude=="number"&&typeof ce.options[Se].latitude=="number";if(Se==="proximity"&&$e){const dt=ce.options[Se].longitude,Y=ce.options[Se].latitude;_e[Se]=[dt,Y]}return _e},{});switch(j){case q.REVERSE:{var de=Z.split(xe).map(function(_e){return parseFloat(_e,10)});ce.options.flipCoordinates||de.reverse(),me.types&&me.types[0],me=c(me,{query:de,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(_e){_e in me&&delete me[_e]})}break;case q.FORWARD:{const _e=Z.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(_e)&&(Z=Z.replace(/,/g," ")),me=c(me,{query:Z})}break}return me.session_token=this.eventManager.getSessionId(),me},_geocode:function(j){this.inputString=j,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:j});const Z=this._requestType(this.options,j),ne=this._setupConfig(Z,j);var xe;switch(Z){case q.LOCAL:xe=Promise.resolve();break;case q.FORWARD:xe=this.geocoderService.forwardGeocode(ne).send();break;case q.REVERSE:xe=this.geocoderService.reverseGeocode(ne).send();break}var ce=this.options.localGeocoder?this.options.localGeocoder(j)||[]:[],me=[],de=null;return xe.catch((function(_e){de=_e}).bind(this)).then((function(_e){this._hideLoadingIcon();var Se={};return _e?_e.statusCode=="200"&&(Se=_e.body,Se.request=_e.request,Se.headers=_e.headers,this._headers=_e.headers):Se={type:"FeatureCollection",features:[]},Se.config=ne,this.fresh&&(this.eventManager.start(this),this.fresh=!1),Se.features&&Se.features.length&&Se.features.map(function($e){$e._source="mapbox"}),Se.features=Se.features?ce.concat(Se.features):ce,this.options.externalGeocoder?(me=this.options.externalGeocoder(j,Se.features)||Promise.resolve([]),me.then(function($e){return Se.features=Se.features?$e.concat(Se.features):$e,Se},function(){return Se})):Se}).bind(this)).then((function(_e){if(de)throw de;this.options.filter&&_e.features.length&&(_e.features=_e.features.filter(this.options.filter)),_e.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",_e),this._typeahead.update(_e.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",_e))}).bind(this)).catch((function(_e){this._hideLoadingIcon(),this._hideAttribution(),ce.length&&this.options.localGeocoder||me.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(ce)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:ce}),this._eventEmitter.emit("error",{error:_e})}).bind(this)),xe},_clear:function(j){j&&j.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this.eventManager.sessionIncrementer++,this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(j){this._clear(j),this._inputEl.focus()},_clearOnBlur:function(j){var Z=this;j.relatedTarget&&Z._clear(j)},_onQueryResult:function(j){var Z=j.body;if(Z.features.length){var ne=Z.features[0];this._typeahead.selected=ne,this._inputEl.value=ne.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var j=this._map.getCenter().wrap();this.setProximity({longitude:j.lng,latitude:j.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(j){return this._geocode(j).then(this._onQueryResult),this},_renderError:function(){var j="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(j)},_renderLocationError:function(){var j="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(j)},_renderNoResults:function(){var j="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(j)},_renderUserDeniedGeolocationError:function(){var j="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(j)},_renderMessage:function(j){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(j)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var j=this.options.language.split(",")[0],Z=I.language(j),ne=o.placeholder[Z];if(ne)return ne}return"Search"},setInput:function(j,Z){return Z===void 0&&(Z=!1),this._inputEl.value=j,this._typeahead.selected=null,this._typeahead.clear(),j.length>=this.options.minLength&&(Z?this._geocode(j):this._onChange()),this},setProximity:function(j,Z=!0){return this.options.proximity=j,Z&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(j){return j&&typeof j=="function"&&(this._typeahead.render=j),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(j){var Z=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=j||this.options.language||Z,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(j){return this.options.zoom=j,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(j){return this.options.flyTo=j,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(j){return this.options.placeholder=j||this._getPlaceholderText(),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(j){return this.options.bbox=j,this},getCountries:function(){return this.options.countries},setCountries:function(j){return this.options.countries=j,this},getTypes:function(){return this.options.types},setTypes:function(j){return this.options.types=j,this},getMinLength:function(){return this.options.minLength},setMinLength:function(j){return this.options.minLength=j,this._typeahead&&(this._typeahead.options.minLength=j),this},getLimit:function(){return this.options.limit},setLimit:function(j){return this.options.limit=j,this._typeahead&&(this._typeahead.options.limit=j),this},getFilter:function(){return this.options.filter},setFilter:function(j){return this.options.filter=j,this},setOrigin:function(j){return this.options.origin=j,this.geocoderService=S(T({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(j){return this.options.accessToken=j,this.geocoderService=S(T({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(j){return this.options.autocomplete=j,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(j){return this.options.fuzzyMatch=j,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(j){return this.options.routing=j,this},getRouting:function(){return this.options.routing},setWorldview:function(j){return this.options.worldview=j,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(j){if(this._map){this._removeMarker();var Z={color:"#4668F2"},ne=c({},Z,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(ne),j.center?this.mapMarker.setLngLat(j.center).addTo(this._map):j.geometry&&j.geometry.type&&j.geometry.type==="Point"&&j.geometry.coordinates&&this.mapMarker.setLngLat(j.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(j,Z){return this._eventEmitter.on(j,Z),this},off:function(j,Z){return this._eventEmitter.removeListener(j,Z),this.eventManager.remove(),this}},Bv=H,Bv}var BD=OD();const FD=Ay(BD),ND=(i,s=null)=>{const[c,p]=Ee.useState(s||null),[_,T]=Ee.useState(null);Ee.useEffect(()=>{s?(p(s),S(s.lat,s.lng)):"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(async k=>{const o=k.coords.latitude,I=k.coords.longitude;p({lat:o,lng:I})})},[s]);const S=(k,o)=>{let I=null,O=1/0;i.forEach(V=>{const q=Math.sqrt(Math.pow(k-V.lat,2)+Math.pow(o-V.lng,2));q<O&&(O=q,I=V)}),T(I)};return{userLocation:c,nearestPOI:_}},Fv="pk.eyJ1IjoidmVyaWZpZWRmaW5uIiwiYSI6ImNtN21tdWQ2ZjBqcm8ycnIwNXFwN2Z4bGcifQ.BckuIZ-IAbwTNq6oaIunGg",jD=()=>{const i=Ee.useRef(null),[s,c]=Ee.useState(null),[p,_]=Ee.useState(""),T=Ee.useRef(null),S=Ee.useRef(null),[k,o]=Ee.useState(!0),{userLocation:I}=ND([]),O=aa(),V=async(Z,ne)=>{var ce;const xe=`https://api.mapbox.com/geocoding/v5/mapbox.places/${ne},${Z}.json?access_token=${Fv}`;try{const _e=((ce=(await(await fetch(xe)).json()).features[0])==null?void 0:ce.place_name)||"Unknown Location";_(_e)}catch(me){console.error("❌ Failed to reverse geocode:",me)}},q=Z=>{const{lat:ne,lng:xe}=Z.lngLat;c({lat:ne,lng:xe}),V(ne,xe),T.current&&T.current.remove(),T.current=new If.Marker().setLngLat([xe,ne]).addTo(S.current)};Ee.useEffect(()=>{const Z=new If.Map({container:i.current,style:"mapbox://styles/mapbox/streets-v11",center:[-6.2603,53.3498],zoom:14,accessToken:Fv});S.current=Z;const ne=new FD({accessToken:Fv,mapboxgl:If,marker:!1});return Z.addControl(ne,"top-left"),ne.on("result",xe=>{const[ce,me]=xe.result.center;c({lng:ce,lat:me}),V(me,ce),T.current&&T.current.remove(),T.current=new If.Marker().setLngLat([ce,me]).addTo(Z),Z.flyTo({center:[ce,me],zoom:14})}),Z.on("click",q),()=>{Z.off("click",q),Z.remove()}},[]),Ee.useEffect(()=>{I&&S.current&&!s&&(o(!1),V(I.lat,I.lng),S.current.flyTo({center:[I.lng,I.lat],zoom:14}),T.current&&T.current.remove(),T.current=new If.Marker().setLngLat([I.lng,I.lat]).addTo(S.current))},[I,s]);const ee=()=>{I&&S.current&&(S.current.flyTo({center:[I.lng,I.lat],zoom:14}),T.current&&T.current.remove(),T.current=new If.Marker().setLngLat([I.lng,I.lat]).addTo(S.current))},H=()=>O(-1),j=()=>{const Z=s||I;Z&&p&&O(`/filter-page?lat=${Z.lat}&lng=${Z.lng}&locationName=${encodeURIComponent(p)}`)};return Be.jsxs("div",{className:"map-page",children:[Be.jsx("h1",{children:"Location Selection"}),k&&Be.jsx("p",{children:"Loading your location..."}),Be.jsx("div",{ref:i,style:{width:"100%",height:"500px"}}),s?Be.jsxs("p",{children:["📍 Selected Location: ",s.lat,", ",s.lng]}):I?Be.jsxs("p",{children:["📍 Your Location: ",I.lat,", ",I.lng]}):Be.jsx("p",{children:"📍 Loading location..."}),p&&Be.jsxs("p",{style:{marginTop:"10px"},children:["Location: ",p]}),Be.jsx("button",{onClick:H,className:"back-button",children:"⬅ Go Back"}),Be.jsxs("div",{className:"focus-button",children:[Be.jsx("button",{onClick:ee,children:"📍 Use My Location"}),Be.jsx("button",{onClick:j,className:"confirm-location",children:"✅ Confirm Location"})]})]})};function lC(i,s){return function(){return i.apply(s,arguments)}}const{toString:VD}=Object.prototype,{getPrototypeOf:gx}=Object,{iterator:zy,toStringTag:uC}=Symbol,Oy=(i=>s=>{const c=VD.call(s);return i[c]||(i[c]=c.slice(8,-1).toLowerCase())})(Object.create(null)),gl=i=>(i=i.toLowerCase(),s=>Oy(s)===i),By=i=>s=>typeof s===i,{isArray:np}=Array,Mm=By("undefined");function UD(i){return i!==null&&!Mm(i)&&i.constructor!==null&&!Mm(i.constructor)&&Os(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}const cC=gl("ArrayBuffer");function $D(i){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(i):s=i&&i.buffer&&cC(i.buffer),s}const GD=By("string"),Os=By("function"),hC=By("number"),Fy=i=>i!==null&&typeof i=="object",qD=i=>i===!0||i===!1,iy=i=>{if(Oy(i)!=="object")return!1;const s=gx(i);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(uC in i)&&!(zy in i)},WD=gl("Date"),ZD=gl("File"),HD=gl("Blob"),XD=gl("FileList"),KD=i=>Fy(i)&&Os(i.pipe),YD=i=>{let s;return i&&(typeof FormData=="function"&&i instanceof FormData||Os(i.append)&&((s=Oy(i))==="formdata"||s==="object"&&Os(i.toString)&&i.toString()==="[object FormData]"))},JD=gl("URLSearchParams"),[QD,ez,tz,nz]=["ReadableStream","Request","Response","Headers"].map(gl),rz=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Um(i,s,{allOwnKeys:c=!1}={}){if(i===null||typeof i>"u")return;let p,_;if(typeof i!="object"&&(i=[i]),np(i))for(p=0,_=i.length;p<_;p++)s.call(null,i[p],p,i);else{const T=c?Object.getOwnPropertyNames(i):Object.keys(i),S=T.length;let k;for(p=0;p<S;p++)k=T[p],s.call(null,i[k],k,i)}}function dC(i,s){s=s.toLowerCase();const c=Object.keys(i);let p=c.length,_;for(;p-- >0;)if(_=c[p],s===_.toLowerCase())return _;return null}const Ed=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,fC=i=>!Mm(i)&&i!==Ed;function y0(){const{caseless:i}=fC(this)&&this||{},s={},c=(p,_)=>{const T=i&&dC(s,_)||_;iy(s[T])&&iy(p)?s[T]=y0(s[T],p):iy(p)?s[T]=y0({},p):np(p)?s[T]=p.slice():s[T]=p};for(let p=0,_=arguments.length;p<_;p++)arguments[p]&&Um(arguments[p],c);return s}const iz=(i,s,c,{allOwnKeys:p}={})=>(Um(s,(_,T)=>{c&&Os(_)?i[T]=lC(_,c):i[T]=_},{allOwnKeys:p}),i),oz=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),sz=(i,s,c,p)=>{i.prototype=Object.create(s.prototype,p),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:s.prototype}),c&&Object.assign(i.prototype,c)},az=(i,s,c,p)=>{let _,T,S;const k={};if(s=s||{},i==null)return s;do{for(_=Object.getOwnPropertyNames(i),T=_.length;T-- >0;)S=_[T],(!p||p(S,i,s))&&!k[S]&&(s[S]=i[S],k[S]=!0);i=c!==!1&&gx(i)}while(i&&(!c||c(i,s))&&i!==Object.prototype);return s},lz=(i,s,c)=>{i=String(i),(c===void 0||c>i.length)&&(c=i.length),c-=s.length;const p=i.indexOf(s,c);return p!==-1&&p===c},uz=i=>{if(!i)return null;if(np(i))return i;let s=i.length;if(!hC(s))return null;const c=new Array(s);for(;s-- >0;)c[s]=i[s];return c},cz=(i=>s=>i&&s instanceof i)(typeof Uint8Array<"u"&&gx(Uint8Array)),hz=(i,s)=>{const p=(i&&i[zy]).call(i);let _;for(;(_=p.next())&&!_.done;){const T=_.value;s.call(i,T[0],T[1])}},dz=(i,s)=>{let c;const p=[];for(;(c=i.exec(s))!==null;)p.push(c);return p},fz=gl("HTMLFormElement"),pz=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(c,p,_){return p.toUpperCase()+_}),_T=(({hasOwnProperty:i})=>(s,c)=>i.call(s,c))(Object.prototype),mz=gl("RegExp"),pC=(i,s)=>{const c=Object.getOwnPropertyDescriptors(i),p={};Um(c,(_,T)=>{let S;(S=s(_,T,i))!==!1&&(p[T]=S||_)}),Object.defineProperties(i,p)},gz=i=>{pC(i,(s,c)=>{if(Os(i)&&["arguments","caller","callee"].indexOf(c)!==-1)return!1;const p=i[c];if(Os(p)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+c+"'")})}})},yz=(i,s)=>{const c={},p=_=>{_.forEach(T=>{c[T]=!0})};return np(i)?p(i):p(String(i).split(s)),c},_z=()=>{},vz=(i,s)=>i!=null&&Number.isFinite(i=+i)?i:s;function xz(i){return!!(i&&Os(i.append)&&i[uC]==="FormData"&&i[zy])}const wz=i=>{const s=new Array(10),c=(p,_)=>{if(Fy(p)){if(s.indexOf(p)>=0)return;if(!("toJSON"in p)){s[_]=p;const T=np(p)?[]:{};return Um(p,(S,k)=>{const o=c(S,_+1);!Mm(o)&&(T[k]=o)}),s[_]=void 0,T}}return p};return c(i,0)},bz=gl("AsyncFunction"),Tz=i=>i&&(Fy(i)||Os(i))&&Os(i.then)&&Os(i.catch),mC=((i,s)=>i?setImmediate:s?((c,p)=>(Ed.addEventListener("message",({source:_,data:T})=>{_===Ed&&T===c&&p.length&&p.shift()()},!1),_=>{p.push(_),Ed.postMessage(c,"*")}))(`axios@${Math.random()}`,[]):c=>setTimeout(c))(typeof setImmediate=="function",Os(Ed.postMessage)),Ez=typeof queueMicrotask<"u"?queueMicrotask.bind(Ed):typeof process<"u"&&process.nextTick||mC,Sz=i=>i!=null&&Os(i[zy]),at={isArray:np,isArrayBuffer:cC,isBuffer:UD,isFormData:YD,isArrayBufferView:$D,isString:GD,isNumber:hC,isBoolean:qD,isObject:Fy,isPlainObject:iy,isReadableStream:QD,isRequest:ez,isResponse:tz,isHeaders:nz,isUndefined:Mm,isDate:WD,isFile:ZD,isBlob:HD,isRegExp:mz,isFunction:Os,isStream:KD,isURLSearchParams:JD,isTypedArray:cz,isFileList:XD,forEach:Um,merge:y0,extend:iz,trim:rz,stripBOM:oz,inherits:sz,toFlatObject:az,kindOf:Oy,kindOfTest:gl,endsWith:lz,toArray:uz,forEachEntry:hz,matchAll:dz,isHTMLForm:fz,hasOwnProperty:_T,hasOwnProp:_T,reduceDescriptors:pC,freezeMethods:gz,toObjectSet:yz,toCamelCase:pz,noop:_z,toFiniteNumber:vz,findKey:dC,global:Ed,isContextDefined:fC,isSpecCompliantForm:xz,toJSONObject:wz,isAsyncFn:bz,isThenable:Tz,setImmediate:mC,asap:Ez,isIterable:Sz};function Hn(i,s,c,p,_){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",s&&(this.code=s),c&&(this.config=c),p&&(this.request=p),_&&(this.response=_,this.status=_.status?_.status:null)}at.inherits(Hn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:at.toJSONObject(this.config),code:this.code,status:this.status}}});const gC=Hn.prototype,yC={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{yC[i]={value:i}});Object.defineProperties(Hn,yC);Object.defineProperty(gC,"isAxiosError",{value:!0});Hn.from=(i,s,c,p,_,T)=>{const S=Object.create(gC);return at.toFlatObject(i,S,function(o){return o!==Error.prototype},k=>k!=="isAxiosError"),Hn.call(S,i.message,s,c,p,_),S.cause=i,S.name=i.name,T&&Object.assign(S,T),S};const Cz=null;function _0(i){return at.isPlainObject(i)||at.isArray(i)}function _C(i){return at.endsWith(i,"[]")?i.slice(0,-2):i}function vT(i,s,c){return i?i.concat(s).map(function(_,T){return _=_C(_),!c&&T?"["+_+"]":_}).join(c?".":""):s}function Az(i){return at.isArray(i)&&!i.some(_0)}const Mz=at.toFlatObject(at,{},null,function(s){return/^is[A-Z]/.test(s)});function Ny(i,s,c){if(!at.isObject(i))throw new TypeError("target must be an object");s=s||new FormData,c=at.toFlatObject(c,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,Z){return!at.isUndefined(Z[j])});const p=c.metaTokens,_=c.visitor||O,T=c.dots,S=c.indexes,o=(c.Blob||typeof Blob<"u"&&Blob)&&at.isSpecCompliantForm(s);if(!at.isFunction(_))throw new TypeError("visitor must be a function");function I(H){if(H===null)return"";if(at.isDate(H))return H.toISOString();if(!o&&at.isBlob(H))throw new Hn("Blob is not supported. Use a Buffer instead.");return at.isArrayBuffer(H)||at.isTypedArray(H)?o&&typeof Blob=="function"?new Blob([H]):Buffer.from(H):H}function O(H,j,Z){let ne=H;if(H&&!Z&&typeof H=="object"){if(at.endsWith(j,"{}"))j=p?j:j.slice(0,-2),H=JSON.stringify(H);else if(at.isArray(H)&&Az(H)||(at.isFileList(H)||at.endsWith(j,"[]"))&&(ne=at.toArray(H)))return j=_C(j),ne.forEach(function(ce,me){!(at.isUndefined(ce)||ce===null)&&s.append(S===!0?vT([j],me,T):S===null?j:j+"[]",I(ce))}),!1}return _0(H)?!0:(s.append(vT(Z,j,T),I(H)),!1)}const V=[],q=Object.assign(Mz,{defaultVisitor:O,convertValue:I,isVisitable:_0});function ee(H,j){if(!at.isUndefined(H)){if(V.indexOf(H)!==-1)throw Error("Circular reference detected in "+j.join("."));V.push(H),at.forEach(H,function(ne,xe){(!(at.isUndefined(ne)||ne===null)&&_.call(s,ne,at.isString(xe)?xe.trim():xe,j,q))===!0&&ee(ne,j?j.concat(xe):[xe])}),V.pop()}}if(!at.isObject(i))throw new TypeError("data must be an object");return ee(i),s}function xT(i){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(p){return s[p]})}function yx(i,s){this._pairs=[],i&&Ny(i,this,s)}const vC=yx.prototype;vC.append=function(s,c){this._pairs.push([s,c])};vC.toString=function(s){const c=s?function(p){return s.call(this,p,xT)}:xT;return this._pairs.map(function(_){return c(_[0])+"="+c(_[1])},"").join("&")};function kz(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function xC(i,s,c){if(!s)return i;const p=c&&c.encode||kz;at.isFunction(c)&&(c={serialize:c});const _=c&&c.serialize;let T;if(_?T=_(s,c):T=at.isURLSearchParams(s)?s.toString():new yx(s,c).toString(p),T){const S=i.indexOf("#");S!==-1&&(i=i.slice(0,S)),i+=(i.indexOf("?")===-1?"?":"&")+T}return i}class wT{constructor(){this.handlers=[]}use(s,c,p){return this.handlers.push({fulfilled:s,rejected:c,synchronous:p?p.synchronous:!1,runWhen:p?p.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){at.forEach(this.handlers,function(p){p!==null&&s(p)})}}const wC={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Pz=typeof URLSearchParams<"u"?URLSearchParams:yx,Iz=typeof FormData<"u"?FormData:null,Rz=typeof Blob<"u"?Blob:null,Lz={isBrowser:!0,classes:{URLSearchParams:Pz,FormData:Iz,Blob:Rz},protocols:["http","https","file","blob","url","data"]},_x=typeof window<"u"&&typeof document<"u",v0=typeof navigator=="object"&&navigator||void 0,Dz=_x&&(!v0||["ReactNative","NativeScript","NS"].indexOf(v0.product)<0),zz=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Oz=_x&&window.location.href||"http://localhost",Bz=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:_x,hasStandardBrowserEnv:Dz,hasStandardBrowserWebWorkerEnv:zz,navigator:v0,origin:Oz},Symbol.toStringTag,{value:"Module"})),Qo={...Bz,...Lz};function Fz(i,s){return Ny(i,new Qo.classes.URLSearchParams,Object.assign({visitor:function(c,p,_,T){return Qo.isNode&&at.isBuffer(c)?(this.append(p,c.toString("base64")),!1):T.defaultVisitor.apply(this,arguments)}},s))}function Nz(i){return at.matchAll(/\w+|\[(\w*)]/g,i).map(s=>s[0]==="[]"?"":s[1]||s[0])}function jz(i){const s={},c=Object.keys(i);let p;const _=c.length;let T;for(p=0;p<_;p++)T=c[p],s[T]=i[T];return s}function bC(i){function s(c,p,_,T){let S=c[T++];if(S==="__proto__")return!0;const k=Number.isFinite(+S),o=T>=c.length;return S=!S&&at.isArray(_)?_.length:S,o?(at.hasOwnProp(_,S)?_[S]=[_[S],p]:_[S]=p,!k):((!_[S]||!at.isObject(_[S]))&&(_[S]=[]),s(c,p,_[S],T)&&at.isArray(_[S])&&(_[S]=jz(_[S])),!k)}if(at.isFormData(i)&&at.isFunction(i.entries)){const c={};return at.forEachEntry(i,(p,_)=>{s(Nz(p),_,c,0)}),c}return null}function Vz(i,s,c){if(at.isString(i))try{return(s||JSON.parse)(i),at.trim(i)}catch(p){if(p.name!=="SyntaxError")throw p}return(c||JSON.stringify)(i)}const $m={transitional:wC,adapter:["xhr","http","fetch"],transformRequest:[function(s,c){const p=c.getContentType()||"",_=p.indexOf("application/json")>-1,T=at.isObject(s);if(T&&at.isHTMLForm(s)&&(s=new FormData(s)),at.isFormData(s))return _?JSON.stringify(bC(s)):s;if(at.isArrayBuffer(s)||at.isBuffer(s)||at.isStream(s)||at.isFile(s)||at.isBlob(s)||at.isReadableStream(s))return s;if(at.isArrayBufferView(s))return s.buffer;if(at.isURLSearchParams(s))return c.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let k;if(T){if(p.indexOf("application/x-www-form-urlencoded")>-1)return Fz(s,this.formSerializer).toString();if((k=at.isFileList(s))||p.indexOf("multipart/form-data")>-1){const o=this.env&&this.env.FormData;return Ny(k?{"files[]":s}:s,o&&new o,this.formSerializer)}}return T||_?(c.setContentType("application/json",!1),Vz(s)):s}],transformResponse:[function(s){const c=this.transitional||$m.transitional,p=c&&c.forcedJSONParsing,_=this.responseType==="json";if(at.isResponse(s)||at.isReadableStream(s))return s;if(s&&at.isString(s)&&(p&&!this.responseType||_)){const S=!(c&&c.silentJSONParsing)&&_;try{return JSON.parse(s)}catch(k){if(S)throw k.name==="SyntaxError"?Hn.from(k,Hn.ERR_BAD_RESPONSE,this,null,this.response):k}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Qo.classes.FormData,Blob:Qo.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};at.forEach(["delete","get","head","post","put","patch"],i=>{$m.headers[i]={}});const Uz=at.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$z=i=>{const s={};let c,p,_;return i&&i.split(`
`).forEach(function(S){_=S.indexOf(":"),c=S.substring(0,_).trim().toLowerCase(),p=S.substring(_+1).trim(),!(!c||s[c]&&Uz[c])&&(c==="set-cookie"?s[c]?s[c].push(p):s[c]=[p]:s[c]=s[c]?s[c]+", "+p:p)}),s},bT=Symbol("internals");function om(i){return i&&String(i).trim().toLowerCase()}function oy(i){return i===!1||i==null?i:at.isArray(i)?i.map(oy):String(i)}function Gz(i){const s=Object.create(null),c=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let p;for(;p=c.exec(i);)s[p[1]]=p[2];return s}const qz=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function Nv(i,s,c,p,_){if(at.isFunction(p))return p.call(this,s,c);if(_&&(s=c),!!at.isString(s)){if(at.isString(p))return s.indexOf(p)!==-1;if(at.isRegExp(p))return p.test(s)}}function Wz(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,c,p)=>c.toUpperCase()+p)}function Zz(i,s){const c=at.toCamelCase(" "+s);["get","set","has"].forEach(p=>{Object.defineProperty(i,p+c,{value:function(_,T,S){return this[p].call(this,s,_,T,S)},configurable:!0})})}let Bs=class{constructor(s){s&&this.set(s)}set(s,c,p){const _=this;function T(k,o,I){const O=om(o);if(!O)throw new Error("header name must be a non-empty string");const V=at.findKey(_,O);(!V||_[V]===void 0||I===!0||I===void 0&&_[V]!==!1)&&(_[V||o]=oy(k))}const S=(k,o)=>at.forEach(k,(I,O)=>T(I,O,o));if(at.isPlainObject(s)||s instanceof this.constructor)S(s,c);else if(at.isString(s)&&(s=s.trim())&&!qz(s))S($z(s),c);else if(at.isObject(s)&&at.isIterable(s)){let k={},o,I;for(const O of s){if(!at.isArray(O))throw TypeError("Object iterator must return a key-value pair");k[I=O[0]]=(o=k[I])?at.isArray(o)?[...o,O[1]]:[o,O[1]]:O[1]}S(k,c)}else s!=null&&T(c,s,p);return this}get(s,c){if(s=om(s),s){const p=at.findKey(this,s);if(p){const _=this[p];if(!c)return _;if(c===!0)return Gz(_);if(at.isFunction(c))return c.call(this,_,p);if(at.isRegExp(c))return c.exec(_);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,c){if(s=om(s),s){const p=at.findKey(this,s);return!!(p&&this[p]!==void 0&&(!c||Nv(this,this[p],p,c)))}return!1}delete(s,c){const p=this;let _=!1;function T(S){if(S=om(S),S){const k=at.findKey(p,S);k&&(!c||Nv(p,p[k],k,c))&&(delete p[k],_=!0)}}return at.isArray(s)?s.forEach(T):T(s),_}clear(s){const c=Object.keys(this);let p=c.length,_=!1;for(;p--;){const T=c[p];(!s||Nv(this,this[T],T,s,!0))&&(delete this[T],_=!0)}return _}normalize(s){const c=this,p={};return at.forEach(this,(_,T)=>{const S=at.findKey(p,T);if(S){c[S]=oy(_),delete c[T];return}const k=s?Wz(T):String(T).trim();k!==T&&delete c[T],c[k]=oy(_),p[k]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const c=Object.create(null);return at.forEach(this,(p,_)=>{p!=null&&p!==!1&&(c[_]=s&&at.isArray(p)?p.join(", "):p)}),c}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,c])=>s+": "+c).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...c){const p=new this(s);return c.forEach(_=>p.set(_)),p}static accessor(s){const p=(this[bT]=this[bT]={accessors:{}}).accessors,_=this.prototype;function T(S){const k=om(S);p[k]||(Zz(_,S),p[k]=!0)}return at.isArray(s)?s.forEach(T):T(s),this}};Bs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);at.reduceDescriptors(Bs.prototype,({value:i},s)=>{let c=s[0].toUpperCase()+s.slice(1);return{get:()=>i,set(p){this[c]=p}}});at.freezeMethods(Bs);function jv(i,s){const c=this||$m,p=s||c,_=Bs.from(p.headers);let T=p.data;return at.forEach(i,function(k){T=k.call(c,T,_.normalize(),s?s.status:void 0)}),_.normalize(),T}function TC(i){return!!(i&&i.__CANCEL__)}function rp(i,s,c){Hn.call(this,i??"canceled",Hn.ERR_CANCELED,s,c),this.name="CanceledError"}at.inherits(rp,Hn,{__CANCEL__:!0});function EC(i,s,c){const p=c.config.validateStatus;!c.status||!p||p(c.status)?i(c):s(new Hn("Request failed with status code "+c.status,[Hn.ERR_BAD_REQUEST,Hn.ERR_BAD_RESPONSE][Math.floor(c.status/100)-4],c.config,c.request,c))}function Hz(i){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return s&&s[1]||""}function Xz(i,s){i=i||10;const c=new Array(i),p=new Array(i);let _=0,T=0,S;return s=s!==void 0?s:1e3,function(o){const I=Date.now(),O=p[T];S||(S=I),c[_]=o,p[_]=I;let V=T,q=0;for(;V!==_;)q+=c[V++],V=V%i;if(_=(_+1)%i,_===T&&(T=(T+1)%i),I-S<s)return;const ee=O&&I-O;return ee?Math.round(q*1e3/ee):void 0}}function Kz(i,s){let c=0,p=1e3/s,_,T;const S=(I,O=Date.now())=>{c=O,_=null,T&&(clearTimeout(T),T=null),i.apply(null,I)};return[(...I)=>{const O=Date.now(),V=O-c;V>=p?S(I,O):(_=I,T||(T=setTimeout(()=>{T=null,S(_)},p-V)))},()=>_&&S(_)]}const xy=(i,s,c=3)=>{let p=0;const _=Xz(50,250);return Kz(T=>{const S=T.loaded,k=T.lengthComputable?T.total:void 0,o=S-p,I=_(o),O=S<=k;p=S;const V={loaded:S,total:k,progress:k?S/k:void 0,bytes:o,rate:I||void 0,estimated:I&&k&&O?(k-S)/I:void 0,event:T,lengthComputable:k!=null,[s?"download":"upload"]:!0};i(V)},c)},TT=(i,s)=>{const c=i!=null;return[p=>s[0]({lengthComputable:c,total:i,loaded:p}),s[1]]},ET=i=>(...s)=>at.asap(()=>i(...s)),Yz=Qo.hasStandardBrowserEnv?((i,s)=>c=>(c=new URL(c,Qo.origin),i.protocol===c.protocol&&i.host===c.host&&(s||i.port===c.port)))(new URL(Qo.origin),Qo.navigator&&/(msie|trident)/i.test(Qo.navigator.userAgent)):()=>!0,Jz=Qo.hasStandardBrowserEnv?{write(i,s,c,p,_,T){const S=[i+"="+encodeURIComponent(s)];at.isNumber(c)&&S.push("expires="+new Date(c).toGMTString()),at.isString(p)&&S.push("path="+p),at.isString(_)&&S.push("domain="+_),T===!0&&S.push("secure"),document.cookie=S.join("; ")},read(i){const s=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(i){this.write(i,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Qz(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function eO(i,s){return s?i.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):i}function SC(i,s,c){let p=!Qz(s);return i&&(p||c==!1)?eO(i,s):s}const ST=i=>i instanceof Bs?{...i}:i;function Md(i,s){s=s||{};const c={};function p(I,O,V,q){return at.isPlainObject(I)&&at.isPlainObject(O)?at.merge.call({caseless:q},I,O):at.isPlainObject(O)?at.merge({},O):at.isArray(O)?O.slice():O}function _(I,O,V,q){if(at.isUndefined(O)){if(!at.isUndefined(I))return p(void 0,I,V,q)}else return p(I,O,V,q)}function T(I,O){if(!at.isUndefined(O))return p(void 0,O)}function S(I,O){if(at.isUndefined(O)){if(!at.isUndefined(I))return p(void 0,I)}else return p(void 0,O)}function k(I,O,V){if(V in s)return p(I,O);if(V in i)return p(void 0,I)}const o={url:T,method:T,data:T,baseURL:S,transformRequest:S,transformResponse:S,paramsSerializer:S,timeout:S,timeoutMessage:S,withCredentials:S,withXSRFToken:S,adapter:S,responseType:S,xsrfCookieName:S,xsrfHeaderName:S,onUploadProgress:S,onDownloadProgress:S,decompress:S,maxContentLength:S,maxBodyLength:S,beforeRedirect:S,transport:S,httpAgent:S,httpsAgent:S,cancelToken:S,socketPath:S,responseEncoding:S,validateStatus:k,headers:(I,O,V)=>_(ST(I),ST(O),V,!0)};return at.forEach(Object.keys(Object.assign({},i,s)),function(O){const V=o[O]||_,q=V(i[O],s[O],O);at.isUndefined(q)&&V!==k||(c[O]=q)}),c}const CC=i=>{const s=Md({},i);let{data:c,withXSRFToken:p,xsrfHeaderName:_,xsrfCookieName:T,headers:S,auth:k}=s;s.headers=S=Bs.from(S),s.url=xC(SC(s.baseURL,s.url,s.allowAbsoluteUrls),i.params,i.paramsSerializer),k&&S.set("Authorization","Basic "+btoa((k.username||"")+":"+(k.password?unescape(encodeURIComponent(k.password)):"")));let o;if(at.isFormData(c)){if(Qo.hasStandardBrowserEnv||Qo.hasStandardBrowserWebWorkerEnv)S.setContentType(void 0);else if((o=S.getContentType())!==!1){const[I,...O]=o?o.split(";").map(V=>V.trim()).filter(Boolean):[];S.setContentType([I||"multipart/form-data",...O].join("; "))}}if(Qo.hasStandardBrowserEnv&&(p&&at.isFunction(p)&&(p=p(s)),p||p!==!1&&Yz(s.url))){const I=_&&T&&Jz.read(T);I&&S.set(_,I)}return s},tO=typeof XMLHttpRequest<"u",nO=tO&&function(i){return new Promise(function(c,p){const _=CC(i);let T=_.data;const S=Bs.from(_.headers).normalize();let{responseType:k,onUploadProgress:o,onDownloadProgress:I}=_,O,V,q,ee,H;function j(){ee&&ee(),H&&H(),_.cancelToken&&_.cancelToken.unsubscribe(O),_.signal&&_.signal.removeEventListener("abort",O)}let Z=new XMLHttpRequest;Z.open(_.method.toUpperCase(),_.url,!0),Z.timeout=_.timeout;function ne(){if(!Z)return;const ce=Bs.from("getAllResponseHeaders"in Z&&Z.getAllResponseHeaders()),de={data:!k||k==="text"||k==="json"?Z.responseText:Z.response,status:Z.status,statusText:Z.statusText,headers:ce,config:i,request:Z};EC(function(Se){c(Se),j()},function(Se){p(Se),j()},de),Z=null}"onloadend"in Z?Z.onloadend=ne:Z.onreadystatechange=function(){!Z||Z.readyState!==4||Z.status===0&&!(Z.responseURL&&Z.responseURL.indexOf("file:")===0)||setTimeout(ne)},Z.onabort=function(){Z&&(p(new Hn("Request aborted",Hn.ECONNABORTED,i,Z)),Z=null)},Z.onerror=function(){p(new Hn("Network Error",Hn.ERR_NETWORK,i,Z)),Z=null},Z.ontimeout=function(){let me=_.timeout?"timeout of "+_.timeout+"ms exceeded":"timeout exceeded";const de=_.transitional||wC;_.timeoutErrorMessage&&(me=_.timeoutErrorMessage),p(new Hn(me,de.clarifyTimeoutError?Hn.ETIMEDOUT:Hn.ECONNABORTED,i,Z)),Z=null},T===void 0&&S.setContentType(null),"setRequestHeader"in Z&&at.forEach(S.toJSON(),function(me,de){Z.setRequestHeader(de,me)}),at.isUndefined(_.withCredentials)||(Z.withCredentials=!!_.withCredentials),k&&k!=="json"&&(Z.responseType=_.responseType),I&&([q,H]=xy(I,!0),Z.addEventListener("progress",q)),o&&Z.upload&&([V,ee]=xy(o),Z.upload.addEventListener("progress",V),Z.upload.addEventListener("loadend",ee)),(_.cancelToken||_.signal)&&(O=ce=>{Z&&(p(!ce||ce.type?new rp(null,i,Z):ce),Z.abort(),Z=null)},_.cancelToken&&_.cancelToken.subscribe(O),_.signal&&(_.signal.aborted?O():_.signal.addEventListener("abort",O)));const xe=Hz(_.url);if(xe&&Qo.protocols.indexOf(xe)===-1){p(new Hn("Unsupported protocol "+xe+":",Hn.ERR_BAD_REQUEST,i));return}Z.send(T||null)})},rO=(i,s)=>{const{length:c}=i=i?i.filter(Boolean):[];if(s||c){let p=new AbortController,_;const T=function(I){if(!_){_=!0,k();const O=I instanceof Error?I:this.reason;p.abort(O instanceof Hn?O:new rp(O instanceof Error?O.message:O))}};let S=s&&setTimeout(()=>{S=null,T(new Hn(`timeout ${s} of ms exceeded`,Hn.ETIMEDOUT))},s);const k=()=>{i&&(S&&clearTimeout(S),S=null,i.forEach(I=>{I.unsubscribe?I.unsubscribe(T):I.removeEventListener("abort",T)}),i=null)};i.forEach(I=>I.addEventListener("abort",T));const{signal:o}=p;return o.unsubscribe=()=>at.asap(k),o}},iO=function*(i,s){let c=i.byteLength;if(c<s){yield i;return}let p=0,_;for(;p<c;)_=p+s,yield i.slice(p,_),p=_},oO=async function*(i,s){for await(const c of sO(i))yield*iO(c,s)},sO=async function*(i){if(i[Symbol.asyncIterator]){yield*i;return}const s=i.getReader();try{for(;;){const{done:c,value:p}=await s.read();if(c)break;yield p}}finally{await s.cancel()}},CT=(i,s,c,p)=>{const _=oO(i,s);let T=0,S,k=o=>{S||(S=!0,p&&p(o))};return new ReadableStream({async pull(o){try{const{done:I,value:O}=await _.next();if(I){k(),o.close();return}let V=O.byteLength;if(c){let q=T+=V;c(q)}o.enqueue(new Uint8Array(O))}catch(I){throw k(I),I}},cancel(o){return k(o),_.return()}},{highWaterMark:2})},jy=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",AC=jy&&typeof ReadableStream=="function",aO=jy&&(typeof TextEncoder=="function"?(i=>s=>i.encode(s))(new TextEncoder):async i=>new Uint8Array(await new Response(i).arrayBuffer())),MC=(i,...s)=>{try{return!!i(...s)}catch{return!1}},lO=AC&&MC(()=>{let i=!1;const s=new Request(Qo.origin,{body:new ReadableStream,method:"POST",get duplex(){return i=!0,"half"}}).headers.has("Content-Type");return i&&!s}),AT=64*1024,x0=AC&&MC(()=>at.isReadableStream(new Response("").body)),wy={stream:x0&&(i=>i.body)};jy&&(i=>{["text","arrayBuffer","blob","formData","stream"].forEach(s=>{!wy[s]&&(wy[s]=at.isFunction(i[s])?c=>c[s]():(c,p)=>{throw new Hn(`Response type '${s}' is not supported`,Hn.ERR_NOT_SUPPORT,p)})})})(new Response);const uO=async i=>{if(i==null)return 0;if(at.isBlob(i))return i.size;if(at.isSpecCompliantForm(i))return(await new Request(Qo.origin,{method:"POST",body:i}).arrayBuffer()).byteLength;if(at.isArrayBufferView(i)||at.isArrayBuffer(i))return i.byteLength;if(at.isURLSearchParams(i)&&(i=i+""),at.isString(i))return(await aO(i)).byteLength},cO=async(i,s)=>{const c=at.toFiniteNumber(i.getContentLength());return c??uO(s)},hO=jy&&(async i=>{let{url:s,method:c,data:p,signal:_,cancelToken:T,timeout:S,onDownloadProgress:k,onUploadProgress:o,responseType:I,headers:O,withCredentials:V="same-origin",fetchOptions:q}=CC(i);I=I?(I+"").toLowerCase():"text";let ee=rO([_,T&&T.toAbortSignal()],S),H;const j=ee&&ee.unsubscribe&&(()=>{ee.unsubscribe()});let Z;try{if(o&&lO&&c!=="get"&&c!=="head"&&(Z=await cO(O,p))!==0){let de=new Request(s,{method:"POST",body:p,duplex:"half"}),_e;if(at.isFormData(p)&&(_e=de.headers.get("content-type"))&&O.setContentType(_e),de.body){const[Se,$e]=TT(Z,xy(ET(o)));p=CT(de.body,AT,Se,$e)}}at.isString(V)||(V=V?"include":"omit");const ne="credentials"in Request.prototype;H=new Request(s,{...q,signal:ee,method:c.toUpperCase(),headers:O.normalize().toJSON(),body:p,duplex:"half",credentials:ne?V:void 0});let xe=await fetch(H);const ce=x0&&(I==="stream"||I==="response");if(x0&&(k||ce&&j)){const de={};["status","statusText","headers"].forEach(dt=>{de[dt]=xe[dt]});const _e=at.toFiniteNumber(xe.headers.get("content-length")),[Se,$e]=k&&TT(_e,xy(ET(k),!0))||[];xe=new Response(CT(xe.body,AT,Se,()=>{$e&&$e(),j&&j()}),de)}I=I||"text";let me=await wy[at.findKey(wy,I)||"text"](xe,i);return!ce&&j&&j(),await new Promise((de,_e)=>{EC(de,_e,{data:me,headers:Bs.from(xe.headers),status:xe.status,statusText:xe.statusText,config:i,request:H})})}catch(ne){throw j&&j(),ne&&ne.name==="TypeError"&&/Load failed|fetch/i.test(ne.message)?Object.assign(new Hn("Network Error",Hn.ERR_NETWORK,i,H),{cause:ne.cause||ne}):Hn.from(ne,ne&&ne.code,i,H)}}),w0={http:Cz,xhr:nO,fetch:hO};at.forEach(w0,(i,s)=>{if(i){try{Object.defineProperty(i,"name",{value:s})}catch{}Object.defineProperty(i,"adapterName",{value:s})}});const MT=i=>`- ${i}`,dO=i=>at.isFunction(i)||i===null||i===!1,kC={getAdapter:i=>{i=at.isArray(i)?i:[i];const{length:s}=i;let c,p;const _={};for(let T=0;T<s;T++){c=i[T];let S;if(p=c,!dO(c)&&(p=w0[(S=String(c)).toLowerCase()],p===void 0))throw new Hn(`Unknown adapter '${S}'`);if(p)break;_[S||"#"+T]=p}if(!p){const T=Object.entries(_).map(([k,o])=>`adapter ${k} `+(o===!1?"is not supported by the environment":"is not available in the build"));let S=s?T.length>1?`since :
`+T.map(MT).join(`
`):" "+MT(T[0]):"as no adapter specified";throw new Hn("There is no suitable adapter to dispatch the request "+S,"ERR_NOT_SUPPORT")}return p},adapters:w0};function Vv(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new rp(null,i)}function kT(i){return Vv(i),i.headers=Bs.from(i.headers),i.data=jv.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),kC.getAdapter(i.adapter||$m.adapter)(i).then(function(p){return Vv(i),p.data=jv.call(i,i.transformResponse,p),p.headers=Bs.from(p.headers),p},function(p){return TC(p)||(Vv(i),p&&p.response&&(p.response.data=jv.call(i,i.transformResponse,p.response),p.response.headers=Bs.from(p.response.headers))),Promise.reject(p)})}const PC="1.9.0",Vy={};["object","boolean","number","function","string","symbol"].forEach((i,s)=>{Vy[i]=function(p){return typeof p===i||"a"+(s<1?"n ":" ")+i}});const PT={};Vy.transitional=function(s,c,p){function _(T,S){return"[Axios v"+PC+"] Transitional option '"+T+"'"+S+(p?". "+p:"")}return(T,S,k)=>{if(s===!1)throw new Hn(_(S," has been removed"+(c?" in "+c:"")),Hn.ERR_DEPRECATED);return c&&!PT[S]&&(PT[S]=!0,console.warn(_(S," has been deprecated since v"+c+" and will be removed in the near future"))),s?s(T,S,k):!0}};Vy.spelling=function(s){return(c,p)=>(console.warn(`${p} is likely a misspelling of ${s}`),!0)};function fO(i,s,c){if(typeof i!="object")throw new Hn("options must be an object",Hn.ERR_BAD_OPTION_VALUE);const p=Object.keys(i);let _=p.length;for(;_-- >0;){const T=p[_],S=s[T];if(S){const k=i[T],o=k===void 0||S(k,T,i);if(o!==!0)throw new Hn("option "+T+" must be "+o,Hn.ERR_BAD_OPTION_VALUE);continue}if(c!==!0)throw new Hn("Unknown option "+T,Hn.ERR_BAD_OPTION)}}const sy={assertOptions:fO,validators:Vy},lu=sy.validators;let Ad=class{constructor(s){this.defaults=s||{},this.interceptors={request:new wT,response:new wT}}async request(s,c){try{return await this._request(s,c)}catch(p){if(p instanceof Error){let _={};Error.captureStackTrace?Error.captureStackTrace(_):_=new Error;const T=_.stack?_.stack.replace(/^.+\n/,""):"";try{p.stack?T&&!String(p.stack).endsWith(T.replace(/^.+\n.+\n/,""))&&(p.stack+=`
`+T):p.stack=T}catch{}}throw p}}_request(s,c){typeof s=="string"?(c=c||{},c.url=s):c=s||{},c=Md(this.defaults,c);const{transitional:p,paramsSerializer:_,headers:T}=c;p!==void 0&&sy.assertOptions(p,{silentJSONParsing:lu.transitional(lu.boolean),forcedJSONParsing:lu.transitional(lu.boolean),clarifyTimeoutError:lu.transitional(lu.boolean)},!1),_!=null&&(at.isFunction(_)?c.paramsSerializer={serialize:_}:sy.assertOptions(_,{encode:lu.function,serialize:lu.function},!0)),c.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?c.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:c.allowAbsoluteUrls=!0),sy.assertOptions(c,{baseUrl:lu.spelling("baseURL"),withXsrfToken:lu.spelling("withXSRFToken")},!0),c.method=(c.method||this.defaults.method||"get").toLowerCase();let S=T&&at.merge(T.common,T[c.method]);T&&at.forEach(["delete","get","head","post","put","patch","common"],H=>{delete T[H]}),c.headers=Bs.concat(S,T);const k=[];let o=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(c)===!1||(o=o&&j.synchronous,k.unshift(j.fulfilled,j.rejected))});const I=[];this.interceptors.response.forEach(function(j){I.push(j.fulfilled,j.rejected)});let O,V=0,q;if(!o){const H=[kT.bind(this),void 0];for(H.unshift.apply(H,k),H.push.apply(H,I),q=H.length,O=Promise.resolve(c);V<q;)O=O.then(H[V++],H[V++]);return O}q=k.length;let ee=c;for(V=0;V<q;){const H=k[V++],j=k[V++];try{ee=H(ee)}catch(Z){j.call(this,Z);break}}try{O=kT.call(this,ee)}catch(H){return Promise.reject(H)}for(V=0,q=I.length;V<q;)O=O.then(I[V++],I[V++]);return O}getUri(s){s=Md(this.defaults,s);const c=SC(s.baseURL,s.url,s.allowAbsoluteUrls);return xC(c,s.params,s.paramsSerializer)}};at.forEach(["delete","get","head","options"],function(s){Ad.prototype[s]=function(c,p){return this.request(Md(p||{},{method:s,url:c,data:(p||{}).data}))}});at.forEach(["post","put","patch"],function(s){function c(p){return function(T,S,k){return this.request(Md(k||{},{method:s,headers:p?{"Content-Type":"multipart/form-data"}:{},url:T,data:S}))}}Ad.prototype[s]=c(),Ad.prototype[s+"Form"]=c(!0)});let pO=class IC{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let c;this.promise=new Promise(function(T){c=T});const p=this;this.promise.then(_=>{if(!p._listeners)return;let T=p._listeners.length;for(;T-- >0;)p._listeners[T](_);p._listeners=null}),this.promise.then=_=>{let T;const S=new Promise(k=>{p.subscribe(k),T=k}).then(_);return S.cancel=function(){p.unsubscribe(T)},S},s(function(T,S,k){p.reason||(p.reason=new rp(T,S,k),c(p.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const c=this._listeners.indexOf(s);c!==-1&&this._listeners.splice(c,1)}toAbortSignal(){const s=new AbortController,c=p=>{s.abort(p)};return this.subscribe(c),s.signal.unsubscribe=()=>this.unsubscribe(c),s.signal}static source(){let s;return{token:new IC(function(_){s=_}),cancel:s}}};function mO(i){return function(c){return i.apply(null,c)}}function gO(i){return at.isObject(i)&&i.isAxiosError===!0}const b0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(b0).forEach(([i,s])=>{b0[s]=i});function RC(i){const s=new Ad(i),c=lC(Ad.prototype.request,s);return at.extend(c,Ad.prototype,s,{allOwnKeys:!0}),at.extend(c,s,null,{allOwnKeys:!0}),c.create=function(_){return RC(Md(i,_))},c}const Pi=RC($m);Pi.Axios=Ad;Pi.CanceledError=rp;Pi.CancelToken=pO;Pi.isCancel=TC;Pi.VERSION=PC;Pi.toFormData=Ny;Pi.AxiosError=Hn;Pi.Cancel=Pi.CanceledError;Pi.all=function(s){return Promise.all(s)};Pi.spread=mO;Pi.isAxiosError=gO;Pi.mergeConfig=Md;Pi.AxiosHeaders=Bs;Pi.formToJSON=i=>bC(at.isHTMLForm(i)?new FormData(i):i);Pi.getAdapter=kC.getAdapter;Pi.HttpStatusCode=b0;Pi.default=Pi;const{Axios:R4,AxiosError:L4,CanceledError:D4,isCancel:z4,CancelToken:O4,VERSION:B4,all:F4,Cancel:N4,isAxiosError:j4,spread:V4,toFormData:U4,AxiosHeaders:$4,HttpStatusCode:G4,formToJSON:q4,getAdapter:W4,mergeConfig:Z4}=Pi;function yO(){const i=aa(),[s,c]=Ee.useState(""),[p,_]=Ee.useState(""),[T,S]=Ee.useState(""),k=()=>{Pi.post("/login",{username:s,password:p}).then(o=>{if(o.data.message==="Login successful"){const I=o.data.user;localStorage.setItem("userId",I.id),localStorage.setItem("email",I.email),S(`Welcome, ${I.name}!`),i("/session-choice")}else S(o.data.message||"Login failed.")}).catch(o=>{console.error("Login error:",o),S("❌ Error logging in.")})};return Be.jsxs("div",{className:"container",children:[Be.jsx("div",{className:"header",children:Be.jsx("div",{className:"text",children:"Login"})}),Be.jsxs("div",{className:"inputs",children:[Be.jsx("div",{className:"input",children:Be.jsx("input",{type:"email",placeholder:"Email",value:s,onChange:o=>c(o.target.value)})}),Be.jsx("div",{className:"input",children:Be.jsx("input",{type:"password",placeholder:"Password",value:p,onChange:o=>_(o.target.value)})})]}),Be.jsx("div",{className:"submit-container",children:Be.jsx("button",{type:"submit",onClick:k,children:"Log In"})}),T&&Be.jsx("h1",{children:T})]})}function _O(){const[i,s]=Ee.useState(""),[c,p]=Ee.useState(""),[_,T]=Ee.useState(""),S=aa(),k=()=>{if(!i||!c){T("Please fill out both fields.");return}Pi.post("/register",{username:i,password:c}).then(o=>{console.log(o.data),o.data.user&&(localStorage.setItem("userId",o.data.user.id),localStorage.setItem("username",o.data.user.name),localStorage.setItem("email",o.data.user.email)),T("✅ Registered successfully!"),setTimeout(()=>{T(""),S("/session-choice")},1e3)}).catch(o=>{console.error(o),T("❌ Registration failed.")})};return Be.jsxs("div",{className:"container",children:[Be.jsx("div",{className:"header",children:Be.jsx("div",{className:"text",children:"Registration"})}),Be.jsxs("div",{className:"inputs",children:[Be.jsx("div",{className:"input",children:Be.jsx("input",{type:"email",placeholder:"Email",value:i,onChange:o=>s(o.target.value)})}),Be.jsx("div",{className:"input",children:Be.jsx("input",{type:"password",placeholder:"Password",value:c,onChange:o=>p(o.target.value)})}),Be.jsx("div",{className:"submit-container",children:Be.jsx("button",{type:"submit",onClick:k,children:"Register"})}),_&&Be.jsx("p",{style:{marginTop:"10px"},children:_})]})]})}const vO=()=>{const i=aa();return Be.jsx("div",{className:"start-screen-wrapper",children:Be.jsx("div",{className:"phone-frame",children:Be.jsxs("div",{className:"start-screen",children:[Be.jsx("div",{className:"logo-placeholder",children:Be.jsx("img",{src:"/images/swipelogo.svg",alt:"Swipetizer Logo"})}),Be.jsxs("div",{className:"button-group",children:[Be.jsx("button",{onClick:()=>i("/register"),children:"Get Started"}),Be.jsx("button",{onClick:()=>i("/login"),children:"Log In"}),Be.jsx("button",{onClick:()=>{localStorage.removeItem("userId"),localStorage.removeItem("email"),sessionStorage.clear(),i("/session-choice")},children:"Join without an account"})]})]})})})},xO=()=>{const[i,s]=Ee.useState(!1),[c,p]=Ee.useState(""),_=aa(),T=()=>{const S=c.trim();S!==""&&_(`/waiting-room?code=${S}`)};return Be.jsx("div",{className:"session-choice-wrapper",children:Be.jsxs("div",{className:"session-choice-card",children:[Be.jsx("h2",{children:"How do you want to start?"}),Be.jsx("button",{className:"session-button",onClick:()=>s(S=>!S),children:"Join Session"}),Be.jsxs("div",{className:`pin-dropdown ${i?"open":""}`,children:[Be.jsx("input",{type:"text",placeholder:"PIN",className:"pin-input",value:c,onChange:S=>p(S.target.value)}),Be.jsx("button",{className:"pin-join-btn",onClick:T,children:"Join"})]}),Be.jsx("button",{className:"session-button",onClick:()=>_("/filter-page"),children:"Create Session"})]})})};function LC(i){var s,c,p="";if(typeof i=="string"||typeof i=="number")p+=i;else if(typeof i=="object")if(Array.isArray(i)){var _=i.length;for(s=0;s<_;s++)i[s]&&(c=LC(i[s]))&&(p&&(p+=" "),p+=c)}else for(c in i)i[c]&&(p&&(p+=" "),p+=c);return p}function cc(){for(var i,s,c=0,p="",_=arguments.length;c<_;c++)(i=arguments[c])&&(s=LC(i))&&(p&&(p+=" "),p+=s);return p}function DC(i,s,c=void 0){const p={};for(const _ in i){const T=i[_];let S="",k=!0;for(let o=0;o<T.length;o+=1){const I=T[o];I&&(S+=(k===!0?"":" ")+s(I),k=!1,c&&c[I]&&(S+=" "+c[I]))}p[_]=S}return p}function kd(i,...s){const c=new URL(`https://mui.com/production-error/?code=${i}`);return s.forEach(p=>c.searchParams.append("args[]",p)),`Minified MUI error #${i}; visit ${c} for the full message.`}function Ff(i,s=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER){return Math.max(s,Math.min(i,c))}function vx(i,s=0,c=1){return Ff(i,s,c)}function wO(i){i=i.slice(1);const s=new RegExp(`.{1,${i.length>=6?2:1}}`,"g");let c=i.match(s);return c&&c[0].length===1&&(c=c.map(p=>p+p)),c?`rgb${c.length===4?"a":""}(${c.map((p,_)=>_<3?parseInt(p,16):Math.round(parseInt(p,16)/255*1e3)/1e3).join(", ")})`:""}function dh(i){if(i.type)return i;if(i.charAt(0)==="#")return dh(wO(i));const s=i.indexOf("("),c=i.substring(0,s);if(!["rgb","rgba","hsl","hsla","color"].includes(c))throw new Error(kd(9,i));let p=i.substring(s+1,i.length-1),_;if(c==="color"){if(p=p.split(" "),_=p.shift(),p.length===4&&p[3].charAt(0)==="/"&&(p[3]=p[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(_))throw new Error(kd(10,_))}else p=p.split(",");return p=p.map(T=>parseFloat(T)),{type:c,values:p,colorSpace:_}}const bO=i=>{const s=dh(i);return s.values.slice(0,3).map((c,p)=>s.type.includes("hsl")&&p!==0?`${c}%`:c).join(" ")},hm=(i,s)=>{try{return bO(i)}catch{return i}};function Uy(i){const{type:s,colorSpace:c}=i;let{values:p}=i;return s.includes("rgb")?p=p.map((_,T)=>T<3?parseInt(_,10):_):s.includes("hsl")&&(p[1]=`${p[1]}%`,p[2]=`${p[2]}%`),s.includes("color")?p=`${c} ${p.join(" ")}`:p=`${p.join(", ")}`,`${s}(${p})`}function zC(i){i=dh(i);const{values:s}=i,c=s[0],p=s[1]/100,_=s[2]/100,T=p*Math.min(_,1-_),S=(I,O=(I+c/30)%12)=>_-T*Math.max(Math.min(O-3,9-O,1),-1);let k="rgb";const o=[Math.round(S(0)*255),Math.round(S(8)*255),Math.round(S(4)*255)];return i.type==="hsla"&&(k+="a",o.push(s[3])),Uy({type:k,values:o})}function T0(i){i=dh(i);let s=i.type==="hsl"||i.type==="hsla"?dh(zC(i)).values:i.values;return s=s.map(c=>(i.type!=="color"&&(c/=255),c<=.03928?c/12.92:((c+.055)/1.055)**2.4)),Number((.2126*s[0]+.7152*s[1]+.0722*s[2]).toFixed(3))}function TO(i,s){const c=T0(i),p=T0(s);return(Math.max(c,p)+.05)/(Math.min(c,p)+.05)}function E0(i,s){return i=dh(i),s=vx(s),(i.type==="rgb"||i.type==="hsl")&&(i.type+="a"),i.type==="color"?i.values[3]=`/${s}`:i.values[3]=s,Uy(i)}function Gg(i,s,c){try{return E0(i,s)}catch{return i}}function km(i,s){if(i=dh(i),s=vx(s),i.type.includes("hsl"))i.values[2]*=1-s;else if(i.type.includes("rgb")||i.type.includes("color"))for(let c=0;c<3;c+=1)i.values[c]*=1-s;return Uy(i)}function Gr(i,s,c){try{return km(i,s)}catch{return i}}function Pm(i,s){if(i=dh(i),s=vx(s),i.type.includes("hsl"))i.values[2]+=(100-i.values[2])*s;else if(i.type.includes("rgb"))for(let c=0;c<3;c+=1)i.values[c]+=(255-i.values[c])*s;else if(i.type.includes("color"))for(let c=0;c<3;c+=1)i.values[c]+=(1-i.values[c])*s;return Uy(i)}function qr(i,s,c){try{return Pm(i,s)}catch{return i}}function EO(i,s=.15){return T0(i)>.5?km(i,s):Pm(i,s)}function qg(i,s,c){try{return EO(i,s)}catch{return i}}const SO=Ee.createContext(),CO=()=>Ee.useContext(SO)??!1;function OC(...i){const s=Ee.useRef(void 0),c=Ee.useCallback(p=>{const _=i.map(T=>{if(T==null)return null;if(typeof T=="function"){const S=T,k=S(p);return typeof k=="function"?k:()=>{S(null)}}return T.current=p,()=>{T.current=null}});return()=>{_.forEach(T=>T==null?void 0:T())}},i);return Ee.useMemo(()=>i.every(p=>p==null)?null:p=>{s.current&&(s.current(),s.current=void 0),p!=null&&(s.current=c(p))},i)}function AO(i){return typeof i=="string"}function MO(i,s,c){return i===void 0||AO(i)?s:{...s,ownerState:{...s.ownerState,...c}}}function ay(i,s=[]){if(i===void 0)return{};const c={};return Object.keys(i).filter(p=>p.match(/^on[A-Z]/)&&typeof i[p]=="function"&&!s.includes(p)).forEach(p=>{c[p]=i[p]}),c}function IT(i){if(i===void 0)return{};const s={};return Object.keys(i).filter(c=>!(c.match(/^on[A-Z]/)&&typeof i[c]=="function")).forEach(c=>{s[c]=i[c]}),s}function kO(i){const{getSlotProps:s,additionalProps:c,externalSlotProps:p,externalForwardedProps:_,className:T}=i;if(!s){const ee=cc(c==null?void 0:c.className,T,_==null?void 0:_.className,p==null?void 0:p.className),H={...c==null?void 0:c.style,..._==null?void 0:_.style,...p==null?void 0:p.style},j={...c,..._,...p};return ee.length>0&&(j.className=ee),Object.keys(H).length>0&&(j.style=H),{props:j,internalRef:void 0}}const S=ay({..._,...p}),k=IT(p),o=IT(_),I=s(S),O=cc(I==null?void 0:I.className,c==null?void 0:c.className,T,_==null?void 0:_.className,p==null?void 0:p.className),V={...I==null?void 0:I.style,...c==null?void 0:c.style,..._==null?void 0:_.style,...p==null?void 0:p.style},q={...I,...c,...o,...k};return O.length>0&&(q.className=O),Object.keys(V).length>0&&(q.style=V),{props:q,internalRef:I.ref}}function PO(i,s,c){return typeof i=="function"?i(s,c):i}function ah(i){var V;const{elementType:s,externalSlotProps:c,ownerState:p,skipResolvingSlotProps:_=!1,...T}=i,S=_?{}:PO(c,p),{props:k,internalRef:o}=kO({...T,externalSlotProps:S}),I=OC(o,S==null?void 0:S.ref,(V=i.additionalProps)==null?void 0:V.ref);return MO(s,{...k,ref:I},p)}var Uv={exports:{}},Fr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RT;function IO(){if(RT)return Fr;RT=1;var i=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),S=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),o=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),q=Symbol.for("react.view_transition"),ee=Symbol.for("react.client.reference");function H(j){if(typeof j=="object"&&j!==null){var Z=j.$$typeof;switch(Z){case i:switch(j=j.type,j){case c:case _:case p:case o:case I:case q:return j;default:switch(j=j&&j.$$typeof,j){case S:case k:case V:case O:return j;case T:return j;default:return Z}}case s:return Z}}}return Fr.ContextConsumer=T,Fr.ContextProvider=S,Fr.Element=i,Fr.ForwardRef=k,Fr.Fragment=c,Fr.Lazy=V,Fr.Memo=O,Fr.Portal=s,Fr.Profiler=_,Fr.StrictMode=p,Fr.Suspense=o,Fr.SuspenseList=I,Fr.isContextConsumer=function(j){return H(j)===T},Fr.isContextProvider=function(j){return H(j)===S},Fr.isElement=function(j){return typeof j=="object"&&j!==null&&j.$$typeof===i},Fr.isForwardRef=function(j){return H(j)===k},Fr.isFragment=function(j){return H(j)===c},Fr.isLazy=function(j){return H(j)===V},Fr.isMemo=function(j){return H(j)===O},Fr.isPortal=function(j){return H(j)===s},Fr.isProfiler=function(j){return H(j)===_},Fr.isStrictMode=function(j){return H(j)===p},Fr.isSuspense=function(j){return H(j)===o},Fr.isSuspenseList=function(j){return H(j)===I},Fr.isValidElementType=function(j){return typeof j=="string"||typeof j=="function"||j===c||j===_||j===p||j===o||j===I||typeof j=="object"&&j!==null&&(j.$$typeof===V||j.$$typeof===O||j.$$typeof===S||j.$$typeof===T||j.$$typeof===k||j.$$typeof===ee||j.getModuleId!==void 0)},Fr.typeOf=H,Fr}var LT;function RO(){return LT||(LT=1,Uv.exports=IO()),Uv.exports}var BC=RO();function du(i){if(typeof i!="object"||i===null)return!1;const s=Object.getPrototypeOf(i);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)}function FC(i){if(Ee.isValidElement(i)||BC.isValidElementType(i)||!du(i))return i;const s={};return Object.keys(i).forEach(c=>{s[c]=FC(i[c])}),s}function oa(i,s,c={clone:!0}){const p=c.clone?{...i}:i;return du(i)&&du(s)&&Object.keys(s).forEach(_=>{Ee.isValidElement(s[_])||BC.isValidElementType(s[_])?p[_]=s[_]:du(s[_])&&Object.prototype.hasOwnProperty.call(i,_)&&du(i[_])?p[_]=oa(i[_],s[_],c):c.clone?p[_]=du(s[_])?FC(s[_]):s[_]:p[_]=s[_]}),p}function ia(i){if(typeof i!="string")throw new Error(kd(7));return i.charAt(0).toUpperCase()+i.slice(1)}function ly(i){return i&&i.ownerDocument||document}const NC=typeof window<"u"?Ee.useLayoutEffect:Ee.useEffect;function LO({controlled:i,default:s,name:c,state:p="value"}){const{current:_}=Ee.useRef(i!==void 0),[T,S]=Ee.useState(s),k=_?i:T,o=Ee.useCallback(I=>{_||S(I)},[]);return[k,o]}function $v(i){const s=Ee.useRef(i);return NC(()=>{s.current=i}),Ee.useRef((...c)=>(0,s.current)(...c)).current}function DT(i){try{return i.matches(":focus-visible")}catch{}return!1}const DO={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function S0(i,s){const c={...s};for(const p in i)if(Object.prototype.hasOwnProperty.call(i,p)){const _=p;if(_==="components"||_==="slots")c[_]={...i[_],...c[_]};else if(_==="componentsProps"||_==="slotProps"){const T=i[_],S=s[_];if(!S)c[_]=T||{};else if(!T)c[_]=S;else{c[_]={...S};for(const k in T)if(Object.prototype.hasOwnProperty.call(T,k)){const o=k;c[_][o]=S0(T[o],S[o])}}}else c[_]===void 0&&(c[_]=i[_])}return c}const zT=i=>i,zO=()=>{let i=zT;return{configure(s){i=s},generate(s){return i(s)},reset(){i=zT}}},OO=zO(),BO={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function xx(i,s,c="Mui"){const p=BO[s];return p?`${c}-${p}`:`${OO.generate(i)}-${s}`}function jC(i,s,c="Mui"){const p={};return s.forEach(_=>{p[_]=xx(i,_,c)}),p}function FO(i,s,c=(p,_)=>p===_){return i.length===s.length&&i.every((p,_)=>c(p,s[_]))}const NO=2;function Rf(i,s,c,p,_){return c===1?Math.min(i+s,_):Math.max(i-s,p)}function VC(i,s){return i-s}function OT(i,s){const{index:c}=i.reduce((p,_,T)=>{const S=Math.abs(s-_);return p===null||S<p.distance||S===p.distance?{distance:S,index:T}:p},null)??{};return c}function Wg(i,s){if(s.current!==void 0&&i.changedTouches){const c=i;for(let p=0;p<c.changedTouches.length;p+=1){const _=c.changedTouches[p];if(_.identifier===s.current)return{x:_.clientX,y:_.clientY}}return!1}return{x:i.clientX,y:i.clientY}}function by(i,s,c){return(i-s)*100/(c-s)}function jO(i,s,c){return(c-s)*i+s}function VO(i){if(Math.abs(i)<1){const c=i.toExponential().split("e-"),p=c[0].split(".")[1];return(p?p.length:0)+parseInt(c[1],10)}const s=i.toString().split(".")[1];return s?s.length:0}function UO(i,s,c){const p=Math.round((i-c)/s)*s+c;return Number(p.toFixed(VO(s)))}function BT({values:i,newValue:s,index:c}){const p=i.slice();return p[c]=s,p.sort(VC)}function Zg({sliderRef:i,activeIndex:s,setActive:c}){var _,T,S;const p=ly(i.current);(!((_=i.current)!=null&&_.contains(p.activeElement))||Number((T=p==null?void 0:p.activeElement)==null?void 0:T.getAttribute("data-index"))!==s)&&((S=i.current)==null||S.querySelector(`[type="range"][data-index="${s}"]`).focus()),c&&c(s)}function Hg(i,s){return typeof i=="number"&&typeof s=="number"?i===s:typeof i=="object"&&typeof s=="object"?FO(i,s):!1}const $O={horizontal:{offset:i=>({left:`${i}%`}),leap:i=>({width:`${i}%`})},"horizontal-reverse":{offset:i=>({right:`${i}%`}),leap:i=>({width:`${i}%`})},vertical:{offset:i=>({bottom:`${i}%`}),leap:i=>({height:`${i}%`})}},GO=i=>i;let Xg;function FT(){return Xg===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Xg=CSS.supports("touch-action","none"):Xg=!0),Xg}function qO(i){const{"aria-labelledby":s,defaultValue:c,disabled:p=!1,disableSwap:_=!1,isRtl:T=!1,marks:S=!1,max:k=100,min:o=0,name:I,onChange:O,onChangeCommitted:V,orientation:q="horizontal",rootRef:ee,scale:H=GO,step:j=1,shiftStep:Z=10,tabIndex:ne,value:xe}=i,ce=Ee.useRef(void 0),[me,de]=Ee.useState(-1),[_e,Se]=Ee.useState(-1),[$e,dt]=Ee.useState(!1),Y=Ee.useRef(0),pt=Ee.useRef(null),[Lt,lt]=LO({controlled:xe,default:c??o,name:"Slider"}),zt=O&&((It,Ht,mn)=>{const xn=It.nativeEvent||It,Wn=new xn.constructor(xn.type,xn);Object.defineProperty(Wn,"target",{writable:!0,value:{value:Ht,name:I}}),pt.current=Ht,O(Wn,Ht,mn)}),$n=Array.isArray(Lt);let ln=$n?Lt.slice().sort(VC):[Lt];ln=ln.map(It=>It==null?o:Ff(It,o,k));const fn=S===!0&&j!==null?[...Array(Math.floor((k-o)/j)+1)].map((It,Ht)=>({value:o+j*Ht})):S||[],gt=fn.map(It=>It.value),[Et,Le]=Ee.useState(-1),te=Ee.useRef(null),Ue=OC(ee,te),Pt=It=>Ht=>{var xn;const mn=Number(Ht.currentTarget.getAttribute("data-index"));DT(Ht.target)&&Le(mn),Se(mn),(xn=It==null?void 0:It.onFocus)==null||xn.call(It,Ht)},kt=It=>Ht=>{var mn;DT(Ht.target)||Le(-1),Se(-1),(mn=It==null?void 0:It.onBlur)==null||mn.call(It,Ht)},qt=(It,Ht)=>{const mn=Number(It.currentTarget.getAttribute("data-index")),xn=ln[mn],Wn=gt.indexOf(xn);let un=Ht;if(fn&&j==null){const tr=gt[gt.length-1];un>=tr?un=tr:un<=gt[0]?un=gt[0]:un=un<xn?gt[Wn-1]:gt[Wn+1]}if(un=Ff(un,o,k),$n){_&&(un=Ff(un,ln[mn-1]||-1/0,ln[mn+1]||1/0));const tr=un;un=BT({values:ln,newValue:un,index:mn});let zr=mn;_||(zr=un.indexOf(tr)),Zg({sliderRef:te,activeIndex:zr})}lt(un),Le(mn),zt&&!Hg(un,Lt)&&zt(It,un,mn),V&&V(It,pt.current??un)},Wt=It=>Ht=>{var mn;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(Ht.key)){Ht.preventDefault();const xn=Number(Ht.currentTarget.getAttribute("data-index")),Wn=ln[xn];let un=null;if(j!=null){const tr=Ht.shiftKey?Z:j;switch(Ht.key){case"ArrowUp":un=Rf(Wn,tr,1,o,k);break;case"ArrowRight":un=Rf(Wn,tr,T?-1:1,o,k);break;case"ArrowDown":un=Rf(Wn,tr,-1,o,k);break;case"ArrowLeft":un=Rf(Wn,tr,T?1:-1,o,k);break;case"PageUp":un=Rf(Wn,Z,1,o,k);break;case"PageDown":un=Rf(Wn,Z,-1,o,k);break;case"Home":un=o;break;case"End":un=k;break}}else if(fn){const tr=gt[gt.length-1],zr=gt.indexOf(Wn),pr=[T?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"],Yr=[T?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];pr.includes(Ht.key)?zr===0?un=gt[0]:un=gt[zr-1]:Yr.includes(Ht.key)&&(zr===gt.length-1?un=tr:un=gt[zr+1])}un!=null&&qt(Ht,un)}(mn=It==null?void 0:It.onKeyDown)==null||mn.call(It,Ht)};NC(()=>{var It;p&&te.current.contains(document.activeElement)&&((It=document.activeElement)==null||It.blur())},[p]),p&&me!==-1&&de(-1),p&&Et!==-1&&Le(-1);const St=It=>Ht=>{var mn;(mn=It.onChange)==null||mn.call(It,Ht),qt(Ht,Ht.target.valueAsNumber)},Ft=Ee.useRef(void 0);let en=q;T&&q==="horizontal"&&(en+="-reverse");const yn=({finger:It,move:Ht=!1})=>{const{current:mn}=te,{width:xn,height:Wn,bottom:un,left:tr}=mn.getBoundingClientRect();let zr;en.startsWith("vertical")?zr=(un-It.y)/Wn:zr=(It.x-tr)/xn,en.includes("-reverse")&&(zr=1-zr);let pr;if(pr=jO(zr,o,k),j)pr=UO(pr,j,o);else{const io=OT(gt,pr);pr=gt[io]}pr=Ff(pr,o,k);let Yr=0;if($n){Ht?Yr=Ft.current:Yr=OT(ln,pr),_&&(pr=Ff(pr,ln[Yr-1]||-1/0,ln[Yr+1]||1/0));const io=pr;pr=BT({values:ln,newValue:pr,index:Yr}),_&&Ht||(Yr=pr.indexOf(io),Ft.current=Yr)}return{newValue:pr,activeIndex:Yr}},Bn=$v(It=>{const Ht=Wg(It,ce);if(!Ht)return;if(Y.current+=1,It.type==="mousemove"&&It.buttons===0){Xt(It);return}const{newValue:mn,activeIndex:xn}=yn({finger:Ht,move:!0});Zg({sliderRef:te,activeIndex:xn,setActive:de}),lt(mn),!$e&&Y.current>NO&&dt(!0),zt&&!Hg(mn,Lt)&&zt(It,mn,xn)}),Xt=$v(It=>{const Ht=Wg(It,ce);if(dt(!1),!Ht)return;const{newValue:mn}=yn({finger:Ht,move:!0});de(-1),It.type==="touchend"&&Se(-1),V&&V(It,pt.current??mn),ce.current=void 0,pn()}),Fn=$v(It=>{if(p)return;FT()||It.preventDefault();const Ht=It.changedTouches[0];Ht!=null&&(ce.current=Ht.identifier);const mn=Wg(It,ce);if(mn!==!1){const{newValue:Wn,activeIndex:un}=yn({finger:mn});Zg({sliderRef:te,activeIndex:un,setActive:de}),lt(Wn),zt&&!Hg(Wn,Lt)&&zt(It,Wn,un)}Y.current=0;const xn=ly(te.current);xn.addEventListener("touchmove",Bn,{passive:!0}),xn.addEventListener("touchend",Xt,{passive:!0})}),pn=Ee.useCallback(()=>{const It=ly(te.current);It.removeEventListener("mousemove",Bn),It.removeEventListener("mouseup",Xt),It.removeEventListener("touchmove",Bn),It.removeEventListener("touchend",Xt)},[Xt,Bn]);Ee.useEffect(()=>{const{current:It}=te;return It.addEventListener("touchstart",Fn,{passive:FT()}),()=>{It.removeEventListener("touchstart",Fn),pn()}},[pn,Fn]),Ee.useEffect(()=>{p&&pn()},[p,pn]);const Pr=It=>Ht=>{var Wn;if((Wn=It.onMouseDown)==null||Wn.call(It,Ht),p||Ht.defaultPrevented||Ht.button!==0)return;Ht.preventDefault();const mn=Wg(Ht,ce);if(mn!==!1){const{newValue:un,activeIndex:tr}=yn({finger:mn});Zg({sliderRef:te,activeIndex:tr,setActive:de}),lt(un),zt&&!Hg(un,Lt)&&zt(Ht,un,tr)}Y.current=0;const xn=ly(te.current);xn.addEventListener("mousemove",Bn,{passive:!0}),xn.addEventListener("mouseup",Xt)},Nn=by($n?ln[0]:o,o,k),jn=by(ln[ln.length-1],o,k)-Nn,Kr=(It={})=>{const Ht=ay(It),mn={onMouseDown:Pr(Ht||{})},xn={...Ht,...mn};return{...It,ref:Ue,...xn}},Dr=It=>Ht=>{var xn;(xn=It.onMouseOver)==null||xn.call(It,Ht);const mn=Number(Ht.currentTarget.getAttribute("data-index"));Se(mn)},lr=It=>Ht=>{var mn;(mn=It.onMouseLeave)==null||mn.call(It,Ht),Se(-1)},Ii=(It={})=>{const Ht=ay(It),mn={onMouseOver:Dr(Ht||{}),onMouseLeave:lr(Ht||{})};return{...It,...Ht,...mn}},Zi=It=>({pointerEvents:me!==-1&&me!==It?"none":void 0});let Hi;return q==="vertical"&&(Hi=T?"vertical-rl":"vertical-lr"),{active:me,axis:en,axisProps:$O,dragging:$e,focusedThumbIndex:Et,getHiddenInputProps:(It={})=>{const Ht=ay(It),mn={onChange:St(Ht||{}),onFocus:Pt(Ht||{}),onBlur:kt(Ht||{}),onKeyDown:Wt(Ht||{})},xn={...Ht,...mn};return{tabIndex:ne,"aria-labelledby":s,"aria-orientation":q,"aria-valuemax":H(k),"aria-valuemin":H(o),name:I,type:"range",min:i.min,max:i.max,step:i.step===null&&i.marks?"any":i.step??void 0,disabled:p,...It,...xn,style:{...DO,direction:T?"rtl":"ltr",width:"100%",height:"100%",writingMode:Hi}}},getRootProps:Kr,getThumbProps:Ii,marks:fn,open:_e,range:$n,rootRef:Ue,trackLeap:jn,trackOffset:Nn,values:ln,getThumbStyle:Zi}}function uy(i){return typeof i=="string"}function _m(i,s){return s?oa(i,s,{clone:!1}):i}function WO(i,s){if(!i.containerQueries)return s;const c=Object.keys(s).filter(p=>p.startsWith("@container")).sort((p,_)=>{var S,k;const T=/min-width:\s*([0-9.]+)/;return+(((S=p.match(T))==null?void 0:S[1])||0)-+(((k=_.match(T))==null?void 0:k[1])||0)});return c.length?c.reduce((p,_)=>{const T=s[_];return delete p[_],p[_]=T,p},{...s}):s}function ZO(i,s){return s==="@"||s.startsWith("@")&&(i.some(c=>s.startsWith(`@${c}`))||!!s.match(/^@\d/))}function HO(i,s){const c=s.match(/^@([^/]+)?\/?(.+)?$/);if(!c)return null;const[,p,_]=c,T=Number.isNaN(+p)?p||0:+p;return i.containerQueries(_).up(T)}function XO(i){const s=(T,S)=>T.replace("@media",S?`@container ${S}`:"@container");function c(T,S){T.up=(...k)=>s(i.breakpoints.up(...k),S),T.down=(...k)=>s(i.breakpoints.down(...k),S),T.between=(...k)=>s(i.breakpoints.between(...k),S),T.only=(...k)=>s(i.breakpoints.only(...k),S),T.not=(...k)=>{const o=s(i.breakpoints.not(...k),S);return o.includes("not all and")?o.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):o}}const p={},_=T=>(c(p,T),p);return c(_),{...i,containerQueries:_}}const $y={xs:0,sm:600,md:900,lg:1200,xl:1536},NT={keys:["xs","sm","md","lg","xl"],up:i=>`@media (min-width:${$y[i]}px)`},KO={containerQueries:i=>({up:s=>{let c=typeof s=="number"?s:$y[s]||s;return typeof c=="number"&&(c=`${c}px`),i?`@container ${i} (min-width:${c})`:`@container (min-width:${c})`}})};function pc(i,s,c){const p=i.theme||{};if(Array.isArray(s)){const T=p.breakpoints||NT;return s.reduce((S,k,o)=>(S[T.up(T.keys[o])]=c(s[o]),S),{})}if(typeof s=="object"){const T=p.breakpoints||NT;return Object.keys(s).reduce((S,k)=>{if(ZO(T.keys,k)){const o=HO(p.containerQueries?p:KO,k);o&&(S[o]=c(s[k],k))}else if(Object.keys(T.values||$y).includes(k)){const o=T.up(k);S[o]=c(s[k],k)}else{const o=k;S[o]=s[o]}return S},{})}return c(s)}function YO(i={}){var c;return((c=i.keys)==null?void 0:c.reduce((p,_)=>{const T=i.up(_);return p[T]={},p},{}))||{}}function JO(i,s){return i.reduce((c,p)=>{const _=c[p];return(!_||Object.keys(_).length===0)&&delete c[p],c},s)}function Gy(i,s,c=!0){if(!s||typeof s!="string")return null;if(i&&i.vars&&c){const p=`vars.${s}`.split(".").reduce((_,T)=>_&&_[T]?_[T]:null,i);if(p!=null)return p}return s.split(".").reduce((p,_)=>p&&p[_]!=null?p[_]:null,i)}function Ty(i,s,c,p=c){let _;return typeof i=="function"?_=i(c):Array.isArray(i)?_=i[c]||p:_=Gy(i,c)||p,s&&(_=s(_,p,i)),_}function Bi(i){const{prop:s,cssProperty:c=i.prop,themeKey:p,transform:_}=i,T=S=>{if(S[s]==null)return null;const k=S[s],o=S.theme,I=Gy(o,p)||{};return pc(S,k,V=>{let q=Ty(I,_,V);return V===q&&typeof V=="string"&&(q=Ty(I,_,`${s}${V==="default"?"":ia(V)}`,V)),c===!1?q:{[c]:q}})};return T.propTypes={},T.filterProps=[s],T}function QO(i){const s={};return c=>(s[c]===void 0&&(s[c]=i(c)),s[c])}const eB={m:"margin",p:"padding"},tB={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},jT={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},nB=QO(i=>{if(i.length>2)if(jT[i])i=jT[i];else return[i];const[s,c]=i.split(""),p=eB[s],_=tB[c]||"";return Array.isArray(_)?_.map(T=>p+T):[p+_]}),wx=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],bx=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...wx,...bx];function Gm(i,s,c,p){const _=Gy(i,s,!0)??c;return typeof _=="number"||typeof _=="string"?T=>typeof T=="string"?T:typeof _=="string"?_.startsWith("var(")&&T===0?0:_.startsWith("var(")&&T===1?_:`calc(${T} * ${_})`:_*T:Array.isArray(_)?T=>{if(typeof T=="string")return T;const S=Math.abs(T),k=_[S];return T>=0?k:typeof k=="number"?-k:typeof k=="string"&&k.startsWith("var(")?`calc(-1 * ${k})`:`-${k}`}:typeof _=="function"?_:()=>{}}function Tx(i){return Gm(i,"spacing",8)}function qm(i,s){return typeof s=="string"||s==null?s:i(s)}function rB(i,s){return c=>i.reduce((p,_)=>(p[_]=qm(s,c),p),{})}function iB(i,s,c,p){if(!s.includes(c))return null;const _=nB(c),T=rB(_,p),S=i[c];return pc(i,S,T)}function UC(i,s){const c=Tx(i.theme);return Object.keys(i).map(p=>iB(i,s,p,c)).reduce(_m,{})}function Ai(i){return UC(i,wx)}Ai.propTypes={};Ai.filterProps=wx;function Mi(i){return UC(i,bx)}Mi.propTypes={};Mi.filterProps=bx;function qy(...i){const s=i.reduce((p,_)=>(_.filterProps.forEach(T=>{p[T]=_}),p),{}),c=p=>Object.keys(p).reduce((_,T)=>s[T]?_m(_,s[T](p)):_,{});return c.propTypes={},c.filterProps=i.reduce((p,_)=>p.concat(_.filterProps),[]),c}function za(i){return typeof i!="number"?i:`${i}px solid`}function Na(i,s){return Bi({prop:i,themeKey:"borders",transform:s})}const oB=Na("border",za),sB=Na("borderTop",za),aB=Na("borderRight",za),lB=Na("borderBottom",za),uB=Na("borderLeft",za),cB=Na("borderColor"),hB=Na("borderTopColor"),dB=Na("borderRightColor"),fB=Na("borderBottomColor"),pB=Na("borderLeftColor"),mB=Na("outline",za),gB=Na("outlineColor"),Wy=i=>{if(i.borderRadius!==void 0&&i.borderRadius!==null){const s=Gm(i.theme,"shape.borderRadius",4),c=p=>({borderRadius:qm(s,p)});return pc(i,i.borderRadius,c)}return null};Wy.propTypes={};Wy.filterProps=["borderRadius"];qy(oB,sB,aB,lB,uB,cB,hB,dB,fB,pB,Wy,mB,gB);const Zy=i=>{if(i.gap!==void 0&&i.gap!==null){const s=Gm(i.theme,"spacing",8),c=p=>({gap:qm(s,p)});return pc(i,i.gap,c)}return null};Zy.propTypes={};Zy.filterProps=["gap"];const Hy=i=>{if(i.columnGap!==void 0&&i.columnGap!==null){const s=Gm(i.theme,"spacing",8),c=p=>({columnGap:qm(s,p)});return pc(i,i.columnGap,c)}return null};Hy.propTypes={};Hy.filterProps=["columnGap"];const Xy=i=>{if(i.rowGap!==void 0&&i.rowGap!==null){const s=Gm(i.theme,"spacing",8),c=p=>({rowGap:qm(s,p)});return pc(i,i.rowGap,c)}return null};Xy.propTypes={};Xy.filterProps=["rowGap"];const yB=Bi({prop:"gridColumn"}),_B=Bi({prop:"gridRow"}),vB=Bi({prop:"gridAutoFlow"}),xB=Bi({prop:"gridAutoColumns"}),wB=Bi({prop:"gridAutoRows"}),bB=Bi({prop:"gridTemplateColumns"}),TB=Bi({prop:"gridTemplateRows"}),EB=Bi({prop:"gridTemplateAreas"}),SB=Bi({prop:"gridArea"});qy(Zy,Hy,Xy,yB,_B,vB,xB,wB,bB,TB,EB,SB);function Gf(i,s){return s==="grey"?s:i}const CB=Bi({prop:"color",themeKey:"palette",transform:Gf}),AB=Bi({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Gf}),MB=Bi({prop:"backgroundColor",themeKey:"palette",transform:Gf});qy(CB,AB,MB);function ra(i){return i<=1&&i!==0?`${i*100}%`:i}const kB=Bi({prop:"width",transform:ra}),Ex=i=>{if(i.maxWidth!==void 0&&i.maxWidth!==null){const s=c=>{var _,T,S,k,o;const p=((S=(T=(_=i.theme)==null?void 0:_.breakpoints)==null?void 0:T.values)==null?void 0:S[c])||$y[c];return p?((o=(k=i.theme)==null?void 0:k.breakpoints)==null?void 0:o.unit)!=="px"?{maxWidth:`${p}${i.theme.breakpoints.unit}`}:{maxWidth:p}:{maxWidth:ra(c)}};return pc(i,i.maxWidth,s)}return null};Ex.filterProps=["maxWidth"];const PB=Bi({prop:"minWidth",transform:ra}),IB=Bi({prop:"height",transform:ra}),RB=Bi({prop:"maxHeight",transform:ra}),LB=Bi({prop:"minHeight",transform:ra});Bi({prop:"size",cssProperty:"width",transform:ra});Bi({prop:"size",cssProperty:"height",transform:ra});const DB=Bi({prop:"boxSizing"});qy(kB,Ex,PB,IB,RB,LB,DB);const Wm={border:{themeKey:"borders",transform:za},borderTop:{themeKey:"borders",transform:za},borderRight:{themeKey:"borders",transform:za},borderBottom:{themeKey:"borders",transform:za},borderLeft:{themeKey:"borders",transform:za},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:za},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Wy},color:{themeKey:"palette",transform:Gf},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Gf},backgroundColor:{themeKey:"palette",transform:Gf},p:{style:Mi},pt:{style:Mi},pr:{style:Mi},pb:{style:Mi},pl:{style:Mi},px:{style:Mi},py:{style:Mi},padding:{style:Mi},paddingTop:{style:Mi},paddingRight:{style:Mi},paddingBottom:{style:Mi},paddingLeft:{style:Mi},paddingX:{style:Mi},paddingY:{style:Mi},paddingInline:{style:Mi},paddingInlineStart:{style:Mi},paddingInlineEnd:{style:Mi},paddingBlock:{style:Mi},paddingBlockStart:{style:Mi},paddingBlockEnd:{style:Mi},m:{style:Ai},mt:{style:Ai},mr:{style:Ai},mb:{style:Ai},ml:{style:Ai},mx:{style:Ai},my:{style:Ai},margin:{style:Ai},marginTop:{style:Ai},marginRight:{style:Ai},marginBottom:{style:Ai},marginLeft:{style:Ai},marginX:{style:Ai},marginY:{style:Ai},marginInline:{style:Ai},marginInlineStart:{style:Ai},marginInlineEnd:{style:Ai},marginBlock:{style:Ai},marginBlockStart:{style:Ai},marginBlockEnd:{style:Ai},displayPrint:{cssProperty:!1,transform:i=>({"@media print":{display:i}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Zy},rowGap:{style:Xy},columnGap:{style:Hy},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:ra},maxWidth:{style:Ex},minWidth:{transform:ra},height:{transform:ra},maxHeight:{transform:ra},minHeight:{transform:ra},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function zB(...i){const s=i.reduce((p,_)=>p.concat(Object.keys(_)),[]),c=new Set(s);return i.every(p=>c.size===Object.keys(p).length)}function OB(i,s){return typeof i=="function"?i(s):i}function BB(){function i(c,p,_,T){const S={[c]:p,theme:_},k=T[c];if(!k)return{[c]:p};const{cssProperty:o=c,themeKey:I,transform:O,style:V}=k;if(p==null)return null;if(I==="typography"&&p==="inherit")return{[c]:p};const q=Gy(_,I)||{};return V?V(S):pc(S,p,H=>{let j=Ty(q,O,H);return H===j&&typeof H=="string"&&(j=Ty(q,O,`${c}${H==="default"?"":ia(H)}`,H)),o===!1?j:{[o]:j}})}function s(c){const{sx:p,theme:_={}}=c||{};if(!p)return null;const T=_.unstable_sxConfig??Wm;function S(k){let o=k;if(typeof k=="function")o=k(_);else if(typeof k!="object")return k;if(!o)return null;const I=YO(_.breakpoints),O=Object.keys(I);let V=I;return Object.keys(o).forEach(q=>{const ee=OB(o[q],_);if(ee!=null)if(typeof ee=="object")if(T[q])V=_m(V,i(q,ee,_,T));else{const H=pc({theme:_},ee,j=>({[q]:j}));zB(H,ee)?V[q]=s({sx:ee,theme:_}):V=_m(V,H)}else V=_m(V,i(q,ee,_,T))}),WO(_,JO(O,V))}return Array.isArray(p)?p.map(S):S(p)}return s}const Hf=BB();Hf.filterProps=["sx"];const FB=i=>{var p;const s={systemProps:{},otherProps:{}},c=((p=i==null?void 0:i.theme)==null?void 0:p.unstable_sxConfig)??Wm;return Object.keys(i).forEach(_=>{c[_]?s.systemProps[_]=i[_]:s.otherProps[_]=i[_]}),s};function NB(i){const{sx:s,...c}=i,{systemProps:p,otherProps:_}=FB(c);let T;return Array.isArray(s)?T=[p,...s]:typeof s=="function"?T=(...S)=>{const k=s(...S);return du(k)?{...p,...k}:p}:T={...p,...s},{..._,sx:T}}function C0(){return C0=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var c=arguments[s];for(var p in c)({}).hasOwnProperty.call(c,p)&&(i[p]=c[p])}return i},C0.apply(null,arguments)}function jB(i){if(i.sheet)return i.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===i)return document.styleSheets[s]}function VB(i){var s=document.createElement("style");return s.setAttribute("data-emotion",i.key),i.nonce!==void 0&&s.setAttribute("nonce",i.nonce),s.appendChild(document.createTextNode("")),s.setAttribute("data-s",""),s}var UB=function(){function i(c){var p=this;this._insertTag=function(_){var T;p.tags.length===0?p.insertionPoint?T=p.insertionPoint.nextSibling:p.prepend?T=p.container.firstChild:T=p.before:T=p.tags[p.tags.length-1].nextSibling,p.container.insertBefore(_,T),p.tags.push(_)},this.isSpeedy=c.speedy===void 0?!0:c.speedy,this.tags=[],this.ctr=0,this.nonce=c.nonce,this.key=c.key,this.container=c.container,this.prepend=c.prepend,this.insertionPoint=c.insertionPoint,this.before=null}var s=i.prototype;return s.hydrate=function(p){p.forEach(this._insertTag)},s.insert=function(p){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(VB(this));var _=this.tags[this.tags.length-1];if(this.isSpeedy){var T=jB(_);try{T.insertRule(p,T.cssRules.length)}catch{}}else _.appendChild(document.createTextNode(p));this.ctr++},s.flush=function(){this.tags.forEach(function(p){var _;return(_=p.parentNode)==null?void 0:_.removeChild(p)}),this.tags=[],this.ctr=0},i}(),Yo="-ms-",Ey="-moz-",Er="-webkit-",$C="comm",Sx="rule",Cx="decl",$B="@import",GC="@keyframes",GB="@layer",qB=Math.abs,Ky=String.fromCharCode,WB=Object.assign;function ZB(i,s){return Ro(i,0)^45?(((s<<2^Ro(i,0))<<2^Ro(i,1))<<2^Ro(i,2))<<2^Ro(i,3):0}function qC(i){return i.trim()}function HB(i,s){return(i=s.exec(i))?i[0]:i}function Sr(i,s,c){return i.replace(s,c)}function A0(i,s){return i.indexOf(s)}function Ro(i,s){return i.charCodeAt(s)|0}function Im(i,s,c){return i.slice(s,c)}function cu(i){return i.length}function Ax(i){return i.length}function Kg(i,s){return s.push(i),i}function XB(i,s){return i.map(s).join("")}var Yy=1,Xf=1,WC=0,Fs=0,Wi=0,ip="";function Jy(i,s,c,p,_,T,S){return{value:i,root:s,parent:c,type:p,props:_,children:T,line:Yy,column:Xf,length:S,return:""}}function sm(i,s){return WB(Jy("",null,null,"",null,null,0),i,{length:-i.length},s)}function KB(){return Wi}function YB(){return Wi=Fs>0?Ro(ip,--Fs):0,Xf--,Wi===10&&(Xf=1,Yy--),Wi}function sa(){return Wi=Fs<WC?Ro(ip,Fs++):0,Xf++,Wi===10&&(Xf=1,Yy++),Wi}function gu(){return Ro(ip,Fs)}function cy(){return Fs}function Zm(i,s){return Im(ip,i,s)}function Rm(i){switch(i){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ZC(i){return Yy=Xf=1,WC=cu(ip=i),Fs=0,[]}function HC(i){return ip="",i}function hy(i){return qC(Zm(Fs-1,M0(i===91?i+2:i===40?i+1:i)))}function JB(i){for(;(Wi=gu())&&Wi<33;)sa();return Rm(i)>2||Rm(Wi)>3?"":" "}function QB(i,s){for(;--s&&sa()&&!(Wi<48||Wi>102||Wi>57&&Wi<65||Wi>70&&Wi<97););return Zm(i,cy()+(s<6&&gu()==32&&sa()==32))}function M0(i){for(;sa();)switch(Wi){case i:return Fs;case 34:case 39:i!==34&&i!==39&&M0(Wi);break;case 40:i===41&&M0(i);break;case 92:sa();break}return Fs}function e5(i,s){for(;sa()&&i+Wi!==57;)if(i+Wi===84&&gu()===47)break;return"/*"+Zm(s,Fs-1)+"*"+Ky(i===47?i:sa())}function t5(i){for(;!Rm(gu());)sa();return Zm(i,Fs)}function n5(i){return HC(dy("",null,null,null,[""],i=ZC(i),0,[0],i))}function dy(i,s,c,p,_,T,S,k,o){for(var I=0,O=0,V=S,q=0,ee=0,H=0,j=1,Z=1,ne=1,xe=0,ce="",me=_,de=T,_e=p,Se=ce;Z;)switch(H=xe,xe=sa()){case 40:if(H!=108&&Ro(Se,V-1)==58){A0(Se+=Sr(hy(xe),"&","&\f"),"&\f")!=-1&&(ne=-1);break}case 34:case 39:case 91:Se+=hy(xe);break;case 9:case 10:case 13:case 32:Se+=JB(H);break;case 92:Se+=QB(cy()-1,7);continue;case 47:switch(gu()){case 42:case 47:Kg(r5(e5(sa(),cy()),s,c),o);break;default:Se+="/"}break;case 123*j:k[I++]=cu(Se)*ne;case 125*j:case 59:case 0:switch(xe){case 0:case 125:Z=0;case 59+O:ne==-1&&(Se=Sr(Se,/\f/g,"")),ee>0&&cu(Se)-V&&Kg(ee>32?UT(Se+";",p,c,V-1):UT(Sr(Se," ","")+";",p,c,V-2),o);break;case 59:Se+=";";default:if(Kg(_e=VT(Se,s,c,I,O,_,k,ce,me=[],de=[],V),T),xe===123)if(O===0)dy(Se,s,_e,_e,me,T,V,k,de);else switch(q===99&&Ro(Se,3)===110?100:q){case 100:case 108:case 109:case 115:dy(i,_e,_e,p&&Kg(VT(i,_e,_e,0,0,_,k,ce,_,me=[],V),de),_,de,V,k,p?me:de);break;default:dy(Se,_e,_e,_e,[""],de,0,k,de)}}I=O=ee=0,j=ne=1,ce=Se="",V=S;break;case 58:V=1+cu(Se),ee=H;default:if(j<1){if(xe==123)--j;else if(xe==125&&j++==0&&YB()==125)continue}switch(Se+=Ky(xe),xe*j){case 38:ne=O>0?1:(Se+="\f",-1);break;case 44:k[I++]=(cu(Se)-1)*ne,ne=1;break;case 64:gu()===45&&(Se+=hy(sa())),q=gu(),O=V=cu(ce=Se+=t5(cy())),xe++;break;case 45:H===45&&cu(Se)==2&&(j=0)}}return T}function VT(i,s,c,p,_,T,S,k,o,I,O){for(var V=_-1,q=_===0?T:[""],ee=Ax(q),H=0,j=0,Z=0;H<p;++H)for(var ne=0,xe=Im(i,V+1,V=qB(j=S[H])),ce=i;ne<ee;++ne)(ce=qC(j>0?q[ne]+" "+xe:Sr(xe,/&\f/g,q[ne])))&&(o[Z++]=ce);return Jy(i,s,c,_===0?Sx:k,o,I,O)}function r5(i,s,c){return Jy(i,s,c,$C,Ky(KB()),Im(i,2,-2),0)}function UT(i,s,c,p){return Jy(i,s,c,Cx,Im(i,0,p),Im(i,p+1,-1),p)}function qf(i,s){for(var c="",p=Ax(i),_=0;_<p;_++)c+=s(i[_],_,i,s)||"";return c}function i5(i,s,c,p){switch(i.type){case GB:if(i.children.length)break;case $B:case Cx:return i.return=i.return||i.value;case $C:return"";case GC:return i.return=i.value+"{"+qf(i.children,p)+"}";case Sx:i.value=i.props.join(",")}return cu(c=qf(i.children,p))?i.return=i.value+"{"+c+"}":""}function o5(i){var s=Ax(i);return function(c,p,_,T){for(var S="",k=0;k<s;k++)S+=i[k](c,p,_,T)||"";return S}}function s5(i){return function(s){s.root||(s=s.return)&&i(s)}}function XC(i){var s=Object.create(null);return function(c){return s[c]===void 0&&(s[c]=i(c)),s[c]}}var a5=function(s,c,p){for(var _=0,T=0;_=T,T=gu(),_===38&&T===12&&(c[p]=1),!Rm(T);)sa();return Zm(s,Fs)},l5=function(s,c){var p=-1,_=44;do switch(Rm(_)){case 0:_===38&&gu()===12&&(c[p]=1),s[p]+=a5(Fs-1,c,p);break;case 2:s[p]+=hy(_);break;case 4:if(_===44){s[++p]=gu()===58?"&\f":"",c[p]=s[p].length;break}default:s[p]+=Ky(_)}while(_=sa());return s},u5=function(s,c){return HC(l5(ZC(s),c))},$T=new WeakMap,c5=function(s){if(!(s.type!=="rule"||!s.parent||s.length<1)){for(var c=s.value,p=s.parent,_=s.column===p.column&&s.line===p.line;p.type!=="rule";)if(p=p.parent,!p)return;if(!(s.props.length===1&&c.charCodeAt(0)!==58&&!$T.get(p))&&!_){$T.set(s,!0);for(var T=[],S=u5(c,T),k=p.props,o=0,I=0;o<S.length;o++)for(var O=0;O<k.length;O++,I++)s.props[I]=T[o]?S[o].replace(/&\f/g,k[O]):k[O]+" "+S[o]}}},h5=function(s){if(s.type==="decl"){var c=s.value;c.charCodeAt(0)===108&&c.charCodeAt(2)===98&&(s.return="",s.value="")}};function KC(i,s){switch(ZB(i,s)){case 5103:return Er+"print-"+i+i;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Er+i+i;case 5349:case 4246:case 4810:case 6968:case 2756:return Er+i+Ey+i+Yo+i+i;case 6828:case 4268:return Er+i+Yo+i+i;case 6165:return Er+i+Yo+"flex-"+i+i;case 5187:return Er+i+Sr(i,/(\w+).+(:[^]+)/,Er+"box-$1$2"+Yo+"flex-$1$2")+i;case 5443:return Er+i+Yo+"flex-item-"+Sr(i,/flex-|-self/,"")+i;case 4675:return Er+i+Yo+"flex-line-pack"+Sr(i,/align-content|flex-|-self/,"")+i;case 5548:return Er+i+Yo+Sr(i,"shrink","negative")+i;case 5292:return Er+i+Yo+Sr(i,"basis","preferred-size")+i;case 6060:return Er+"box-"+Sr(i,"-grow","")+Er+i+Yo+Sr(i,"grow","positive")+i;case 4554:return Er+Sr(i,/([^-])(transform)/g,"$1"+Er+"$2")+i;case 6187:return Sr(Sr(Sr(i,/(zoom-|grab)/,Er+"$1"),/(image-set)/,Er+"$1"),i,"")+i;case 5495:case 3959:return Sr(i,/(image-set\([^]*)/,Er+"$1$`$1");case 4968:return Sr(Sr(i,/(.+:)(flex-)?(.*)/,Er+"box-pack:$3"+Yo+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Er+i+i;case 4095:case 3583:case 4068:case 2532:return Sr(i,/(.+)-inline(.+)/,Er+"$1$2")+i;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(cu(i)-1-s>6)switch(Ro(i,s+1)){case 109:if(Ro(i,s+4)!==45)break;case 102:return Sr(i,/(.+:)(.+)-([^]+)/,"$1"+Er+"$2-$3$1"+Ey+(Ro(i,s+3)==108?"$3":"$2-$3"))+i;case 115:return~A0(i,"stretch")?KC(Sr(i,"stretch","fill-available"),s)+i:i}break;case 4949:if(Ro(i,s+1)!==115)break;case 6444:switch(Ro(i,cu(i)-3-(~A0(i,"!important")&&10))){case 107:return Sr(i,":",":"+Er)+i;case 101:return Sr(i,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Er+(Ro(i,14)===45?"inline-":"")+"box$3$1"+Er+"$2$3$1"+Yo+"$2box$3")+i}break;case 5936:switch(Ro(i,s+11)){case 114:return Er+i+Yo+Sr(i,/[svh]\w+-[tblr]{2}/,"tb")+i;case 108:return Er+i+Yo+Sr(i,/[svh]\w+-[tblr]{2}/,"tb-rl")+i;case 45:return Er+i+Yo+Sr(i,/[svh]\w+-[tblr]{2}/,"lr")+i}return Er+i+Yo+i+i}return i}var d5=function(s,c,p,_){if(s.length>-1&&!s.return)switch(s.type){case Cx:s.return=KC(s.value,s.length);break;case GC:return qf([sm(s,{value:Sr(s.value,"@","@"+Er)})],_);case Sx:if(s.length)return XB(s.props,function(T){switch(HB(T,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return qf([sm(s,{props:[Sr(T,/:(read-\w+)/,":"+Ey+"$1")]})],_);case"::placeholder":return qf([sm(s,{props:[Sr(T,/:(plac\w+)/,":"+Er+"input-$1")]}),sm(s,{props:[Sr(T,/:(plac\w+)/,":"+Ey+"$1")]}),sm(s,{props:[Sr(T,/:(plac\w+)/,Yo+"input-$1")]})],_)}return""})}},f5=[d5],p5=function(s){var c=s.key;if(c==="css"){var p=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(p,function(j){var Z=j.getAttribute("data-emotion");Z.indexOf(" ")!==-1&&(document.head.appendChild(j),j.setAttribute("data-s",""))})}var _=s.stylisPlugins||f5,T={},S,k=[];S=s.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+c+' "]'),function(j){for(var Z=j.getAttribute("data-emotion").split(" "),ne=1;ne<Z.length;ne++)T[Z[ne]]=!0;k.push(j)});var o,I=[c5,h5];{var O,V=[i5,s5(function(j){O.insert(j)})],q=o5(I.concat(_,V)),ee=function(Z){return qf(n5(Z),q)};o=function(Z,ne,xe,ce){O=xe,ee(Z?Z+"{"+ne.styles+"}":ne.styles),ce&&(H.inserted[ne.name]=!0)}}var H={key:c,sheet:new UB({key:c,container:S,nonce:s.nonce,speedy:s.speedy,prepend:s.prepend,insertionPoint:s.insertionPoint}),nonce:s.nonce,inserted:T,registered:{},insert:o};return H.sheet.hydrate(k),H},m5=!0;function g5(i,s,c){var p="";return c.split(" ").forEach(function(_){i[_]!==void 0?s.push(i[_]+";"):_&&(p+=_+" ")}),p}var YC=function(s,c,p){var _=s.key+"-"+c.name;(p===!1||m5===!1)&&s.registered[_]===void 0&&(s.registered[_]=c.styles)},y5=function(s,c,p){YC(s,c,p);var _=s.key+"-"+c.name;if(s.inserted[c.name]===void 0){var T=c;do s.insert(c===T?"."+_:"",T,s.sheet,!0),T=T.next;while(T!==void 0)}};function _5(i){for(var s=0,c,p=0,_=i.length;_>=4;++p,_-=4)c=i.charCodeAt(p)&255|(i.charCodeAt(++p)&255)<<8|(i.charCodeAt(++p)&255)<<16|(i.charCodeAt(++p)&255)<<24,c=(c&65535)*1540483477+((c>>>16)*59797<<16),c^=c>>>24,s=(c&65535)*1540483477+((c>>>16)*59797<<16)^(s&65535)*1540483477+((s>>>16)*59797<<16);switch(_){case 3:s^=(i.charCodeAt(p+2)&255)<<16;case 2:s^=(i.charCodeAt(p+1)&255)<<8;case 1:s^=i.charCodeAt(p)&255,s=(s&65535)*1540483477+((s>>>16)*59797<<16)}return s^=s>>>13,s=(s&65535)*1540483477+((s>>>16)*59797<<16),((s^s>>>15)>>>0).toString(36)}var v5={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},x5=/[A-Z]|^ms/g,w5=/_EMO_([^_]+?)_([^]*?)_EMO_/g,JC=function(s){return s.charCodeAt(1)===45},GT=function(s){return s!=null&&typeof s!="boolean"},Gv=XC(function(i){return JC(i)?i:i.replace(x5,"-$&").toLowerCase()}),qT=function(s,c){switch(s){case"animation":case"animationName":if(typeof c=="string")return c.replace(w5,function(p,_,T){return hu={name:_,styles:T,next:hu},_})}return v5[s]!==1&&!JC(s)&&typeof c=="number"&&c!==0?c+"px":c};function Lm(i,s,c){if(c==null)return"";var p=c;if(p.__emotion_styles!==void 0)return p;switch(typeof c){case"boolean":return"";case"object":{var _=c;if(_.anim===1)return hu={name:_.name,styles:_.styles,next:hu},_.name;var T=c;if(T.styles!==void 0){var S=T.next;if(S!==void 0)for(;S!==void 0;)hu={name:S.name,styles:S.styles,next:hu},S=S.next;var k=T.styles+";";return k}return b5(i,s,c)}case"function":{if(i!==void 0){var o=hu,I=c(i);return hu=o,Lm(i,s,I)}break}}var O=c;if(s==null)return O;var V=s[O];return V!==void 0?V:O}function b5(i,s,c){var p="";if(Array.isArray(c))for(var _=0;_<c.length;_++)p+=Lm(i,s,c[_])+";";else for(var T in c){var S=c[T];if(typeof S!="object"){var k=S;s!=null&&s[k]!==void 0?p+=T+"{"+s[k]+"}":GT(k)&&(p+=Gv(T)+":"+qT(T,k)+";")}else if(Array.isArray(S)&&typeof S[0]=="string"&&(s==null||s[S[0]]===void 0))for(var o=0;o<S.length;o++)GT(S[o])&&(p+=Gv(T)+":"+qT(T,S[o])+";");else{var I=Lm(i,s,S);switch(T){case"animation":case"animationName":{p+=Gv(T)+":"+I+";";break}default:p+=T+"{"+I+"}"}}}return p}var WT=/label:\s*([^\s;{]+)\s*(;|$)/g,hu;function QC(i,s,c){if(i.length===1&&typeof i[0]=="object"&&i[0]!==null&&i[0].styles!==void 0)return i[0];var p=!0,_="";hu=void 0;var T=i[0];if(T==null||T.raw===void 0)p=!1,_+=Lm(c,s,T);else{var S=T;_+=S[0]}for(var k=1;k<i.length;k++)if(_+=Lm(c,s,i[k]),p){var o=T;_+=o[k]}WT.lastIndex=0;for(var I="",O;(O=WT.exec(_))!==null;)I+="-"+O[1];var V=_5(_)+I;return{name:V,styles:_,next:hu}}var T5=function(s){return s()},E5=lw.useInsertionEffect?lw.useInsertionEffect:!1,S5=E5||T5,eA=Ee.createContext(typeof HTMLElement<"u"?p5({key:"css"}):null);eA.Provider;var C5=function(s){return Ee.forwardRef(function(c,p){var _=Ee.useContext(eA);return s(c,_,p)})},A5=Ee.createContext({}),M5=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,k5=XC(function(i){return M5.test(i)||i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)<91}),P5=k5,I5=function(s){return s!=="theme"},ZT=function(s){return typeof s=="string"&&s.charCodeAt(0)>96?P5:I5},HT=function(s,c,p){var _;if(c){var T=c.shouldForwardProp;_=s.__emotion_forwardProp&&T?function(S){return s.__emotion_forwardProp(S)&&T(S)}:T}return typeof _!="function"&&p&&(_=s.__emotion_forwardProp),_},R5=function(s){var c=s.cache,p=s.serialized,_=s.isStringTag;return YC(c,p,_),S5(function(){return y5(c,p,_)}),null},L5=function i(s,c){var p=s.__emotion_real===s,_=p&&s.__emotion_base||s,T,S;c!==void 0&&(T=c.label,S=c.target);var k=HT(s,c,p),o=k||ZT(_),I=!o("as");return function(){var O=arguments,V=p&&s.__emotion_styles!==void 0?s.__emotion_styles.slice(0):[];if(T!==void 0&&V.push("label:"+T+";"),O[0]==null||O[0].raw===void 0)V.push.apply(V,O);else{var q=O[0];V.push(q[0]);for(var ee=O.length,H=1;H<ee;H++)V.push(O[H],q[H])}var j=C5(function(Z,ne,xe){var ce=I&&Z.as||_,me="",de=[],_e=Z;if(Z.theme==null){_e={};for(var Se in Z)_e[Se]=Z[Se];_e.theme=Ee.useContext(A5)}typeof Z.className=="string"?me=g5(ne.registered,de,Z.className):Z.className!=null&&(me=Z.className+" ");var $e=QC(V.concat(de),ne.registered,_e);me+=ne.key+"-"+$e.name,S!==void 0&&(me+=" "+S);var dt=I&&k===void 0?ZT(ce):o,Y={};for(var pt in Z)I&&pt==="as"||dt(pt)&&(Y[pt]=Z[pt]);return Y.className=me,xe&&(Y.ref=xe),Ee.createElement(Ee.Fragment,null,Ee.createElement(R5,{cache:ne,serialized:$e,isStringTag:typeof ce=="string"}),Ee.createElement(ce,Y))});return j.displayName=T!==void 0?T:"Styled("+(typeof _=="string"?_:_.displayName||_.name||"Component")+")",j.defaultProps=s.defaultProps,j.__emotion_real=j,j.__emotion_base=_,j.__emotion_styles=V,j.__emotion_forwardProp=k,Object.defineProperty(j,"toString",{value:function(){return"."+S}}),j.withComponent=function(Z,ne){var xe=i(Z,C0({},c,ne,{shouldForwardProp:HT(j,ne,!0)}));return xe.apply(void 0,V)},j}},D5=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],k0=L5.bind(null);D5.forEach(function(i){k0[i]=k0(i)});function z5(i,s){return k0(i,s)}function O5(i,s){Array.isArray(i.__emotion_styles)&&(i.__emotion_styles=s(i.__emotion_styles))}const XT=[];function KT(i){return XT[0]=i,QC(XT)}const B5=i=>{const s=Object.keys(i).map(c=>({key:c,val:i[c]}))||[];return s.sort((c,p)=>c.val-p.val),s.reduce((c,p)=>({...c,[p.key]:p.val}),{})};function F5(i){const{values:s={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:c="px",step:p=5,..._}=i,T=B5(s),S=Object.keys(T);function k(q){return`@media (min-width:${typeof s[q]=="number"?s[q]:q}${c})`}function o(q){return`@media (max-width:${(typeof s[q]=="number"?s[q]:q)-p/100}${c})`}function I(q,ee){const H=S.indexOf(ee);return`@media (min-width:${typeof s[q]=="number"?s[q]:q}${c}) and (max-width:${(H!==-1&&typeof s[S[H]]=="number"?s[S[H]]:ee)-p/100}${c})`}function O(q){return S.indexOf(q)+1<S.length?I(q,S[S.indexOf(q)+1]):k(q)}function V(q){const ee=S.indexOf(q);return ee===0?k(S[1]):ee===S.length-1?o(S[ee]):I(q,S[S.indexOf(q)+1]).replace("@media","@media not all and")}return{keys:S,values:T,up:k,down:o,between:I,only:O,not:V,unit:c,..._}}const N5={borderRadius:4};function tA(i=8,s=Tx({spacing:i})){if(i.mui)return i;const c=(...p)=>(p.length===0?[1]:p).map(T=>{const S=s(T);return typeof S=="number"?`${S}px`:S}).join(" ");return c.mui=!0,c}function j5(i,s){var p;const c=this;if(c.vars){if(!((p=c.colorSchemes)!=null&&p[i])||typeof c.getColorSchemeSelector!="function")return{};let _=c.getColorSchemeSelector(i);return _==="&"?s:((_.includes("data-")||_.includes("."))&&(_=`*:where(${_.replace(/\s*&$/,"")}) &`),{[_]:s})}return c.palette.mode===i?s:{}}function nA(i={},...s){const{breakpoints:c={},palette:p={},spacing:_,shape:T={},...S}=i,k=F5(c),o=tA(_);let I=oa({breakpoints:k,direction:"ltr",components:{},palette:{mode:"light",...p},spacing:o,shape:{...N5,...T}},S);return I=XO(I),I.applyStyles=j5,I=s.reduce((O,V)=>oa(O,V),I),I.unstable_sxConfig={...Wm,...S==null?void 0:S.unstable_sxConfig},I.unstable_sx=function(V){return Hf({sx:V,theme:this})},I}function rA(i){const{variants:s,...c}=i,p={variants:s,style:KT(c),isProcessed:!0};return p.style===c||s&&s.forEach(_=>{typeof _.style!="function"&&(_.style=KT(_.style))}),p}const V5=nA();function qv(i){return i!=="ownerState"&&i!=="theme"&&i!=="sx"&&i!=="as"}function U5(i){return i?(s,c)=>c[i]:null}function $5(i,s,c){i.theme=W5(i.theme)?c:i.theme[s]||i.theme}function fy(i,s){const c=typeof s=="function"?s(i):s;if(Array.isArray(c))return c.flatMap(p=>fy(i,p));if(Array.isArray(c==null?void 0:c.variants)){let p;if(c.isProcessed)p=c.style;else{const{variants:_,...T}=c;p=T}return iA(i,c.variants,[p])}return c!=null&&c.isProcessed?c.style:c}function iA(i,s,c=[]){var _;let p;e:for(let T=0;T<s.length;T+=1){const S=s[T];if(typeof S.props=="function"){if(p??(p={...i,...i.ownerState,ownerState:i.ownerState}),!S.props(p))continue}else for(const k in S.props)if(i[k]!==S.props[k]&&((_=i.ownerState)==null?void 0:_[k])!==S.props[k])continue e;typeof S.style=="function"?(p??(p={...i,...i.ownerState,ownerState:i.ownerState}),c.push(S.style(p))):c.push(S.style)}return c}function G5(i={}){const{themeId:s,defaultTheme:c=V5,rootShouldForwardProp:p=qv,slotShouldForwardProp:_=qv}=i;function T(k){$5(k,s,c)}return(k,o={})=>{O5(k,de=>de.filter(_e=>_e!==Hf));const{name:I,slot:O,skipVariantsResolver:V,skipSx:q,overridesResolver:ee=U5(H5(O)),...H}=o,j=V!==void 0?V:O&&O!=="Root"&&O!=="root"||!1,Z=q||!1;let ne=qv;O==="Root"||O==="root"?ne=p:O?ne=_:Z5(k)&&(ne=void 0);const xe=z5(k,{shouldForwardProp:ne,label:q5(),...H}),ce=de=>{if(typeof de=="function"&&de.__emotion_real!==de)return function(Se){return fy(Se,de)};if(du(de)){const _e=rA(de);return _e.variants?function($e){return fy($e,_e)}:_e.style}return de},me=(...de)=>{const _e=[],Se=de.map(ce),$e=[];if(_e.push(T),I&&ee&&$e.push(function(Lt){var ln,fn;const zt=(fn=(ln=Lt.theme.components)==null?void 0:ln[I])==null?void 0:fn.styleOverrides;if(!zt)return null;const $n={};for(const gt in zt)$n[gt]=fy(Lt,zt[gt]);return ee(Lt,$n)}),I&&!j&&$e.push(function(Lt){var $n,ln;const lt=Lt.theme,zt=(ln=($n=lt==null?void 0:lt.components)==null?void 0:$n[I])==null?void 0:ln.variants;return zt?iA(Lt,zt):null}),Z||$e.push(Hf),Array.isArray(Se[0])){const pt=Se.shift(),Lt=new Array(_e.length).fill(""),lt=new Array($e.length).fill("");let zt;zt=[...Lt,...pt,...lt],zt.raw=[...Lt,...pt.raw,...lt],_e.unshift(zt)}const dt=[..._e,...Se,...$e],Y=xe(...dt);return k.muiName&&(Y.muiName=k.muiName),Y};return xe.withConfig&&(me.withConfig=xe.withConfig),me}}function q5(i,s){return void 0}function W5(i){for(const s in i)return!1;return!0}function Z5(i){return typeof i=="string"&&i.charCodeAt(0)>96}function H5(i){return i&&i.charAt(0).toLowerCase()+i.slice(1)}const X5=Ee.createContext(void 0);function K5(i){const{theme:s,name:c,props:p}=i;if(!s||!s.components||!s.components[c])return p;const _=s.components[c];return _.defaultProps?S0(_.defaultProps,p):!_.styleOverrides&&!_.variants?S0(_,p):p}function Y5({props:i,name:s}){const c=Ee.useContext(X5);return K5({props:i,name:s,theme:{components:c}})}const YT={theme:void 0};function J5(i){let s,c;return function(_){let T=s;return(T===void 0||_.theme!==c)&&(YT.theme=_.theme,T=rA(i(YT)),s=T,c=_.theme),T}}function Q5(i=""){function s(...p){if(!p.length)return"";const _=p[0];return typeof _=="string"&&!_.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${i?`${i}-`:""}${_}${s(...p.slice(1))})`:`, ${_}`}return(p,..._)=>`var(--${i?`${i}-`:""}${p}${s(..._)})`}const JT=(i,s,c,p=[])=>{let _=i;s.forEach((T,S)=>{S===s.length-1?Array.isArray(_)?_[Number(T)]=c:_&&typeof _=="object"&&(_[T]=c):_&&typeof _=="object"&&(_[T]||(_[T]=p.includes(T)?[]:{}),_=_[T])})},eF=(i,s,c)=>{function p(_,T=[],S=[]){Object.entries(_).forEach(([k,o])=>{(!c||c&&!c([...T,k]))&&o!=null&&(typeof o=="object"&&Object.keys(o).length>0?p(o,[...T,k],Array.isArray(o)?[...S,k]:S):s([...T,k],o,S))})}p(i)},tF=(i,s)=>typeof s=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(p=>i.includes(p))||i[i.length-1].toLowerCase().includes("opacity")?s:`${s}px`:s;function Wv(i,s){const{prefix:c,shouldSkipGeneratingVar:p}=s||{},_={},T={},S={};return eF(i,(k,o,I)=>{if((typeof o=="string"||typeof o=="number")&&(!p||!p(k,o))){const O=`--${c?`${c}-`:""}${k.join("-")}`,V=tF(k,o);Object.assign(_,{[O]:V}),JT(T,k,`var(${O})`,I),JT(S,k,`var(${O}, ${V})`,I)}},k=>k[0]==="vars"),{css:_,vars:T,varsWithDefaults:S}}function nF(i,s={}){const{getSelector:c=Z,disableCssColorScheme:p,colorSchemeSelector:_}=s,{colorSchemes:T={},components:S,defaultColorScheme:k="light",...o}=i,{vars:I,css:O,varsWithDefaults:V}=Wv(o,s);let q=V;const ee={},{[k]:H,...j}=T;if(Object.entries(j||{}).forEach(([ce,me])=>{const{vars:de,css:_e,varsWithDefaults:Se}=Wv(me,s);q=oa(q,Se),ee[ce]={css:_e,vars:de}}),H){const{css:ce,vars:me,varsWithDefaults:de}=Wv(H,s);q=oa(q,de),ee[k]={css:ce,vars:me}}function Z(ce,me){var _e,Se;let de=_;if(_==="class"&&(de=".%s"),_==="data"&&(de="[data-%s]"),_!=null&&_.startsWith("data-")&&!_.includes("%s")&&(de=`[${_}="%s"]`),ce){if(de==="media")return i.defaultColorScheme===ce?":root":{[`@media (prefers-color-scheme: ${((Se=(_e=T[ce])==null?void 0:_e.palette)==null?void 0:Se.mode)||ce})`]:{":root":me}};if(de)return i.defaultColorScheme===ce?`:root, ${de.replace("%s",String(ce))}`:de.replace("%s",String(ce))}return":root"}return{vars:q,generateThemeVars:()=>{let ce={...I};return Object.entries(ee).forEach(([,{vars:me}])=>{ce=oa(ce,me)}),ce},generateStyleSheets:()=>{var $e,dt;const ce=[],me=i.defaultColorScheme||"light";function de(Y,pt){Object.keys(pt).length&&ce.push(typeof Y=="string"?{[Y]:{...pt}}:Y)}de(c(void 0,{...O}),O);const{[me]:_e,...Se}=ee;if(_e){const{css:Y}=_e,pt=(dt=($e=T[me])==null?void 0:$e.palette)==null?void 0:dt.mode,Lt=!p&&pt?{colorScheme:pt,...Y}:{...Y};de(c(me,{...Lt}),Lt)}return Object.entries(Se).forEach(([Y,{css:pt}])=>{var zt,$n;const Lt=($n=(zt=T[Y])==null?void 0:zt.palette)==null?void 0:$n.mode,lt=!p&&Lt?{colorScheme:Lt,...pt}:{...pt};de(c(Y,{...lt}),lt)}),ce}}}function rF(i){return function(c){return i==="media"?`@media (prefers-color-scheme: ${c})`:i?i.startsWith("data-")&&!i.includes("%s")?`[${i}="${c}"] &`:i==="class"?`.${c} &`:i==="data"?`[data-${c}] &`:`${i.replace("%s",c)} &`:"&"}}const Dm={black:"#000",white:"#fff"},iF={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Lf={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Df={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},am={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},zf={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Of={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Bf={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function oA(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Dm.white,default:Dm.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const oF=oA();function sA(){return{text:{primary:Dm.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Dm.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const QT=sA();function eE(i,s,c,p){const _=p.light||p,T=p.dark||p*1.5;i[s]||(i.hasOwnProperty(c)?i[s]=i[c]:s==="light"?i.light=Pm(i.main,_):s==="dark"&&(i.dark=km(i.main,T)))}function sF(i="light"){return i==="dark"?{main:zf[200],light:zf[50],dark:zf[400]}:{main:zf[700],light:zf[400],dark:zf[800]}}function aF(i="light"){return i==="dark"?{main:Lf[200],light:Lf[50],dark:Lf[400]}:{main:Lf[500],light:Lf[300],dark:Lf[700]}}function lF(i="light"){return i==="dark"?{main:Df[500],light:Df[300],dark:Df[700]}:{main:Df[700],light:Df[400],dark:Df[800]}}function uF(i="light"){return i==="dark"?{main:Of[400],light:Of[300],dark:Of[700]}:{main:Of[700],light:Of[500],dark:Of[900]}}function cF(i="light"){return i==="dark"?{main:Bf[400],light:Bf[300],dark:Bf[700]}:{main:Bf[800],light:Bf[500],dark:Bf[900]}}function hF(i="light"){return i==="dark"?{main:am[400],light:am[300],dark:am[700]}:{main:"#ed6c02",light:am[500],dark:am[900]}}function Mx(i){const{mode:s="light",contrastThreshold:c=3,tonalOffset:p=.2,..._}=i,T=i.primary||sF(s),S=i.secondary||aF(s),k=i.error||lF(s),o=i.info||uF(s),I=i.success||cF(s),O=i.warning||hF(s);function V(j){return TO(j,QT.text.primary)>=c?QT.text.primary:oF.text.primary}const q=({color:j,name:Z,mainShade:ne=500,lightShade:xe=300,darkShade:ce=700})=>{if(j={...j},!j.main&&j[ne]&&(j.main=j[ne]),!j.hasOwnProperty("main"))throw new Error(kd(11,Z?` (${Z})`:"",ne));if(typeof j.main!="string")throw new Error(kd(12,Z?` (${Z})`:"",JSON.stringify(j.main)));return eE(j,"light",xe,p),eE(j,"dark",ce,p),j.contrastText||(j.contrastText=V(j.main)),j};let ee;return s==="light"?ee=oA():s==="dark"&&(ee=sA()),oa({common:{...Dm},mode:s,primary:q({color:T,name:"primary"}),secondary:q({color:S,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:q({color:k,name:"error"}),warning:q({color:O,name:"warning"}),info:q({color:o,name:"info"}),success:q({color:I,name:"success"}),grey:iF,contrastThreshold:c,getContrastText:V,augmentColor:q,tonalOffset:p,...ee},_)}function dF(i){const s={};return Object.entries(i).forEach(p=>{const[_,T]=p;typeof T=="object"&&(s[_]=`${T.fontStyle?`${T.fontStyle} `:""}${T.fontVariant?`${T.fontVariant} `:""}${T.fontWeight?`${T.fontWeight} `:""}${T.fontStretch?`${T.fontStretch} `:""}${T.fontSize||""}${T.lineHeight?`/${T.lineHeight} `:""}${T.fontFamily||""}`)}),s}function fF(i,s){return{toolbar:{minHeight:56,[i.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[i.up("sm")]:{minHeight:64}},...s}}function pF(i){return Math.round(i*1e5)/1e5}const tE={textTransform:"uppercase"},nE='"Roboto", "Helvetica", "Arial", sans-serif';function mF(i,s){const{fontFamily:c=nE,fontSize:p=14,fontWeightLight:_=300,fontWeightRegular:T=400,fontWeightMedium:S=500,fontWeightBold:k=700,htmlFontSize:o=16,allVariants:I,pxToRem:O,...V}=typeof s=="function"?s(i):s,q=p/14,ee=O||(Z=>`${Z/o*q}rem`),H=(Z,ne,xe,ce,me)=>({fontFamily:c,fontWeight:Z,fontSize:ee(ne),lineHeight:xe,...c===nE?{letterSpacing:`${pF(ce/ne)}em`}:{},...me,...I}),j={h1:H(_,96,1.167,-1.5),h2:H(_,60,1.2,-.5),h3:H(T,48,1.167,0),h4:H(T,34,1.235,.25),h5:H(T,24,1.334,0),h6:H(S,20,1.6,.15),subtitle1:H(T,16,1.75,.15),subtitle2:H(S,14,1.57,.1),body1:H(T,16,1.5,.15),body2:H(T,14,1.43,.15),button:H(S,14,1.75,.4,tE),caption:H(T,12,1.66,.4),overline:H(T,12,2.66,1,tE),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return oa({htmlFontSize:o,pxToRem:ee,fontFamily:c,fontSize:p,fontWeightLight:_,fontWeightRegular:T,fontWeightMedium:S,fontWeightBold:k,...j},V,{clone:!1})}const gF=.2,yF=.14,_F=.12;function li(...i){return[`${i[0]}px ${i[1]}px ${i[2]}px ${i[3]}px rgba(0,0,0,${gF})`,`${i[4]}px ${i[5]}px ${i[6]}px ${i[7]}px rgba(0,0,0,${yF})`,`${i[8]}px ${i[9]}px ${i[10]}px ${i[11]}px rgba(0,0,0,${_F})`].join(",")}const vF=["none",li(0,2,1,-1,0,1,1,0,0,1,3,0),li(0,3,1,-2,0,2,2,0,0,1,5,0),li(0,3,3,-2,0,3,4,0,0,1,8,0),li(0,2,4,-1,0,4,5,0,0,1,10,0),li(0,3,5,-1,0,5,8,0,0,1,14,0),li(0,3,5,-1,0,6,10,0,0,1,18,0),li(0,4,5,-2,0,7,10,1,0,2,16,1),li(0,5,5,-3,0,8,10,1,0,3,14,2),li(0,5,6,-3,0,9,12,1,0,3,16,2),li(0,6,6,-3,0,10,14,1,0,4,18,3),li(0,6,7,-4,0,11,15,1,0,4,20,3),li(0,7,8,-4,0,12,17,2,0,5,22,4),li(0,7,8,-4,0,13,19,2,0,5,24,4),li(0,7,9,-4,0,14,21,2,0,5,26,4),li(0,8,9,-5,0,15,22,2,0,6,28,5),li(0,8,10,-5,0,16,24,2,0,6,30,5),li(0,8,11,-5,0,17,26,2,0,6,32,5),li(0,9,11,-5,0,18,28,2,0,7,34,6),li(0,9,12,-6,0,19,29,2,0,7,36,6),li(0,10,13,-6,0,20,31,3,0,8,38,7),li(0,10,13,-6,0,21,33,3,0,8,40,7),li(0,10,14,-6,0,22,35,3,0,8,42,7),li(0,11,14,-7,0,23,36,3,0,9,44,8),li(0,11,15,-7,0,24,38,3,0,9,46,8)],xF={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},wF={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function rE(i){return`${Math.round(i)}ms`}function bF(i){if(!i)return 0;const s=i/36;return Math.min(Math.round((4+15*s**.25+s/5)*10),3e3)}function TF(i){const s={...xF,...i.easing},c={...wF,...i.duration};return{getAutoHeightDuration:bF,create:(_=["all"],T={})=>{const{duration:S=c.standard,easing:k=s.easeInOut,delay:o=0,...I}=T;return(Array.isArray(_)?_:[_]).map(O=>`${O} ${typeof S=="string"?S:rE(S)} ${k} ${typeof o=="string"?o:rE(o)}`).join(",")},...i,easing:s,duration:c}}const EF={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function SF(i){return du(i)||typeof i>"u"||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||Array.isArray(i)}function aA(i={}){const s={...i};function c(p){const _=Object.entries(p);for(let T=0;T<_.length;T++){const[S,k]=_[T];!SF(k)||S.startsWith("unstable_")?delete p[S]:du(k)&&(p[S]={...k},c(p[S]))}}return c(s),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(s,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function P0(i={},...s){const{breakpoints:c,mixins:p={},spacing:_,palette:T={},transitions:S={},typography:k={},shape:o,...I}=i;if(i.vars&&i.generateThemeVars===void 0)throw new Error(kd(20));const O=Mx(T),V=nA(i);let q=oa(V,{mixins:fF(V.breakpoints,p),palette:O,shadows:vF.slice(),typography:mF(O,k),transitions:TF(S),zIndex:{...EF}});return q=oa(q,I),q=s.reduce((ee,H)=>oa(ee,H),q),q.unstable_sxConfig={...Wm,...I==null?void 0:I.unstable_sxConfig},q.unstable_sx=function(H){return Hf({sx:H,theme:this})},q.toRuntimeSource=aA,q}function CF(i){let s;return i<1?s=5.11916*i**2:s=4.5*Math.log(i+1)+2,Math.round(s*10)/1e3}const AF=[...Array(25)].map((i,s)=>{if(s===0)return"none";const c=CF(s);return`linear-gradient(rgba(255 255 255 / ${c}), rgba(255 255 255 / ${c}))`});function lA(i){return{inputPlaceholder:i==="dark"?.5:.42,inputUnderline:i==="dark"?.7:.42,switchTrackDisabled:i==="dark"?.2:.12,switchTrack:i==="dark"?.3:.38}}function uA(i){return i==="dark"?AF:[]}function MF(i){const{palette:s={mode:"light"},opacity:c,overlays:p,..._}=i,T=Mx(s);return{palette:T,opacity:{...lA(T.mode),...c},overlays:p||uA(T.mode),..._}}function kF(i){var s;return!!i[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!i[0].match(/sxConfig$/)||i[0]==="palette"&&!!((s=i[1])!=null&&s.match(/(mode|contrastThreshold|tonalOffset)/))}const PF=i=>[...[...Array(25)].map((s,c)=>`--${i?`${i}-`:""}overlays-${c}`),`--${i?`${i}-`:""}palette-AppBar-darkBg`,`--${i?`${i}-`:""}palette-AppBar-darkColor`],IF=i=>(s,c)=>{const p=i.rootSelector||":root",_=i.colorSchemeSelector;let T=_;if(_==="class"&&(T=".%s"),_==="data"&&(T="[data-%s]"),_!=null&&_.startsWith("data-")&&!_.includes("%s")&&(T=`[${_}="%s"]`),i.defaultColorScheme===s){if(s==="dark"){const S={};return PF(i.cssVarPrefix).forEach(k=>{S[k]=c[k],delete c[k]}),T==="media"?{[p]:c,"@media (prefers-color-scheme: dark)":{[p]:S}}:T?{[T.replace("%s",s)]:S,[`${p}, ${T.replace("%s",s)}`]:c}:{[p]:{...c,...S}}}if(T&&T!=="media")return`${p}, ${T.replace("%s",String(s))}`}else if(s){if(T==="media")return{[`@media (prefers-color-scheme: ${String(s)})`]:{[p]:c}};if(T)return T.replace("%s",String(s))}return p};function RF(i,s){s.forEach(c=>{i[c]||(i[c]={})})}function ft(i,s,c){!i[s]&&c&&(i[s]=c)}function dm(i){return typeof i!="string"||!i.startsWith("hsl")?i:zC(i)}function ac(i,s){`${s}Channel`in i||(i[`${s}Channel`]=hm(dm(i[s])))}function LF(i){return typeof i=="number"?`${i}px`:typeof i=="string"||typeof i=="function"||Array.isArray(i)?i:"8px"}const uu=i=>{try{return i()}catch{}},DF=(i="mui")=>Q5(i);function Zv(i,s,c,p){if(!s)return;s=s===!0?{}:s;const _=p==="dark"?"dark":"light";if(!c){i[p]=MF({...s,palette:{mode:_,...s==null?void 0:s.palette}});return}const{palette:T,...S}=P0({...c,palette:{mode:_,...s==null?void 0:s.palette}});return i[p]={...s,palette:T,opacity:{...lA(_),...s==null?void 0:s.opacity},overlays:(s==null?void 0:s.overlays)||uA(_)},S}function zF(i={},...s){const{colorSchemes:c={light:!0},defaultColorScheme:p,disableCssColorScheme:_=!1,cssVarPrefix:T="mui",shouldSkipGeneratingVar:S=kF,colorSchemeSelector:k=c.light&&c.dark?"media":void 0,rootSelector:o=":root",...I}=i,O=Object.keys(c)[0],V=p||(c.light&&O!=="light"?"light":O),q=DF(T),{[V]:ee,light:H,dark:j,...Z}=c,ne={...Z};let xe=ee;if((V==="dark"&&!("dark"in c)||V==="light"&&!("light"in c))&&(xe=!0),!xe)throw new Error(kd(21,V));const ce=Zv(ne,xe,I,V);H&&!ne.light&&Zv(ne,H,void 0,"light"),j&&!ne.dark&&Zv(ne,j,void 0,"dark");let me={defaultColorScheme:V,...ce,cssVarPrefix:T,colorSchemeSelector:k,rootSelector:o,getCssVar:q,colorSchemes:ne,font:{...dF(ce.typography),...ce.font},spacing:LF(I.spacing)};Object.keys(me.colorSchemes).forEach(dt=>{const Y=me.colorSchemes[dt].palette,pt=Lt=>{const lt=Lt.split("-"),zt=lt[1],$n=lt[2];return q(Lt,Y[zt][$n])};if(Y.mode==="light"&&(ft(Y.common,"background","#fff"),ft(Y.common,"onBackground","#000")),Y.mode==="dark"&&(ft(Y.common,"background","#000"),ft(Y.common,"onBackground","#fff")),RF(Y,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),Y.mode==="light"){ft(Y.Alert,"errorColor",Gr(Y.error.light,.6)),ft(Y.Alert,"infoColor",Gr(Y.info.light,.6)),ft(Y.Alert,"successColor",Gr(Y.success.light,.6)),ft(Y.Alert,"warningColor",Gr(Y.warning.light,.6)),ft(Y.Alert,"errorFilledBg",pt("palette-error-main")),ft(Y.Alert,"infoFilledBg",pt("palette-info-main")),ft(Y.Alert,"successFilledBg",pt("palette-success-main")),ft(Y.Alert,"warningFilledBg",pt("palette-warning-main")),ft(Y.Alert,"errorFilledColor",uu(()=>Y.getContrastText(Y.error.main))),ft(Y.Alert,"infoFilledColor",uu(()=>Y.getContrastText(Y.info.main))),ft(Y.Alert,"successFilledColor",uu(()=>Y.getContrastText(Y.success.main))),ft(Y.Alert,"warningFilledColor",uu(()=>Y.getContrastText(Y.warning.main))),ft(Y.Alert,"errorStandardBg",qr(Y.error.light,.9)),ft(Y.Alert,"infoStandardBg",qr(Y.info.light,.9)),ft(Y.Alert,"successStandardBg",qr(Y.success.light,.9)),ft(Y.Alert,"warningStandardBg",qr(Y.warning.light,.9)),ft(Y.Alert,"errorIconColor",pt("palette-error-main")),ft(Y.Alert,"infoIconColor",pt("palette-info-main")),ft(Y.Alert,"successIconColor",pt("palette-success-main")),ft(Y.Alert,"warningIconColor",pt("palette-warning-main")),ft(Y.AppBar,"defaultBg",pt("palette-grey-100")),ft(Y.Avatar,"defaultBg",pt("palette-grey-400")),ft(Y.Button,"inheritContainedBg",pt("palette-grey-300")),ft(Y.Button,"inheritContainedHoverBg",pt("palette-grey-A100")),ft(Y.Chip,"defaultBorder",pt("palette-grey-400")),ft(Y.Chip,"defaultAvatarColor",pt("palette-grey-700")),ft(Y.Chip,"defaultIconColor",pt("palette-grey-700")),ft(Y.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),ft(Y.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),ft(Y.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),ft(Y.LinearProgress,"primaryBg",qr(Y.primary.main,.62)),ft(Y.LinearProgress,"secondaryBg",qr(Y.secondary.main,.62)),ft(Y.LinearProgress,"errorBg",qr(Y.error.main,.62)),ft(Y.LinearProgress,"infoBg",qr(Y.info.main,.62)),ft(Y.LinearProgress,"successBg",qr(Y.success.main,.62)),ft(Y.LinearProgress,"warningBg",qr(Y.warning.main,.62)),ft(Y.Skeleton,"bg",`rgba(${pt("palette-text-primaryChannel")} / 0.11)`),ft(Y.Slider,"primaryTrack",qr(Y.primary.main,.62)),ft(Y.Slider,"secondaryTrack",qr(Y.secondary.main,.62)),ft(Y.Slider,"errorTrack",qr(Y.error.main,.62)),ft(Y.Slider,"infoTrack",qr(Y.info.main,.62)),ft(Y.Slider,"successTrack",qr(Y.success.main,.62)),ft(Y.Slider,"warningTrack",qr(Y.warning.main,.62));const Lt=qg(Y.background.default,.8);ft(Y.SnackbarContent,"bg",Lt),ft(Y.SnackbarContent,"color",uu(()=>Y.getContrastText(Lt))),ft(Y.SpeedDialAction,"fabHoverBg",qg(Y.background.paper,.15)),ft(Y.StepConnector,"border",pt("palette-grey-400")),ft(Y.StepContent,"border",pt("palette-grey-400")),ft(Y.Switch,"defaultColor",pt("palette-common-white")),ft(Y.Switch,"defaultDisabledColor",pt("palette-grey-100")),ft(Y.Switch,"primaryDisabledColor",qr(Y.primary.main,.62)),ft(Y.Switch,"secondaryDisabledColor",qr(Y.secondary.main,.62)),ft(Y.Switch,"errorDisabledColor",qr(Y.error.main,.62)),ft(Y.Switch,"infoDisabledColor",qr(Y.info.main,.62)),ft(Y.Switch,"successDisabledColor",qr(Y.success.main,.62)),ft(Y.Switch,"warningDisabledColor",qr(Y.warning.main,.62)),ft(Y.TableCell,"border",qr(Gg(Y.divider,1),.88)),ft(Y.Tooltip,"bg",Gg(Y.grey[700],.92))}if(Y.mode==="dark"){ft(Y.Alert,"errorColor",qr(Y.error.light,.6)),ft(Y.Alert,"infoColor",qr(Y.info.light,.6)),ft(Y.Alert,"successColor",qr(Y.success.light,.6)),ft(Y.Alert,"warningColor",qr(Y.warning.light,.6)),ft(Y.Alert,"errorFilledBg",pt("palette-error-dark")),ft(Y.Alert,"infoFilledBg",pt("palette-info-dark")),ft(Y.Alert,"successFilledBg",pt("palette-success-dark")),ft(Y.Alert,"warningFilledBg",pt("palette-warning-dark")),ft(Y.Alert,"errorFilledColor",uu(()=>Y.getContrastText(Y.error.dark))),ft(Y.Alert,"infoFilledColor",uu(()=>Y.getContrastText(Y.info.dark))),ft(Y.Alert,"successFilledColor",uu(()=>Y.getContrastText(Y.success.dark))),ft(Y.Alert,"warningFilledColor",uu(()=>Y.getContrastText(Y.warning.dark))),ft(Y.Alert,"errorStandardBg",Gr(Y.error.light,.9)),ft(Y.Alert,"infoStandardBg",Gr(Y.info.light,.9)),ft(Y.Alert,"successStandardBg",Gr(Y.success.light,.9)),ft(Y.Alert,"warningStandardBg",Gr(Y.warning.light,.9)),ft(Y.Alert,"errorIconColor",pt("palette-error-main")),ft(Y.Alert,"infoIconColor",pt("palette-info-main")),ft(Y.Alert,"successIconColor",pt("palette-success-main")),ft(Y.Alert,"warningIconColor",pt("palette-warning-main")),ft(Y.AppBar,"defaultBg",pt("palette-grey-900")),ft(Y.AppBar,"darkBg",pt("palette-background-paper")),ft(Y.AppBar,"darkColor",pt("palette-text-primary")),ft(Y.Avatar,"defaultBg",pt("palette-grey-600")),ft(Y.Button,"inheritContainedBg",pt("palette-grey-800")),ft(Y.Button,"inheritContainedHoverBg",pt("palette-grey-700")),ft(Y.Chip,"defaultBorder",pt("palette-grey-700")),ft(Y.Chip,"defaultAvatarColor",pt("palette-grey-300")),ft(Y.Chip,"defaultIconColor",pt("palette-grey-300")),ft(Y.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),ft(Y.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),ft(Y.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),ft(Y.LinearProgress,"primaryBg",Gr(Y.primary.main,.5)),ft(Y.LinearProgress,"secondaryBg",Gr(Y.secondary.main,.5)),ft(Y.LinearProgress,"errorBg",Gr(Y.error.main,.5)),ft(Y.LinearProgress,"infoBg",Gr(Y.info.main,.5)),ft(Y.LinearProgress,"successBg",Gr(Y.success.main,.5)),ft(Y.LinearProgress,"warningBg",Gr(Y.warning.main,.5)),ft(Y.Skeleton,"bg",`rgba(${pt("palette-text-primaryChannel")} / 0.13)`),ft(Y.Slider,"primaryTrack",Gr(Y.primary.main,.5)),ft(Y.Slider,"secondaryTrack",Gr(Y.secondary.main,.5)),ft(Y.Slider,"errorTrack",Gr(Y.error.main,.5)),ft(Y.Slider,"infoTrack",Gr(Y.info.main,.5)),ft(Y.Slider,"successTrack",Gr(Y.success.main,.5)),ft(Y.Slider,"warningTrack",Gr(Y.warning.main,.5));const Lt=qg(Y.background.default,.98);ft(Y.SnackbarContent,"bg",Lt),ft(Y.SnackbarContent,"color",uu(()=>Y.getContrastText(Lt))),ft(Y.SpeedDialAction,"fabHoverBg",qg(Y.background.paper,.15)),ft(Y.StepConnector,"border",pt("palette-grey-600")),ft(Y.StepContent,"border",pt("palette-grey-600")),ft(Y.Switch,"defaultColor",pt("palette-grey-300")),ft(Y.Switch,"defaultDisabledColor",pt("palette-grey-600")),ft(Y.Switch,"primaryDisabledColor",Gr(Y.primary.main,.55)),ft(Y.Switch,"secondaryDisabledColor",Gr(Y.secondary.main,.55)),ft(Y.Switch,"errorDisabledColor",Gr(Y.error.main,.55)),ft(Y.Switch,"infoDisabledColor",Gr(Y.info.main,.55)),ft(Y.Switch,"successDisabledColor",Gr(Y.success.main,.55)),ft(Y.Switch,"warningDisabledColor",Gr(Y.warning.main,.55)),ft(Y.TableCell,"border",Gr(Gg(Y.divider,1),.68)),ft(Y.Tooltip,"bg",Gg(Y.grey[700],.92))}ac(Y.background,"default"),ac(Y.background,"paper"),ac(Y.common,"background"),ac(Y.common,"onBackground"),ac(Y,"divider"),Object.keys(Y).forEach(Lt=>{const lt=Y[Lt];Lt!=="tonalOffset"&&lt&&typeof lt=="object"&&(lt.main&&ft(Y[Lt],"mainChannel",hm(dm(lt.main))),lt.light&&ft(Y[Lt],"lightChannel",hm(dm(lt.light))),lt.dark&&ft(Y[Lt],"darkChannel",hm(dm(lt.dark))),lt.contrastText&&ft(Y[Lt],"contrastTextChannel",hm(dm(lt.contrastText))),Lt==="text"&&(ac(Y[Lt],"primary"),ac(Y[Lt],"secondary")),Lt==="action"&&(lt.active&&ac(Y[Lt],"active"),lt.selected&&ac(Y[Lt],"selected")))})}),me=s.reduce((dt,Y)=>oa(dt,Y),me);const de={prefix:T,disableCssColorScheme:_,shouldSkipGeneratingVar:S,getSelector:IF(me)},{vars:_e,generateThemeVars:Se,generateStyleSheets:$e}=nF(me,de);return me.vars=_e,Object.entries(me.colorSchemes[me.defaultColorScheme]).forEach(([dt,Y])=>{me[dt]=Y}),me.generateThemeVars=Se,me.generateStyleSheets=$e,me.generateSpacing=function(){return tA(I.spacing,Tx(this))},me.getColorSchemeSelector=rF(k),me.spacing=me.generateSpacing(),me.shouldSkipGeneratingVar=S,me.unstable_sxConfig={...Wm,...I==null?void 0:I.unstable_sxConfig},me.unstable_sx=function(Y){return Hf({sx:Y,theme:this})},me.toRuntimeSource=aA,me}function iE(i,s,c){i.colorSchemes&&c&&(i.colorSchemes[s]={...c!==!0&&c,palette:Mx({...c===!0?{}:c.palette,mode:s})})}function OF(i={},...s){const{palette:c,cssVariables:p=!1,colorSchemes:_=c?void 0:{light:!0},defaultColorScheme:T=c==null?void 0:c.mode,...S}=i,k=T||"light",o=_==null?void 0:_[k],I={..._,...c?{[k]:{...typeof o!="boolean"&&o,palette:c}}:void 0};if(p===!1){if(!("colorSchemes"in i))return P0(i,...s);let O=c;"palette"in i||I[k]&&(I[k]!==!0?O=I[k].palette:k==="dark"&&(O={mode:"dark"}));const V=P0({...i,palette:O},...s);return V.defaultColorScheme=k,V.colorSchemes=I,V.palette.mode==="light"&&(V.colorSchemes.light={...I.light!==!0&&I.light,palette:V.palette},iE(V,"dark",I.dark)),V.palette.mode==="dark"&&(V.colorSchemes.dark={...I.dark!==!0&&I.dark,palette:V.palette},iE(V,"light",I.light)),V}return!c&&!("light"in I)&&k==="light"&&(I.light=!0),zF({...S,colorSchemes:I,defaultColorScheme:k,...typeof p!="boolean"&&p},...s)}const BF=OF(),FF="$$material";function kx(i){return i!=="ownerState"&&i!=="theme"&&i!=="sx"&&i!=="as"}const NF=i=>kx(i)&&i!=="classes",ph=G5({themeId:FF,defaultTheme:BF,rootShouldForwardProp:NF});function jF(){return NB}const Pd=J5;function cA(i){return Y5(i)}const VF=i=>!i||!uy(i);function UF(i){return typeof i.main=="string"}function $F(i,s=[]){if(!UF(i))return!1;for(const c of s)if(!i.hasOwnProperty(c)||typeof i[c]!="string")return!1;return!0}function Qy(i=[]){return([,s])=>s&&$F(s,i)}function GF(i){return xx("MuiSlider",i)}const Oa=jC("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),qF=i=>{const{open:s}=i;return{offset:cc(s&&Oa.valueLabelOpen),circle:Oa.valueLabelCircle,label:Oa.valueLabelLabel}};function WF(i){const{children:s,className:c,value:p}=i,_=qF(i);return s?Ee.cloneElement(s,{className:cc(s.props.className)},Be.jsxs(Ee.Fragment,{children:[s.props.children,Be.jsx("span",{className:cc(_.offset,c),"aria-hidden":!0,children:Be.jsx("span",{className:_.circle,children:Be.jsx("span",{className:_.label,children:p})})})]})):null}function oE(i){return i}const ZF=ph("span",{name:"MuiSlider",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:c}=i;return[s.root,s[`color${ia(c.color)}`],c.size!=="medium"&&s[`size${ia(c.size)}`],c.marked&&s.marked,c.orientation==="vertical"&&s.vertical,c.track==="inverted"&&s.trackInverted,c.track===!1&&s.trackFalse]}})(Pd(({theme:i})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${Oa.disabled}`]:{pointerEvents:"none",cursor:"default",color:(i.vars||i).palette.grey[400]},[`&.${Oa.dragging}`]:{[`& .${Oa.thumb}, & .${Oa.track}`]:{transition:"none"}},variants:[...Object.entries(i.palette).filter(Qy()).map(([s])=>({props:{color:s},style:{color:(i.vars||i).palette[s].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),HF=ph("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(i,s)=>s.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),XF=ph("span",{name:"MuiSlider",slot:"Track",overridesResolver:(i,s)=>s.track})(Pd(({theme:i})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:i.transitions.create(["left","width","bottom","height"],{duration:i.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(i.palette).filter(Qy()).map(([s])=>({props:{color:s,track:"inverted"},style:{...i.vars?{backgroundColor:i.vars.palette.Slider[`${s}Track`],borderColor:i.vars.palette.Slider[`${s}Track`]}:{backgroundColor:Pm(i.palette[s].main,.62),borderColor:Pm(i.palette[s].main,.62),...i.applyStyles("dark",{backgroundColor:km(i.palette[s].main,.5)}),...i.applyStyles("dark",{borderColor:km(i.palette[s].main,.5)})}}}))]}))),KF=ph("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(i,s)=>{const{ownerState:c}=i;return[s.thumb,s[`thumbColor${ia(c.color)}`],c.size!=="medium"&&s[`thumbSize${ia(c.size)}`]]}})(Pd(({theme:i})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:i.transitions.create(["box-shadow","left","bottom"],{duration:i.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(i.vars||i).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${Oa.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(i.palette).filter(Qy()).map(([s])=>({props:{color:s},style:{[`&:hover, &.${Oa.focusVisible}`]:{...i.vars?{boxShadow:`0px 0px 0px 8px rgba(${i.vars.palette[s].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${E0(i.palette[s].main,.16)}`},"@media (hover: none)":{boxShadow:"none"}},[`&.${Oa.active}`]:{...i.vars?{boxShadow:`0px 0px 0px 14px rgba(${i.vars.palette[s].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${E0(i.palette[s].main,.16)}`}}}}))]}))),YF=ph(WF,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(i,s)=>s.valueLabel})(Pd(({theme:i})=>({zIndex:1,whiteSpace:"nowrap",...i.typography.body2,fontWeight:500,transition:i.transitions.create(["transform"],{duration:i.transitions.duration.shortest}),position:"absolute",backgroundColor:(i.vars||i).palette.grey[600],borderRadius:2,color:(i.vars||i).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${Oa.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${Oa.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:i.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),JF=ph("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:i=>kx(i)&&i!=="markActive",overridesResolver:(i,s)=>{const{markActive:c}=i;return[s.mark,c&&s.markActive]}})(Pd(({theme:i})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(i.vars||i).palette.background.paper,opacity:.8}}]}))),QF=ph("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:i=>kx(i)&&i!=="markLabelActive",overridesResolver:(i,s)=>s.markLabel})(Pd(({theme:i})=>({...i.typography.body2,color:(i.vars||i).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(i.vars||i).palette.text.primary}}]}))),e4=i=>{const{disabled:s,dragging:c,marked:p,orientation:_,track:T,classes:S,color:k,size:o}=i,I={root:["root",s&&"disabled",c&&"dragging",p&&"marked",_==="vertical"&&"vertical",T==="inverted"&&"trackInverted",T===!1&&"trackFalse",k&&`color${ia(k)}`,o&&`size${ia(o)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",s&&"disabled",o&&`thumbSize${ia(o)}`,k&&`thumbColor${ia(k)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return DC(I,GF,S)},t4=({children:i})=>i,Hv=Ee.forwardRef(function(s,c){const p=cA({props:s,name:"MuiSlider"}),_=CO(),{"aria-label":T,"aria-valuetext":S,"aria-labelledby":k,component:o="span",components:I={},componentsProps:O={},color:V="primary",classes:q,className:ee,disableSwap:H=!1,disabled:j=!1,getAriaLabel:Z,getAriaValueText:ne,marks:xe=!1,max:ce=100,min:me=0,name:de,onChange:_e,onChangeCommitted:Se,orientation:$e="horizontal",shiftStep:dt=10,size:Y="medium",step:pt=1,scale:Lt=oE,slotProps:lt,slots:zt,tabIndex:$n,track:ln="normal",value:fn,valueLabelDisplay:gt="off",valueLabelFormat:Et=oE,...Le}=p,te={...p,isRtl:_,max:ce,min:me,classes:q,disabled:j,disableSwap:H,orientation:$e,marks:xe,color:V,size:Y,step:pt,shiftStep:dt,scale:Lt,track:ln,valueLabelDisplay:gt,valueLabelFormat:Et},{axisProps:Ue,getRootProps:Pt,getHiddenInputProps:kt,getThumbProps:qt,open:Wt,active:St,axis:Ft,focusedThumbIndex:en,range:yn,dragging:Bn,marks:Xt,values:Fn,trackOffset:pn,trackLeap:Pr,getThumbStyle:Nn}=qO({...te,rootRef:c});te.marked=Xt.length>0&&Xt.some(Q=>Q.label),te.dragging=Bn,te.focusedThumbIndex=en;const jn=e4(te),Kr=(zt==null?void 0:zt.root)??I.Root??ZF,Dr=(zt==null?void 0:zt.rail)??I.Rail??HF,lr=(zt==null?void 0:zt.track)??I.Track??XF,Ii=(zt==null?void 0:zt.thumb)??I.Thumb??KF,Zi=(zt==null?void 0:zt.valueLabel)??I.ValueLabel??YF,Hi=(zt==null?void 0:zt.mark)??I.Mark??JF,Ri=(zt==null?void 0:zt.markLabel)??I.MarkLabel??QF,It=(zt==null?void 0:zt.input)??I.Input??"input",Ht=(lt==null?void 0:lt.root)??O.root,mn=(lt==null?void 0:lt.rail)??O.rail,xn=(lt==null?void 0:lt.track)??O.track,Wn=(lt==null?void 0:lt.thumb)??O.thumb,un=(lt==null?void 0:lt.valueLabel)??O.valueLabel,tr=(lt==null?void 0:lt.mark)??O.mark,zr=(lt==null?void 0:lt.markLabel)??O.markLabel,pr=(lt==null?void 0:lt.input)??O.input,Yr=ah({elementType:Kr,getSlotProps:Pt,externalSlotProps:Ht,externalForwardedProps:Le,additionalProps:{...VF(Kr)&&{as:o}},ownerState:{...te,...Ht==null?void 0:Ht.ownerState},className:[jn.root,ee]}),io=ah({elementType:Dr,externalSlotProps:mn,ownerState:te,className:jn.rail}),ts=ah({elementType:lr,externalSlotProps:xn,additionalProps:{style:{...Ue[Ft].offset(pn),...Ue[Ft].leap(Pr)}},ownerState:{...te,...xn==null?void 0:xn.ownerState},className:jn.track}),yo=ah({elementType:Ii,getSlotProps:qt,externalSlotProps:Wn,ownerState:{...te,...Wn==null?void 0:Wn.ownerState},className:jn.thumb}),gs=ah({elementType:Zi,externalSlotProps:un,ownerState:{...te,...un==null?void 0:un.ownerState},className:jn.valueLabel}),ys=ah({elementType:Hi,externalSlotProps:tr,ownerState:te,className:jn.mark}),we=ah({elementType:Ri,externalSlotProps:zr,ownerState:te,className:jn.markLabel}),J=ah({elementType:It,getSlotProps:kt,externalSlotProps:pr,ownerState:te});return Be.jsxs(Kr,{...Yr,children:[Be.jsx(Dr,{...io}),Be.jsx(lr,{...ts}),Xt.filter(Q=>Q.value>=me&&Q.value<=ce).map((Q,ye)=>{const Ae=by(Q.value,me,ce),De=Ue[Ft].offset(Ae);let Ve;return ln===!1?Ve=Fn.includes(Q.value):Ve=ln==="normal"&&(yn?Q.value>=Fn[0]&&Q.value<=Fn[Fn.length-1]:Q.value<=Fn[0])||ln==="inverted"&&(yn?Q.value<=Fn[0]||Q.value>=Fn[Fn.length-1]:Q.value>=Fn[0]),Be.jsxs(Ee.Fragment,{children:[Be.jsx(Hi,{"data-index":ye,...ys,...!uy(Hi)&&{markActive:Ve},style:{...De,...ys.style},className:cc(ys.className,Ve&&jn.markActive)}),Q.label!=null?Be.jsx(Ri,{"aria-hidden":!0,"data-index":ye,...we,...!uy(Ri)&&{markLabelActive:Ve},style:{...De,...we.style},className:cc(jn.markLabel,we.className,Ve&&jn.markLabelActive),children:Q.label}):null]},ye)}),Fn.map((Q,ye)=>{const Ae=by(Q,me,ce),De=Ue[Ft].offset(Ae),Ve=gt==="off"?t4:Zi;return Be.jsx(Ve,{...!uy(Ve)&&{valueLabelFormat:Et,valueLabelDisplay:gt,value:typeof Et=="function"?Et(Lt(Q),ye):Et,index:ye,open:Wt===ye||St===ye||gt==="on",disabled:j},...gs,children:Be.jsx(Ii,{"data-index":ye,...yo,className:cc(jn.thumb,yo.className,St===ye&&jn.active,en===ye&&jn.focusVisible),style:{...De,...Nn(ye),...yo.style},children:Be.jsx(It,{"data-index":ye,"aria-label":Z?Z(ye):T,"aria-valuenow":Lt(Q),"aria-labelledby":k,"aria-valuetext":ne?ne(Lt(Q),ye):S,value:Fn[ye],...J})})},ye)})]})});function n4(i){return xx("MuiTypography",i)}jC("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const r4={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},i4=jF(),o4=i=>{const{align:s,gutterBottom:c,noWrap:p,paragraph:_,variant:T,classes:S}=i,k={root:["root",T,i.align!=="inherit"&&`align${ia(s)}`,c&&"gutterBottom",p&&"noWrap",_&&"paragraph"]};return DC(k,n4,S)},s4=ph("span",{name:"MuiTypography",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:c}=i;return[s.root,c.variant&&s[c.variant],c.align!=="inherit"&&s[`align${ia(c.align)}`],c.noWrap&&s.noWrap,c.gutterBottom&&s.gutterBottom,c.paragraph&&s.paragraph]}})(Pd(({theme:i})=>{var s;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(i.typography).filter(([c,p])=>c!=="inherit"&&p&&typeof p=="object").map(([c,p])=>({props:{variant:c},style:p})),...Object.entries(i.palette).filter(Qy()).map(([c])=>({props:{color:c},style:{color:(i.vars||i).palette[c].main}})),...Object.entries(((s=i.palette)==null?void 0:s.text)||{}).filter(([,c])=>typeof c=="string").map(([c])=>({props:{color:`text${ia(c)}`},style:{color:(i.vars||i).palette.text[c]}})),{props:({ownerState:c})=>c.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:c})=>c.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:c})=>c.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:c})=>c.paragraph,style:{marginBottom:16}}]}})),sE={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Xv=Ee.forwardRef(function(s,c){const{color:p,..._}=cA({props:s,name:"MuiTypography"}),T=!r4[p],S=i4({..._,...T&&{color:p}}),{align:k="inherit",className:o,component:I,gutterBottom:O=!1,noWrap:V=!1,paragraph:q=!1,variant:ee="body1",variantMapping:H=sE,...j}=S,Z={...S,align:k,color:p,className:o,component:I,gutterBottom:O,noWrap:V,paragraph:q,variant:ee,variantMapping:H},ne=I||(q?"p":H[ee]||sE[ee])||"span",xe=o4(Z);return Be.jsx(s4,{as:ne,ref:c,className:cc(xe.root,o),...j,ownerState:Z,style:{...k!=="inherit"&&{"--Typography-textAlign":k},...j.style}})}),a4=()=>{const i=aa();return Be.jsx("button",{className:"back-arrow",onClick:()=>i(-1),children:"←"})},l4=()=>{const[i,s]=Ee.useState(5),[c,p]=Ee.useState([2,3]),[_,T]=Ee.useState([3,5]),[S,k]=Ee.useState([]),[o,I]=Ee.useState([]),[O,V]=Ee.useState(""),q=aa(),ee=Fa(),[H,j]=Ee.useState(null),[Z,ne]=Ee.useState("");Ee.useEffect(()=>{const _e=new URLSearchParams(ee.search),Se=_e.get("lat"),$e=_e.get("lng"),dt=_e.get("locationName");Se&&$e?(j({lat:parseFloat(Se),lng:parseFloat($e)}),ne(dt||"Unknown Location")):navigator.geolocation&&navigator.geolocation.getCurrentPosition(Y=>{const{latitude:pt,longitude:Lt}=Y.coords;j({lat:pt,lng:Lt}),xe(pt,Lt)})},[ee.search]);const xe=async(_e,Se)=>{var dt;const $e=`https://api.mapbox.com/geocoding/v5/mapbox.places/${Se},${_e}.json?access_token=pk.eyJ1IjoidmVyaWZpZWRmaW5uIiwiYSI6ImNtN21tdWQ2ZjBqcm8ycnIwNXFwN2Z4bGcifQ.BckuIZ-IAbwTNq6oaIunGg`;try{const Lt=((dt=(await(await fetch($e)).json()).features[0])==null?void 0:dt.place_name)||"Unknown Location";ne(Lt)}catch(Y){console.error("❌ Failed to reverse geocode:",Y)}},ce=()=>{q("/map")},me=(_e,Se)=>{_e($e=>$e.includes(Se)?$e.filter(dt=>dt!==Se):[...$e,Se])},de=()=>{const _e={distance:i,priceRange:c,ratingRange:_,dietaryRestrictions:S,cuisinePreferences:o,selectedLocation:H},Se=Math.random().toString(36).substring(2,8).toUpperCase();V(Se),q(`/waiting-room?code=${Se}`,{state:{preferences:_e,selectedLocation:H,filteredPOIs:[],isCreator:!0,creatorId:Se}})};return Be.jsxs("div",{className:"filter-page",style:{position:"relative",padding:"40px 30px 30px 30px"},children:[Be.jsx(a4,{}),Be.jsx("h1",{style:{textAlign:"center",marginBottom:"30px"},children:"SESSION PREFERENCES"}),Be.jsxs("div",{className:"location-section",children:[Be.jsx("button",{className:"choose-location-button",onClick:ce,children:"Choose on Map"}),H?Be.jsxs("p",{className:"selected-location",children:["📍 ",Z||`${H.lat}, ${H.lng}`]}):Be.jsx("p",{children:"📍 No location selected"})]}),O&&Be.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[Be.jsx("h3",{children:"Session Code"}),Be.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",letterSpacing:"2px"},children:O})]}),Be.jsxs("div",{className:"section",children:[Be.jsxs(Xv,{gutterBottom:!0,children:["Maximum Distance: ",i," km"]}),Be.jsx(Hv,{value:i,onChange:(_e,Se)=>s(Se),min:1,max:10,valueLabelDisplay:"auto",sx:{color:"#f37474"}})]}),Be.jsxs("div",{className:"section",children:[Be.jsxs(Xv,{gutterBottom:!0,children:["Price Range: ",["€","€€","€€€","€€€€","€€€€€"].slice(c[0]-1,c[1]).join(" - ")]}),Be.jsx(Hv,{value:c,onChange:(_e,Se)=>p(Se),valueLabelDisplay:"auto",step:1,min:1,max:5,sx:{color:"#f37474"}})]}),Be.jsxs("div",{className:"section",children:[Be.jsxs(Xv,{gutterBottom:!0,children:["Rating Range: ",["★","★★","★★★","★★★★","★★★★★"].slice(_[0]-1,_[1]).join(" - ")]}),Be.jsx(Hv,{value:_,onChange:(_e,Se)=>T(Se),valueLabelDisplay:"auto",step:1,min:1,max:5,sx:{color:"#f37474"}})]}),Be.jsxs("div",{className:"section",style:{display:"flex",justifyContent:"space-between"},children:[Be.jsxs("div",{style:{width:"45%"},children:[Be.jsx("h3",{children:"Dietary Restrictions"}),["Vegetarian","Vegan","Gluten-Free","Fast-Casual"].map(_e=>Be.jsxs("label",{children:[Be.jsx("input",{type:"checkbox",checked:S.includes(_e),onChange:()=>me(k,_e)})," ",_e]},_e))]}),Be.jsx("div",{style:{borderLeft:"2px solid",height:"200px",marginTop:"10px"}}),Be.jsxs("div",{style:{width:"45%"},children:[Be.jsx("h3",{children:"Cuisine Preferences"}),["Italian","Japanese","Mexican","Pub fare, potatoes and pints"].map(_e=>Be.jsxs("label",{children:[Be.jsx("input",{type:"checkbox",checked:o.includes(_e),onChange:()=>me(I,_e)})," ",_e]},_e))]})]}),Be.jsx("button",{className:"create-session-btn",onClick:de,children:"Create New Session"})]})},u4=()=>{const i=aa(),s=Fa(),p=new URLSearchParams(s.search).get("code")||"DEMO123",[_,T]=Ee.useState([]),[S,k]=Ee.useState(!1),[o,I]=Ee.useState(()=>{const ee=sessionStorage.getItem("isCreator");return ee?JSON.parse(ee):!0});Ee.useEffect(()=>{sessionStorage.setItem("isCreator",JSON.stringify(!0)),I(!0),T([{username:"You",isCreator:!0},{username:"Guest",isCreator:!1}])},[]);const O=()=>{navigator.clipboard.writeText(p).then(()=>{k(!0),setTimeout(()=>k(!1),2e3)})},V=()=>{var H;const ee=((H=s.state)==null?void 0:H.preferences)||{};i(`/swipe?code=${p}`,{state:{preferences:ee,isCreator:!0}})},q=()=>{i("/session-choice")};return Be.jsxs("div",{className:"filter-page",children:[Be.jsx("h1",{children:"Waiting Room"}),Be.jsxs("div",{className:"session-code",children:[Be.jsx("h3",{children:"SESSION CODE"}),Be.jsx("div",{className:"code-box",children:p}),Be.jsx("button",{onClick:O,children:S?"Copied!":"Copy Code"})]}),Be.jsxs("div",{className:"section",children:[Be.jsxs("div",{className:"label",children:["Participants (",_.length,")"]}),Be.jsx("div",{className:"participants-container",children:_.length===0?Be.jsx("p",{className:"waiting-message",children:"Waiting for your friends to join..."}):_.map((ee,H)=>Be.jsx("div",{className:"participant-item",children:Be.jsxs("span",{className:"participant-name",children:[ee.username||`Guest ${H+1}`,ee.isCreator&&Be.jsx("span",{className:"creator-badge",children:"Host"})]})},H))})]}),Be.jsx("hr",{}),Be.jsx("div",{className:"section",children:Be.jsx("p",{className:"waiting-message",children:o?"Waiting for your friends to join...":"Waiting for host to start the session..."})}),o?Be.jsx("button",{className:"create-session-btn launch-button",onClick:V,children:"Launch Session"}):Be.jsx("button",{className:"create-session-btn waiting-button",disabled:!0,children:"Waiting for Host..."}),Be.jsx("div",{className:"button-margin-top",children:Be.jsx("button",{className:"create-session-btn cancel-button",onClick:q,children:"Leave Session"})})]})};var hA={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},aE=lc.createContext&&lc.createContext(hA),c4=["attr","size","title"];function h4(i,s){if(i==null)return{};var c=d4(i,s),p,_;if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(i);for(_=0;_<T.length;_++)p=T[_],!(s.indexOf(p)>=0)&&Object.prototype.propertyIsEnumerable.call(i,p)&&(c[p]=i[p])}return c}function d4(i,s){if(i==null)return{};var c={};for(var p in i)if(Object.prototype.hasOwnProperty.call(i,p)){if(s.indexOf(p)>=0)continue;c[p]=i[p]}return c}function Sy(){return Sy=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var c=arguments[s];for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(i[p]=c[p])}return i},Sy.apply(this,arguments)}function lE(i,s){var c=Object.keys(i);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(i);s&&(p=p.filter(function(_){return Object.getOwnPropertyDescriptor(i,_).enumerable})),c.push.apply(c,p)}return c}function Cy(i){for(var s=1;s<arguments.length;s++){var c=arguments[s]!=null?arguments[s]:{};s%2?lE(Object(c),!0).forEach(function(p){f4(i,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(c)):lE(Object(c)).forEach(function(p){Object.defineProperty(i,p,Object.getOwnPropertyDescriptor(c,p))})}return i}function f4(i,s,c){return s=p4(s),s in i?Object.defineProperty(i,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[s]=c,i}function p4(i){var s=m4(i,"string");return typeof s=="symbol"?s:s+""}function m4(i,s){if(typeof i!="object"||!i)return i;var c=i[Symbol.toPrimitive];if(c!==void 0){var p=c.call(i,s);if(typeof p!="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(i)}function dA(i){return i&&i.map((s,c)=>lc.createElement(s.tag,Cy({key:c},s.attr),dA(s.child)))}function Px(i){return s=>lc.createElement(g4,Sy({attr:Cy({},i.attr)},s),dA(i.child))}function g4(i){var s=c=>{var{attr:p,size:_,title:T}=i,S=h4(i,c4),k=_||c.size||"1em",o;return c.className&&(o=c.className),i.className&&(o=(o?o+" ":"")+i.className),lc.createElement("svg",Sy({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},c.attr,p,S,{className:o,style:Cy(Cy({color:i.color||c.color},c.style),i.style),height:k,width:k,xmlns:"http://www.w3.org/2000/svg"}),T&&lc.createElement("title",null,T),i.children)};return aE!==void 0?lc.createElement(aE.Consumer,null,c=>s(c)):s(hA)}function y4(i){return Px({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"},child:[]}]})(i)}function _4(i){return Px({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(i)}function v4(i){return Px({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(i)}var Hm={};(function i(s,c,p,_){var T=!!(s.Worker&&s.Blob&&s.Promise&&s.OffscreenCanvas&&s.OffscreenCanvasRenderingContext2D&&s.HTMLCanvasElement&&s.HTMLCanvasElement.prototype.transferControlToOffscreen&&s.URL&&s.URL.createObjectURL),S=typeof Path2D=="function"&&typeof DOMMatrix=="function",k=function(){if(!s.OffscreenCanvas)return!1;var Le=new OffscreenCanvas(1,1),te=Le.getContext("2d");te.fillRect(0,0,1,1);var Ue=Le.transferToImageBitmap();try{te.createPattern(Ue,"no-repeat")}catch{return!1}return!0}();function o(){}function I(Le){var te=c.exports.Promise,Ue=te!==void 0?te:s.Promise;return typeof Ue=="function"?new Ue(Le):(Le(o,o),null)}var O=function(Le,te){return{transform:function(Ue){if(Le)return Ue;if(te.has(Ue))return te.get(Ue);var Pt=new OffscreenCanvas(Ue.width,Ue.height),kt=Pt.getContext("2d");return kt.drawImage(Ue,0,0),te.set(Ue,Pt),Pt},clear:function(){te.clear()}}}(k,new Map),V=function(){var Le=Math.floor(16.666666666666668),te,Ue,Pt={},kt=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(te=function(qt){var Wt=Math.random();return Pt[Wt]=requestAnimationFrame(function St(Ft){kt===Ft||kt+Le-1<Ft?(kt=Ft,delete Pt[Wt],qt()):Pt[Wt]=requestAnimationFrame(St)}),Wt},Ue=function(qt){Pt[qt]&&cancelAnimationFrame(Pt[qt])}):(te=function(qt){return setTimeout(qt,Le)},Ue=function(qt){return clearTimeout(qt)}),{frame:te,cancel:Ue}}(),q=function(){var Le,te,Ue={};function Pt(kt){function qt(Wt,St){kt.postMessage({options:Wt||{},callback:St})}kt.init=function(St){var Ft=St.transferControlToOffscreen();kt.postMessage({canvas:Ft},[Ft])},kt.fire=function(St,Ft,en){if(te)return qt(St,null),te;var yn=Math.random().toString(36).slice(2);return te=I(function(Bn){function Xt(Fn){Fn.data.callback===yn&&(delete Ue[yn],kt.removeEventListener("message",Xt),te=null,O.clear(),en(),Bn())}kt.addEventListener("message",Xt),qt(St,yn),Ue[yn]=Xt.bind(null,{data:{callback:yn}})}),te},kt.reset=function(){kt.postMessage({reset:!0});for(var St in Ue)Ue[St](),delete Ue[St]}}return function(){if(Le)return Le;if(!p&&T){var kt=["var CONFETTI, SIZE = {}, module = {};","("+i.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{Le=new Worker(URL.createObjectURL(new Blob([kt])))}catch(qt){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",qt),null}Pt(Le)}return Le}}(),ee={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function H(Le,te){return te?te(Le):Le}function j(Le){return Le!=null}function Z(Le,te,Ue){return H(Le&&j(Le[te])?Le[te]:ee[te],Ue)}function ne(Le){return Le<0?0:Math.floor(Le)}function xe(Le,te){return Math.floor(Math.random()*(te-Le))+Le}function ce(Le){return parseInt(Le,16)}function me(Le){return Le.map(de)}function de(Le){var te=String(Le).replace(/[^0-9a-f]/gi,"");return te.length<6&&(te=te[0]+te[0]+te[1]+te[1]+te[2]+te[2]),{r:ce(te.substring(0,2)),g:ce(te.substring(2,4)),b:ce(te.substring(4,6))}}function _e(Le){var te=Z(Le,"origin",Object);return te.x=Z(te,"x",Number),te.y=Z(te,"y",Number),te}function Se(Le){Le.width=document.documentElement.clientWidth,Le.height=document.documentElement.clientHeight}function $e(Le){var te=Le.getBoundingClientRect();Le.width=te.width,Le.height=te.height}function dt(Le){var te=document.createElement("canvas");return te.style.position="fixed",te.style.top="0px",te.style.left="0px",te.style.pointerEvents="none",te.style.zIndex=Le,te}function Y(Le,te,Ue,Pt,kt,qt,Wt,St,Ft){Le.save(),Le.translate(te,Ue),Le.rotate(qt),Le.scale(Pt,kt),Le.arc(0,0,1,Wt,St,Ft),Le.restore()}function pt(Le){var te=Le.angle*(Math.PI/180),Ue=Le.spread*(Math.PI/180);return{x:Le.x,y:Le.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:Le.startVelocity*.5+Math.random()*Le.startVelocity,angle2D:-te+(.5*Ue-Math.random()*Ue),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:Le.color,shape:Le.shape,tick:0,totalTicks:Le.ticks,decay:Le.decay,drift:Le.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:Le.gravity*3,ovalScalar:.6,scalar:Le.scalar,flat:Le.flat}}function Lt(Le,te){te.x+=Math.cos(te.angle2D)*te.velocity+te.drift,te.y+=Math.sin(te.angle2D)*te.velocity+te.gravity,te.velocity*=te.decay,te.flat?(te.wobble=0,te.wobbleX=te.x+10*te.scalar,te.wobbleY=te.y+10*te.scalar,te.tiltSin=0,te.tiltCos=0,te.random=1):(te.wobble+=te.wobbleSpeed,te.wobbleX=te.x+10*te.scalar*Math.cos(te.wobble),te.wobbleY=te.y+10*te.scalar*Math.sin(te.wobble),te.tiltAngle+=.1,te.tiltSin=Math.sin(te.tiltAngle),te.tiltCos=Math.cos(te.tiltAngle),te.random=Math.random()+2);var Ue=te.tick++/te.totalTicks,Pt=te.x+te.random*te.tiltCos,kt=te.y+te.random*te.tiltSin,qt=te.wobbleX+te.random*te.tiltCos,Wt=te.wobbleY+te.random*te.tiltSin;if(Le.fillStyle="rgba("+te.color.r+", "+te.color.g+", "+te.color.b+", "+(1-Ue)+")",Le.beginPath(),S&&te.shape.type==="path"&&typeof te.shape.path=="string"&&Array.isArray(te.shape.matrix))Le.fill(fn(te.shape.path,te.shape.matrix,te.x,te.y,Math.abs(qt-Pt)*.1,Math.abs(Wt-kt)*.1,Math.PI/10*te.wobble));else if(te.shape.type==="bitmap"){var St=Math.PI/10*te.wobble,Ft=Math.abs(qt-Pt)*.1,en=Math.abs(Wt-kt)*.1,yn=te.shape.bitmap.width*te.scalar,Bn=te.shape.bitmap.height*te.scalar,Xt=new DOMMatrix([Math.cos(St)*Ft,Math.sin(St)*Ft,-Math.sin(St)*en,Math.cos(St)*en,te.x,te.y]);Xt.multiplySelf(new DOMMatrix(te.shape.matrix));var Fn=Le.createPattern(O.transform(te.shape.bitmap),"no-repeat");Fn.setTransform(Xt),Le.globalAlpha=1-Ue,Le.fillStyle=Fn,Le.fillRect(te.x-yn/2,te.y-Bn/2,yn,Bn),Le.globalAlpha=1}else if(te.shape==="circle")Le.ellipse?Le.ellipse(te.x,te.y,Math.abs(qt-Pt)*te.ovalScalar,Math.abs(Wt-kt)*te.ovalScalar,Math.PI/10*te.wobble,0,2*Math.PI):Y(Le,te.x,te.y,Math.abs(qt-Pt)*te.ovalScalar,Math.abs(Wt-kt)*te.ovalScalar,Math.PI/10*te.wobble,0,2*Math.PI);else if(te.shape==="star")for(var pn=Math.PI/2*3,Pr=4*te.scalar,Nn=8*te.scalar,jn=te.x,Kr=te.y,Dr=5,lr=Math.PI/Dr;Dr--;)jn=te.x+Math.cos(pn)*Nn,Kr=te.y+Math.sin(pn)*Nn,Le.lineTo(jn,Kr),pn+=lr,jn=te.x+Math.cos(pn)*Pr,Kr=te.y+Math.sin(pn)*Pr,Le.lineTo(jn,Kr),pn+=lr;else Le.moveTo(Math.floor(te.x),Math.floor(te.y)),Le.lineTo(Math.floor(te.wobbleX),Math.floor(kt)),Le.lineTo(Math.floor(qt),Math.floor(Wt)),Le.lineTo(Math.floor(Pt),Math.floor(te.wobbleY));return Le.closePath(),Le.fill(),te.tick<te.totalTicks}function lt(Le,te,Ue,Pt,kt){var qt=te.slice(),Wt=Le.getContext("2d"),St,Ft,en=I(function(yn){function Bn(){St=Ft=null,Wt.clearRect(0,0,Pt.width,Pt.height),O.clear(),kt(),yn()}function Xt(){p&&!(Pt.width===_.width&&Pt.height===_.height)&&(Pt.width=Le.width=_.width,Pt.height=Le.height=_.height),!Pt.width&&!Pt.height&&(Ue(Le),Pt.width=Le.width,Pt.height=Le.height),Wt.clearRect(0,0,Pt.width,Pt.height),qt=qt.filter(function(Fn){return Lt(Wt,Fn)}),qt.length?St=V.frame(Xt):Bn()}St=V.frame(Xt),Ft=Bn});return{addFettis:function(yn){return qt=qt.concat(yn),en},canvas:Le,promise:en,reset:function(){St&&V.cancel(St),Ft&&Ft()}}}function zt(Le,te){var Ue=!Le,Pt=!!Z(te||{},"resize"),kt=!1,qt=Z(te,"disableForReducedMotion",Boolean),Wt=T&&!!Z(te||{},"useWorker"),St=Wt?q():null,Ft=Ue?Se:$e,en=Le&&St?!!Le.__confetti_initialized:!1,yn=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,Bn;function Xt(pn,Pr,Nn){for(var jn=Z(pn,"particleCount",ne),Kr=Z(pn,"angle",Number),Dr=Z(pn,"spread",Number),lr=Z(pn,"startVelocity",Number),Ii=Z(pn,"decay",Number),Zi=Z(pn,"gravity",Number),Hi=Z(pn,"drift",Number),Ri=Z(pn,"colors",me),It=Z(pn,"ticks",Number),Ht=Z(pn,"shapes"),mn=Z(pn,"scalar"),xn=!!Z(pn,"flat"),Wn=_e(pn),un=jn,tr=[],zr=Le.width*Wn.x,pr=Le.height*Wn.y;un--;)tr.push(pt({x:zr,y:pr,angle:Kr,spread:Dr,startVelocity:lr,color:Ri[un%Ri.length],shape:Ht[xe(0,Ht.length)],ticks:It,decay:Ii,gravity:Zi,drift:Hi,scalar:mn,flat:xn}));return Bn?Bn.addFettis(tr):(Bn=lt(Le,tr,Ft,Pr,Nn),Bn.promise)}function Fn(pn){var Pr=qt||Z(pn,"disableForReducedMotion",Boolean),Nn=Z(pn,"zIndex",Number);if(Pr&&yn)return I(function(lr){lr()});Ue&&Bn?Le=Bn.canvas:Ue&&!Le&&(Le=dt(Nn),document.body.appendChild(Le)),Pt&&!en&&Ft(Le);var jn={width:Le.width,height:Le.height};St&&!en&&St.init(Le),en=!0,St&&(Le.__confetti_initialized=!0);function Kr(){if(St){var lr={getBoundingClientRect:function(){if(!Ue)return Le.getBoundingClientRect()}};Ft(lr),St.postMessage({resize:{width:lr.width,height:lr.height}});return}jn.width=jn.height=null}function Dr(){Bn=null,Pt&&(kt=!1,s.removeEventListener("resize",Kr)),Ue&&Le&&(document.body.contains(Le)&&document.body.removeChild(Le),Le=null,en=!1)}return Pt&&!kt&&(kt=!0,s.addEventListener("resize",Kr,!1)),St?St.fire(pn,jn,Dr):Xt(pn,jn,Dr)}return Fn.reset=function(){St&&St.reset(),Bn&&Bn.reset()},Fn}var $n;function ln(){return $n||($n=zt(null,{useWorker:!0,resize:!0})),$n}function fn(Le,te,Ue,Pt,kt,qt,Wt){var St=new Path2D(Le),Ft=new Path2D;Ft.addPath(St,new DOMMatrix(te));var en=new Path2D;return en.addPath(Ft,new DOMMatrix([Math.cos(Wt)*kt,Math.sin(Wt)*kt,-Math.sin(Wt)*qt,Math.cos(Wt)*qt,Ue,Pt])),en}function gt(Le){if(!S)throw new Error("path confetti are not supported in this browser");var te,Ue;typeof Le=="string"?te=Le:(te=Le.path,Ue=Le.matrix);var Pt=new Path2D(te),kt=document.createElement("canvas"),qt=kt.getContext("2d");if(!Ue){for(var Wt=1e3,St=Wt,Ft=Wt,en=0,yn=0,Bn,Xt,Fn=0;Fn<Wt;Fn+=2)for(var pn=0;pn<Wt;pn+=2)qt.isPointInPath(Pt,Fn,pn,"nonzero")&&(St=Math.min(St,Fn),Ft=Math.min(Ft,pn),en=Math.max(en,Fn),yn=Math.max(yn,pn));Bn=en-St,Xt=yn-Ft;var Pr=10,Nn=Math.min(Pr/Bn,Pr/Xt);Ue=[Nn,0,0,Nn,-Math.round(Bn/2+St)*Nn,-Math.round(Xt/2+Ft)*Nn]}return{type:"path",path:te,matrix:Ue}}function Et(Le){var te,Ue=1,Pt="#000000",kt='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof Le=="string"?te=Le:(te=Le.text,Ue="scalar"in Le?Le.scalar:Ue,kt="fontFamily"in Le?Le.fontFamily:kt,Pt="color"in Le?Le.color:Pt);var qt=10*Ue,Wt=""+qt+"px "+kt,St=new OffscreenCanvas(qt,qt),Ft=St.getContext("2d");Ft.font=Wt;var en=Ft.measureText(te),yn=Math.ceil(en.actualBoundingBoxRight+en.actualBoundingBoxLeft),Bn=Math.ceil(en.actualBoundingBoxAscent+en.actualBoundingBoxDescent),Xt=2,Fn=en.actualBoundingBoxLeft+Xt,pn=en.actualBoundingBoxAscent+Xt;yn+=Xt+Xt,Bn+=Xt+Xt,St=new OffscreenCanvas(yn,Bn),Ft=St.getContext("2d"),Ft.font=Wt,Ft.fillStyle=Pt,Ft.fillText(te,Fn,pn);var Pr=1/Ue;return{type:"bitmap",bitmap:St.transferToImageBitmap(),matrix:[Pr,0,0,Pr,-yn*Pr/2,-Bn*Pr/2]}}c.exports=function(){return ln().apply(this,arguments)},c.exports.reset=function(){ln().reset()},c.exports.create=zt,c.exports.shapeFromPath=gt,c.exports.shapeFromText=Et})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Hm,!1);const x4=Hm.exports;Hm.exports.create;const w4=({restaurant:i})=>{const s=aa();Ee.useEffect(()=>{x4({particleCount:200,spread:100,origin:{y:.6}})},[]),Ee.useEffect(()=>{const p=()=>{s("/session-choice",{replace:!0})};return window.history.pushState(null,"",window.location.pathname),window.addEventListener("popstate",p),()=>{window.removeEventListener("popstate",p)}},[s]);const c=p=>{const T=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(p)}`;window.open(T,"_blank")};return Be.jsx("div",{className:"match-page-wrapper",style:{background:"radial-gradient(circle at center, rgba(0,0,0,0.7), rgba(0,0,0,0.95))",position:"fixed",top:0,left:0,height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center",padding:"1rem",overflow:"hidden",zIndex:0},children:Be.jsx(Cd.div,{className:"card-ui match-card",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:100,damping:14},style:{backgroundImage:`linear-gradient(
            to top,
            rgba(0, 0, 0, 0.6) 0%,
            rgba(0, 0, 0, 0.4) 30%,
            rgba(0, 0, 0, 0.0) 50%
          ), url(${i==null?void 0:i.image})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:Be.jsxs("div",{className:"card-body",children:[Be.jsxs(Cd.h1,{className:"match-header",initial:{scale:.8,opacity:0},animate:{scale:[1.1,1.05,1],opacity:1},transition:{duration:1,ease:"easeInOut"},children:["💘 It's a Match!",Be.jsx("span",{className:"white-sheen"})]}),Be.jsx("h2",{className:"restaurant-title",children:i==null?void 0:i.name}),Be.jsx("p",{className:"tag price",children:i==null?void 0:i["price range"]}),Be.jsx("p",{className:"tag cuisine",children:Array.isArray(i==null?void 0:i["cuisine style"])?i["cuisine style"].join(", "):""}),Be.jsxs("div",{className:"button-group",children:[Be.jsx("a",{href:`tel:${i==null?void 0:i.phone}`,children:Be.jsx("button",{className:"button pretty-button",children:Be.jsx(v4,{})})}),Be.jsx("button",{className:"button pretty-button",onClick:()=>c(i==null?void 0:i.address),children:Be.jsx(_4,{})}),Be.jsx("button",{className:"button pretty-button",onClick:()=>s("/session-choice"),children:Be.jsx(y4,{})})]})]})})})},b4=(i,s,c,p)=>{const _=I=>I*Math.PI/180,S=_(c-i),k=_(p-s),o=Math.sin(S/2)**2+Math.cos(_(i))*Math.cos(_(c))*Math.sin(k/2)**2;return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))},T4=()=>{var j;const i=Ee.useRef([]),[s,c]=Ee.useState([]),[p,_]=Ee.useState(null),[T,S]=Ee.useState(!0),[k,o]=Ee.useState(!0),I=aa(),V=((j=Fa().state)==null?void 0:j.preferences)||{cuisinePreferences:[],dietaryRestrictions:[],priceRange:[1,5],ratingRange:[1,5]},q=(Z,ne)=>{const xe=(ne.cuisinePreferences||[]).map($e=>$e.toLowerCase()),ce=(ne.dietaryRestrictions||[]).map($e=>$e.toLowerCase()),me=ne.priceRange||[1,5],de=ne.ratingRange||[1,5],_e=ne.distance||10,Se=ne.selectedLocation;return Z.filter($e=>{var zt,$n;const dt=Array.isArray($e["cuisine style"])?$e["cuisine style"].map(ln=>ln.toLowerCase()):[],pt=(($n=(zt=($e["price range"]||"").match(/[$€]+/g))==null?void 0:zt[0])==null?void 0:$n.length)||1,Lt=parseFloat($e.rating)||0;let lt=!0;return Se&&$e.lat&&$e.lng&&(lt=b4(Se.lat,Se.lng,parseFloat($e.lat),parseFloat($e.lng))<=_e),(xe.length===0||xe.some(ln=>dt.includes(ln)))&&(ce.length===0||ce.some(ln=>dt.includes(ln)))&&pt>=me[0]&&pt<=me[1]&&Lt>=de[0]&&Lt<=de[1]&&lt})};Ee.useEffect(()=>{const Z=setTimeout(()=>S(!1),1e3);return fetch("/localdata.json").then(ne=>ne.json()).then(ne=>{const xe=q(ne,V);c(xe),i.current=xe}).catch(ne=>console.error("❌ Failed to load cards:",ne)),()=>clearTimeout(Z)},[]);const ee=Z=>{const ne=s[0];ne&&(_(Z),setTimeout(()=>{c(xe=>xe.slice(1)),_(null),Z==="right"&&I("/match",{state:{restaurant:ne}})},300))},H=Z=>{ee(Z?"right":"left")};return Ee.useEffect(()=>{const Z=ne=>{const xe=ne.target.tagName.toLowerCase();xe==="input"||xe==="textarea"||(ne.key==="ArrowRight"&&(ne.preventDefault(),H(!0)),ne.key==="ArrowLeft"&&(ne.preventDefault(),H(!1)))};return window.addEventListener("keydown",Z,{passive:!1}),()=>window.removeEventListener("keydown",Z)},[]),T?Be.jsxs("div",{className:"loading-page",children:[Be.jsx("div",{className:"loader"}),Be.jsx("h2",{children:"Loading..."})]}):s.length?Be.jsxs("div",{className:"swipe-page",children:[k&&Be.jsx(Cd.div,{className:"instruction-text",initial:{opacity:1},animate:{opacity:0},exit:{opacity:0},transition:{delay:10,duration:5},children:Be.jsx("h2",{children:"Click, Drag, or Use Arrows to Swipe"})}),p&&Be.jsx(Cd.div,{className:`action ${p}`,initial:{opacity:1,scale:.8},animate:{opacity:1,scale:1.1},exit:{opacity:0,scale:0},children:p==="right"?"LIKED":"DISLIKED"}),Be.jsx("div",{className:"deck",children:Be.jsx(hE,{children:s.slice(0,3).map((Z,ne)=>{const xe=2-ne;return Be.jsx(Cd.div,{className:"card-ui",drag:"x",dragConstraints:{left:0,right:0},dragElastic:.5,onDragEnd:(ce,me)=>{me.velocity.x>.5||me.offset.x>100?ee("right"):(me.velocity.x<-.5||me.offset.x<-100)&&ee("left")},initial:{scale:1,y:xe*10,zIndex:xe},animate:{scale:1,y:xe*10,zIndex:xe},exit:{x:p==="right"?700:-700,rotate:p==="right"?15:-15,opacity:0},whileDrag:{scale:1.05},style:{backgroundImage:`linear-gradient(
                    to top,
                    rgba(0, 0, 0, 0.6) 0%,
                    rgba(0, 0, 0, 0.4) 30%,
                    rgba(0, 0, 0, 0.0) 50%
                  ), url(${Z.image})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:Be.jsxs("div",{className:"card-body",children:[Be.jsxs("div",{className:"top-row",children:[Be.jsx("h2",{children:Z.name}),Be.jsx("p",{className:"tag price",children:Z["price range"]})]}),Be.jsxs("div",{className:"bottom-row",children:[Be.jsxs("p",{className:"tag rating",children:["⭐ ",Z.rating]}),Be.jsx("p",{className:"tag cuisine",children:Array.isArray(Z["cuisine style"])?Z["cuisine style"].join(", "):""})]})]})},Z.name)})})}),Be.jsxs("div",{className:"swipe-button-group",children:[Be.jsx("button",{onClick:()=>H(!1),children:"❌ Skip"}),Be.jsx("button",{onClick:()=>H(!0),children:"❤️ Like"})]})]}):Be.jsx("h2",{style:{textAlign:"center"},children:"No more restaurants found based on preferences."})};function E4(){var p;const s=(p=Fa().state)==null?void 0:p.restaurant,c=aa();return Ee.useEffect(()=>{s||c("/swipe")},[s,c]),Be.jsx(w4,{restaurant:s})}function S4(){const[i,s]=Ee.useState([]),[c,p]=Ee.useState(null),[_,T]=Ee.useState(null),[S,k]=Ee.useState(!0),o=Fa(),I=aa();Ee.useEffect(()=>{const V=setTimeout(()=>k(!1),1e3);return fetch("/localdata.json").then(q=>{if(!q.ok)throw new Error("Failed to fetch data");return q.json()}).then(q=>s(q.reverse())).catch(q=>console.error("Error loading data:",q)),()=>clearTimeout(V)},[]),Ee.useEffect(()=>{var ee;const q=new URLSearchParams(o.search).get("session");(ee=o.state)!=null&&ee.sessionCode?T(o.state.sessionCode):q?T(q):o.pathname==="/home"&&I("/session-choice")},[o,I]);const O=(V,q)=>{p(V),setTimeout(()=>{s(ee=>ee.filter((H,j)=>j!==q)),p(null)},300)};return S?Be.jsxs("div",{className:"loading-page",children:[Be.jsx("div",{className:"loader"}),Be.jsx("h2",{children:"Loading..."})]}):Be.jsx("div",{className:"App",children:Be.jsxs(y3,{children:[Be.jsx(pl,{path:"/",element:Be.jsx(vO,{})}),Be.jsx(pl,{path:"/register",element:Be.jsx(_O,{})}),Be.jsx(pl,{path:"/login",element:Be.jsx(yO,{})}),Be.jsx(pl,{path:"/session-choice",element:Be.jsx(xO,{})}),Be.jsx(pl,{path:"/filter-page",element:Be.jsx(l4,{})}),Be.jsx(pl,{path:"/swipe",element:Be.jsx(T4,{})}),Be.jsx(pl,{path:"/waiting-room",element:Be.jsx(u4,{})}),Be.jsx(pl,{path:"/match",element:Be.jsx(E4,{})}),Be.jsx(pl,{path:"/map",element:Be.jsx(jD,{})}),Be.jsx(pl,{path:"/home",element:_?Be.jsxs(Be.Fragment,{children:[Be.jsx("h1",{children:"Swipe Deck"}),Be.jsxs("h2",{children:["Session code: ",_]}),c&&Be.jsx(Cd.div,{className:`action ${c}`,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1.1},exit:{opacity:0,scale:0},children:c==="right"?"LIKED":"DISLIKED"}),Be.jsx("div",{className:"deck",children:Be.jsx(hE,{children:i.slice(-3).map((V,q)=>{const ee=i.length-3+q;return Be.jsx(Cd.div,{className:"card-ui",drag:"x",dragConstraints:{left:0,right:0},dragElastic:.5,onDragEnd:(H,j)=>{j.velocity.x>.5||j.offset.x>100?O("right",ee):(j.velocity.x<-.5||j.offset.x<-100)&&O("left",ee)},initial:{scale:1,y:q*10,zIndex:q},animate:{scale:1,y:q*10,zIndex:q},exit:{x:c==="right"?700:-700,rotate:c==="right"?15:-15,opacity:0},whileDrag:{scale:1.05},style:{backgroundImage:`linear-gradient(to top, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.4) 30%, rgba(0,0,0,0.0) 50%), url(${V.image})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:Be.jsxs("div",{className:"card-body",children:[Be.jsxs("div",{className:"top-row",children:[Be.jsx("h2",{children:V.name}),Be.jsx("p",{className:"tag price",children:V["price range"]})]}),Be.jsxs("div",{className:"bottom-row",children:[Be.jsxs("p",{className:"tag rating",children:["⭐ ",V.rating]}),Be.jsx("p",{className:"tag cuisine",children:Array.isArray(V["cuisine style"])?V["cuisine style"].join(", "):""})]})]})},V.name)})})})]}):null})]})})}function C4(){return Be.jsx(j3,{children:Be.jsx(S4,{})})}qM.createRoot(document.getElementById("root")).render(Be.jsx(lc.StrictMode,{children:Be.jsx(C4,{})}))});export default A4();
